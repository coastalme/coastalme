<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>CoastalME (Coastal Modelling Environment): create_polygons.cpp Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<script type="text/javascript" src="../../clipboard.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../cookie.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">CoastalME (Coastal Modelling Environment)
   </div>
   <div id="projectbrief">Simulates the long-term behaviour of complex coastlines</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(1); });
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('d6/d91/create__polygons_8cpp_source.html','../../'); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">create_polygons.cpp</div></div>
</div><!--header-->
<div class="contents">
<a href="../../d6/d91/create__polygons_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno">    1</span> </div>
<div class="line"><a id="l00014" name="l00014"></a><span class="lineno">   14</span><span class="comment">/*==============================================================================================================================</span></div>
<div class="line"><a id="l00015" name="l00015"></a><span class="lineno">   15</span><span class="comment"></span> </div>
<div class="line"><a id="l00016" name="l00016"></a><span class="lineno">   16</span><span class="comment">This file is part of CoastalME, the Coastal Modelling Environment.</span></div>
<div class="line"><a id="l00017" name="l00017"></a><span class="lineno">   17</span><span class="comment"></span> </div>
<div class="line"><a id="l00018" name="l00018"></a><span class="lineno">   18</span><span class="comment">CoastalME is free software; you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation; either version 3 of the License, or (at your option) any later version.</span></div>
<div class="line"><a id="l00019" name="l00019"></a><span class="lineno">   19</span><span class="comment"></span> </div>
<div class="line"><a id="l00020" name="l00020"></a><span class="lineno">   20</span><span class="comment">This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.</span></div>
<div class="line"><a id="l00021" name="l00021"></a><span class="lineno">   21</span><span class="comment"></span> </div>
<div class="line"><a id="l00022" name="l00022"></a><span class="lineno">   22</span><span class="comment">You should have received a copy of the GNU General Public License along with this program; if not, write to the Free Software Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.</span></div>
<div class="line"><a id="l00023" name="l00023"></a><span class="lineno">   23</span><span class="comment"></span> </div>
<div class="line"><a id="l00024" name="l00024"></a><span class="lineno">   24</span><span class="comment">==============================================================================================================================*/</span></div>
<div class="line"><a id="l00025" name="l00025"></a><span class="lineno">   25</span><span class="preprocessor">#include &lt;assert.h&gt;</span></div>
<div class="line"><a id="l00026" name="l00026"></a><span class="lineno">   26</span><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><a id="l00027" name="l00027"></a><span class="lineno">   27</span><span class="keyword">using </span>std::endl;</div>
<div class="line"><a id="l00028" name="l00028"></a><span class="lineno">   28</span> </div>
<div class="line"><a id="l00029" name="l00029"></a><span class="lineno">   29</span><span class="preprocessor">#include &lt;string&gt;</span></div>
<div class="line"><a id="l00030" name="l00030"></a><span class="lineno">   30</span><span class="keyword">using </span>std::to_string;</div>
<div class="line"><a id="l00031" name="l00031"></a><span class="lineno">   31</span> </div>
<div class="line"><a id="l00032" name="l00032"></a><span class="lineno">   32</span><span class="preprocessor">#include &lt;stack&gt;</span></div>
<div class="line"><a id="l00033" name="l00033"></a><span class="lineno">   33</span><span class="keyword">using </span>std::stack;</div>
<div class="line"><a id="l00034" name="l00034"></a><span class="lineno">   34</span> </div>
<div class="line"><a id="l00035" name="l00035"></a><span class="lineno">   35</span><span class="preprocessor">#include &quot;<a class="code" href="../../d6/d2a/cme_8h.html">cme.h</a>&quot;</span></div>
<div class="line"><a id="l00036" name="l00036"></a><span class="lineno">   36</span><span class="preprocessor">#include &quot;<a class="code" href="../../dd/d6a/simulation_8h.html">simulation.h</a>&quot;</span></div>
<div class="line"><a id="l00037" name="l00037"></a><span class="lineno">   37</span><span class="preprocessor">#include &quot;<a class="code" href="../../de/d65/coast_8h.html">coast.h</a>&quot;</span></div>
<div class="line"><a id="l00038" name="l00038"></a><span class="lineno">   38</span> </div>
<div class="line"><a id="l00039" name="l00039"></a><span class="lineno">   39</span><span class="comment">//===============================================================================================================================</span></div>
<div class="line"><a id="l00041" name="l00041"></a><span class="lineno">   41</span><span class="comment">//===============================================================================================================================</span></div>
<div class="foldopen" id="foldopen00042" data-start="{" data-end="}">
<div class="line"><a id="l00042" name="l00042"></a><span class="lineno"><a class="line" href="../../d1/d98/classCSimulation.html#a736d521c8e0c2b59218e5cc4af03818c">   42</a></span><span class="keywordtype">int</span> <a class="code hl_function" href="../../d1/d98/classCSimulation.html#a736d521c8e0c2b59218e5cc4af03818c">CSimulation::nCreateAllPolygons</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a id="l00043" name="l00043"></a><span class="lineno">   43</span>{</div>
<div class="line"><a id="l00044" name="l00044"></a><span class="lineno">   44</span>   <span class="comment">// Global polygon count</span></div>
<div class="line"><a id="l00045" name="l00045"></a><span class="lineno">   45</span>   <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#adca826b2787fe966fbcb03aac09f9049">m_nGlobalPolygonID</a> = -1;</div>
<div class="line"><a id="l00046" name="l00046"></a><span class="lineno">   46</span> </div>
<div class="line"><a id="l00047" name="l00047"></a><span class="lineno">   47</span>   <span class="comment">// Do this for each coast</span></div>
<div class="line"><a id="l00048" name="l00048"></a><span class="lineno">   48</span>   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> nCoast = 0; nCoast &lt; static_cast&lt;int&gt;(<a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a25ada8139c82ca7beab3f279cff83184">m_VCoast</a>.size()); nCoast++)</div>
<div class="line"><a id="l00049" name="l00049"></a><span class="lineno">   49</span>   {</div>
<div class="line"><a id="l00050" name="l00050"></a><span class="lineno">   50</span>      <span class="comment">// Do this for every point on the coastline</span></div>
<div class="line"><a id="l00051" name="l00051"></a><span class="lineno">   51</span>      <span class="keywordtype">int</span> nPolygon = -1;          <span class="comment">// This-coast-only polygon ID</span></div>
<div class="line"><a id="l00052" name="l00052"></a><span class="lineno">   52</span>      <span class="keywordtype">int</span> nNode = -1;</div>
<div class="line"><a id="l00053" name="l00053"></a><span class="lineno">   53</span>      <span class="keywordtype">int</span> nPrevProfileCoastPoint = -1;</div>
<div class="line"><a id="l00054" name="l00054"></a><span class="lineno">   54</span>      <span class="keywordtype">int</span> nPrevProfile = -1;</div>
<div class="line"><a id="l00055" name="l00055"></a><span class="lineno">   55</span> </div>
<div class="line"><a id="l00056" name="l00056"></a><span class="lineno">   56</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> nCoastPoint = 0; nCoastPoint &lt; <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a25ada8139c82ca7beab3f279cff83184">m_VCoast</a>[nCoast].nGetCoastlineSize(); nCoastPoint++)</div>
<div class="line"><a id="l00057" name="l00057"></a><span class="lineno">   57</span>      {</div>
<div class="line"><a id="l00058" name="l00058"></a><span class="lineno">   58</span>         <span class="keywordtype">int</span> nThisProfile = <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a25ada8139c82ca7beab3f279cff83184">m_VCoast</a>[nCoast].nGetProfileNumber(nCoastPoint);</div>
<div class="line"><a id="l00059" name="l00059"></a><span class="lineno">   59</span>         <a class="code hl_class" href="../../da/dae/classCGeomProfile.html">CGeomProfile</a>* pThisProfile = <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a25ada8139c82ca7beab3f279cff83184">m_VCoast</a>[nCoast].pGetProfile(nThisProfile);</div>
<div class="line"><a id="l00060" name="l00060"></a><span class="lineno">   60</span> </div>
<div class="line"><a id="l00061" name="l00061"></a><span class="lineno">   61</span>         <span class="keywordflow">if</span> ((nThisProfile != <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#a01aa8b423260b337ddff2016107b51a0">INT_NODATA</a>) &amp;&amp; (pThisProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#aac223e2610d50ca2c7eadaf8542e9498">bOKIncStartAndEndOfCoast</a>()))</div>
<div class="line"><a id="l00062" name="l00062"></a><span class="lineno">   62</span>         {</div>
<div class="line"><a id="l00063" name="l00063"></a><span class="lineno">   63</span>            <span class="comment">// There is a valid profile at this coast point</span></div>
<div class="line"><a id="l00064" name="l00064"></a><span class="lineno">   64</span>            <span class="keywordflow">if</span> (nPrevProfileCoastPoint &gt;= 0)</div>
<div class="line"><a id="l00065" name="l00065"></a><span class="lineno">   65</span>            {</div>
<div class="line"><a id="l00066" name="l00066"></a><span class="lineno">   66</span>               <span class="comment">// Calculate half the along-coast distance (in coast points) between this profile and the previous (i.e. up-coast) profile</span></div>
<div class="line"><a id="l00067" name="l00067"></a><span class="lineno">   67</span>               <span class="keywordtype">int</span> nDist = (nCoastPoint - nPrevProfileCoastPoint) / 2;</div>
<div class="line"><a id="l00068" name="l00068"></a><span class="lineno">   68</span> </div>
<div class="line"><a id="l00069" name="l00069"></a><span class="lineno">   69</span>               <span class="comment">// OK, set the node point in the coast object. We do this now, instead of earlier on, since some profiles (i.e. polygon boundaries) may have been marked as invalid</span></div>
<div class="line"><a id="l00070" name="l00070"></a><span class="lineno">   70</span>               <span class="keywordtype">int</span> nNodePoint = nCoastPoint - nDist;</div>
<div class="line"><a id="l00071" name="l00071"></a><span class="lineno">   71</span>               <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a25ada8139c82ca7beab3f279cff83184">m_VCoast</a>[nCoast].SetPolygonNode(nNodePoint, ++nNode);</div>
<div class="line"><a id="l00072" name="l00072"></a><span class="lineno">   72</span> </div>
<div class="line"><a id="l00073" name="l00073"></a><span class="lineno">   73</span>               <span class="comment">// Get the grid CRS co-ordinates of the coast node</span></div>
<div class="line"><a id="l00074" name="l00074"></a><span class="lineno">   74</span>               <a class="code hl_class" href="../../d6/d0d/classCGeom2DIPoint.html">CGeom2DIPoint</a> PtiNode = *<a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a25ada8139c82ca7beab3f279cff83184">m_VCoast</a>[nCoast].pPtiGetCellMarkedAsCoastline(nNodePoint);</div>
<div class="line"><a id="l00075" name="l00075"></a><span class="lineno">   75</span> </div>
<div class="line"><a id="l00076" name="l00076"></a><span class="lineno">   76</span>               <span class="comment">// Get the previous profile, also set some defaults (assuming for now that this polygon is not approximately triangular i.e. both normals do not meet)</span></div>
<div class="line"><a id="l00077" name="l00077"></a><span class="lineno">   77</span>               <a class="code hl_class" href="../../da/dae/classCGeomProfile.html">CGeomProfile</a>* pPrevProfile = <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a25ada8139c82ca7beab3f279cff83184">m_VCoast</a>[nCoast].pGetProfile(nPrevProfile);</div>
<div class="line"><a id="l00078" name="l00078"></a><span class="lineno">   78</span>               <span class="keywordtype">int</span> nPrevProfileEnd = pPrevProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#abaf88697019588a2b0901bd19044aee4">nGetProfileSize</a>()-1;</div>
<div class="line"><a id="l00079" name="l00079"></a><span class="lineno">   79</span>               <span class="keywordtype">int</span> nThisProfileEnd = pThisProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#abaf88697019588a2b0901bd19044aee4">nGetProfileSize</a>()-1;</div>
<div class="line"><a id="l00080" name="l00080"></a><span class="lineno">   80</span>               <span class="keywordtype">bool</span> bMeetsAtAPoint = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00081" name="l00081"></a><span class="lineno">   81</span>               <a class="code hl_class" href="../../d5/d4e/classCGeom2DPoint.html">CGeom2DPoint</a> PtCoastwardTip;</div>
<div class="line"><a id="l00082" name="l00082"></a><span class="lineno">   82</span> </div>
<div class="line"><a id="l00083" name="l00083"></a><span class="lineno">   83</span><span class="comment">//                // DEBUG CODE =============================</span></div>
<div class="line"><a id="l00084" name="l00084"></a><span class="lineno">   84</span><span class="comment">//                CGeom2DPoint PtPrevEndTmp = *pPrevProfile-&gt;pPtGetPointInProfile(nPrevProfileEnd);</span></div>
<div class="line"><a id="l00085" name="l00085"></a><span class="lineno">   85</span><span class="comment">//                double</span></div>
<div class="line"><a id="l00086" name="l00086"></a><span class="lineno">   86</span><span class="comment">//                   dXTmp = dExtCRSXToGridX(PtPrevEndTmp.dGetX()),</span></div>
<div class="line"><a id="l00087" name="l00087"></a><span class="lineno">   87</span><span class="comment">//                   dYTmp = dExtCRSYToGridY(PtPrevEndTmp.dGetY());</span></div>
<div class="line"><a id="l00088" name="l00088"></a><span class="lineno">   88</span><span class="comment">//                assert(bIsWithinValidGrid(dXTmp, dYTmp));</span></div>
<div class="line"><a id="l00089" name="l00089"></a><span class="lineno">   89</span><span class="comment">//</span></div>
<div class="line"><a id="l00090" name="l00090"></a><span class="lineno">   90</span><span class="comment">//                CGeom2DPoint PtThisEndTmp = *pThisProfile-&gt;pPtGetPointInProfile(nThisProfileEnd);</span></div>
<div class="line"><a id="l00091" name="l00091"></a><span class="lineno">   91</span><span class="comment">//                dXTmp = dExtCRSXToGridX(PtThisEndTmp.dGetX());</span></div>
<div class="line"><a id="l00092" name="l00092"></a><span class="lineno">   92</span><span class="comment">//                dYTmp = dExtCRSYToGridY(PtThisEndTmp.dGetY());</span></div>
<div class="line"><a id="l00093" name="l00093"></a><span class="lineno">   93</span><span class="comment">//                assert(bIsWithinValidGrid(dXTmp, dYTmp));</span></div>
<div class="line"><a id="l00094" name="l00094"></a><span class="lineno">   94</span><span class="comment">//                // DEBUG CODE =============================</span></div>
<div class="line"><a id="l00095" name="l00095"></a><span class="lineno">   95</span> </div>
<div class="line"><a id="l00096" name="l00096"></a><span class="lineno">   96</span>               <span class="comment">// Now check to see if the two normals do meet i.e. if they are coincident</span></div>
<div class="line"><a id="l00097" name="l00097"></a><span class="lineno">   97</span>               <span class="keywordflow">if</span> (pThisProfile-&gt;<a class="code hl_function" href="../../d0/d89/classCGeomMultiLine.html#a397a6f2cc166220b5342cf3444e16753">bFindProfileInCoincidentProfiles</a>(nPrevProfile))</div>
<div class="line"><a id="l00098" name="l00098"></a><span class="lineno">   98</span>               {</div>
<div class="line"><a id="l00099" name="l00099"></a><span class="lineno">   99</span>                  <span class="comment">// Yes they do meet</span></div>
<div class="line"><a id="l00100" name="l00100"></a><span class="lineno">  100</span>                  bMeetsAtAPoint = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00101" name="l00101"></a><span class="lineno">  101</span> </div>
<div class="line"><a id="l00102" name="l00102"></a><span class="lineno">  102</span>                  <span class="comment">// Find the most coastward point at which this normal and the previous normal touch. If they do not touch, the polygon requires a &#39;joining line&#39;</span></div>
<div class="line"><a id="l00103" name="l00103"></a><span class="lineno">  103</span>                  pThisProfile-&gt;<a class="code hl_function" href="../../d0/d89/classCGeomMultiLine.html#a6dd16a3f527b6a681fbddd8a68e9deaf">GetMostCoastwardSharedLineSegment</a>(nPrevProfile, nThisProfileEnd, nPrevProfileEnd);</div>
<div class="line"><a id="l00104" name="l00104"></a><span class="lineno">  104</span>                  <span class="keywordflow">if</span> (nThisProfileEnd == -1)</div>
<div class="line"><a id="l00105" name="l00105"></a><span class="lineno">  105</span>                  {</div>
<div class="line"><a id="l00106" name="l00106"></a><span class="lineno">  106</span>                     <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a222962121613613a48f518e0c2110f21">LogStream</a> &lt;&lt; <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#ad67e8c5b30a0572f64ecfb5c062c2edc">m_ulIter</a> &lt;&lt; <span class="stringliteral">&quot;: &quot;</span> &lt;&lt; <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#a292fc90846543ca4814daa9f759feb05">ERR</a> &lt;&lt; <span class="stringliteral">&quot;profile &quot;</span> &lt;&lt; nPrevProfile &lt;&lt; <span class="stringliteral">&quot; should be coincident with profile &quot;</span> &lt;&lt; nThisProfile &lt;&lt; <span class="stringliteral">&quot; but was not found&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a id="l00107" name="l00107"></a><span class="lineno">  107</span>                     <span class="keywordflow">return</span> <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#aa2941c3f10e5c29aa29a01fb6f7e91a6">RTN_ERR_BAD_MULTILINE</a>;</div>
<div class="line"><a id="l00108" name="l00108"></a><span class="lineno">  108</span>                  }</div>
<div class="line"><a id="l00109" name="l00109"></a><span class="lineno">  109</span> </div>
<div class="line"><a id="l00110" name="l00110"></a><span class="lineno">  110</span>                  PtCoastwardTip = *pThisProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#aaa8ddb9c775927bdb7940f7826f90a74">pPtGetPointInProfile</a>(nThisProfileEnd);</div>
<div class="line"><a id="l00111" name="l00111"></a><span class="lineno">  111</span>               }</div>
<div class="line"><a id="l00112" name="l00112"></a><span class="lineno">  112</span> </div>
<div class="line"><a id="l00113" name="l00113"></a><span class="lineno">  113</span>               <span class="comment">// Next, calculate the polygon&#39;s boundary (external CRS), do this in an anti-clockwise sequence</span></div>
<div class="line"><a id="l00114" name="l00114"></a><span class="lineno">  114</span>               vector&lt;CGeom2DPoint&gt; PtVBoundary;</div>
<div class="line"><a id="l00115" name="l00115"></a><span class="lineno">  115</span> </div>
<div class="line"><a id="l00116" name="l00116"></a><span class="lineno">  116</span>               <span class="comment">// Start appending points: begin at the node point, then move down-coast as far as the down-coast (this) normal</span></div>
<div class="line"><a id="l00117" name="l00117"></a><span class="lineno">  117</span>               <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = nNodePoint; i &lt;= nCoastPoint; i++)</div>
<div class="line"><a id="l00118" name="l00118"></a><span class="lineno">  118</span>                  PtVBoundary.push_back(*<a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a25ada8139c82ca7beab3f279cff83184">m_VCoast</a>[nCoast].pPtGetCoastlinePointExtCRS(i));</div>
<div class="line"><a id="l00119" name="l00119"></a><span class="lineno">  119</span> </div>
<div class="line"><a id="l00120" name="l00120"></a><span class="lineno">  120</span>               <span class="comment">// Use the penultimate coastline point as the start point for the point-in-polygon search later, during flood fill</span></div>
<div class="line"><a id="l00121" name="l00121"></a><span class="lineno">  121</span>               <span class="keywordtype">int</span> nPointInPolygonStartPoint = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(PtVBoundary.size()) - 2;</div>
<div class="line"><a id="l00122" name="l00122"></a><span class="lineno">  122</span> </div>
<div class="line"><a id="l00123" name="l00123"></a><span class="lineno">  123</span>               <span class="comment">// Append the points in the down-coast normal. Omit the last point of this normal if the the most seaward point of the this normal, and the most seaward point of the up-coast (previous) normal are the same</span></div>
<div class="line"><a id="l00124" name="l00124"></a><span class="lineno">  124</span>               <span class="keywordtype">int</span> nFinishPoint = nThisProfileEnd;</div>
<div class="line"><a id="l00125" name="l00125"></a><span class="lineno">  125</span> </div>
<div class="line"><a id="l00126" name="l00126"></a><span class="lineno">  126</span>               <span class="keywordflow">if</span> (bMeetsAtAPoint)</div>
<div class="line"><a id="l00127" name="l00127"></a><span class="lineno">  127</span>                  nFinishPoint--;</div>
<div class="line"><a id="l00128" name="l00128"></a><span class="lineno">  128</span> </div>
<div class="line"><a id="l00129" name="l00129"></a><span class="lineno">  129</span>               <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= nFinishPoint; i++)</div>
<div class="line"><a id="l00130" name="l00130"></a><span class="lineno">  130</span>               {</div>
<div class="line"><a id="l00131" name="l00131"></a><span class="lineno">  131</span>                  <a class="code hl_class" href="../../d5/d4e/classCGeom2DPoint.html">CGeom2DPoint</a> PtThis = *pThisProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#aaa8ddb9c775927bdb7940f7826f90a74">pPtGetPointInProfile</a>(i);</div>
<div class="line"><a id="l00132" name="l00132"></a><span class="lineno">  132</span>                  <span class="keywordflow">if</span> (! (PtThis == &amp;PtVBoundary.back()))</div>
<div class="line"><a id="l00133" name="l00133"></a><span class="lineno">  133</span>                     PtVBoundary.push_back(PtThis);</div>
<div class="line"><a id="l00134" name="l00134"></a><span class="lineno">  134</span>               }</div>
<div class="line"><a id="l00135" name="l00135"></a><span class="lineno">  135</span> </div>
<div class="line"><a id="l00136" name="l00136"></a><span class="lineno">  136</span>               <span class="comment">// Append the points in the up-coast (previous) normal, in reverse order</span></div>
<div class="line"><a id="l00137" name="l00137"></a><span class="lineno">  137</span>               <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = nPrevProfileEnd; i &gt;= 0; i--)</div>
<div class="line"><a id="l00138" name="l00138"></a><span class="lineno">  138</span>               {</div>
<div class="line"><a id="l00139" name="l00139"></a><span class="lineno">  139</span>                  <a class="code hl_class" href="../../d5/d4e/classCGeom2DPoint.html">CGeom2DPoint</a> PtThis = *pPrevProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#aaa8ddb9c775927bdb7940f7826f90a74">pPtGetPointInProfile</a>(i);</div>
<div class="line"><a id="l00140" name="l00140"></a><span class="lineno">  140</span>                  <span class="keywordflow">if</span> (! (PtThis == &amp;PtVBoundary.back()))</div>
<div class="line"><a id="l00141" name="l00141"></a><span class="lineno">  141</span>                     PtVBoundary.push_back(PtThis);</div>
<div class="line"><a id="l00142" name="l00142"></a><span class="lineno">  142</span>               }</div>
<div class="line"><a id="l00143" name="l00143"></a><span class="lineno">  143</span> </div>
<div class="line"><a id="l00144" name="l00144"></a><span class="lineno">  144</span>               <span class="comment">// Append the points from the remaining bit of coast, moving down-coast to finish at the node point. Note that we must include the node point here, in order to obtain a closed polygon</span></div>
<div class="line"><a id="l00145" name="l00145"></a><span class="lineno">  145</span>               <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = nPrevProfileCoastPoint; i &lt;= nNodePoint; i++)</div>
<div class="line"><a id="l00146" name="l00146"></a><span class="lineno">  146</span>               {</div>
<div class="line"><a id="l00147" name="l00147"></a><span class="lineno">  147</span>                  <a class="code hl_class" href="../../d5/d4e/classCGeom2DPoint.html">CGeom2DPoint</a> PtThis = *<a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a25ada8139c82ca7beab3f279cff83184">m_VCoast</a>[nCoast].pPtGetCoastlinePointExtCRS(i);</div>
<div class="line"><a id="l00148" name="l00148"></a><span class="lineno">  148</span>                  <span class="keywordflow">if</span> (! (PtThis == &amp;PtVBoundary.back()))</div>
<div class="line"><a id="l00149" name="l00149"></a><span class="lineno">  149</span>                     PtVBoundary.push_back(PtThis);</div>
<div class="line"><a id="l00150" name="l00150"></a><span class="lineno">  150</span>               }</div>
<div class="line"><a id="l00151" name="l00151"></a><span class="lineno">  151</span> </div>
<div class="line"><a id="l00152" name="l00152"></a><span class="lineno">  152</span>               <span class="comment">// Now identify the &#39;anti-node&#39;, this is the seaward point &#39;opposite&#39; the polygon&#39;s coastal node</span></div>
<div class="line"><a id="l00153" name="l00153"></a><span class="lineno">  153</span>               <a class="code hl_class" href="../../d6/d0d/classCGeom2DIPoint.html">CGeom2DIPoint</a> PtiAntiNode;</div>
<div class="line"><a id="l00154" name="l00154"></a><span class="lineno">  154</span>               <span class="keywordflow">if</span> (bMeetsAtAPoint)</div>
<div class="line"><a id="l00155" name="l00155"></a><span class="lineno">  155</span>                  PtiAntiNode = <a class="code hl_function" href="../../d1/d98/classCSimulation.html#a1cdb36fc97d2f40d471edc2d59734960">PtiExtCRSToGridRound</a>(&amp;PtCoastwardTip);</div>
<div class="line"><a id="l00156" name="l00156"></a><span class="lineno">  156</span>               <span class="keywordflow">else</span></div>
<div class="line"><a id="l00157" name="l00157"></a><span class="lineno">  157</span>               {</div>
<div class="line"><a id="l00158" name="l00158"></a><span class="lineno">  158</span>                  <a class="code hl_class" href="../../d5/d4e/classCGeom2DPoint.html">CGeom2DPoint</a> PtAvg = <a class="code hl_function" href="../../d1/d98/classCSimulation.html#a41d2806566f688547f97c0d573bb1611">PtAverage</a>(pThisProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#aaa8ddb9c775927bdb7940f7826f90a74">pPtGetPointInProfile</a>(nThisProfileEnd), pPrevProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#aaa8ddb9c775927bdb7940f7826f90a74">pPtGetPointInProfile</a>(nPrevProfileEnd));</div>
<div class="line"><a id="l00159" name="l00159"></a><span class="lineno">  159</span>                  PtiAntiNode = <a class="code hl_function" href="../../d1/d98/classCSimulation.html#a1cdb36fc97d2f40d471edc2d59734960">PtiExtCRSToGridRound</a>(&amp;PtAvg);</div>
<div class="line"><a id="l00160" name="l00160"></a><span class="lineno">  160</span>               }</div>
<div class="line"><a id="l00161" name="l00161"></a><span class="lineno">  161</span> </div>
<div class="line"><a id="l00162" name="l00162"></a><span class="lineno">  162</span>               <span class="comment">// Safety check</span></div>
<div class="line"><a id="l00163" name="l00163"></a><span class="lineno">  163</span> </div>
<div class="line"><a id="l00164" name="l00164"></a><span class="lineno">  164</span>               <span class="comment">// Create the coast&#39;s polygon object</span></div>
<div class="line"><a id="l00165" name="l00165"></a><span class="lineno">  165</span>               <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a25ada8139c82ca7beab3f279cff83184">m_VCoast</a>[nCoast].CreatePolygon(++<a class="code hl_variable" href="../../d1/d98/classCSimulation.html#adca826b2787fe966fbcb03aac09f9049">m_nGlobalPolygonID</a>, ++nPolygon, nNodePoint, &amp;PtiNode, &amp;PtiAntiNode, nPrevProfile, nThisProfile, &amp;PtVBoundary, nPrevProfileEnd+1, nThisProfileEnd+1, nPointInPolygonStartPoint);</div>
<div class="line"><a id="l00166" name="l00166"></a><span class="lineno">  166</span> </div>
<div class="line"><a id="l00167" name="l00167"></a><span class="lineno">  167</span>               <span class="comment">// Get a pointer to this polygon object</span></div>
<div class="line"><a id="l00168" name="l00168"></a><span class="lineno">  168</span>               <a class="code hl_class" href="../../df/d45/classCGeomCoastPolygon.html">CGeomCoastPolygon</a>* pPolygon = <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a25ada8139c82ca7beab3f279cff83184">m_VCoast</a>[nCoast].pGetPolygon(nPolygon);</div>
<div class="line"><a id="l00169" name="l00169"></a><span class="lineno">  169</span> </div>
<div class="line"><a id="l00170" name="l00170"></a><span class="lineno">  170</span>               <span class="comment">// And store this pointer for simulation-wide access</span></div>
<div class="line"><a id="l00171" name="l00171"></a><span class="lineno">  171</span>               <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#afdf9931c6687dab00b0f48c0709d6c8a">m_pVCoastPolygon</a>.push_back(pPolygon);</div>
<div class="line"><a id="l00172" name="l00172"></a><span class="lineno">  172</span> </div>
<div class="line"><a id="l00173" name="l00173"></a><span class="lineno">  173</span>               <span class="comment">// Now rasterize the polygon boundaries: first, the coastline. This is necessary so that sand/coarse sediment derived from platform erosion of the coast cells is correctly added to the containing polygon&#39;s unconsolidated sediment</span></div>
<div class="line"><a id="l00174" name="l00174"></a><span class="lineno">  174</span>               <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = nPrevProfileCoastPoint; i &lt;= nCoastPoint; i++)</div>
<div class="line"><a id="l00175" name="l00175"></a><span class="lineno">  175</span>               {</div>
<div class="line"><a id="l00176" name="l00176"></a><span class="lineno">  176</span>                  <a class="code hl_class" href="../../d6/d0d/classCGeom2DIPoint.html">CGeom2DIPoint</a> PtiToMark = *<a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a25ada8139c82ca7beab3f279cff83184">m_VCoast</a>[nCoast].pPtiGetCellMarkedAsCoastline(i);</div>
<div class="line"><a id="l00177" name="l00177"></a><span class="lineno">  177</span>                  <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;<a class="code hl_variable" href="../../d6/d3e/classCGeomRasterGrid.html#a1c337248d939a7775ffca16b86e7a93b">m_Cell</a>[PtiToMark.<a class="code hl_function" href="../../d6/d0d/classCGeom2DIPoint.html#af84c687b2d0be01ab41cbcc0565f4f3f">nGetX</a>()][PtiToMark.<a class="code hl_function" href="../../d6/d0d/classCGeom2DIPoint.html#a4d9c20bcca90dcb9d519b664aba09cbd">nGetY</a>()].<a class="code hl_function" href="../../d1/dd9/classCGeomCell.html#a6f998fef62c1873fdee5f2685544aad4">SetPolygonID</a>(<a class="code hl_variable" href="../../d1/d98/classCSimulation.html#adca826b2787fe966fbcb03aac09f9049">m_nGlobalPolygonID</a>);</div>
<div class="line"><a id="l00178" name="l00178"></a><span class="lineno">  178</span>               }</div>
<div class="line"><a id="l00179" name="l00179"></a><span class="lineno">  179</span> </div>
<div class="line"><a id="l00180" name="l00180"></a><span class="lineno">  180</span>               <span class="comment">// Do the upcoast normal profile (does the whole length, including any shared line segments. So some cells are marked twice, however this is not a problem)</span></div>
<div class="line"><a id="l00181" name="l00181"></a><span class="lineno">  181</span>               <span class="keywordtype">int</span> nCellsInProfile = pPrevProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#a8a29c3fa364ab1f7b3930b7a9c83f45f">nGetNumCellsInProfile</a>();</div>
<div class="line"><a id="l00182" name="l00182"></a><span class="lineno">  182</span>               <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nCellsInProfile; i++)</div>
<div class="line"><a id="l00183" name="l00183"></a><span class="lineno">  183</span>               {</div>
<div class="line"><a id="l00184" name="l00184"></a><span class="lineno">  184</span>                  <a class="code hl_class" href="../../d6/d0d/classCGeom2DIPoint.html">CGeom2DIPoint</a> PtiToMark = *pPrevProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#a6d13079f744085f2d132405e0120ca54">pPtiGetCellInProfile</a>(i);</div>
<div class="line"><a id="l00185" name="l00185"></a><span class="lineno">  185</span>                  <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;<a class="code hl_variable" href="../../d6/d3e/classCGeomRasterGrid.html#a1c337248d939a7775ffca16b86e7a93b">m_Cell</a>[PtiToMark.<a class="code hl_function" href="../../d6/d0d/classCGeom2DIPoint.html#af84c687b2d0be01ab41cbcc0565f4f3f">nGetX</a>()][PtiToMark.<a class="code hl_function" href="../../d6/d0d/classCGeom2DIPoint.html#a4d9c20bcca90dcb9d519b664aba09cbd">nGetY</a>()].<a class="code hl_function" href="../../d1/dd9/classCGeomCell.html#a6f998fef62c1873fdee5f2685544aad4">SetPolygonID</a>(<a class="code hl_variable" href="../../d1/d98/classCSimulation.html#adca826b2787fe966fbcb03aac09f9049">m_nGlobalPolygonID</a>);</div>
<div class="line"><a id="l00186" name="l00186"></a><span class="lineno">  186</span>               }</div>
<div class="line"><a id="l00187" name="l00187"></a><span class="lineno">  187</span> </div>
<div class="line"><a id="l00188" name="l00188"></a><span class="lineno">  188</span>               <span class="comment">// Do the downcoast normal profile (again does the whole length, including any shared line segments)</span></div>
<div class="line"><a id="l00189" name="l00189"></a><span class="lineno">  189</span>               nCellsInProfile = pThisProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#a8a29c3fa364ab1f7b3930b7a9c83f45f">nGetNumCellsInProfile</a>();</div>
<div class="line"><a id="l00190" name="l00190"></a><span class="lineno">  190</span>               <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nCellsInProfile; i++)</div>
<div class="line"><a id="l00191" name="l00191"></a><span class="lineno">  191</span>               {</div>
<div class="line"><a id="l00192" name="l00192"></a><span class="lineno">  192</span>                  <a class="code hl_class" href="../../d6/d0d/classCGeom2DIPoint.html">CGeom2DIPoint</a> PtiToMark = *pThisProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#a6d13079f744085f2d132405e0120ca54">pPtiGetCellInProfile</a>(i);</div>
<div class="line"><a id="l00193" name="l00193"></a><span class="lineno">  193</span>                  <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;<a class="code hl_variable" href="../../d6/d3e/classCGeomRasterGrid.html#a1c337248d939a7775ffca16b86e7a93b">m_Cell</a>[PtiToMark.<a class="code hl_function" href="../../d6/d0d/classCGeom2DIPoint.html#af84c687b2d0be01ab41cbcc0565f4f3f">nGetX</a>()][PtiToMark.<a class="code hl_function" href="../../d6/d0d/classCGeom2DIPoint.html#a4d9c20bcca90dcb9d519b664aba09cbd">nGetY</a>()].<a class="code hl_function" href="../../d1/dd9/classCGeomCell.html#a6f998fef62c1873fdee5f2685544aad4">SetPolygonID</a>(<a class="code hl_variable" href="../../d1/d98/classCSimulation.html#adca826b2787fe966fbcb03aac09f9049">m_nGlobalPolygonID</a>);</div>
<div class="line"><a id="l00194" name="l00194"></a><span class="lineno">  194</span>               }</div>
<div class="line"><a id="l00195" name="l00195"></a><span class="lineno">  195</span> </div>
<div class="line"><a id="l00196" name="l00196"></a><span class="lineno">  196</span>               <span class="comment">// If the polygon doesn&#39;t meet at a point at its seaward end, also need to rasterize the &#39;joining line&#39;</span></div>
<div class="line"><a id="l00197" name="l00197"></a><span class="lineno">  197</span>               <span class="keywordflow">if</span> (! bMeetsAtAPoint)</div>
<div class="line"><a id="l00198" name="l00198"></a><span class="lineno">  198</span>               {</div>
<div class="line"><a id="l00199" name="l00199"></a><span class="lineno">  199</span>                  <a class="code hl_class" href="../../d5/d4e/classCGeom2DPoint.html">CGeom2DPoint</a></div>
<div class="line"><a id="l00200" name="l00200"></a><span class="lineno">  200</span>                     PtUpCoastNormalEnd = *pPrevProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#aaa8ddb9c775927bdb7940f7826f90a74">pPtGetPointInProfile</a>(nPrevProfileEnd),</div>
<div class="line"><a id="l00201" name="l00201"></a><span class="lineno">  201</span>                     PtDownCoastNormalEnd = *pThisProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#aaa8ddb9c775927bdb7940f7826f90a74">pPtGetPointInProfile</a>(nThisProfileEnd);</div>
<div class="line"><a id="l00202" name="l00202"></a><span class="lineno">  202</span> </div>
<div class="line"><a id="l00203" name="l00203"></a><span class="lineno">  203</span>                  <a class="code hl_function" href="../../d1/d98/classCSimulation.html#ad9eb8ca8551f4b8fe0d425f554881e46">RasterizePolygonJoiningLine</a>(&amp;PtUpCoastNormalEnd, &amp;PtDownCoastNormalEnd);</div>
<div class="line"><a id="l00204" name="l00204"></a><span class="lineno">  204</span> </div>
<div class="line"><a id="l00205" name="l00205"></a><span class="lineno">  205</span><span class="comment">//                   pPolygon-&gt;SetNotPointed();</span></div>
<div class="line"><a id="l00206" name="l00206"></a><span class="lineno">  206</span>               }</div>
<div class="line"><a id="l00207" name="l00207"></a><span class="lineno">  207</span>            }</div>
<div class="line"><a id="l00208" name="l00208"></a><span class="lineno">  208</span> </div>
<div class="line"><a id="l00209" name="l00209"></a><span class="lineno">  209</span>            nPrevProfileCoastPoint = nCoastPoint;</div>
<div class="line"><a id="l00210" name="l00210"></a><span class="lineno">  210</span>            nPrevProfile = nThisProfile;</div>
<div class="line"><a id="l00211" name="l00211"></a><span class="lineno">  211</span>         }</div>
<div class="line"><a id="l00212" name="l00212"></a><span class="lineno">  212</span>      }</div>
<div class="line"><a id="l00213" name="l00213"></a><span class="lineno">  213</span>   }</div>
<div class="line"><a id="l00214" name="l00214"></a><span class="lineno">  214</span> </div>
<div class="line"><a id="l00215" name="l00215"></a><span class="lineno">  215</span>   <span class="keywordflow">return</span> <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#aa768cb14b5c6123ee95e6e4ebd9fe331">RTN_OK</a>;</div>
<div class="line"><a id="l00216" name="l00216"></a><span class="lineno">  216</span>}</div>
</div>
<div class="line"><a id="l00217" name="l00217"></a><span class="lineno">  217</span> </div>
<div class="line"><a id="l00218" name="l00218"></a><span class="lineno">  218</span><span class="comment">//===============================================================================================================================</span></div>
<div class="line"><a id="l00220" name="l00220"></a><span class="lineno">  220</span><span class="comment">//===============================================================================================================================</span></div>
<div class="foldopen" id="foldopen00221" data-start="{" data-end="}">
<div class="line"><a id="l00221" name="l00221"></a><span class="lineno"><a class="line" href="../../d1/d98/classCSimulation.html#ad9eb8ca8551f4b8fe0d425f554881e46">  221</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="../../d1/d98/classCSimulation.html#ad9eb8ca8551f4b8fe0d425f554881e46">CSimulation::RasterizePolygonJoiningLine</a>(<a class="code hl_class" href="../../d5/d4e/classCGeom2DPoint.html">CGeom2DPoint</a> <span class="keyword">const</span>* pPt1, <a class="code hl_class" href="../../d5/d4e/classCGeom2DPoint.html">CGeom2DPoint</a> <span class="keyword">const</span>* pPt2)</div>
<div class="line"><a id="l00222" name="l00222"></a><span class="lineno">  222</span>{</div>
<div class="line"><a id="l00223" name="l00223"></a><span class="lineno">  223</span>   <span class="comment">// The start point of the line, must convert from the external CRS to grid CRS</span></div>
<div class="line"><a id="l00224" name="l00224"></a><span class="lineno">  224</span>   <span class="keywordtype">double</span> dXStart = <a class="code hl_function" href="../../d1/d98/classCSimulation.html#a9fbe52d4e0f26ad432f12b7154c599e4">dExtCRSXToGridX</a>(pPt1-&gt;<a class="code hl_function" href="../../d5/d4e/classCGeom2DPoint.html#a250f937d03cfdf6e0244b74ad2bf96a4">dGetX</a>());</div>
<div class="line"><a id="l00225" name="l00225"></a><span class="lineno">  225</span>   <span class="keywordtype">double</span> dYStart = <a class="code hl_function" href="../../d1/d98/classCSimulation.html#ac2e7e204d9e9b527d0a4c941f2e525ad">dExtCRSYToGridY</a>(pPt1-&gt;<a class="code hl_function" href="../../d5/d4e/classCGeom2DPoint.html#a216921dc2c592d9468e6430fee7c7719">dGetY</a>());</div>
<div class="line"><a id="l00226" name="l00226"></a><span class="lineno">  226</span> </div>
<div class="line"><a id="l00227" name="l00227"></a><span class="lineno">  227</span>   <span class="comment">// The end point of the line, again convert from the external CRS to grid CRS</span></div>
<div class="line"><a id="l00228" name="l00228"></a><span class="lineno">  228</span>   <span class="keywordtype">double</span> dXEnd = <a class="code hl_function" href="../../d1/d98/classCSimulation.html#a9fbe52d4e0f26ad432f12b7154c599e4">dExtCRSXToGridX</a>(pPt2-&gt;<a class="code hl_function" href="../../d5/d4e/classCGeom2DPoint.html#a250f937d03cfdf6e0244b74ad2bf96a4">dGetX</a>());</div>
<div class="line"><a id="l00229" name="l00229"></a><span class="lineno">  229</span>   <span class="keywordtype">double</span> dYEnd = <a class="code hl_function" href="../../d1/d98/classCSimulation.html#ac2e7e204d9e9b527d0a4c941f2e525ad">dExtCRSYToGridY</a>(pPt2-&gt;<a class="code hl_function" href="../../d5/d4e/classCGeom2DPoint.html#a216921dc2c592d9468e6430fee7c7719">dGetY</a>());</div>
<div class="line"><a id="l00230" name="l00230"></a><span class="lineno">  230</span> </div>
<div class="line"><a id="l00231" name="l00231"></a><span class="lineno">  231</span>   <span class="comment">// Safety check, in case the two points are identical (can happen due to rounding errors)</span></div>
<div class="line"><a id="l00232" name="l00232"></a><span class="lineno">  232</span>   <span class="keywordflow">if</span> ((<a class="code hl_function" href="../../d6/d2a/cme_8h.html#a61afa8560a3b39c80657661a1d8f76ab">bFPIsEqual</a>(dXStart, dXEnd, <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#a08b1623863ee3bd4300a8892de323722">TOLERANCE</a>)) &amp;&amp; (<a class="code hl_function" href="../../d6/d2a/cme_8h.html#a61afa8560a3b39c80657661a1d8f76ab">bFPIsEqual</a>(dYStart, dYEnd, <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#a08b1623863ee3bd4300a8892de323722">TOLERANCE</a>)))</div>
<div class="line"><a id="l00233" name="l00233"></a><span class="lineno">  233</span>      <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00234" name="l00234"></a><span class="lineno">  234</span> </div>
<div class="line"><a id="l00235" name="l00235"></a><span class="lineno">  235</span>   <span class="comment">// Interpolate between cells by a simple DDA line algorithm, see http://en.wikipedia.org/wiki/Digital_differential_analyzer_(graphics_algorithm) Note that Bresenham&#39;s algorithm gave occasional gaps</span></div>
<div class="line"><a id="l00236" name="l00236"></a><span class="lineno">  236</span>   <span class="keywordtype">double</span> dXInc = dXEnd - dXStart;</div>
<div class="line"><a id="l00237" name="l00237"></a><span class="lineno">  237</span>   <span class="keywordtype">double</span> dYInc = dYEnd - dYStart;</div>
<div class="line"><a id="l00238" name="l00238"></a><span class="lineno">  238</span>   <span class="keywordtype">double</span> dLength = <a class="code hl_function" href="../../d6/d2a/cme_8h.html#a7e895b460cef877dec4d12ead0c74f15">tMax</a>(<a class="code hl_function" href="../../d6/d2a/cme_8h.html#ae3b6dc50cfc97050529faa5e0bd66136">tAbs</a>(dXInc), <a class="code hl_function" href="../../d6/d2a/cme_8h.html#ae3b6dc50cfc97050529faa5e0bd66136">tAbs</a>(dYInc));</div>
<div class="line"><a id="l00239" name="l00239"></a><span class="lineno">  239</span> </div>
<div class="line"><a id="l00240" name="l00240"></a><span class="lineno">  240</span>   dXInc /= dLength;</div>
<div class="line"><a id="l00241" name="l00241"></a><span class="lineno">  241</span>   dYInc /= dLength;</div>
<div class="line"><a id="l00242" name="l00242"></a><span class="lineno">  242</span> </div>
<div class="line"><a id="l00243" name="l00243"></a><span class="lineno">  243</span>   <span class="keywordtype">double</span> dX = dXStart;</div>
<div class="line"><a id="l00244" name="l00244"></a><span class="lineno">  244</span>   <span class="keywordtype">double</span> dY = dYStart;</div>
<div class="line"><a id="l00245" name="l00245"></a><span class="lineno">  245</span> </div>
<div class="line"><a id="l00246" name="l00246"></a><span class="lineno">  246</span>   <span class="comment">// Process each interpolated point</span></div>
<div class="line"><a id="l00247" name="l00247"></a><span class="lineno">  247</span>   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> m = 0; m &lt;= <a class="code hl_function" href="../../d2/dfd/utils__global_8cpp.html#a20842d0a19d0ca952c91f3e1eb175fee">nRound</a>(dLength); m++)</div>
<div class="line"><a id="l00248" name="l00248"></a><span class="lineno">  248</span>   {</div>
<div class="line"><a id="l00249" name="l00249"></a><span class="lineno">  249</span>      <span class="keywordtype">int</span> nX = <a class="code hl_function" href="../../d2/dfd/utils__global_8cpp.html#a20842d0a19d0ca952c91f3e1eb175fee">nRound</a>(dX);</div>
<div class="line"><a id="l00250" name="l00250"></a><span class="lineno">  250</span>      <span class="keywordtype">int</span> nY = <a class="code hl_function" href="../../d2/dfd/utils__global_8cpp.html#a20842d0a19d0ca952c91f3e1eb175fee">nRound</a>(dY);</div>
<div class="line"><a id="l00251" name="l00251"></a><span class="lineno">  251</span> </div>
<div class="line"><a id="l00252" name="l00252"></a><span class="lineno">  252</span>      <span class="comment">// Safety check</span></div>
<div class="line"><a id="l00253" name="l00253"></a><span class="lineno">  253</span>      <span class="keywordflow">if</span> (! <a class="code hl_function" href="../../d1/d98/classCSimulation.html#ac900a5701df97da22278fae928951f50">bIsWithinValidGrid</a>(nX, nY))</div>
<div class="line"><a id="l00254" name="l00254"></a><span class="lineno">  254</span>         <a class="code hl_function" href="../../d1/d98/classCSimulation.html#aa0eddb8270d03b9c1a0a6e96254ebfed">KeepWithinValidGrid</a>(<a class="code hl_function" href="../../d2/dfd/utils__global_8cpp.html#a20842d0a19d0ca952c91f3e1eb175fee">nRound</a>(dXStart), <a class="code hl_function" href="../../d2/dfd/utils__global_8cpp.html#a20842d0a19d0ca952c91f3e1eb175fee">nRound</a>(dYStart), nX, nY);</div>
<div class="line"><a id="l00255" name="l00255"></a><span class="lineno">  255</span> </div>
<div class="line"><a id="l00256" name="l00256"></a><span class="lineno">  256</span>      <span class="comment">// Mark this point on the raster grid</span></div>
<div class="line"><a id="l00257" name="l00257"></a><span class="lineno">  257</span>      <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;<a class="code hl_variable" href="../../d6/d3e/classCGeomRasterGrid.html#a1c337248d939a7775ffca16b86e7a93b">m_Cell</a>[nX][nY].<a class="code hl_function" href="../../d1/dd9/classCGeomCell.html#a6f998fef62c1873fdee5f2685544aad4">SetPolygonID</a>(<a class="code hl_variable" href="../../d1/d98/classCSimulation.html#adca826b2787fe966fbcb03aac09f9049">m_nGlobalPolygonID</a>);</div>
<div class="line"><a id="l00258" name="l00258"></a><span class="lineno">  258</span> </div>
<div class="line"><a id="l00259" name="l00259"></a><span class="lineno">  259</span>      <span class="comment">// And increment for next time</span></div>
<div class="line"><a id="l00260" name="l00260"></a><span class="lineno">  260</span>      dX += dXInc;</div>
<div class="line"><a id="l00261" name="l00261"></a><span class="lineno">  261</span>      dY += dYInc;</div>
<div class="line"><a id="l00262" name="l00262"></a><span class="lineno">  262</span>   }</div>
<div class="line"><a id="l00263" name="l00263"></a><span class="lineno">  263</span>}</div>
</div>
<div class="line"><a id="l00264" name="l00264"></a><span class="lineno">  264</span> </div>
<div class="line"><a id="l00265" name="l00265"></a><span class="lineno">  265</span><span class="comment">//===============================================================================================================================</span></div>
<div class="line"><a id="l00267" name="l00267"></a><span class="lineno">  267</span><span class="comment">//===============================================================================================================================</span></div>
<div class="foldopen" id="foldopen00268" data-start="{" data-end="}">
<div class="line"><a id="l00268" name="l00268"></a><span class="lineno"><a class="line" href="../../d1/d98/classCSimulation.html#abdc9fa851fdb5b8cc64a707f450495c1">  268</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="../../d1/d98/classCSimulation.html#abdc9fa851fdb5b8cc64a707f450495c1">CSimulation::MarkPolygonCells</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a id="l00269" name="l00269"></a><span class="lineno">  269</span>{</div>
<div class="line"><a id="l00270" name="l00270"></a><span class="lineno">  270</span>   <span class="comment">// Do this for each coast</span></div>
<div class="line"><a id="l00271" name="l00271"></a><span class="lineno">  271</span>   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> nCoast = 0; nCoast &lt; static_cast&lt;int&gt;(<a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a25ada8139c82ca7beab3f279cff83184">m_VCoast</a>.size()); nCoast++)</div>
<div class="line"><a id="l00272" name="l00272"></a><span class="lineno">  272</span>   {</div>
<div class="line"><a id="l00273" name="l00273"></a><span class="lineno">  273</span>      <span class="comment">// Do this for every coastal polygon</span></div>
<div class="line"><a id="l00274" name="l00274"></a><span class="lineno">  274</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> nPoly = 0; nPoly &lt; <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a25ada8139c82ca7beab3f279cff83184">m_VCoast</a>[nCoast].nGetNumPolygons(); nPoly++)</div>
<div class="line"><a id="l00275" name="l00275"></a><span class="lineno">  275</span>      {</div>
<div class="line"><a id="l00276" name="l00276"></a><span class="lineno">  276</span>         <span class="keywordtype">int</span> nCellsInPolygon = 0;</div>
<div class="line"><a id="l00277" name="l00277"></a><span class="lineno">  277</span>         <span class="keywordtype">double</span> dTotDepth = 0;</div>
<div class="line"><a id="l00278" name="l00278"></a><span class="lineno">  278</span>         <span class="keywordtype">double</span> dStoredUnconsFine = 0;</div>
<div class="line"><a id="l00279" name="l00279"></a><span class="lineno">  279</span>         <span class="keywordtype">double</span> dStoredUnconsSand = 0;</div>
<div class="line"><a id="l00280" name="l00280"></a><span class="lineno">  280</span>         <span class="keywordtype">double</span> dStoredUnconsCoarse = 0;</div>
<div class="line"><a id="l00281" name="l00281"></a><span class="lineno">  281</span>         <span class="keywordtype">double</span> dStoredConsFine = 0;</div>
<div class="line"><a id="l00282" name="l00282"></a><span class="lineno">  282</span>         <span class="keywordtype">double</span> dStoredConsSand = 0;</div>
<div class="line"><a id="l00283" name="l00283"></a><span class="lineno">  283</span>         <span class="keywordtype">double</span> dStoredConsCoarse = 0;</div>
<div class="line"><a id="l00284" name="l00284"></a><span class="lineno">  284</span>         <span class="keywordtype">double</span> dSedimentInputFine = 0;</div>
<div class="line"><a id="l00285" name="l00285"></a><span class="lineno">  285</span>         <span class="keywordtype">double</span> dSedimentInputSand = 0;</div>
<div class="line"><a id="l00286" name="l00286"></a><span class="lineno">  286</span>         <span class="keywordtype">double</span> dSedimentInputCoarse = 0;</div>
<div class="line"><a id="l00287" name="l00287"></a><span class="lineno">  287</span> </div>
<div class="line"><a id="l00288" name="l00288"></a><span class="lineno">  288</span>         <a class="code hl_class" href="../../df/d45/classCGeomCoastPolygon.html">CGeomCoastPolygon</a>* pPolygon = <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a25ada8139c82ca7beab3f279cff83184">m_VCoast</a>[nCoast].pGetPolygon(nPoly);</div>
<div class="line"><a id="l00289" name="l00289"></a><span class="lineno">  289</span>         <span class="keywordtype">int</span> nPolyID = pPolygon-&gt;<a class="code hl_function" href="../../df/d45/classCGeomCoastPolygon.html#a765ccfcf69a2d02959dd156d32af579e">nGetGlobalID</a>();</div>
<div class="line"><a id="l00290" name="l00290"></a><span class="lineno">  290</span> </div>
<div class="line"><a id="l00291" name="l00291"></a><span class="lineno">  291</span>         <span class="comment">// Create an empty stack</span></div>
<div class="line"><a id="l00292" name="l00292"></a><span class="lineno">  292</span>         stack&lt;CGeom2DIPoint&gt; PtiStack;</div>
<div class="line"><a id="l00293" name="l00293"></a><span class="lineno">  293</span> </div>
<div class="line"><a id="l00294" name="l00294"></a><span class="lineno">  294</span>         <span class="comment">// Since the polygon&#39;s vector boundary does not coincide exactly with the polygon&#39;s raster boundary, and the point-in-polygon check gives an indeterminate result if the point is exactly on the polygon&#39;s boundary, for safety we must construct a vector &#39;inner buffer&#39; which is smaller than, and inside, the vector boundary</span></div>
<div class="line"><a id="l00295" name="l00295"></a><span class="lineno">  295</span>         <span class="keywordtype">int</span> nHand = <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a25ada8139c82ca7beab3f279cff83184">m_VCoast</a>[nCoast].nGetSeaHandedness();</div>
<div class="line"><a id="l00296" name="l00296"></a><span class="lineno">  296</span>         <span class="keywordtype">int</span> nSize = pPolygon-&gt;<a class="code hl_function" href="../../df/d45/classCGeomCoastPolygon.html#ab852fa65536ccc1e4d5357a9b40806f6">nGetBoundarySize</a>();</div>
<div class="line"><a id="l00297" name="l00297"></a><span class="lineno">  297</span>         vector&lt;CGeom2DPoint&gt; PtVInnerBuffer;</div>
<div class="line"><a id="l00298" name="l00298"></a><span class="lineno">  298</span> </div>
<div class="line"><a id="l00299" name="l00299"></a><span class="lineno">  299</span>         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nSize-1; i++)</div>
<div class="line"><a id="l00300" name="l00300"></a><span class="lineno">  300</span>         {</div>
<div class="line"><a id="l00301" name="l00301"></a><span class="lineno">  301</span>            <span class="keywordtype">int</span> j = i + 1;</div>
<div class="line"><a id="l00302" name="l00302"></a><span class="lineno">  302</span>            <span class="keywordflow">if</span> (i == nSize-2)       <span class="comment">// We must ignore the duplicated node point</span></div>
<div class="line"><a id="l00303" name="l00303"></a><span class="lineno">  303</span>               j = 0;</div>
<div class="line"><a id="l00304" name="l00304"></a><span class="lineno">  304</span>            </div>
<div class="line"><a id="l00305" name="l00305"></a><span class="lineno">  305</span>            <a class="code hl_class" href="../../d5/d4e/classCGeom2DPoint.html">CGeom2DPoint</a> PtThis = *pPolygon-&gt;<a class="code hl_function" href="../../df/d45/classCGeomCoastPolygon.html#a5fdf4a13695deba1640a1073b48e8410">pPtGetBoundaryPoint</a>(i);</div>
<div class="line"><a id="l00306" name="l00306"></a><span class="lineno">  306</span>            <a class="code hl_class" href="../../d5/d4e/classCGeom2DPoint.html">CGeom2DPoint</a> PtNext = *pPolygon-&gt;<a class="code hl_function" href="../../df/d45/classCGeomCoastPolygon.html#a5fdf4a13695deba1640a1073b48e8410">pPtGetBoundaryPoint</a>(j);</div>
<div class="line"><a id="l00307" name="l00307"></a><span class="lineno">  307</span>               </div>
<div class="line"><a id="l00308" name="l00308"></a><span class="lineno">  308</span>            <span class="comment">// Safety check</span></div>
<div class="line"><a id="l00309" name="l00309"></a><span class="lineno">  309</span>            <span class="keywordflow">if</span> (PtThis == PtNext)</div>
<div class="line"><a id="l00310" name="l00310"></a><span class="lineno">  310</span>               <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l00311" name="l00311"></a><span class="lineno">  311</span>               </div>
<div class="line"><a id="l00312" name="l00312"></a><span class="lineno">  312</span>            <a class="code hl_class" href="../../d5/d4e/classCGeom2DPoint.html">CGeom2DPoint</a> PtBuffer = <a class="code hl_function" href="../../d1/d98/classCSimulation.html#ab13fd70564940a88390f06694fe4a9ad">PtGetPerpendicular</a>(&amp;PtThis, &amp;PtNext, <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#ae0de69c3d3acd6d52dc2ec2f456c0eb5">m_dCellSide</a>, nHand);</div>
<div class="line"><a id="l00313" name="l00313"></a><span class="lineno">  313</span> </div>
<div class="line"><a id="l00314" name="l00314"></a><span class="lineno">  314</span>            PtVInnerBuffer.push_back(PtBuffer);</div>
<div class="line"><a id="l00315" name="l00315"></a><span class="lineno">  315</span>         }</div>
<div class="line"><a id="l00316" name="l00316"></a><span class="lineno">  316</span> </div>
<div class="line"><a id="l00317" name="l00317"></a><span class="lineno">  317</span><span class="comment">//          // DEBUG STUFF</span></div>
<div class="line"><a id="l00318" name="l00318"></a><span class="lineno">  318</span><span class="comment">//          LogStream &lt;&lt; endl &lt;&lt; m_ulIter &lt;&lt; &quot;:: coast &quot; &lt;&lt; nCoast &lt;&lt; &quot;, polygon &quot; &lt;&lt; nPoly &lt;&lt; endl;</span></div>
<div class="line"><a id="l00319" name="l00319"></a><span class="lineno">  319</span><span class="comment">//          LogStream &lt;&lt; &quot;Boundary\t\t\tBuffer&quot; &lt;&lt; endl;</span></div>
<div class="line"><a id="l00320" name="l00320"></a><span class="lineno">  320</span><span class="comment">//          for (int i = 0; i &lt; pPolygon-&gt;nGetBoundarySize()-1; i++)</span></div>
<div class="line"><a id="l00321" name="l00321"></a><span class="lineno">  321</span><span class="comment">//             LogStream &lt;&lt; &quot;{&quot; &lt;&lt; pPolygon-&gt;pPtGetBoundaryPoint(i)-&gt;dGetX() &lt;&lt; &quot;, &quot; &lt;&lt; pPolygon-&gt;pPtGetBoundaryPoint(i)-&gt;dGetY() &lt;&lt; &quot;}\t{&quot; &lt;&lt; PtVInnerBuffer[i].dGetX() &lt;&lt; &quot;, &quot; &lt;&lt; PtVInnerBuffer[i].dGetY() &lt;&lt; &quot;}&quot; &lt;&lt; endl;</span></div>
<div class="line"><a id="l00322" name="l00322"></a><span class="lineno">  322</span><span class="comment">//          LogStream &lt;&lt; endl;</span></div>
<div class="line"><a id="l00323" name="l00323"></a><span class="lineno">  323</span> </div>
<div class="line"><a id="l00324" name="l00324"></a><span class="lineno">  324</span>         <span class="comment">// Now look for a point that is within the polygon as a start point for the flood fill. For a first attempt, calculate the polygon&#39;s centroid</span></div>
<div class="line"><a id="l00325" name="l00325"></a><span class="lineno">  325</span>         <a class="code hl_class" href="../../d5/d4e/classCGeom2DPoint.html">CGeom2DPoint</a> PtStart = pPolygon-&gt;<a class="code hl_function" href="../../d9/d0e/classCA2DShape.html#ac72351d5502907edbf335a7611a2b7ca">PtGetCentroid</a>();</div>
<div class="line"><a id="l00326" name="l00326"></a><span class="lineno">  326</span> </div>
<div class="line"><a id="l00327" name="l00327"></a><span class="lineno">  327</span>         <span class="comment">// Is the centroid within the inner buffer?</span></div>
<div class="line"><a id="l00328" name="l00328"></a><span class="lineno">  328</span>         <span class="keywordflow">if</span> (! <a class="code hl_function" href="../../d1/d98/classCSimulation.html#af26b975e1c0f041d6fdaaf83065ef2c8">bIsWithinPolygon</a>(&amp;PtStart, &amp;PtVInnerBuffer))</div>
<div class="line"><a id="l00329" name="l00329"></a><span class="lineno">  329</span>         {</div>
<div class="line"><a id="l00330" name="l00330"></a><span class="lineno">  330</span>            <span class="comment">// No, it is not: the polygon must be a concave polygon. So keep looking for a point which is definitely inside the polygon, using an alternative method</span></div>
<div class="line"><a id="l00331" name="l00331"></a><span class="lineno">  331</span>            PtStart = <a class="code hl_function" href="../../d1/d98/classCSimulation.html#ab071e8422c990d7dff462e3eab8df941">PtFindPointInPolygon</a>(&amp;PtVInnerBuffer, pPolygon-&gt;<a class="code hl_function" href="../../df/d45/classCGeomCoastPolygon.html#a5bfd1f0d803176bf7bb318a3ff3964c6">nGetPointInPolygonSearchStartPoint</a>());</div>
<div class="line"><a id="l00332" name="l00332"></a><span class="lineno">  332</span>         }</div>
<div class="line"><a id="l00333" name="l00333"></a><span class="lineno">  333</span> </div>
<div class="line"><a id="l00334" name="l00334"></a><span class="lineno">  334</span>         <span class="comment">// Safety check (PtFindPointInPolygon() returns CGeom2DPoint(DBL_NODATA, DBL_NODATA) if it cannot find a valid start point)</span></div>
<div class="line"><a id="l00335" name="l00335"></a><span class="lineno">  335</span>         <span class="keywordflow">if</span> (<a class="code hl_function" href="../../d6/d2a/cme_8h.html#a61afa8560a3b39c80657661a1d8f76ab">bFPIsEqual</a>(PtStart.<a class="code hl_function" href="../../d5/d4e/classCGeom2DPoint.html#a250f937d03cfdf6e0244b74ad2bf96a4">dGetX</a>(), <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#ac003bdff958dca839f5d274f15786e07">DBL_NODATA</a>, <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#a08b1623863ee3bd4300a8892de323722">TOLERANCE</a>))</div>
<div class="line"><a id="l00336" name="l00336"></a><span class="lineno">  336</span>         {</div>
<div class="line"><a id="l00337" name="l00337"></a><span class="lineno">  337</span>            <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a222962121613613a48f518e0c2110f21">LogStream</a> &lt;&lt; <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#ad67e8c5b30a0572f64ecfb5c062c2edc">m_ulIter</a> &lt;&lt; <span class="stringliteral">&quot;: &quot;</span> &lt;&lt; <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#a292fc90846543ca4814daa9f759feb05">ERR</a> &lt;&lt; <span class="stringliteral">&quot;could not find a flood fill start point for coast &quot;</span> &lt;&lt; nCoast &lt;&lt; <span class="stringliteral">&quot;, polygon &quot;</span> &lt;&lt; nPoly &lt;&lt; endl;</div>
<div class="line"><a id="l00338" name="l00338"></a><span class="lineno">  338</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00339" name="l00339"></a><span class="lineno">  339</span>         }</div>
<div class="line"><a id="l00340" name="l00340"></a><span class="lineno">  340</span> </div>
<div class="line"><a id="l00341" name="l00341"></a><span class="lineno">  341</span>         <span class="comment">// We have a flood fill start point which is definitely within the polygon so push this point onto the stack</span></div>
<div class="line"><a id="l00342" name="l00342"></a><span class="lineno">  342</span>         <a class="code hl_class" href="../../d6/d0d/classCGeom2DIPoint.html">CGeom2DIPoint</a> PtiStart = <a class="code hl_function" href="../../d1/d98/classCSimulation.html#a1cdb36fc97d2f40d471edc2d59734960">PtiExtCRSToGridRound</a>(&amp;PtStart);                <span class="comment">// Grid CRS</span></div>
<div class="line"><a id="l00343" name="l00343"></a><span class="lineno">  343</span>         PtiStack.push(PtiStart);</div>
<div class="line"><a id="l00344" name="l00344"></a><span class="lineno">  344</span> </div>
<div class="line"><a id="l00345" name="l00345"></a><span class="lineno">  345</span><span class="comment">//          LogStream &lt;&lt; m_ulIter &lt;&lt; &quot;: filling polygon &quot; &lt;&lt; nPoly &lt;&lt; &quot; from [&quot; &lt;&lt; PtiStart.nGetX() &lt;&lt; &quot;][&quot; &lt;&lt; PtiStart.nGetY() &lt;&lt; &quot;] = {&quot; &lt;&lt; dGridCentroidXToExtCRSX(PtiStart.nGetX()) &lt;&lt; &quot;, &quot; &lt;&lt; dGridCentroidYToExtCRSY(PtiStart.nGetY()) &lt;&lt; &quot;}&quot; &lt;&lt; endl;</span></div>
<div class="line"><a id="l00346" name="l00346"></a><span class="lineno">  346</span> </div>
<div class="line"><a id="l00347" name="l00347"></a><span class="lineno">  347</span>         <span class="comment">// Then do the flood fill: loop until there are no more cell co-ordinates on the stack</span></div>
<div class="line"><a id="l00348" name="l00348"></a><span class="lineno">  348</span>         <span class="keywordflow">while</span> (! PtiStack.empty())</div>
<div class="line"><a id="l00349" name="l00349"></a><span class="lineno">  349</span>         {</div>
<div class="line"><a id="l00350" name="l00350"></a><span class="lineno">  350</span>            <a class="code hl_class" href="../../d6/d0d/classCGeom2DIPoint.html">CGeom2DIPoint</a> Pti = PtiStack.top();</div>
<div class="line"><a id="l00351" name="l00351"></a><span class="lineno">  351</span>            PtiStack.pop();</div>
<div class="line"><a id="l00352" name="l00352"></a><span class="lineno">  352</span> </div>
<div class="line"><a id="l00353" name="l00353"></a><span class="lineno">  353</span>            <span class="keywordtype">int</span> nX = Pti.<a class="code hl_function" href="../../d6/d0d/classCGeom2DIPoint.html#af84c687b2d0be01ab41cbcc0565f4f3f">nGetX</a>();</div>
<div class="line"><a id="l00354" name="l00354"></a><span class="lineno">  354</span>            <span class="keywordtype">int</span> nY = Pti.<a class="code hl_function" href="../../d6/d0d/classCGeom2DIPoint.html#a4d9c20bcca90dcb9d519b664aba09cbd">nGetY</a>();</div>
<div class="line"><a id="l00355" name="l00355"></a><span class="lineno">  355</span>               </div>
<div class="line"><a id="l00356" name="l00356"></a><span class="lineno">  356</span>            <span class="keywordflow">while</span> ((nX &gt;= 0) &amp;&amp; (<a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;<a class="code hl_variable" href="../../d6/d3e/classCGeomRasterGrid.html#a1c337248d939a7775ffca16b86e7a93b">m_Cell</a>[nX][nY].<a class="code hl_function" href="../../d1/dd9/classCGeomCell.html#a622387009a4fcb864bfdab627389ea84">nGetPolygonID</a>() == <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#a01aa8b423260b337ddff2016107b51a0">INT_NODATA</a>))</div>
<div class="line"><a id="l00357" name="l00357"></a><span class="lineno">  357</span>               nX--;</div>
<div class="line"><a id="l00358" name="l00358"></a><span class="lineno">  358</span> </div>
<div class="line"><a id="l00359" name="l00359"></a><span class="lineno">  359</span>            nX++;</div>
<div class="line"><a id="l00360" name="l00360"></a><span class="lineno">  360</span>            </div>
<div class="line"><a id="l00361" name="l00361"></a><span class="lineno">  361</span>            <span class="keywordtype">bool</span> bSpanAbove = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00362" name="l00362"></a><span class="lineno">  362</span>            <span class="keywordtype">bool</span> bSpanBelow = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00363" name="l00363"></a><span class="lineno">  363</span> </div>
<div class="line"><a id="l00364" name="l00364"></a><span class="lineno">  364</span>            <span class="keywordflow">while</span> ((nX &lt; <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1652253500dab35e6f6f9f734207e20b">m_nXGridSize</a>) &amp;&amp; (<a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;<a class="code hl_variable" href="../../d6/d3e/classCGeomRasterGrid.html#a1c337248d939a7775ffca16b86e7a93b">m_Cell</a>[nX][nY].<a class="code hl_function" href="../../d1/dd9/classCGeomCell.html#a622387009a4fcb864bfdab627389ea84">nGetPolygonID</a>() == <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#a01aa8b423260b337ddff2016107b51a0">INT_NODATA</a>))</div>
<div class="line"><a id="l00365" name="l00365"></a><span class="lineno">  365</span>            {</div>
<div class="line"><a id="l00366" name="l00366"></a><span class="lineno">  366</span>               <span class="comment">// Mark the cell as being in this polygon</span></div>
<div class="line"><a id="l00367" name="l00367"></a><span class="lineno">  367</span>               <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;<a class="code hl_variable" href="../../d6/d3e/classCGeomRasterGrid.html#a1c337248d939a7775ffca16b86e7a93b">m_Cell</a>[nX][nY].<a class="code hl_function" href="../../d1/dd9/classCGeomCell.html#a6f998fef62c1873fdee5f2685544aad4">SetPolygonID</a>(nPolyID);</div>
<div class="line"><a id="l00368" name="l00368"></a><span class="lineno">  368</span><span class="comment">//                LogStream &lt;&lt; &quot;[&quot; &lt;&lt; nX &lt;&lt; &quot;][&quot; &lt;&lt; nY &lt;&lt; &quot;] = {&quot; &lt;&lt; dGridCentroidXToExtCRSX(nX) &lt;&lt; &quot;, &quot; &lt;&lt; dGridCentroidYToExtCRSY(nY) &lt;&lt; &quot;}&quot; &lt;&lt; endl;</span></div>
<div class="line"><a id="l00369" name="l00369"></a><span class="lineno">  369</span>               </div>
<div class="line"><a id="l00370" name="l00370"></a><span class="lineno">  370</span>               <span class="comment">// Increment the running totals for this polygon</span></div>
<div class="line"><a id="l00371" name="l00371"></a><span class="lineno">  371</span>               <span class="comment">// dCliffCollapseErosionFine += m_pRasterGrid-&gt;m_Cell[nX][nY].dGetThisIterCliffCollapseErosionFine();</span></div>
<div class="line"><a id="l00372" name="l00372"></a><span class="lineno">  372</span>               <span class="comment">// dCliffCollapseErosionSand += m_pRasterGrid-&gt;m_Cell[nX][nY].dGetThisIterCliffCollapseErosionSand();</span></div>
<div class="line"><a id="l00373" name="l00373"></a><span class="lineno">  373</span>               <span class="comment">// dCliffCollapseErosionCoarse += m_pRasterGrid-&gt;m_Cell[nX][nY].dGetThisIterCliffCollapseErosionCoarse();</span></div>
<div class="line"><a id="l00374" name="l00374"></a><span class="lineno">  374</span>               <span class="comment">// dCliffCollapseTalusSand += m_pRasterGrid-&gt;m_Cell[nX][nY].dGetThisIterCliffCollapseSandTalusDeposition();</span></div>
<div class="line"><a id="l00375" name="l00375"></a><span class="lineno">  375</span>               <span class="comment">// dCliffCollapseTalusCoarse += m_pRasterGrid-&gt;m_Cell[nX][nY].dGetThisIterCliffCollapseCoarseTalusDeposition();</span></div>
<div class="line"><a id="l00376" name="l00376"></a><span class="lineno">  376</span>               </div>
<div class="line"><a id="l00377" name="l00377"></a><span class="lineno">  377</span>               <span class="comment">// Get the number of the highest layer with non-zero thickness</span></div>
<div class="line"><a id="l00378" name="l00378"></a><span class="lineno">  378</span>               <span class="keywordtype">int</span> nThisLayer = <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;<a class="code hl_variable" href="../../d6/d3e/classCGeomRasterGrid.html#a1c337248d939a7775ffca16b86e7a93b">m_Cell</a>[nX][nY].<a class="code hl_function" href="../../d1/dd9/classCGeomCell.html#a43434d6fd45da697ae17f7b274ba9a83">nGetTopNonZeroLayerAboveBasement</a>();</div>
<div class="line"><a id="l00379" name="l00379"></a><span class="lineno">  379</span>               </div>
<div class="line"><a id="l00380" name="l00380"></a><span class="lineno">  380</span>               <span class="comment">// And increment some more running totals for this polygon TODO 066 should this be for ALL layers above the basement?</span></div>
<div class="line"><a id="l00381" name="l00381"></a><span class="lineno">  381</span>               dStoredUnconsFine += <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;<a class="code hl_variable" href="../../d6/d3e/classCGeomRasterGrid.html#a1c337248d939a7775ffca16b86e7a93b">m_Cell</a>[nX][nY].<a class="code hl_function" href="../../d1/dd9/classCGeomCell.html#a65dc08df7cf712555b94d91157431965">pGetLayerAboveBasement</a>(nThisLayer)-&gt;<a class="code hl_function" href="../../d5/d6d/classCRWCellLayer.html#a6ee086df697edf497ddb97fe2f4adf53">pGetUnconsolidatedSediment</a>()-&gt;<a class="code hl_function" href="../../d5/dc6/classCRWCellSediment.html#a37bcb7fc471a15c70f71ea583c7ff8e8">dGetFineDepth</a>();</div>
<div class="line"><a id="l00382" name="l00382"></a><span class="lineno">  382</span>               dStoredUnconsSand += <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;<a class="code hl_variable" href="../../d6/d3e/classCGeomRasterGrid.html#a1c337248d939a7775ffca16b86e7a93b">m_Cell</a>[nX][nY].<a class="code hl_function" href="../../d1/dd9/classCGeomCell.html#a65dc08df7cf712555b94d91157431965">pGetLayerAboveBasement</a>(nThisLayer)-&gt;<a class="code hl_function" href="../../d5/d6d/classCRWCellLayer.html#a6ee086df697edf497ddb97fe2f4adf53">pGetUnconsolidatedSediment</a>()-&gt;<a class="code hl_function" href="../../d5/dc6/classCRWCellSediment.html#af6a401b3101e209ad9f77270cd7f3598">dGetSandDepth</a>();</div>
<div class="line"><a id="l00383" name="l00383"></a><span class="lineno">  383</span>               dStoredUnconsCoarse += <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;<a class="code hl_variable" href="../../d6/d3e/classCGeomRasterGrid.html#a1c337248d939a7775ffca16b86e7a93b">m_Cell</a>[nX][nY].<a class="code hl_function" href="../../d1/dd9/classCGeomCell.html#a65dc08df7cf712555b94d91157431965">pGetLayerAboveBasement</a>(nThisLayer)-&gt;<a class="code hl_function" href="../../d5/d6d/classCRWCellLayer.html#a6ee086df697edf497ddb97fe2f4adf53">pGetUnconsolidatedSediment</a>()-&gt;<a class="code hl_function" href="../../d5/dc6/classCRWCellSediment.html#a0e040b4dea833e47bbeb7cd285941b89">dGetCoarseDepth</a>();</div>
<div class="line"><a id="l00384" name="l00384"></a><span class="lineno">  384</span> </div>
<div class="line"><a id="l00385" name="l00385"></a><span class="lineno">  385</span>               dStoredConsFine += <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;<a class="code hl_variable" href="../../d6/d3e/classCGeomRasterGrid.html#a1c337248d939a7775ffca16b86e7a93b">m_Cell</a>[nX][nY].<a class="code hl_function" href="../../d1/dd9/classCGeomCell.html#a65dc08df7cf712555b94d91157431965">pGetLayerAboveBasement</a>(nThisLayer)-&gt;<a class="code hl_function" href="../../d5/d6d/classCRWCellLayer.html#a30800b5cd971976ffec36381d4e54342">pGetConsolidatedSediment</a>()-&gt;<a class="code hl_function" href="../../d5/dc6/classCRWCellSediment.html#a37bcb7fc471a15c70f71ea583c7ff8e8">dGetFineDepth</a>();</div>
<div class="line"><a id="l00386" name="l00386"></a><span class="lineno">  386</span>               dStoredConsSand += <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;<a class="code hl_variable" href="../../d6/d3e/classCGeomRasterGrid.html#a1c337248d939a7775ffca16b86e7a93b">m_Cell</a>[nX][nY].<a class="code hl_function" href="../../d1/dd9/classCGeomCell.html#a65dc08df7cf712555b94d91157431965">pGetLayerAboveBasement</a>(nThisLayer)-&gt;<a class="code hl_function" href="../../d5/d6d/classCRWCellLayer.html#a30800b5cd971976ffec36381d4e54342">pGetConsolidatedSediment</a>()-&gt;<a class="code hl_function" href="../../d5/dc6/classCRWCellSediment.html#af6a401b3101e209ad9f77270cd7f3598">dGetSandDepth</a>();</div>
<div class="line"><a id="l00387" name="l00387"></a><span class="lineno">  387</span>               dStoredConsCoarse += <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;<a class="code hl_variable" href="../../d6/d3e/classCGeomRasterGrid.html#a1c337248d939a7775ffca16b86e7a93b">m_Cell</a>[nX][nY].<a class="code hl_function" href="../../d1/dd9/classCGeomCell.html#a65dc08df7cf712555b94d91157431965">pGetLayerAboveBasement</a>(nThisLayer)-&gt;<a class="code hl_function" href="../../d5/d6d/classCRWCellLayer.html#a30800b5cd971976ffec36381d4e54342">pGetConsolidatedSediment</a>()-&gt;<a class="code hl_function" href="../../d5/dc6/classCRWCellSediment.html#a0e040b4dea833e47bbeb7cd285941b89">dGetCoarseDepth</a>();</div>
<div class="line"><a id="l00388" name="l00388"></a><span class="lineno">  388</span> </div>
<div class="line"><a id="l00389" name="l00389"></a><span class="lineno">  389</span>               <span class="comment">// Add to the start-iteration total of suspended fine sediment within polygons</span></div>
<div class="line"><a id="l00390" name="l00390"></a><span class="lineno">  390</span>               <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a45597177a9aecb40378ed4b9632008fd">m_dStartIterSuspFineInPolygons</a> += <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;<a class="code hl_variable" href="../../d6/d3e/classCGeomRasterGrid.html#a1c337248d939a7775ffca16b86e7a93b">m_Cell</a>[nX][nY].<a class="code hl_function" href="../../d1/dd9/classCGeomCell.html#ad201e23ab4726d7c1825d873237ff368">dGetSuspendedSediment</a>();</div>
<div class="line"><a id="l00391" name="l00391"></a><span class="lineno">  391</span> </div>
<div class="line"><a id="l00392" name="l00392"></a><span class="lineno">  392</span>               <span class="comment">// Add to the total of sediment derived from sediment input events</span></div>
<div class="line"><a id="l00393" name="l00393"></a><span class="lineno">  393</span>               dSedimentInputFine += <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;<a class="code hl_variable" href="../../d6/d3e/classCGeomRasterGrid.html#a1c337248d939a7775ffca16b86e7a93b">m_Cell</a>[nX][nY].<a class="code hl_function" href="../../d1/dd9/classCGeomCell.html#a65dc08df7cf712555b94d91157431965">pGetLayerAboveBasement</a>(nThisLayer)-&gt;<a class="code hl_function" href="../../d5/d6d/classCRWCellLayer.html#a6ee086df697edf497ddb97fe2f4adf53">pGetUnconsolidatedSediment</a>()-&gt;<a class="code hl_function" href="../../d5/dc6/classCRWCellSediment.html#abdbf4ca9108505d958aa7071d4cd1bf1">dGetFineSedimentInputDepth</a>();</div>
<div class="line"><a id="l00394" name="l00394"></a><span class="lineno">  394</span>               dSedimentInputSand += <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;<a class="code hl_variable" href="../../d6/d3e/classCGeomRasterGrid.html#a1c337248d939a7775ffca16b86e7a93b">m_Cell</a>[nX][nY].<a class="code hl_function" href="../../d1/dd9/classCGeomCell.html#a65dc08df7cf712555b94d91157431965">pGetLayerAboveBasement</a>(nThisLayer)-&gt;<a class="code hl_function" href="../../d5/d6d/classCRWCellLayer.html#a6ee086df697edf497ddb97fe2f4adf53">pGetUnconsolidatedSediment</a>()-&gt;<a class="code hl_function" href="../../d5/dc6/classCRWCellSediment.html#a09e7de8337de200c1cc3991914b81e32">dGetSandSedimentInputDepth</a>();</div>
<div class="line"><a id="l00395" name="l00395"></a><span class="lineno">  395</span>               dSedimentInputCoarse += <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;<a class="code hl_variable" href="../../d6/d3e/classCGeomRasterGrid.html#a1c337248d939a7775ffca16b86e7a93b">m_Cell</a>[nX][nY].<a class="code hl_function" href="../../d1/dd9/classCGeomCell.html#a65dc08df7cf712555b94d91157431965">pGetLayerAboveBasement</a>(nThisLayer)-&gt;<a class="code hl_function" href="../../d5/d6d/classCRWCellLayer.html#a6ee086df697edf497ddb97fe2f4adf53">pGetUnconsolidatedSediment</a>()-&gt;<a class="code hl_function" href="../../d5/dc6/classCRWCellSediment.html#abf94c4b1d346d4746c1bfaf56ea3ebc5">dGetCoarseSedimentInputDepth</a>();</div>
<div class="line"><a id="l00396" name="l00396"></a><span class="lineno">  396</span> </div>
<div class="line"><a id="l00397" name="l00397"></a><span class="lineno">  397</span>               nCellsInPolygon++;</div>
<div class="line"><a id="l00398" name="l00398"></a><span class="lineno">  398</span>               dTotDepth += <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;<a class="code hl_variable" href="../../d6/d3e/classCGeomRasterGrid.html#a1c337248d939a7775ffca16b86e7a93b">m_Cell</a>[nX][nY].<a class="code hl_function" href="../../d1/dd9/classCGeomCell.html#a3a378431e2f6095792582989f50fb435">dGetSeaDepth</a>();</div>
<div class="line"><a id="l00399" name="l00399"></a><span class="lineno">  399</span> </div>
<div class="line"><a id="l00400" name="l00400"></a><span class="lineno">  400</span>               <span class="keywordflow">if</span> ((! bSpanAbove) &amp;&amp; (nY &gt; 0) &amp;&amp; (<a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;<a class="code hl_variable" href="../../d6/d3e/classCGeomRasterGrid.html#a1c337248d939a7775ffca16b86e7a93b">m_Cell</a>[nX][nY-1].<a class="code hl_function" href="../../d1/dd9/classCGeomCell.html#a622387009a4fcb864bfdab627389ea84">nGetPolygonID</a>() == <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#a01aa8b423260b337ddff2016107b51a0">INT_NODATA</a>))</div>
<div class="line"><a id="l00401" name="l00401"></a><span class="lineno">  401</span>               {</div>
<div class="line"><a id="l00402" name="l00402"></a><span class="lineno">  402</span>                  PtiStack.push(<a class="code hl_class" href="../../d6/d0d/classCGeom2DIPoint.html">CGeom2DIPoint</a>(nX, nY-1));</div>
<div class="line"><a id="l00403" name="l00403"></a><span class="lineno">  403</span>                  bSpanAbove = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00404" name="l00404"></a><span class="lineno">  404</span>               }</div>
<div class="line"><a id="l00405" name="l00405"></a><span class="lineno">  405</span>               <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bSpanAbove &amp;&amp; (nY &gt; 0) &amp;&amp; (<a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;<a class="code hl_variable" href="../../d6/d3e/classCGeomRasterGrid.html#a1c337248d939a7775ffca16b86e7a93b">m_Cell</a>[nX][nY-1].<a class="code hl_function" href="../../d1/dd9/classCGeomCell.html#a622387009a4fcb864bfdab627389ea84">nGetPolygonID</a>() != <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#a01aa8b423260b337ddff2016107b51a0">INT_NODATA</a>))</div>
<div class="line"><a id="l00406" name="l00406"></a><span class="lineno">  406</span>               {</div>
<div class="line"><a id="l00407" name="l00407"></a><span class="lineno">  407</span>                  bSpanAbove = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00408" name="l00408"></a><span class="lineno">  408</span>               }</div>
<div class="line"><a id="l00409" name="l00409"></a><span class="lineno">  409</span> </div>
<div class="line"><a id="l00410" name="l00410"></a><span class="lineno">  410</span>               <span class="keywordflow">if</span> ((! bSpanBelow) &amp;&amp; (nY &lt; <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a3755fdc07c0ac9f2ce6c2237cfef50ce">m_nYGridSize</a>-1) &amp;&amp; (<a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;<a class="code hl_variable" href="../../d6/d3e/classCGeomRasterGrid.html#a1c337248d939a7775ffca16b86e7a93b">m_Cell</a>[nX][nY+1].<a class="code hl_function" href="../../d1/dd9/classCGeomCell.html#a622387009a4fcb864bfdab627389ea84">nGetPolygonID</a>() == <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#a01aa8b423260b337ddff2016107b51a0">INT_NODATA</a>))</div>
<div class="line"><a id="l00411" name="l00411"></a><span class="lineno">  411</span>               {</div>
<div class="line"><a id="l00412" name="l00412"></a><span class="lineno">  412</span>                  PtiStack.push(<a class="code hl_class" href="../../d6/d0d/classCGeom2DIPoint.html">CGeom2DIPoint</a>(nX, nY+1));</div>
<div class="line"><a id="l00413" name="l00413"></a><span class="lineno">  413</span>                  bSpanBelow = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00414" name="l00414"></a><span class="lineno">  414</span>               }</div>
<div class="line"><a id="l00415" name="l00415"></a><span class="lineno">  415</span>               <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bSpanBelow &amp;&amp; (nY &lt; <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a3755fdc07c0ac9f2ce6c2237cfef50ce">m_nYGridSize</a>-1) &amp;&amp; (<a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;<a class="code hl_variable" href="../../d6/d3e/classCGeomRasterGrid.html#a1c337248d939a7775ffca16b86e7a93b">m_Cell</a>[nX][nY+1].<a class="code hl_function" href="../../d1/dd9/classCGeomCell.html#a622387009a4fcb864bfdab627389ea84">nGetPolygonID</a>() != <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#a01aa8b423260b337ddff2016107b51a0">INT_NODATA</a>))</div>
<div class="line"><a id="l00416" name="l00416"></a><span class="lineno">  416</span>               {</div>
<div class="line"><a id="l00417" name="l00417"></a><span class="lineno">  417</span>                  bSpanBelow = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00418" name="l00418"></a><span class="lineno">  418</span>               }</div>
<div class="line"><a id="l00419" name="l00419"></a><span class="lineno">  419</span> </div>
<div class="line"><a id="l00420" name="l00420"></a><span class="lineno">  420</span>               nX++;</div>
<div class="line"><a id="l00421" name="l00421"></a><span class="lineno">  421</span>            }</div>
<div class="line"><a id="l00422" name="l00422"></a><span class="lineno">  422</span>         }</div>
<div class="line"><a id="l00423" name="l00423"></a><span class="lineno">  423</span>         </div>
<div class="line"><a id="l00424" name="l00424"></a><span class="lineno">  424</span>         <span class="comment">// Store this polygon&#39;s stored unconsolidated sediment depths</span></div>
<div class="line"><a id="l00425" name="l00425"></a><span class="lineno">  425</span>         pPolygon-&gt;<a class="code hl_function" href="../../df/d45/classCGeomCoastPolygon.html#a34cf2701da81a0b72365b1fa7fa855b4">SetPreExistingUnconsFine</a>(dStoredUnconsFine);</div>
<div class="line"><a id="l00426" name="l00426"></a><span class="lineno">  426</span>         pPolygon-&gt;<a class="code hl_function" href="../../df/d45/classCGeomCoastPolygon.html#a41ffd18c3a9539811aeb120f6886e6da">SetPreExistingUnconsSand</a>(dStoredUnconsSand);</div>
<div class="line"><a id="l00427" name="l00427"></a><span class="lineno">  427</span>         pPolygon-&gt;<a class="code hl_function" href="../../df/d45/classCGeomCoastPolygon.html#abdb77248b1f7a026e656bf4e4e08696b">SetPreExistingUnconsCoarse</a>(dStoredUnconsCoarse);</div>
<div class="line"><a id="l00428" name="l00428"></a><span class="lineno">  428</span> </div>
<div class="line"><a id="l00429" name="l00429"></a><span class="lineno">  429</span>         <span class="comment">// Store this polygon&#39;s values for unconsolidated sediment derived from sediment input event(s)</span></div>
<div class="line"><a id="l00430" name="l00430"></a><span class="lineno">  430</span>         pPolygon-&gt;<a class="code hl_function" href="../../df/d45/classCGeomCoastPolygon.html#a35df99fb60cac21d4f6c42218f8169d2">SetSedimentInputUnconsFine</a>(dSedimentInputFine);</div>
<div class="line"><a id="l00431" name="l00431"></a><span class="lineno">  431</span>         pPolygon-&gt;<a class="code hl_function" href="../../df/d45/classCGeomCoastPolygon.html#a33b5ee96a889a83c8aa34399f3f15c12">SetSedimentInputUnconsSand</a>(dSedimentInputSand);</div>
<div class="line"><a id="l00432" name="l00432"></a><span class="lineno">  432</span>         pPolygon-&gt;<a class="code hl_function" href="../../df/d45/classCGeomCoastPolygon.html#a6b42ec53178379945ca004050f30f039">SetSedimentInputUnconsCoarse</a>(dSedimentInputCoarse);</div>
<div class="line"><a id="l00433" name="l00433"></a><span class="lineno">  433</span> </div>
<div class="line"><a id="l00434" name="l00434"></a><span class="lineno">  434</span>         <span class="comment">// Store this polygon&#39;s stored consolidated sediment depths</span></div>
<div class="line"><a id="l00435" name="l00435"></a><span class="lineno">  435</span>         pPolygon-&gt;<a class="code hl_function" href="../../df/d45/classCGeomCoastPolygon.html#a3d3d6e36327eed01f632184ccdade662">SetPreExistingConsFine</a>(dStoredConsFine);</div>
<div class="line"><a id="l00436" name="l00436"></a><span class="lineno">  436</span>         pPolygon-&gt;<a class="code hl_function" href="../../df/d45/classCGeomCoastPolygon.html#ae15a709df66f5ca57b9b2c9115f2d354">SetPreExistingConsSand</a>(dStoredConsSand);</div>
<div class="line"><a id="l00437" name="l00437"></a><span class="lineno">  437</span>         pPolygon-&gt;<a class="code hl_function" href="../../df/d45/classCGeomCoastPolygon.html#ab02a39464ee62ca5ec8b7b3a556153bf">SetPreExistingConsCoarse</a>(dStoredConsCoarse);</div>
<div class="line"><a id="l00438" name="l00438"></a><span class="lineno">  438</span> </div>
<div class="line"><a id="l00439" name="l00439"></a><span class="lineno">  439</span>         <span class="comment">// Store the number of cells in the interior of the polygon</span></div>
<div class="line"><a id="l00440" name="l00440"></a><span class="lineno">  440</span>         pPolygon-&gt;<a class="code hl_function" href="../../df/d45/classCGeomCoastPolygon.html#aea28877120b36563169e11c9cdcf2294">SetNumCellsInPolygon</a>(nCellsInPolygon);</div>
<div class="line"><a id="l00441" name="l00441"></a><span class="lineno">  441</span>         <span class="comment">// LogStream &lt;&lt; m_ulIter &lt;&lt; &quot;: N cells = &quot; &lt;&lt; nCellsInPolygon &lt;&lt; &quot; in polygon &quot; &lt;&lt; nPoly &lt;&lt; endl;</span></div>
<div class="line"><a id="l00442" name="l00442"></a><span class="lineno">  442</span> </div>
<div class="line"><a id="l00443" name="l00443"></a><span class="lineno">  443</span>         <span class="comment">// Calculate the total volume of seawater on the polygon (m3) and store it</span></div>
<div class="line"><a id="l00444" name="l00444"></a><span class="lineno">  444</span>         <span class="keywordtype">double</span> dSeaVolume = dTotDepth * <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#ae0de69c3d3acd6d52dc2ec2f456c0eb5">m_dCellSide</a>;</div>
<div class="line"><a id="l00445" name="l00445"></a><span class="lineno">  445</span>         pPolygon-&gt;<a class="code hl_function" href="../../df/d45/classCGeomCoastPolygon.html#a440264eb31972f7f9ce65de909d61832">SetSeawaterVolume</a>(dSeaVolume);</div>
<div class="line"><a id="l00446" name="l00446"></a><span class="lineno">  446</span>      }</div>
<div class="line"><a id="l00447" name="l00447"></a><span class="lineno">  447</span>   }</div>
<div class="line"><a id="l00448" name="l00448"></a><span class="lineno">  448</span> </div>
<div class="line"><a id="l00449" name="l00449"></a><span class="lineno">  449</span><span class="comment">//    // DEBUG CODE ===========================================</span></div>
<div class="line"><a id="l00450" name="l00450"></a><span class="lineno">  450</span><span class="comment">//    string strOutFile = m_strOutPath + &quot;polygon_test_&quot;;</span></div>
<div class="line"><a id="l00451" name="l00451"></a><span class="lineno">  451</span><span class="comment">//    strOutFile += to_string(m_ulIter);</span></div>
<div class="line"><a id="l00452" name="l00452"></a><span class="lineno">  452</span><span class="comment">//    strOutFile += &quot;.tif&quot;;</span></div>
<div class="line"><a id="l00453" name="l00453"></a><span class="lineno">  453</span><span class="comment">// </span></div>
<div class="line"><a id="l00454" name="l00454"></a><span class="lineno">  454</span><span class="comment">//    GDALDriver* pDriver = GetGDALDriverManager()-&gt;GetDriverByName(&quot;gtiff&quot;);</span></div>
<div class="line"><a id="l00455" name="l00455"></a><span class="lineno">  455</span><span class="comment">//    GDALDataset* pDataSet = pDriver-&gt;Create(strOutFile.c_str(), m_nXGridSize, m_nYGridSize, 1, GDT_Float64, m_papszGDALRasterOptions);</span></div>
<div class="line"><a id="l00456" name="l00456"></a><span class="lineno">  456</span><span class="comment">//    pDataSet-&gt;SetProjection(m_strGDALBasementDEMProjection.c_str());</span></div>
<div class="line"><a id="l00457" name="l00457"></a><span class="lineno">  457</span><span class="comment">//    pDataSet-&gt;SetGeoTransform(m_dGeoTransform);</span></div>
<div class="line"><a id="l00458" name="l00458"></a><span class="lineno">  458</span><span class="comment">//    double* pdRaster = new double[m_nXGridSize * m_nYGridSize];</span></div>
<div class="line"><a id="l00459" name="l00459"></a><span class="lineno">  459</span><span class="comment">//    int</span></div>
<div class="line"><a id="l00460" name="l00460"></a><span class="lineno">  460</span><span class="comment">//       n = 0,</span></div>
<div class="line"><a id="l00461" name="l00461"></a><span class="lineno">  461</span><span class="comment">//       nInPoly = 0,</span></div>
<div class="line"><a id="l00462" name="l00462"></a><span class="lineno">  462</span><span class="comment">//       nNotInPoly = 0;</span></div>
<div class="line"><a id="l00463" name="l00463"></a><span class="lineno">  463</span><span class="comment">//       </span></div>
<div class="line"><a id="l00464" name="l00464"></a><span class="lineno">  464</span><span class="comment">//    for (int nY = 0; nY &lt; m_nYGridSize; nY++)</span></div>
<div class="line"><a id="l00465" name="l00465"></a><span class="lineno">  465</span><span class="comment">//    {</span></div>
<div class="line"><a id="l00466" name="l00466"></a><span class="lineno">  466</span><span class="comment">//       for (int nX = 0; nX &lt; m_nXGridSize; nX++)</span></div>
<div class="line"><a id="l00467" name="l00467"></a><span class="lineno">  467</span><span class="comment">//       {</span></div>
<div class="line"><a id="l00468" name="l00468"></a><span class="lineno">  468</span><span class="comment">//          int nID = m_pRasterGrid-&gt;m_Cell[nX][nY].nGetPolygonID();</span></div>
<div class="line"><a id="l00469" name="l00469"></a><span class="lineno">  469</span><span class="comment">//          if (nID == INT_NODATA)</span></div>
<div class="line"><a id="l00470" name="l00470"></a><span class="lineno">  470</span><span class="comment">//             nNotInPoly++;</span></div>
<div class="line"><a id="l00471" name="l00471"></a><span class="lineno">  471</span><span class="comment">//          else</span></div>
<div class="line"><a id="l00472" name="l00472"></a><span class="lineno">  472</span><span class="comment">//             nInPoly++;</span></div>
<div class="line"><a id="l00473" name="l00473"></a><span class="lineno">  473</span><span class="comment">//          </span></div>
<div class="line"><a id="l00474" name="l00474"></a><span class="lineno">  474</span><span class="comment">//          // if (nX == 12)</span></div>
<div class="line"><a id="l00475" name="l00475"></a><span class="lineno">  475</span><span class="comment">//          // {</span></div>
<div class="line"><a id="l00476" name="l00476"></a><span class="lineno">  476</span><span class="comment">//          //    LogStream &lt;&lt; m_ulIter &lt;&lt; &quot; &quot; &lt;&lt; &quot;[&quot; &lt;&lt; nX &lt;&lt; &quot;][&quot; &lt;&lt; nY &lt;&lt; &quot;] is &quot;;</span></div>
<div class="line"><a id="l00477" name="l00477"></a><span class="lineno">  477</span><span class="comment">//          //    if (nID == INT_NODATA)</span></div>
<div class="line"><a id="l00478" name="l00478"></a><span class="lineno">  478</span><span class="comment">//          //       LogStream &lt;&lt; &quot;NOT in poly&quot; &lt;&lt; endl;</span></div>
<div class="line"><a id="l00479" name="l00479"></a><span class="lineno">  479</span><span class="comment">//          //    else</span></div>
<div class="line"><a id="l00480" name="l00480"></a><span class="lineno">  480</span><span class="comment">//          //       LogStream &lt;&lt; &quot;in poly &quot; &lt;&lt; nID &lt;&lt; endl;</span></div>
<div class="line"><a id="l00481" name="l00481"></a><span class="lineno">  481</span><span class="comment">//          // }       </span></div>
<div class="line"><a id="l00482" name="l00482"></a><span class="lineno">  482</span><span class="comment">//          // </span></div>
<div class="line"><a id="l00483" name="l00483"></a><span class="lineno">  483</span><span class="comment">//          // if (nX == 72)</span></div>
<div class="line"><a id="l00484" name="l00484"></a><span class="lineno">  484</span><span class="comment">//          // {</span></div>
<div class="line"><a id="l00485" name="l00485"></a><span class="lineno">  485</span><span class="comment">//          //    LogStream &lt;&lt; m_ulIter &lt;&lt; &quot; &quot; &lt;&lt; &quot;[&quot; &lt;&lt; nX &lt;&lt; &quot;][&quot; &lt;&lt; nY &lt;&lt; &quot;] is &quot;;</span></div>
<div class="line"><a id="l00486" name="l00486"></a><span class="lineno">  486</span><span class="comment">//          //    if (nID == INT_NODATA)</span></div>
<div class="line"><a id="l00487" name="l00487"></a><span class="lineno">  487</span><span class="comment">//          //       LogStream &lt;&lt; &quot;NOT in poly&quot; &lt;&lt; endl;</span></div>
<div class="line"><a id="l00488" name="l00488"></a><span class="lineno">  488</span><span class="comment">//          //    else</span></div>
<div class="line"><a id="l00489" name="l00489"></a><span class="lineno">  489</span><span class="comment">//          //       LogStream &lt;&lt; &quot;in poly &quot; &lt;&lt; nID &lt;&lt; endl;</span></div>
<div class="line"><a id="l00490" name="l00490"></a><span class="lineno">  490</span><span class="comment">//          // }       </span></div>
<div class="line"><a id="l00491" name="l00491"></a><span class="lineno">  491</span><span class="comment">// </span></div>
<div class="line"><a id="l00492" name="l00492"></a><span class="lineno">  492</span><span class="comment">//          pdRaster[n++] = nID;</span></div>
<div class="line"><a id="l00493" name="l00493"></a><span class="lineno">  493</span><span class="comment">//       }      </span></div>
<div class="line"><a id="l00494" name="l00494"></a><span class="lineno">  494</span><span class="comment">//    }</span></div>
<div class="line"><a id="l00495" name="l00495"></a><span class="lineno">  495</span><span class="comment">// </span></div>
<div class="line"><a id="l00496" name="l00496"></a><span class="lineno">  496</span><span class="comment">//    GDALRasterBand* pBand = pDataSet-&gt;GetRasterBand(1);</span></div>
<div class="line"><a id="l00497" name="l00497"></a><span class="lineno">  497</span><span class="comment">//    pBand-&gt;SetNoDataValue(m_dMissingValue);</span></div>
<div class="line"><a id="l00498" name="l00498"></a><span class="lineno">  498</span><span class="comment">//    int nRet = pBand-&gt;RasterIO(GF_Write, 0, 0, m_nXGridSize, m_nYGridSize, pdRaster, m_nXGridSize, m_nYGridSize, GDT_Float64, 0, 0, NULL);</span></div>
<div class="line"><a id="l00499" name="l00499"></a><span class="lineno">  499</span><span class="comment">//    if (nRet == CE_Failure)</span></div>
<div class="line"><a id="l00500" name="l00500"></a><span class="lineno">  500</span><span class="comment">//       return;</span></div>
<div class="line"><a id="l00501" name="l00501"></a><span class="lineno">  501</span><span class="comment">// </span></div>
<div class="line"><a id="l00502" name="l00502"></a><span class="lineno">  502</span><span class="comment">//    GDALClose(pDataSet);</span></div>
<div class="line"><a id="l00503" name="l00503"></a><span class="lineno">  503</span><span class="comment">//    delete[] pdRaster;</span></div>
<div class="line"><a id="l00504" name="l00504"></a><span class="lineno">  504</span><span class="comment">// </span></div>
<div class="line"><a id="l00505" name="l00505"></a><span class="lineno">  505</span><span class="comment">//    // LogStream &lt;&lt; m_ulIter &lt;&lt; &quot; Number of cells in a polygon = &quot; &lt;&lt; nInPoly &lt;&lt; endl;</span></div>
<div class="line"><a id="l00506" name="l00506"></a><span class="lineno">  506</span><span class="comment">//    // LogStream &lt;&lt; m_ulIter &lt;&lt; &quot; Number of cells not in any polygon = &quot; &lt;&lt; nNotInPoly &lt;&lt; endl;</span></div>
<div class="line"><a id="l00507" name="l00507"></a><span class="lineno">  507</span><span class="comment">// </span></div>
<div class="line"><a id="l00508" name="l00508"></a><span class="lineno">  508</span><span class="comment">//    // DEBUG CODE ===========================================</span></div>
<div class="line"><a id="l00509" name="l00509"></a><span class="lineno">  509</span>}</div>
</div>
<div class="line"><a id="l00510" name="l00510"></a><span class="lineno">  510</span> </div>
<div class="line"><a id="l00511" name="l00511"></a><span class="lineno">  511</span> </div>
<div class="line"><a id="l00512" name="l00512"></a><span class="lineno">  512</span><span class="comment">//===============================================================================================================================</span></div>
<div class="line"><a id="l00514" name="l00514"></a><span class="lineno">  514</span><span class="comment">//===============================================================================================================================</span></div>
<div class="foldopen" id="foldopen00515" data-start="{" data-end="}">
<div class="line"><a id="l00515" name="l00515"></a><span class="lineno"><a class="line" href="../../d1/d98/classCSimulation.html#af103396c763e8526e49a977ee0e04ddb">  515</a></span><span class="keywordtype">int</span> <a class="code hl_function" href="../../d1/d98/classCSimulation.html#af103396c763e8526e49a977ee0e04ddb">CSimulation::nDoPolygonSharedBoundaries</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a id="l00516" name="l00516"></a><span class="lineno">  516</span>{</div>
<div class="line"><a id="l00517" name="l00517"></a><span class="lineno">  517</span>   <span class="comment">// Do this for every coast</span></div>
<div class="line"><a id="l00518" name="l00518"></a><span class="lineno">  518</span>   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> nCoast = 0; nCoast &lt; static_cast&lt;int&gt;(<a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a25ada8139c82ca7beab3f279cff83184">m_VCoast</a>.size()); nCoast++)</div>
<div class="line"><a id="l00519" name="l00519"></a><span class="lineno">  519</span>   {</div>
<div class="line"><a id="l00520" name="l00520"></a><span class="lineno">  520</span>      <span class="keywordtype">int</span> nNumPolygons = <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a25ada8139c82ca7beab3f279cff83184">m_VCoast</a>[nCoast].nGetNumPolygons();</div>
<div class="line"><a id="l00521" name="l00521"></a><span class="lineno">  521</span> </div>
<div class="line"><a id="l00522" name="l00522"></a><span class="lineno">  522</span>      <span class="comment">// Do this for every coastal polygon</span></div>
<div class="line"><a id="l00523" name="l00523"></a><span class="lineno">  523</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> nPoly = 0; nPoly &lt; nNumPolygons; nPoly++)</div>
<div class="line"><a id="l00524" name="l00524"></a><span class="lineno">  524</span>      {</div>
<div class="line"><a id="l00525" name="l00525"></a><span class="lineno">  525</span>         <a class="code hl_class" href="../../df/d45/classCGeomCoastPolygon.html">CGeomCoastPolygon</a>* pPolygon = <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a25ada8139c82ca7beab3f279cff83184">m_VCoast</a>[nCoast].pGetPolygon(nPoly);</div>
<div class="line"><a id="l00526" name="l00526"></a><span class="lineno">  526</span> </div>
<div class="line"><a id="l00527" name="l00527"></a><span class="lineno">  527</span>         vector&lt;int&gt;</div>
<div class="line"><a id="l00528" name="l00528"></a><span class="lineno">  528</span>            nVUpCoastAdjacentPolygon,</div>
<div class="line"><a id="l00529" name="l00529"></a><span class="lineno">  529</span>            nVDownCoastAdjacentPolygon;</div>
<div class="line"><a id="l00530" name="l00530"></a><span class="lineno">  530</span> </div>
<div class="line"><a id="l00531" name="l00531"></a><span class="lineno">  531</span>         vector&lt;double&gt;</div>
<div class="line"><a id="l00532" name="l00532"></a><span class="lineno">  532</span>            dVUpCoastBoundaryShare,</div>
<div class="line"><a id="l00533" name="l00533"></a><span class="lineno">  533</span>            dVDownCoastBoundaryShare;</div>
<div class="line"><a id="l00534" name="l00534"></a><span class="lineno">  534</span> </div>
<div class="line"><a id="l00535" name="l00535"></a><span class="lineno">  535</span>         <span class="comment">// First deal with up-coast adjacent polygons</span></div>
<div class="line"><a id="l00536" name="l00536"></a><span class="lineno">  536</span>         <span class="keywordflow">if</span> (nPoly == 0)</div>
<div class="line"><a id="l00537" name="l00537"></a><span class="lineno">  537</span>         {</div>
<div class="line"><a id="l00538" name="l00538"></a><span class="lineno">  538</span>            <span class="comment">// We are at the start of the coastline, no other polygon is adjacent to the up-coast profile of the start-of-coast polygon</span></div>
<div class="line"><a id="l00539" name="l00539"></a><span class="lineno">  539</span>            nVUpCoastAdjacentPolygon.push_back(<a class="code hl_variable" href="../../d6/d2a/cme_8h.html#a01aa8b423260b337ddff2016107b51a0">INT_NODATA</a>);</div>
<div class="line"><a id="l00540" name="l00540"></a><span class="lineno">  540</span>            dVUpCoastBoundaryShare.push_back(1);</div>
<div class="line"><a id="l00541" name="l00541"></a><span class="lineno">  541</span> </div>
<div class="line"><a id="l00542" name="l00542"></a><span class="lineno">  542</span>            <span class="comment">// Store in the polygon</span></div>
<div class="line"><a id="l00543" name="l00543"></a><span class="lineno">  543</span>            pPolygon-&gt;<a class="code hl_function" href="../../df/d45/classCGeomCoastPolygon.html#adbd8b304081b250addc82262b474ed08">SetUpCoastAdjacentPolygons</a>(&amp;nVUpCoastAdjacentPolygon);</div>
<div class="line"><a id="l00544" name="l00544"></a><span class="lineno">  544</span>            pPolygon-&gt;<a class="code hl_function" href="../../df/d45/classCGeomCoastPolygon.html#ad68047ef4a4f8e908858e960a0be4b05">SetUpCoastAdjacentPolygonBoundaryShares</a>(&amp;dVUpCoastBoundaryShare);</div>
<div class="line"><a id="l00545" name="l00545"></a><span class="lineno">  545</span>         }</div>
<div class="line"><a id="l00546" name="l00546"></a><span class="lineno">  546</span>         <span class="keywordflow">else</span></div>
<div class="line"><a id="l00547" name="l00547"></a><span class="lineno">  547</span>         {</div>
<div class="line"><a id="l00548" name="l00548"></a><span class="lineno">  548</span>            <span class="comment">// We are not at the start of the coastline, so there is at least one other polygon adjacent to the up-coast profile of this polygon</span></div>
<div class="line"><a id="l00549" name="l00549"></a><span class="lineno">  549</span>            <span class="keywordtype">int</span></div>
<div class="line"><a id="l00550" name="l00550"></a><span class="lineno">  550</span>               nProfile = pPolygon-&gt;<a class="code hl_function" href="../../df/d45/classCGeomCoastPolygon.html#aa717d51fde4419cad26236395d047b71">nGetUpCoastProfile</a>(),</div>
<div class="line"><a id="l00551" name="l00551"></a><span class="lineno">  551</span>               nPointsInProfile = pPolygon-&gt;<a class="code hl_function" href="../../df/d45/classCGeomCoastPolygon.html#a15e38d01df13699d608e14d52d02cc65">nGetUpCoastProfileNumPointsUsed</a>();</div>
<div class="line"><a id="l00552" name="l00552"></a><span class="lineno">  552</span> </div>
<div class="line"><a id="l00553" name="l00553"></a><span class="lineno">  553</span>            <span class="keywordtype">double</span> dUpCoastTotBoundaryLen = 0;</div>
<div class="line"><a id="l00554" name="l00554"></a><span class="lineno">  554</span> </div>
<div class="line"><a id="l00555" name="l00555"></a><span class="lineno">  555</span>            <a class="code hl_class" href="../../da/dae/classCGeomProfile.html">CGeomProfile</a>* pProfile = <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a25ada8139c82ca7beab3f279cff83184">m_VCoast</a>[nCoast].pGetProfile(nProfile);</div>
<div class="line"><a id="l00556" name="l00556"></a><span class="lineno">  556</span> </div>
<div class="line"><a id="l00557" name="l00557"></a><span class="lineno">  557</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> nPoint = 0; nPoint &lt; nPointsInProfile-1; nPoint++)</div>
<div class="line"><a id="l00558" name="l00558"></a><span class="lineno">  558</span>            {</div>
<div class="line"><a id="l00559" name="l00559"></a><span class="lineno">  559</span>               <a class="code hl_class" href="../../d5/d4e/classCGeom2DPoint.html">CGeom2DPoint</a></div>
<div class="line"><a id="l00560" name="l00560"></a><span class="lineno">  560</span>                  PtStart = *pProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#aaa8ddb9c775927bdb7940f7826f90a74">pPtGetPointInProfile</a>(nPoint),</div>
<div class="line"><a id="l00561" name="l00561"></a><span class="lineno">  561</span>                  PtEnd = *pProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#aaa8ddb9c775927bdb7940f7826f90a74">pPtGetPointInProfile</a>(nPoint+1);</div>
<div class="line"><a id="l00562" name="l00562"></a><span class="lineno">  562</span> </div>
<div class="line"><a id="l00563" name="l00563"></a><span class="lineno">  563</span>               <span class="comment">// Calculate the length of this segment of the normal profile. Note that it should not be zero, since we checked for duplicate points when creating profiles</span></div>
<div class="line"><a id="l00564" name="l00564"></a><span class="lineno">  564</span>               <span class="keywordtype">double</span> dDistBetween = <a class="code hl_function" href="../../d1/d98/classCSimulation.html#a407e01ecfd7c564c74f4474216ce2e16">dGetDistanceBetween</a>(&amp;PtStart, &amp;PtEnd);</div>
<div class="line"><a id="l00565" name="l00565"></a><span class="lineno">  565</span> </div>
<div class="line"><a id="l00566" name="l00566"></a><span class="lineno">  566</span>               <span class="comment">// Find out which polygon is adjacent to each line segment of the polygon&#39;s up-coast profile boundary. The basic approach used is to count the number of coincident profiles in each line segment, and (because we are going up-coast) subtract this number from &#39;this&#39; polygon&#39;s number. However, some of these coincident profiles may be invalid, so we must count only the valid co-incident profiles</span></div>
<div class="line"><a id="l00567" name="l00567"></a><span class="lineno">  567</span>               <span class="keywordtype">int</span></div>
<div class="line"><a id="l00568" name="l00568"></a><span class="lineno">  568</span>                  nNumCoinc = pProfile-&gt;<a class="code hl_function" href="../../d0/d89/classCGeomMultiLine.html#a3516022bd96ee15709653b3bb7cc0155">nGetNumCoincidentProfilesInLineSegment</a>(nPoint),</div>
<div class="line"><a id="l00569" name="l00569"></a><span class="lineno">  569</span>                  nNumValidCoinc = 0;</div>
<div class="line"><a id="l00570" name="l00570"></a><span class="lineno">  570</span> </div>
<div class="line"><a id="l00571" name="l00571"></a><span class="lineno">  571</span>               <span class="keywordflow">for</span> (<span class="keywordtype">int</span> nCoinc = 0; nCoinc &lt; nNumCoinc; nCoinc++)</div>
<div class="line"><a id="l00572" name="l00572"></a><span class="lineno">  572</span>               {</div>
<div class="line"><a id="l00573" name="l00573"></a><span class="lineno">  573</span>                  <span class="keywordtype">int</span> nProf = pProfile-&gt;<a class="code hl_function" href="../../d0/d89/classCGeomMultiLine.html#a4aef627971905a6679ea17401ad8a4d3">nGetCoincidentProfileForLineSegment</a>(nPoint, nCoinc);</div>
<div class="line"><a id="l00574" name="l00574"></a><span class="lineno">  574</span> </div>
<div class="line"><a id="l00575" name="l00575"></a><span class="lineno">  575</span>                  <span class="comment">// Safety check</span></div>
<div class="line"><a id="l00576" name="l00576"></a><span class="lineno">  576</span>                  <span class="keywordflow">if</span> (nProf == -1)</div>
<div class="line"><a id="l00577" name="l00577"></a><span class="lineno">  577</span>                     <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l00578" name="l00578"></a><span class="lineno">  578</span> </div>
<div class="line"><a id="l00579" name="l00579"></a><span class="lineno">  579</span>                  <a class="code hl_class" href="../../da/dae/classCGeomProfile.html">CGeomProfile</a> <span class="keyword">const</span>* pProf = <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a25ada8139c82ca7beab3f279cff83184">m_VCoast</a>[nCoast].pGetProfile(nProf);</div>
<div class="line"><a id="l00580" name="l00580"></a><span class="lineno">  580</span> </div>
<div class="line"><a id="l00581" name="l00581"></a><span class="lineno">  581</span>                  <span class="keywordflow">if</span> (pProf-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#a8dc4e3ce21668f7149ca11aeb7efadf7">bProfileOK</a>())</div>
<div class="line"><a id="l00582" name="l00582"></a><span class="lineno">  582</span>                     nNumValidCoinc++;</div>
<div class="line"><a id="l00583" name="l00583"></a><span class="lineno">  583</span>               }</div>
<div class="line"><a id="l00584" name="l00584"></a><span class="lineno">  584</span> </div>
<div class="line"><a id="l00585" name="l00585"></a><span class="lineno">  585</span>               <span class="comment">// First stab at calculating the number of the adjacent polygon</span></div>
<div class="line"><a id="l00586" name="l00586"></a><span class="lineno">  586</span>               <span class="keywordtype">int</span> nAdj = nPoly - nNumValidCoinc;</div>
<div class="line"><a id="l00587" name="l00587"></a><span class="lineno">  587</span> </div>
<div class="line"><a id="l00588" name="l00588"></a><span class="lineno">  588</span>               <span class="comment">// However, if &#39;this&#39; polygon is close to the start of the coastline, we get polygon numbers below zero i.e. beyond the start of the coastline. If this happens, set the adjacent polygon to &#39;off-edge&#39;</span></div>
<div class="line"><a id="l00589" name="l00589"></a><span class="lineno">  589</span>               <span class="keywordflow">if</span> (nAdj &lt; 0)</div>
<div class="line"><a id="l00590" name="l00590"></a><span class="lineno">  590</span>                  nAdj = <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#a01aa8b423260b337ddff2016107b51a0">INT_NODATA</a>;</div>
<div class="line"><a id="l00591" name="l00591"></a><span class="lineno">  591</span> </div>
<div class="line"><a id="l00592" name="l00592"></a><span class="lineno">  592</span>               nVUpCoastAdjacentPolygon.push_back(nAdj);</div>
<div class="line"><a id="l00593" name="l00593"></a><span class="lineno">  593</span> </div>
<div class="line"><a id="l00594" name="l00594"></a><span class="lineno">  594</span>               dUpCoastTotBoundaryLen += dDistBetween;</div>
<div class="line"><a id="l00595" name="l00595"></a><span class="lineno">  595</span>               dVUpCoastBoundaryShare.push_back(dDistBetween);</div>
<div class="line"><a id="l00596" name="l00596"></a><span class="lineno">  596</span>            }</div>
<div class="line"><a id="l00597" name="l00597"></a><span class="lineno">  597</span> </div>
<div class="line"><a id="l00598" name="l00598"></a><span class="lineno">  598</span>            <span class="comment">// Calculate the up-coast boundary share</span></div>
<div class="line"><a id="l00599" name="l00599"></a><span class="lineno">  599</span>            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n = 0; n &lt; dVUpCoastBoundaryShare.size(); n++)</div>
<div class="line"><a id="l00600" name="l00600"></a><span class="lineno">  600</span>            {</div>
<div class="line"><a id="l00601" name="l00601"></a><span class="lineno">  601</span>               dVUpCoastBoundaryShare[n] /= dUpCoastTotBoundaryLen;</div>
<div class="line"><a id="l00602" name="l00602"></a><span class="lineno">  602</span>               </div>
<div class="line"><a id="l00603" name="l00603"></a><span class="lineno">  603</span>               <span class="comment">// // Safety check</span></div>
<div class="line"><a id="l00604" name="l00604"></a><span class="lineno">  604</span>               <span class="comment">// dVUpCoastBoundaryShare[n] = tMin(dVUpCoastBoundaryShare[n], 1.0);</span></div>
<div class="line"><a id="l00605" name="l00605"></a><span class="lineno">  605</span>            }</div>
<div class="line"><a id="l00606" name="l00606"></a><span class="lineno">  606</span> </div>
<div class="line"><a id="l00607" name="l00607"></a><span class="lineno">  607</span>            <span class="comment">// Store in the polygon</span></div>
<div class="line"><a id="l00608" name="l00608"></a><span class="lineno">  608</span>            pPolygon-&gt;<a class="code hl_function" href="../../df/d45/classCGeomCoastPolygon.html#adbd8b304081b250addc82262b474ed08">SetUpCoastAdjacentPolygons</a>(&amp;nVUpCoastAdjacentPolygon);</div>
<div class="line"><a id="l00609" name="l00609"></a><span class="lineno">  609</span>            pPolygon-&gt;<a class="code hl_function" href="../../df/d45/classCGeomCoastPolygon.html#ad68047ef4a4f8e908858e960a0be4b05">SetUpCoastAdjacentPolygonBoundaryShares</a>(&amp;dVUpCoastBoundaryShare);</div>
<div class="line"><a id="l00610" name="l00610"></a><span class="lineno">  610</span>         }</div>
<div class="line"><a id="l00611" name="l00611"></a><span class="lineno">  611</span> </div>
<div class="line"><a id="l00612" name="l00612"></a><span class="lineno">  612</span>         <span class="comment">// Now deal with down-coast adjacent polygons</span></div>
<div class="line"><a id="l00613" name="l00613"></a><span class="lineno">  613</span>         <span class="keywordflow">if</span> (nPoly == nNumPolygons-1)</div>
<div class="line"><a id="l00614" name="l00614"></a><span class="lineno">  614</span>         {</div>
<div class="line"><a id="l00615" name="l00615"></a><span class="lineno">  615</span>            <span class="comment">// We are at the end of the coastline, no other polygon is adjacent to the down-coast profile of the end-of-coast polygon</span></div>
<div class="line"><a id="l00616" name="l00616"></a><span class="lineno">  616</span>            nVDownCoastAdjacentPolygon.push_back(<a class="code hl_variable" href="../../d6/d2a/cme_8h.html#a01aa8b423260b337ddff2016107b51a0">INT_NODATA</a>);</div>
<div class="line"><a id="l00617" name="l00617"></a><span class="lineno">  617</span>            dVDownCoastBoundaryShare.push_back(1);</div>
<div class="line"><a id="l00618" name="l00618"></a><span class="lineno">  618</span> </div>
<div class="line"><a id="l00619" name="l00619"></a><span class="lineno">  619</span>            <span class="comment">// Store in the polygon</span></div>
<div class="line"><a id="l00620" name="l00620"></a><span class="lineno">  620</span>            pPolygon-&gt;<a class="code hl_function" href="../../df/d45/classCGeomCoastPolygon.html#ad1df78c11a625b56a193cd5a0ae54192">SetDownCoastAdjacentPolygons</a>(&amp;nVDownCoastAdjacentPolygon);</div>
<div class="line"><a id="l00621" name="l00621"></a><span class="lineno">  621</span>            pPolygon-&gt;<a class="code hl_function" href="../../df/d45/classCGeomCoastPolygon.html#a9d56bad783aec1a119fddde1743c50a9">SetDownCoastAdjacentPolygonBoundaryShares</a>(&amp;dVDownCoastBoundaryShare);</div>
<div class="line"><a id="l00622" name="l00622"></a><span class="lineno">  622</span>         }</div>
<div class="line"><a id="l00623" name="l00623"></a><span class="lineno">  623</span>         <span class="keywordflow">else</span></div>
<div class="line"><a id="l00624" name="l00624"></a><span class="lineno">  624</span>         {</div>
<div class="line"><a id="l00625" name="l00625"></a><span class="lineno">  625</span>            <span class="comment">// We are not at the end of the coastline, so there is at least one other polygon adjacent to the down-coast profile of this polygon</span></div>
<div class="line"><a id="l00626" name="l00626"></a><span class="lineno">  626</span>            <span class="keywordtype">int</span> nProfile = pPolygon-&gt;<a class="code hl_function" href="../../df/d45/classCGeomCoastPolygon.html#ae2119674d8d0b78f27bc53ed463fead2">nGetDownCoastProfile</a>();</div>
<div class="line"><a id="l00627" name="l00627"></a><span class="lineno">  627</span>            <span class="keywordtype">int</span> nPointsInProfile = pPolygon-&gt;<a class="code hl_function" href="../../df/d45/classCGeomCoastPolygon.html#a53326f65146f0f9aaef2511e5afbeb69">nGetDownCoastProfileNumPointsUsed</a>();</div>
<div class="line"><a id="l00628" name="l00628"></a><span class="lineno">  628</span> </div>
<div class="line"><a id="l00629" name="l00629"></a><span class="lineno">  629</span>            <span class="keywordtype">double</span> dDownCoastTotBoundaryLen = 0;</div>
<div class="line"><a id="l00630" name="l00630"></a><span class="lineno">  630</span> </div>
<div class="line"><a id="l00631" name="l00631"></a><span class="lineno">  631</span>            <a class="code hl_class" href="../../da/dae/classCGeomProfile.html">CGeomProfile</a>* pProfile = <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a25ada8139c82ca7beab3f279cff83184">m_VCoast</a>[nCoast].pGetProfile(nProfile);</div>
<div class="line"><a id="l00632" name="l00632"></a><span class="lineno">  632</span> </div>
<div class="line"><a id="l00633" name="l00633"></a><span class="lineno">  633</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> nPoint = 0; nPoint &lt; nPointsInProfile-1; nPoint++)</div>
<div class="line"><a id="l00634" name="l00634"></a><span class="lineno">  634</span>            {</div>
<div class="line"><a id="l00635" name="l00635"></a><span class="lineno">  635</span>               <a class="code hl_class" href="../../d5/d4e/classCGeom2DPoint.html">CGeom2DPoint</a> PtStart = *pProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#aaa8ddb9c775927bdb7940f7826f90a74">pPtGetPointInProfile</a>(nPoint);</div>
<div class="line"><a id="l00636" name="l00636"></a><span class="lineno">  636</span>               <a class="code hl_class" href="../../d5/d4e/classCGeom2DPoint.html">CGeom2DPoint</a> PtEnd = *pProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#aaa8ddb9c775927bdb7940f7826f90a74">pPtGetPointInProfile</a>(nPoint+1);</div>
<div class="line"><a id="l00637" name="l00637"></a><span class="lineno">  637</span> </div>
<div class="line"><a id="l00638" name="l00638"></a><span class="lineno">  638</span>               <span class="comment">// Calculate the length of this segment of the normal profile. Note that it should not be zero, since we checked for duplicate points when creating profiles</span></div>
<div class="line"><a id="l00639" name="l00639"></a><span class="lineno">  639</span>               <span class="keywordtype">double</span> dDistBetween = <a class="code hl_function" href="../../d1/d98/classCSimulation.html#a407e01ecfd7c564c74f4474216ce2e16">dGetDistanceBetween</a>(&amp;PtStart, &amp;PtEnd);</div>
<div class="line"><a id="l00640" name="l00640"></a><span class="lineno">  640</span> </div>
<div class="line"><a id="l00641" name="l00641"></a><span class="lineno">  641</span>               <span class="comment">// Find out which polygon is adjacent to each line segment of the polygon&#39;s down-coast profile boundary. The basic approach used is to count the number of coincident profiles in each line segment, and (because we are going down-coast) add this number to &#39;this&#39; polygon&#39;s number. However, some of these coincident profiles may be invalid, so we must count only the valid co-incident profiles</span></div>
<div class="line"><a id="l00642" name="l00642"></a><span class="lineno">  642</span>               <span class="keywordtype">int</span> nNumCoinc = pProfile-&gt;<a class="code hl_function" href="../../d0/d89/classCGeomMultiLine.html#a3516022bd96ee15709653b3bb7cc0155">nGetNumCoincidentProfilesInLineSegment</a>(nPoint);</div>
<div class="line"><a id="l00643" name="l00643"></a><span class="lineno">  643</span>               <span class="keywordtype">int</span> nNumValidCoinc = 0;</div>
<div class="line"><a id="l00644" name="l00644"></a><span class="lineno">  644</span> </div>
<div class="line"><a id="l00645" name="l00645"></a><span class="lineno">  645</span>               <span class="keywordflow">for</span> (<span class="keywordtype">int</span> nCoinc = 0; nCoinc &lt; nNumCoinc; nCoinc++)</div>
<div class="line"><a id="l00646" name="l00646"></a><span class="lineno">  646</span>               {</div>
<div class="line"><a id="l00647" name="l00647"></a><span class="lineno">  647</span>                  <span class="keywordtype">int</span> nProf = pProfile-&gt;<a class="code hl_function" href="../../d0/d89/classCGeomMultiLine.html#a4aef627971905a6679ea17401ad8a4d3">nGetCoincidentProfileForLineSegment</a>(nPoint, nCoinc);</div>
<div class="line"><a id="l00648" name="l00648"></a><span class="lineno">  648</span> </div>
<div class="line"><a id="l00649" name="l00649"></a><span class="lineno">  649</span>                  <span class="comment">// Safety check</span></div>
<div class="line"><a id="l00650" name="l00650"></a><span class="lineno">  650</span>                  <span class="keywordflow">if</span> (nProf == -1)</div>
<div class="line"><a id="l00651" name="l00651"></a><span class="lineno">  651</span>                     <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l00652" name="l00652"></a><span class="lineno">  652</span> </div>
<div class="line"><a id="l00653" name="l00653"></a><span class="lineno">  653</span>                  <a class="code hl_class" href="../../da/dae/classCGeomProfile.html">CGeomProfile</a> <span class="keyword">const</span>* pProf = <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a25ada8139c82ca7beab3f279cff83184">m_VCoast</a>[nCoast].pGetProfile(nProf);</div>
<div class="line"><a id="l00654" name="l00654"></a><span class="lineno">  654</span> </div>
<div class="line"><a id="l00655" name="l00655"></a><span class="lineno">  655</span>                  <span class="keywordflow">if</span> (pProf-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#a8dc4e3ce21668f7149ca11aeb7efadf7">bProfileOK</a>())</div>
<div class="line"><a id="l00656" name="l00656"></a><span class="lineno">  656</span>                     nNumValidCoinc++;</div>
<div class="line"><a id="l00657" name="l00657"></a><span class="lineno">  657</span>               }</div>
<div class="line"><a id="l00658" name="l00658"></a><span class="lineno">  658</span> </div>
<div class="line"><a id="l00659" name="l00659"></a><span class="lineno">  659</span>               <span class="comment">// First stab at calculating the number of the adjacent polygon</span></div>
<div class="line"><a id="l00660" name="l00660"></a><span class="lineno">  660</span>               <span class="keywordtype">int</span> nAdj = nPoly + nNumValidCoinc;</div>
<div class="line"><a id="l00661" name="l00661"></a><span class="lineno">  661</span> </div>
<div class="line"><a id="l00662" name="l00662"></a><span class="lineno">  662</span>               <span class="comment">// However, if &#39;this&#39; polygon is close to the end of the coastline, we get polygon numbers greater than the number of polygons i.e. beyond the end of the coastline. If this happens, set the adjacent polygon to &#39;off-edge&#39;</span></div>
<div class="line"><a id="l00663" name="l00663"></a><span class="lineno">  663</span>               <span class="keywordflow">if</span> (nAdj &gt;= nNumPolygons)</div>
<div class="line"><a id="l00664" name="l00664"></a><span class="lineno">  664</span>                  nAdj = <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#a01aa8b423260b337ddff2016107b51a0">INT_NODATA</a>;</div>
<div class="line"><a id="l00665" name="l00665"></a><span class="lineno">  665</span> </div>
<div class="line"><a id="l00666" name="l00666"></a><span class="lineno">  666</span>               nVDownCoastAdjacentPolygon.push_back(nAdj);</div>
<div class="line"><a id="l00667" name="l00667"></a><span class="lineno">  667</span> </div>
<div class="line"><a id="l00668" name="l00668"></a><span class="lineno">  668</span>               dDownCoastTotBoundaryLen += dDistBetween;</div>
<div class="line"><a id="l00669" name="l00669"></a><span class="lineno">  669</span>               dVDownCoastBoundaryShare.push_back(dDistBetween);</div>
<div class="line"><a id="l00670" name="l00670"></a><span class="lineno">  670</span>            }</div>
<div class="line"><a id="l00671" name="l00671"></a><span class="lineno">  671</span> </div>
<div class="line"><a id="l00672" name="l00672"></a><span class="lineno">  672</span>            <span class="comment">// Calculate the down-coast boundary share</span></div>
<div class="line"><a id="l00673" name="l00673"></a><span class="lineno">  673</span>            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n = 0; n &lt; dVDownCoastBoundaryShare.size(); n++)</div>
<div class="line"><a id="l00674" name="l00674"></a><span class="lineno">  674</span>            {</div>
<div class="line"><a id="l00675" name="l00675"></a><span class="lineno">  675</span>               dVDownCoastBoundaryShare[n] /= dDownCoastTotBoundaryLen;</div>
<div class="line"><a id="l00676" name="l00676"></a><span class="lineno">  676</span>               </div>
<div class="line"><a id="l00677" name="l00677"></a><span class="lineno">  677</span>               <span class="comment">// // Safety check</span></div>
<div class="line"><a id="l00678" name="l00678"></a><span class="lineno">  678</span>               <span class="comment">// dVDownCoastBoundaryShare[n] = tMin(dVDownCoastBoundaryShare[n], 1.0);</span></div>
<div class="line"><a id="l00679" name="l00679"></a><span class="lineno">  679</span>            }</div>
<div class="line"><a id="l00680" name="l00680"></a><span class="lineno">  680</span> </div>
<div class="line"><a id="l00681" name="l00681"></a><span class="lineno">  681</span>            <span class="comment">// Store in the polygon</span></div>
<div class="line"><a id="l00682" name="l00682"></a><span class="lineno">  682</span>            pPolygon-&gt;<a class="code hl_function" href="../../df/d45/classCGeomCoastPolygon.html#ad1df78c11a625b56a193cd5a0ae54192">SetDownCoastAdjacentPolygons</a>(&amp;nVDownCoastAdjacentPolygon);</div>
<div class="line"><a id="l00683" name="l00683"></a><span class="lineno">  683</span>            pPolygon-&gt;<a class="code hl_function" href="../../df/d45/classCGeomCoastPolygon.html#a9d56bad783aec1a119fddde1743c50a9">SetDownCoastAdjacentPolygonBoundaryShares</a>(&amp;dVDownCoastBoundaryShare);</div>
<div class="line"><a id="l00684" name="l00684"></a><span class="lineno">  684</span>         }</div>
<div class="line"><a id="l00685" name="l00685"></a><span class="lineno">  685</span> </div>
<div class="line"><a id="l00686" name="l00686"></a><span class="lineno">  686</span>         <span class="comment">// Finally, calculate the distance between the coast node and the antinode of the polygon</span></div>
<div class="line"><a id="l00687" name="l00687"></a><span class="lineno">  687</span>         <span class="keywordtype">double</span> dPolygonSeawardLen = <a class="code hl_function" href="../../d1/d98/classCSimulation.html#a407e01ecfd7c564c74f4474216ce2e16">dGetDistanceBetween</a>(pPolygon-&gt;<a class="code hl_function" href="../../df/d45/classCGeomCoastPolygon.html#afc6527b76b30e3b0205c65212db99619">pPtiGetNode</a>(), pPolygon-&gt;<a class="code hl_function" href="../../df/d45/classCGeomCoastPolygon.html#a26cb239af6081440054114897f4e9332">pPtiGetAntiNode</a>());</div>
<div class="line"><a id="l00688" name="l00688"></a><span class="lineno">  688</span> </div>
<div class="line"><a id="l00689" name="l00689"></a><span class="lineno">  689</span>         <span class="comment">// And store it</span></div>
<div class="line"><a id="l00690" name="l00690"></a><span class="lineno">  690</span>         <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a25ada8139c82ca7beab3f279cff83184">m_VCoast</a>[nCoast].AppendPolygonLength(dPolygonSeawardLen);</div>
<div class="line"><a id="l00691" name="l00691"></a><span class="lineno">  691</span> </div>
<div class="line"><a id="l00692" name="l00692"></a><span class="lineno">  692</span><span class="comment">//          // DEBUG CODE ======================================================</span></div>
<div class="line"><a id="l00693" name="l00693"></a><span class="lineno">  693</span><span class="comment">//          assert(dVUpCoastBoundaryShare.size() == nVUpCoastAdjacentPolygon.size());</span></div>
<div class="line"><a id="l00694" name="l00694"></a><span class="lineno">  694</span><span class="comment">//          assert(dVDownCoastBoundaryShare.size() == nVDownCoastAdjacentPolygon.size());</span></div>
<div class="line"><a id="l00695" name="l00695"></a><span class="lineno">  695</span><span class="comment">//</span></div>
<div class="line"><a id="l00696" name="l00696"></a><span class="lineno">  696</span><span class="comment">//          //             LogStream &lt;&lt; m_ulIter &lt;&lt; &quot;: polygon = &quot; &lt;&lt; nPoly &lt;&lt; (pPolygon-&gt;bIsPointed() ? &quot; IS TRIANGULAR&quot; : &quot;&quot;) &lt;&lt; endl;</span></div>
<div class="line"><a id="l00697" name="l00697"></a><span class="lineno">  697</span><span class="comment">//          LogStream &lt;&lt; m_ulIter &lt;&lt; &quot;: coast &quot; &lt;&lt; nCoast &lt;&lt; &quot; polygon &quot; &lt;&lt; nPoly &lt;&lt; endl;</span></div>
<div class="line"><a id="l00698" name="l00698"></a><span class="lineno">  698</span><span class="comment">//</span></div>
<div class="line"><a id="l00699" name="l00699"></a><span class="lineno">  699</span><span class="comment">//          LogStream &lt;&lt; &quot;\tThere are &quot; &lt;&lt; nVUpCoastAdjacentPolygon.size() &lt;&lt; &quot; UP-COAST adjacent polygon(s) = &quot;;</span></div>
<div class="line"><a id="l00700" name="l00700"></a><span class="lineno">  700</span><span class="comment">//          for (unsigned int n = 0; n &lt; nVUpCoastAdjacentPolygon.size(); n++)</span></div>
<div class="line"><a id="l00701" name="l00701"></a><span class="lineno">  701</span><span class="comment">//             LogStream &lt;&lt; nVUpCoastAdjacentPolygon[n] &lt;&lt; &quot; &quot;;</span></div>
<div class="line"><a id="l00702" name="l00702"></a><span class="lineno">  702</span><span class="comment">//          LogStream &lt;&lt; endl;</span></div>
<div class="line"><a id="l00703" name="l00703"></a><span class="lineno">  703</span><span class="comment">//</span></div>
<div class="line"><a id="l00704" name="l00704"></a><span class="lineno">  704</span><span class="comment">//          LogStream &lt;&lt; &quot;\tThere are &quot; &lt;&lt; nVDownCoastAdjacentPolygon.size() &lt;&lt; &quot; DOWN-COAST adjacent polygon(s) = &quot;;</span></div>
<div class="line"><a id="l00705" name="l00705"></a><span class="lineno">  705</span><span class="comment">//          for (unsigned int n = 0; n &lt; nVDownCoastAdjacentPolygon.size(); n++)</span></div>
<div class="line"><a id="l00706" name="l00706"></a><span class="lineno">  706</span><span class="comment">//             LogStream &lt;&lt; nVDownCoastAdjacentPolygon[n] &lt;&lt; &quot; &quot;;</span></div>
<div class="line"><a id="l00707" name="l00707"></a><span class="lineno">  707</span><span class="comment">//          LogStream &lt;&lt; endl;</span></div>
<div class="line"><a id="l00708" name="l00708"></a><span class="lineno">  708</span><span class="comment">//</span></div>
<div class="line"><a id="l00709" name="l00709"></a><span class="lineno">  709</span><span class="comment">//          LogStream &lt;&lt; &quot;\tUP-COAST boundary share(s) = &quot;;</span></div>
<div class="line"><a id="l00710" name="l00710"></a><span class="lineno">  710</span><span class="comment">//          for (unsigned int n = 0; n &lt; dVUpCoastBoundaryShare.size(); n++)</span></div>
<div class="line"><a id="l00711" name="l00711"></a><span class="lineno">  711</span><span class="comment">//             LogStream &lt;&lt; dVUpCoastBoundaryShare[n] &lt;&lt; &quot; &quot;;</span></div>
<div class="line"><a id="l00712" name="l00712"></a><span class="lineno">  712</span><span class="comment">//          LogStream &lt;&lt; endl;</span></div>
<div class="line"><a id="l00713" name="l00713"></a><span class="lineno">  713</span><span class="comment">// //          LogStream &lt;&lt; &quot;\tTotal UP-COAST boundary length = &quot; &lt;&lt; dUpCoastTotBoundaryLen &lt;&lt; endl;</span></div>
<div class="line"><a id="l00714" name="l00714"></a><span class="lineno">  714</span><span class="comment">//</span></div>
<div class="line"><a id="l00715" name="l00715"></a><span class="lineno">  715</span><span class="comment">//          LogStream &lt;&lt; &quot;\tDOWN-COAST boundary share(s) = &quot;;</span></div>
<div class="line"><a id="l00716" name="l00716"></a><span class="lineno">  716</span><span class="comment">//          for (unsigned int n = 0; n &lt; dVDownCoastBoundaryShare.size(); n++)</span></div>
<div class="line"><a id="l00717" name="l00717"></a><span class="lineno">  717</span><span class="comment">//             LogStream &lt;&lt; dVDownCoastBoundaryShare[n] &lt;&lt; &quot; &quot;;</span></div>
<div class="line"><a id="l00718" name="l00718"></a><span class="lineno">  718</span><span class="comment">//          LogStream &lt;&lt; endl;</span></div>
<div class="line"><a id="l00719" name="l00719"></a><span class="lineno">  719</span><span class="comment">// //          LogStream &lt;&lt; &quot;\tTotal DOWN-COAST boundary length = &quot; &lt;&lt; dDownCoastTotBoundaryLen &lt;&lt; endl;</span></div>
<div class="line"><a id="l00720" name="l00720"></a><span class="lineno">  720</span><span class="comment">//          // DEBUG CODE ======================================================</span></div>
<div class="line"><a id="l00721" name="l00721"></a><span class="lineno">  721</span>      }</div>
<div class="line"><a id="l00722" name="l00722"></a><span class="lineno">  722</span>   }</div>
<div class="line"><a id="l00723" name="l00723"></a><span class="lineno">  723</span> </div>
<div class="line"><a id="l00724" name="l00724"></a><span class="lineno">  724</span>   <span class="keywordflow">return</span> <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#aa768cb14b5c6123ee95e6e4ebd9fe331">RTN_OK</a>;</div>
<div class="line"><a id="l00725" name="l00725"></a><span class="lineno">  725</span>}</div>
</div>
<div class="line"><a id="l00726" name="l00726"></a><span class="lineno">  726</span> </div>
<div class="line"><a id="l00727" name="l00727"></a><span class="lineno">  727</span><span class="comment">//===============================================================================================================================</span></div>
<div class="line"><a id="l00729" name="l00729"></a><span class="lineno">  729</span><span class="comment">//===============================================================================================================================</span></div>
<div class="foldopen" id="foldopen00730" data-start="{" data-end="}">
<div class="line"><a id="l00730" name="l00730"></a><span class="lineno"><a class="line" href="../../d1/d98/classCSimulation.html#af26b975e1c0f041d6fdaaf83065ef2c8">  730</a></span><span class="keywordtype">bool</span> <a class="code hl_function" href="../../d1/d98/classCSimulation.html#af26b975e1c0f041d6fdaaf83065ef2c8">CSimulation::bIsWithinPolygon</a>(<a class="code hl_class" href="../../d5/d4e/classCGeom2DPoint.html">CGeom2DPoint</a> <span class="keyword">const</span>* pPtStart, vector&lt;CGeom2DPoint&gt; <span class="keyword">const</span>* pPtPoints)</div>
<div class="line"><a id="l00731" name="l00731"></a><span class="lineno">  731</span>{</div>
<div class="line"><a id="l00732" name="l00732"></a><span class="lineno">  732</span>   <span class="keywordtype">bool</span> bOddNodes = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00733" name="l00733"></a><span class="lineno">  733</span> </div>
<div class="line"><a id="l00734" name="l00734"></a><span class="lineno">  734</span>   <span class="keywordtype">int</span></div>
<div class="line"><a id="l00735" name="l00735"></a><span class="lineno">  735</span>      nPolyCorners = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(pPtPoints-&gt;size()),</div>
<div class="line"><a id="l00736" name="l00736"></a><span class="lineno">  736</span>      j = nPolyCorners-1;</div>
<div class="line"><a id="l00737" name="l00737"></a><span class="lineno">  737</span> </div>
<div class="line"><a id="l00738" name="l00738"></a><span class="lineno">  738</span>   <span class="keywordtype">double</span></div>
<div class="line"><a id="l00739" name="l00739"></a><span class="lineno">  739</span>      dX = pPtStart-&gt;<a class="code hl_function" href="../../d5/d4e/classCGeom2DPoint.html#a250f937d03cfdf6e0244b74ad2bf96a4">dGetX</a>(),</div>
<div class="line"><a id="l00740" name="l00740"></a><span class="lineno">  740</span>      dY = pPtStart-&gt;<a class="code hl_function" href="../../d5/d4e/classCGeom2DPoint.html#a216921dc2c592d9468e6430fee7c7719">dGetY</a>();</div>
<div class="line"><a id="l00741" name="l00741"></a><span class="lineno">  741</span> </div>
<div class="line"><a id="l00742" name="l00742"></a><span class="lineno">  742</span>   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nPolyCorners; i++)</div>
<div class="line"><a id="l00743" name="l00743"></a><span class="lineno">  743</span>   {</div>
<div class="line"><a id="l00744" name="l00744"></a><span class="lineno">  744</span>      <span class="keywordtype">double</span></div>
<div class="line"><a id="l00745" name="l00745"></a><span class="lineno">  745</span>         dCorneriX = pPtPoints-&gt;at(i).dGetX(),</div>
<div class="line"><a id="l00746" name="l00746"></a><span class="lineno">  746</span>         dCorneriY = pPtPoints-&gt;at(i).dGetY(),</div>
<div class="line"><a id="l00747" name="l00747"></a><span class="lineno">  747</span>         dCornerjX = pPtPoints-&gt;at(j).dGetX(),</div>
<div class="line"><a id="l00748" name="l00748"></a><span class="lineno">  748</span>         dCornerjY = pPtPoints-&gt;at(j).dGetY();</div>
<div class="line"><a id="l00749" name="l00749"></a><span class="lineno">  749</span> </div>
<div class="line"><a id="l00750" name="l00750"></a><span class="lineno">  750</span>      <span class="keywordflow">if</span> ((dCorneriY &lt; dY &amp;&amp; dCornerjY &gt;= dY) || (dCornerjY &lt; dY &amp;&amp; dCorneriY &gt;= dY))</div>
<div class="line"><a id="l00751" name="l00751"></a><span class="lineno">  751</span>      {</div>
<div class="line"><a id="l00752" name="l00752"></a><span class="lineno">  752</span>         <span class="keywordflow">if</span> (dCorneriX + (dY - dCorneriY) / (dCornerjY - dCorneriY) * (dCornerjX - dCorneriX) &lt; dX)</div>
<div class="line"><a id="l00753" name="l00753"></a><span class="lineno">  753</span>         {</div>
<div class="line"><a id="l00754" name="l00754"></a><span class="lineno">  754</span>            bOddNodes = ! bOddNodes;</div>
<div class="line"><a id="l00755" name="l00755"></a><span class="lineno">  755</span>         }</div>
<div class="line"><a id="l00756" name="l00756"></a><span class="lineno">  756</span>      }</div>
<div class="line"><a id="l00757" name="l00757"></a><span class="lineno">  757</span> </div>
<div class="line"><a id="l00758" name="l00758"></a><span class="lineno">  758</span>      j = i;</div>
<div class="line"><a id="l00759" name="l00759"></a><span class="lineno">  759</span>   }</div>
<div class="line"><a id="l00760" name="l00760"></a><span class="lineno">  760</span> </div>
<div class="line"><a id="l00761" name="l00761"></a><span class="lineno">  761</span>  <span class="keywordflow">return</span> bOddNodes;</div>
<div class="line"><a id="l00762" name="l00762"></a><span class="lineno">  762</span>}</div>
</div>
<div class="line"><a id="l00763" name="l00763"></a><span class="lineno">  763</span> </div>
<div class="line"><a id="l00764" name="l00764"></a><span class="lineno">  764</span><span class="comment">//===============================================================================================================================</span></div>
<div class="line"><a id="l00766" name="l00766"></a><span class="lineno">  766</span><span class="comment">//===============================================================================================================================</span></div>
<div class="foldopen" id="foldopen00767" data-start="{" data-end="}">
<div class="line"><a id="l00767" name="l00767"></a><span class="lineno"><a class="line" href="../../d1/d98/classCSimulation.html#ab071e8422c990d7dff462e3eab8df941">  767</a></span><a class="code hl_class" href="../../d5/d4e/classCGeom2DPoint.html">CGeom2DPoint</a> <a class="code hl_function" href="../../d1/d98/classCSimulation.html#ab071e8422c990d7dff462e3eab8df941">CSimulation::PtFindPointInPolygon</a>(vector&lt;CGeom2DPoint&gt; <span class="keyword">const</span>* pPtPoints, <span class="keywordtype">int</span> <span class="keyword">const</span> nStartPoint)</div>
<div class="line"><a id="l00768" name="l00768"></a><span class="lineno">  768</span>{</div>
<div class="line"><a id="l00769" name="l00769"></a><span class="lineno">  769</span>   <span class="keywordtype">int</span> nPolySize = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(pPtPoints-&gt;size());</div>
<div class="line"><a id="l00770" name="l00770"></a><span class="lineno">  770</span>   <span class="keywordtype">int</span> nOffSet = 0;</div>
<div class="line"><a id="l00771" name="l00771"></a><span class="lineno">  771</span>   <a class="code hl_class" href="../../d5/d4e/classCGeom2DPoint.html">CGeom2DPoint</a> PtStart;</div>
<div class="line"><a id="l00772" name="l00772"></a><span class="lineno">  772</span> </div>
<div class="line"><a id="l00773" name="l00773"></a><span class="lineno">  773</span>   <span class="keywordflow">do</span></div>
<div class="line"><a id="l00774" name="l00774"></a><span class="lineno">  774</span>   {</div>
<div class="line"><a id="l00775" name="l00775"></a><span class="lineno">  775</span>      <span class="comment">// Choose three consecutive points from the polygon</span></div>
<div class="line"><a id="l00776" name="l00776"></a><span class="lineno">  776</span>      vector &lt;CGeom2DPoint&gt; nVTestPoints;</div>
<div class="line"><a id="l00777" name="l00777"></a><span class="lineno">  777</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n = 0; n &lt; 3; n++)</div>
<div class="line"><a id="l00778" name="l00778"></a><span class="lineno">  778</span>      {</div>
<div class="line"><a id="l00779" name="l00779"></a><span class="lineno">  779</span>         <span class="keywordtype">int</span> nIndex = n + nStartPoint + nOffSet;</div>
<div class="line"><a id="l00780" name="l00780"></a><span class="lineno">  780</span>         <span class="keywordflow">if</span> (nIndex &gt; nPolySize-1)</div>
<div class="line"><a id="l00781" name="l00781"></a><span class="lineno">  781</span>            nIndex -= nPolySize;</div>
<div class="line"><a id="l00782" name="l00782"></a><span class="lineno">  782</span> </div>
<div class="line"><a id="l00783" name="l00783"></a><span class="lineno">  783</span>         <span class="comment">// Safety check</span></div>
<div class="line"><a id="l00784" name="l00784"></a><span class="lineno">  784</span>         <span class="keywordflow">if</span> (nIndex &lt; 0)</div>
<div class="line"><a id="l00785" name="l00785"></a><span class="lineno">  785</span>            <span class="keywordflow">return</span> <a class="code hl_class" href="../../d5/d4e/classCGeom2DPoint.html">CGeom2DPoint</a>(<a class="code hl_variable" href="../../d6/d2a/cme_8h.html#ac003bdff958dca839f5d274f15786e07">DBL_NODATA</a>, <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#ac003bdff958dca839f5d274f15786e07">DBL_NODATA</a>);</div>
<div class="line"><a id="l00786" name="l00786"></a><span class="lineno">  786</span> </div>
<div class="line"><a id="l00787" name="l00787"></a><span class="lineno">  787</span>         nVTestPoints.push_back(pPtPoints-&gt;at(nIndex));</div>
<div class="line"><a id="l00788" name="l00788"></a><span class="lineno">  788</span>      }</div>
<div class="line"><a id="l00789" name="l00789"></a><span class="lineno">  789</span> </div>
<div class="line"><a id="l00790" name="l00790"></a><span class="lineno">  790</span>      <span class="comment">// Increment ready for next time</span></div>
<div class="line"><a id="l00791" name="l00791"></a><span class="lineno">  791</span>      nOffSet++;</div>
<div class="line"><a id="l00792" name="l00792"></a><span class="lineno">  792</span> </div>
<div class="line"><a id="l00793" name="l00793"></a><span class="lineno">  793</span>      <span class="comment">// Safety check</span></div>
<div class="line"><a id="l00794" name="l00794"></a><span class="lineno">  794</span>      <span class="keywordflow">if</span> (nOffSet &gt;= (nPolySize + 3))</div>
<div class="line"><a id="l00795" name="l00795"></a><span class="lineno">  795</span>         <span class="keywordflow">return</span> <a class="code hl_class" href="../../d5/d4e/classCGeom2DPoint.html">CGeom2DPoint</a>(<a class="code hl_variable" href="../../d6/d2a/cme_8h.html#ac003bdff958dca839f5d274f15786e07">DBL_NODATA</a>, <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#ac003bdff958dca839f5d274f15786e07">DBL_NODATA</a>);</div>
<div class="line"><a id="l00796" name="l00796"></a><span class="lineno">  796</span> </div>
<div class="line"><a id="l00797" name="l00797"></a><span class="lineno">  797</span>      <span class="comment">// Check if the halfway point between the first and the third point is inside the polygon</span></div>
<div class="line"><a id="l00798" name="l00798"></a><span class="lineno">  798</span>      PtStart = <a class="code hl_function" href="../../d1/d98/classCSimulation.html#a41d2806566f688547f97c0d573bb1611">PtAverage</a>(&amp;nVTestPoints[0], &amp;nVTestPoints[2]);</div>
<div class="line"><a id="l00799" name="l00799"></a><span class="lineno">  799</span>   }</div>
<div class="line"><a id="l00800" name="l00800"></a><span class="lineno">  800</span>   <span class="keywordflow">while</span> (! <a class="code hl_function" href="../../d1/d98/classCSimulation.html#af26b975e1c0f041d6fdaaf83065ef2c8">bIsWithinPolygon</a>(&amp;PtStart, pPtPoints));</div>
<div class="line"><a id="l00801" name="l00801"></a><span class="lineno">  801</span> </div>
<div class="line"><a id="l00802" name="l00802"></a><span class="lineno">  802</span>   <span class="keywordflow">return</span> PtStart;</div>
<div class="line"><a id="l00803" name="l00803"></a><span class="lineno">  803</span>}</div>
</div>
<div class="ttc" id="aclassCA2DShape_html_ac72351d5502907edbf335a7611a2b7ca"><div class="ttname"><a href="../../d9/d0e/classCA2DShape.html#ac72351d5502907edbf335a7611a2b7ca">CA2DShape::PtGetCentroid</a></div><div class="ttdeci">CGeom2DPoint PtGetCentroid(void)</div><div class="ttdoc">Computes the centroid of this 2D polygon (which may be outside, if this is a concave polygon)....</div><div class="ttdef"><b>Definition</b> <a href="../../da/dfd/2d__shape_8cpp_source.html#l00134">2d_shape.cpp:134</a></div></div>
<div class="ttc" id="aclassCGeom2DIPoint_html"><div class="ttname"><a href="../../d6/d0d/classCGeom2DIPoint.html">CGeom2DIPoint</a></div><div class="ttdoc">Geometry class used to represent 2D point objects with integer co-ordinates.</div><div class="ttdef"><b>Definition</b> <a href="../../d2/d66/2di__point_8h_source.html#l00029">2di_point.h:30</a></div></div>
<div class="ttc" id="aclassCGeom2DIPoint_html_a4d9c20bcca90dcb9d519b664aba09cbd"><div class="ttname"><a href="../../d6/d0d/classCGeom2DIPoint.html#a4d9c20bcca90dcb9d519b664aba09cbd">CGeom2DIPoint::nGetY</a></div><div class="ttdeci">int nGetY(void) const</div><div class="ttdoc">Returns the CGeom2DIPoint object's integer Y co-ordinate.</div><div class="ttdef"><b>Definition</b> <a href="../../d8/dc5/2di__point_8cpp_source.html#l00048">2di_point.cpp:48</a></div></div>
<div class="ttc" id="aclassCGeom2DIPoint_html_af84c687b2d0be01ab41cbcc0565f4f3f"><div class="ttname"><a href="../../d6/d0d/classCGeom2DIPoint.html#af84c687b2d0be01ab41cbcc0565f4f3f">CGeom2DIPoint::nGetX</a></div><div class="ttdeci">int nGetX(void) const</div><div class="ttdoc">Returns the CGeom2DIPoint object's integer X co-ordinate.</div><div class="ttdef"><b>Definition</b> <a href="../../d8/dc5/2di__point_8cpp_source.html#l00042">2di_point.cpp:42</a></div></div>
<div class="ttc" id="aclassCGeom2DPoint_html"><div class="ttname"><a href="../../d5/d4e/classCGeom2DPoint.html">CGeom2DPoint</a></div><div class="ttdoc">Geometry class used to represent 2D point objects with floating-point co-ordinates.</div><div class="ttdef"><b>Definition</b> <a href="../../d0/dee/2d__point_8h_source.html#l00025">2d_point.h:26</a></div></div>
<div class="ttc" id="aclassCGeom2DPoint_html_a216921dc2c592d9468e6430fee7c7719"><div class="ttname"><a href="../../d5/d4e/classCGeom2DPoint.html#a216921dc2c592d9468e6430fee7c7719">CGeom2DPoint::dGetY</a></div><div class="ttdeci">double dGetY(void) const</div><div class="ttdoc">Returns the CGeom2DPoint object's double Y co-ordinate.</div><div class="ttdef"><b>Definition</b> <a href="../../d2/d81/2d__point_8cpp_source.html#l00044">2d_point.cpp:44</a></div></div>
<div class="ttc" id="aclassCGeom2DPoint_html_a250f937d03cfdf6e0244b74ad2bf96a4"><div class="ttname"><a href="../../d5/d4e/classCGeom2DPoint.html#a250f937d03cfdf6e0244b74ad2bf96a4">CGeom2DPoint::dGetX</a></div><div class="ttdeci">double dGetX(void) const</div><div class="ttdoc">Returns the CGeom2DPoint object's double X co-ordinate.</div><div class="ttdef"><b>Definition</b> <a href="../../d2/d81/2d__point_8cpp_source.html#l00038">2d_point.cpp:38</a></div></div>
<div class="ttc" id="aclassCGeomCell_html_a3a378431e2f6095792582989f50fb435"><div class="ttname"><a href="../../d1/dd9/classCGeomCell.html#a3a378431e2f6095792582989f50fb435">CGeomCell::dGetSeaDepth</a></div><div class="ttdeci">double dGetSeaDepth(void) const</div><div class="ttdoc">Returns the depth of seawater on this cell.</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d68/cell_8cpp_source.html#l00428">cell.cpp:428</a></div></div>
<div class="ttc" id="aclassCGeomCell_html_a43434d6fd45da697ae17f7b274ba9a83"><div class="ttname"><a href="../../d1/dd9/classCGeomCell.html#a43434d6fd45da697ae17f7b274ba9a83">CGeomCell::nGetTopNonZeroLayerAboveBasement</a></div><div class="ttdeci">int nGetTopNonZeroLayerAboveBasement(void) const</div><div class="ttdoc">Returns the index of the topmost sediment layer (layer 0 being the one just above basement) with non-...</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d68/cell_8cpp_source.html#l00468">cell.cpp:468</a></div></div>
<div class="ttc" id="aclassCGeomCell_html_a622387009a4fcb864bfdab627389ea84"><div class="ttname"><a href="../../d1/dd9/classCGeomCell.html#a622387009a4fcb864bfdab627389ea84">CGeomCell::nGetPolygonID</a></div><div class="ttdeci">int nGetPolygonID(void) const</div><div class="ttdoc">Returns the global ID number of the polygon which 'contains' this cell (returns INT_NODATA if the cel...</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d68/cell_8cpp_source.html#l00274">cell.cpp:274</a></div></div>
<div class="ttc" id="aclassCGeomCell_html_a65dc08df7cf712555b94d91157431965"><div class="ttname"><a href="../../d1/dd9/classCGeomCell.html#a65dc08df7cf712555b94d91157431965">CGeomCell::pGetLayerAboveBasement</a></div><div class="ttdeci">CRWCellLayer * pGetLayerAboveBasement(int const)</div><div class="ttdoc">Return a reference to the Nth sediment layer (layer 0 being just above basement)</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d68/cell_8cpp_source.html#l00510">cell.cpp:510</a></div></div>
<div class="ttc" id="aclassCGeomCell_html_a6f998fef62c1873fdee5f2685544aad4"><div class="ttname"><a href="../../d1/dd9/classCGeomCell.html#a6f998fef62c1873fdee5f2685544aad4">CGeomCell::SetPolygonID</a></div><div class="ttdeci">void SetPolygonID(int const)</div><div class="ttdoc">Sets the global ID number of the polygon which 'contains' this cell.</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d68/cell_8cpp_source.html#l00268">cell.cpp:268</a></div></div>
<div class="ttc" id="aclassCGeomCell_html_ad201e23ab4726d7c1825d873237ff368"><div class="ttname"><a href="../../d1/dd9/classCGeomCell.html#ad201e23ab4726d7c1825d873237ff368">CGeomCell::dGetSuspendedSediment</a></div><div class="ttdeci">double dGetSuspendedSediment(void) const</div><div class="ttdoc">Returns the suspended sediment depth equivalent on this cell.</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d68/cell_8cpp_source.html#l00456">cell.cpp:456</a></div></div>
<div class="ttc" id="aclassCGeomCoastPolygon_html"><div class="ttname"><a href="../../df/d45/classCGeomCoastPolygon.html">CGeomCoastPolygon</a></div><div class="ttdoc">Geometry class used for coast polygon objects.</div><div class="ttdef"><b>Definition</b> <a href="../../d6/db2/coast__polygon_8h_source.html#l00031">coast_polygon.h:32</a></div></div>
<div class="ttc" id="aclassCGeomCoastPolygon_html_a15e38d01df13699d608e14d52d02cc65"><div class="ttname"><a href="../../df/d45/classCGeomCoastPolygon.html#a15e38d01df13699d608e14d52d02cc65">CGeomCoastPolygon::nGetUpCoastProfileNumPointsUsed</a></div><div class="ttdeci">int nGetUpCoastProfileNumPointsUsed(void) const</div><div class="ttdoc">Return the number of points in the up-coast profile.</div><div class="ttdef"><b>Definition</b> <a href="../../df/d30/coast__polygon_8cpp_source.html#l00196">coast_polygon.cpp:196</a></div></div>
<div class="ttc" id="aclassCGeomCoastPolygon_html_a26cb239af6081440054114897f4e9332"><div class="ttname"><a href="../../df/d45/classCGeomCoastPolygon.html#a26cb239af6081440054114897f4e9332">CGeomCoastPolygon::pPtiGetAntiNode</a></div><div class="ttdeci">CGeom2DIPoint * pPtiGetAntiNode(void)</div><div class="ttdoc">Get the anti-node (raster-grid CRS) which is at other (seaward) end of the polygon from the node.</div><div class="ttdef"><b>Definition</b> <a href="../../df/d30/coast__polygon_8cpp_source.html#l00143">coast_polygon.cpp:143</a></div></div>
<div class="ttc" id="aclassCGeomCoastPolygon_html_a33b5ee96a889a83c8aa34399f3f15c12"><div class="ttname"><a href="../../df/d45/classCGeomCoastPolygon.html#a33b5ee96a889a83c8aa34399f3f15c12">CGeomCoastPolygon::SetSedimentInputUnconsSand</a></div><div class="ttdeci">void SetSedimentInputUnconsSand(double const)</div><div class="ttdoc">Set the value of sand sediment on the polygon derived from sediment input events(s)</div><div class="ttdef"><b>Definition</b> <a href="../../df/d30/coast__polygon_8cpp_source.html#l00697">coast_polygon.cpp:697</a></div></div>
<div class="ttc" id="aclassCGeomCoastPolygon_html_a34cf2701da81a0b72365b1fa7fa855b4"><div class="ttname"><a href="../../df/d45/classCGeomCoastPolygon.html#a34cf2701da81a0b72365b1fa7fa855b4">CGeomCoastPolygon::SetPreExistingUnconsFine</a></div><div class="ttdeci">void SetPreExistingUnconsFine(double const)</div><div class="ttdoc">Set the value of pre-existing unconsolidated fine sediment stored on this polygon.</div><div class="ttdef"><b>Definition</b> <a href="../../df/d30/coast__polygon_8cpp_source.html#l00613">coast_polygon.cpp:613</a></div></div>
<div class="ttc" id="aclassCGeomCoastPolygon_html_a35df99fb60cac21d4f6c42218f8169d2"><div class="ttname"><a href="../../df/d45/classCGeomCoastPolygon.html#a35df99fb60cac21d4f6c42218f8169d2">CGeomCoastPolygon::SetSedimentInputUnconsFine</a></div><div class="ttdeci">void SetSedimentInputUnconsFine(double const)</div><div class="ttdoc">Set the value of fine sediment on the polygon derived from sediment input events(s)</div><div class="ttdef"><b>Definition</b> <a href="../../df/d30/coast__polygon_8cpp_source.html#l00685">coast_polygon.cpp:685</a></div></div>
<div class="ttc" id="aclassCGeomCoastPolygon_html_a3d3d6e36327eed01f632184ccdade662"><div class="ttname"><a href="../../df/d45/classCGeomCoastPolygon.html#a3d3d6e36327eed01f632184ccdade662">CGeomCoastPolygon::SetPreExistingConsFine</a></div><div class="ttdeci">void SetPreExistingConsFine(double const)</div><div class="ttdoc">Set the value of pre-existing consolidated fine sediment stored on this polygon.</div><div class="ttdef"><b>Definition</b> <a href="../../df/d30/coast__polygon_8cpp_source.html#l00649">coast_polygon.cpp:649</a></div></div>
<div class="ttc" id="aclassCGeomCoastPolygon_html_a41ffd18c3a9539811aeb120f6886e6da"><div class="ttname"><a href="../../df/d45/classCGeomCoastPolygon.html#a41ffd18c3a9539811aeb120f6886e6da">CGeomCoastPolygon::SetPreExistingUnconsSand</a></div><div class="ttdeci">void SetPreExistingUnconsSand(double const)</div><div class="ttdoc">Set the value of pre-existing unconsolidated sand sediment stored on this polygon.</div><div class="ttdef"><b>Definition</b> <a href="../../df/d30/coast__polygon_8cpp_source.html#l00625">coast_polygon.cpp:625</a></div></div>
<div class="ttc" id="aclassCGeomCoastPolygon_html_a440264eb31972f7f9ce65de909d61832"><div class="ttname"><a href="../../df/d45/classCGeomCoastPolygon.html#a440264eb31972f7f9ce65de909d61832">CGeomCoastPolygon::SetSeawaterVolume</a></div><div class="ttdeci">void SetSeawaterVolume(const double)</div><div class="ttdoc">Set the volume of seawater in the coast polygon.</div><div class="ttdef"><b>Definition</b> <a href="../../df/d30/coast__polygon_8cpp_source.html#l00208">coast_polygon.cpp:208</a></div></div>
<div class="ttc" id="aclassCGeomCoastPolygon_html_a53326f65146f0f9aaef2511e5afbeb69"><div class="ttname"><a href="../../df/d45/classCGeomCoastPolygon.html#a53326f65146f0f9aaef2511e5afbeb69">CGeomCoastPolygon::nGetDownCoastProfileNumPointsUsed</a></div><div class="ttdeci">int nGetDownCoastProfileNumPointsUsed(void) const</div><div class="ttdoc">Return the number of points in the down-coast profile.</div><div class="ttdef"><b>Definition</b> <a href="../../df/d30/coast__polygon_8cpp_source.html#l00202">coast_polygon.cpp:202</a></div></div>
<div class="ttc" id="aclassCGeomCoastPolygon_html_a5bfd1f0d803176bf7bb318a3ff3964c6"><div class="ttname"><a href="../../df/d45/classCGeomCoastPolygon.html#a5bfd1f0d803176bf7bb318a3ff3964c6">CGeomCoastPolygon::nGetPointInPolygonSearchStartPoint</a></div><div class="ttdeci">int nGetPointInPolygonSearchStartPoint(void) const</div><div class="ttdoc">Returns the start point for a point-in-polygon search.</div><div class="ttdef"><b>Definition</b> <a href="../../df/d30/coast__polygon_8cpp_source.html#l00446">coast_polygon.cpp:446</a></div></div>
<div class="ttc" id="aclassCGeomCoastPolygon_html_a5fdf4a13695deba1640a1073b48e8410"><div class="ttname"><a href="../../df/d45/classCGeomCoastPolygon.html#a5fdf4a13695deba1640a1073b48e8410">CGeomCoastPolygon::pPtGetBoundaryPoint</a></div><div class="ttdeci">CGeom2DPoint * pPtGetBoundaryPoint(int const)</div><div class="ttdoc">Get the co-ordinates (external CRS) of a specified point on the polygon's boundary.</div><div class="ttdef"><b>Definition</b> <a href="../../df/d30/coast__polygon_8cpp_source.html#l00183">coast_polygon.cpp:183</a></div></div>
<div class="ttc" id="aclassCGeomCoastPolygon_html_a6b42ec53178379945ca004050f30f039"><div class="ttname"><a href="../../df/d45/classCGeomCoastPolygon.html#a6b42ec53178379945ca004050f30f039">CGeomCoastPolygon::SetSedimentInputUnconsCoarse</a></div><div class="ttdeci">void SetSedimentInputUnconsCoarse(double const)</div><div class="ttdoc">Set the value of coarse sediment on the polygon derived from sediment input events(s)</div><div class="ttdef"><b>Definition</b> <a href="../../df/d30/coast__polygon_8cpp_source.html#l00709">coast_polygon.cpp:709</a></div></div>
<div class="ttc" id="aclassCGeomCoastPolygon_html_a765ccfcf69a2d02959dd156d32af579e"><div class="ttname"><a href="../../df/d45/classCGeomCoastPolygon.html#a765ccfcf69a2d02959dd156d32af579e">CGeomCoastPolygon::nGetGlobalID</a></div><div class="ttdeci">int nGetGlobalID(void) const</div><div class="ttdoc">Get the global ID.</div><div class="ttdef"><b>Definition</b> <a href="../../df/d30/coast__polygon_8cpp_source.html#l00113">coast_polygon.cpp:113</a></div></div>
<div class="ttc" id="aclassCGeomCoastPolygon_html_a9d56bad783aec1a119fddde1743c50a9"><div class="ttname"><a href="../../df/d45/classCGeomCoastPolygon.html#a9d56bad783aec1a119fddde1743c50a9">CGeomCoastPolygon::SetDownCoastAdjacentPolygonBoundaryShares</a></div><div class="ttdeci">void SetDownCoastAdjacentPolygonBoundaryShares(vector&lt; double &gt; const *)</div><div class="ttdoc">Sets the boundary shares for all down-coast adjacent polygons.</div><div class="ttdef"><b>Definition</b> <a href="../../df/d30/coast__polygon_8cpp_source.html#l00433">coast_polygon.cpp:433</a></div></div>
<div class="ttc" id="aclassCGeomCoastPolygon_html_aa717d51fde4419cad26236395d047b71"><div class="ttname"><a href="../../df/d45/classCGeomCoastPolygon.html#aa717d51fde4419cad26236395d047b71">CGeomCoastPolygon::nGetUpCoastProfile</a></div><div class="ttdeci">int nGetUpCoastProfile(void) const</div><div class="ttdoc">Return the number of the up-coast profile.</div><div class="ttdef"><b>Definition</b> <a href="../../df/d30/coast__polygon_8cpp_source.html#l00161">coast_polygon.cpp:161</a></div></div>
<div class="ttc" id="aclassCGeomCoastPolygon_html_ab02a39464ee62ca5ec8b7b3a556153bf"><div class="ttname"><a href="../../df/d45/classCGeomCoastPolygon.html#ab02a39464ee62ca5ec8b7b3a556153bf">CGeomCoastPolygon::SetPreExistingConsCoarse</a></div><div class="ttdeci">void SetPreExistingConsCoarse(double const)</div><div class="ttdoc">Set the value of pre-existing consolidated coarse sediment stored on this polygon.</div><div class="ttdef"><b>Definition</b> <a href="../../df/d30/coast__polygon_8cpp_source.html#l00673">coast_polygon.cpp:673</a></div></div>
<div class="ttc" id="aclassCGeomCoastPolygon_html_ab852fa65536ccc1e4d5357a9b40806f6"><div class="ttname"><a href="../../df/d45/classCGeomCoastPolygon.html#ab852fa65536ccc1e4d5357a9b40806f6">CGeomCoastPolygon::nGetBoundarySize</a></div><div class="ttdeci">int nGetBoundarySize(void) const</div><div class="ttdoc">Get the number of points in the polygon's boundary.</div><div class="ttdef"><b>Definition</b> <a href="../../df/d30/coast__polygon_8cpp_source.html#l00190">coast_polygon.cpp:190</a></div></div>
<div class="ttc" id="aclassCGeomCoastPolygon_html_abdb77248b1f7a026e656bf4e4e08696b"><div class="ttname"><a href="../../df/d45/classCGeomCoastPolygon.html#abdb77248b1f7a026e656bf4e4e08696b">CGeomCoastPolygon::SetPreExistingUnconsCoarse</a></div><div class="ttdeci">void SetPreExistingUnconsCoarse(double const)</div><div class="ttdoc">Set the value of pre-existing unconsolidated coarse sediment stored on this polygon.</div><div class="ttdef"><b>Definition</b> <a href="../../df/d30/coast__polygon_8cpp_source.html#l00637">coast_polygon.cpp:637</a></div></div>
<div class="ttc" id="aclassCGeomCoastPolygon_html_ad1df78c11a625b56a193cd5a0ae54192"><div class="ttname"><a href="../../df/d45/classCGeomCoastPolygon.html#ad1df78c11a625b56a193cd5a0ae54192">CGeomCoastPolygon::SetDownCoastAdjacentPolygons</a></div><div class="ttdeci">void SetDownCoastAdjacentPolygons(vector&lt; int &gt; const *)</div><div class="ttdoc">Sets all down-coast adjacent polygons.</div><div class="ttdef"><b>Definition</b> <a href="../../df/d30/coast__polygon_8cpp_source.html#l00401">coast_polygon.cpp:401</a></div></div>
<div class="ttc" id="aclassCGeomCoastPolygon_html_ad68047ef4a4f8e908858e960a0be4b05"><div class="ttname"><a href="../../df/d45/classCGeomCoastPolygon.html#ad68047ef4a4f8e908858e960a0be4b05">CGeomCoastPolygon::SetUpCoastAdjacentPolygonBoundaryShares</a></div><div class="ttdeci">void SetUpCoastAdjacentPolygonBoundaryShares(vector&lt; double &gt; const *)</div><div class="ttdoc">Sets the boundary shares for all up-coast adjacent polygons.</div><div class="ttdef"><b>Definition</b> <a href="../../df/d30/coast__polygon_8cpp_source.html#l00420">coast_polygon.cpp:420</a></div></div>
<div class="ttc" id="aclassCGeomCoastPolygon_html_adbd8b304081b250addc82262b474ed08"><div class="ttname"><a href="../../df/d45/classCGeomCoastPolygon.html#adbd8b304081b250addc82262b474ed08">CGeomCoastPolygon::SetUpCoastAdjacentPolygons</a></div><div class="ttdeci">void SetUpCoastAdjacentPolygons(vector&lt; int &gt; const *)</div><div class="ttdoc">Sets all up-coast adjacent polygons.</div><div class="ttdef"><b>Definition</b> <a href="../../df/d30/coast__polygon_8cpp_source.html#l00382">coast_polygon.cpp:382</a></div></div>
<div class="ttc" id="aclassCGeomCoastPolygon_html_ae15a709df66f5ca57b9b2c9115f2d354"><div class="ttname"><a href="../../df/d45/classCGeomCoastPolygon.html#ae15a709df66f5ca57b9b2c9115f2d354">CGeomCoastPolygon::SetPreExistingConsSand</a></div><div class="ttdeci">void SetPreExistingConsSand(double const)</div><div class="ttdoc">Set the value of pre-existing consolidated sand sediment stored on this polygon.</div><div class="ttdef"><b>Definition</b> <a href="../../df/d30/coast__polygon_8cpp_source.html#l00661">coast_polygon.cpp:661</a></div></div>
<div class="ttc" id="aclassCGeomCoastPolygon_html_ae2119674d8d0b78f27bc53ed463fead2"><div class="ttname"><a href="../../df/d45/classCGeomCoastPolygon.html#ae2119674d8d0b78f27bc53ed463fead2">CGeomCoastPolygon::nGetDownCoastProfile</a></div><div class="ttdeci">int nGetDownCoastProfile(void) const</div><div class="ttdoc">Return the number of the down-coast profile.</div><div class="ttdef"><b>Definition</b> <a href="../../df/d30/coast__polygon_8cpp_source.html#l00167">coast_polygon.cpp:167</a></div></div>
<div class="ttc" id="aclassCGeomCoastPolygon_html_aea28877120b36563169e11c9cdcf2294"><div class="ttname"><a href="../../df/d45/classCGeomCoastPolygon.html#aea28877120b36563169e11c9cdcf2294">CGeomCoastPolygon::SetNumCellsInPolygon</a></div><div class="ttdeci">void SetNumCellsInPolygon(int const)</div><div class="ttdoc">Set the number of cells in the polygon.</div><div class="ttdef"><b>Definition</b> <a href="../../df/d30/coast__polygon_8cpp_source.html#l00149">coast_polygon.cpp:149</a></div></div>
<div class="ttc" id="aclassCGeomCoastPolygon_html_afc6527b76b30e3b0205c65212db99619"><div class="ttname"><a href="../../df/d45/classCGeomCoastPolygon.html#afc6527b76b30e3b0205c65212db99619">CGeomCoastPolygon::pPtiGetNode</a></div><div class="ttdeci">CGeom2DIPoint * pPtiGetNode(void)</div><div class="ttdoc">Get the grid co-ordinates of the cell on which the node sits.</div><div class="ttdef"><b>Definition</b> <a href="../../df/d30/coast__polygon_8cpp_source.html#l00136">coast_polygon.cpp:136</a></div></div>
<div class="ttc" id="aclassCGeomMultiLine_html_a3516022bd96ee15709653b3bb7cc0155"><div class="ttname"><a href="../../d0/d89/classCGeomMultiLine.html#a3516022bd96ee15709653b3bb7cc0155">CGeomMultiLine::nGetNumCoincidentProfilesInLineSegment</a></div><div class="ttdeci">int nGetNumCoincidentProfilesInLineSegment(int const)</div><div class="ttdoc">Returns the count of coincident profiles in a specified line segment.</div><div class="ttdef"><b>Definition</b> <a href="../../db/d80/multi__line_8cpp_source.html#l00170">multi_line.cpp:170</a></div></div>
<div class="ttc" id="aclassCGeomMultiLine_html_a397a6f2cc166220b5342cf3444e16753"><div class="ttname"><a href="../../d0/d89/classCGeomMultiLine.html#a397a6f2cc166220b5342cf3444e16753">CGeomMultiLine::bFindProfileInCoincidentProfiles</a></div><div class="ttdeci">bool bFindProfileInCoincidentProfiles(int const)</div><div class="ttdoc">Returns true if the given profile number is one of the coincident profiles of the a specified line se...</div><div class="ttdef"><b>Definition</b> <a href="../../db/d80/multi__line_8cpp_source.html#l00206">multi_line.cpp:206</a></div></div>
<div class="ttc" id="aclassCGeomMultiLine_html_a4aef627971905a6679ea17401ad8a4d3"><div class="ttname"><a href="../../d0/d89/classCGeomMultiLine.html#a4aef627971905a6679ea17401ad8a4d3">CGeomMultiLine::nGetCoincidentProfileForLineSegment</a></div><div class="ttdeci">int nGetCoincidentProfileForLineSegment(int const, int const) const</div><div class="ttdoc">Returns the numbers of coincident profiles.</div><div class="ttdef"><b>Definition</b> <a href="../../db/d80/multi__line_8cpp_source.html#l00156">multi_line.cpp:156</a></div></div>
<div class="ttc" id="aclassCGeomMultiLine_html_a6dd16a3f527b6a681fbddd8a68e9deaf"><div class="ttname"><a href="../../d0/d89/classCGeomMultiLine.html#a6dd16a3f527b6a681fbddd8a68e9deaf">CGeomMultiLine::GetMostCoastwardSharedLineSegment</a></div><div class="ttdeci">void GetMostCoastwardSharedLineSegment(int const, int &amp;, int &amp;)</div><div class="ttdoc">Finds the number of the most coastward line segment for which the two profiles are coincident,...</div><div class="ttdef"><b>Definition</b> <a href="../../db/d80/multi__line_8cpp_source.html#l00225">multi_line.cpp:225</a></div></div>
<div class="ttc" id="aclassCGeomProfile_html"><div class="ttname"><a href="../../da/dae/classCGeomProfile.html">CGeomProfile</a></div><div class="ttdoc">Geometry class used to represent coast profile objects.</div><div class="ttdef"><b>Definition</b> <a href="../../de/d45/profile_8h_source.html#l00036">profile.h:37</a></div></div>
<div class="ttc" id="aclassCGeomProfile_html_a6d13079f744085f2d132405e0120ca54"><div class="ttname"><a href="../../da/dae/classCGeomProfile.html#a6d13079f744085f2d132405e0120ca54">CGeomProfile::pPtiGetCellInProfile</a></div><div class="ttdeci">CGeom2DIPoint * pPtiGetCellInProfile(int const)</div><div class="ttdoc">Returns a single cell in the profile.</div><div class="ttdef"><b>Definition</b> <a href="../../db/dfa/profile_8cpp_source.html#l00417">profile.cpp:417</a></div></div>
<div class="ttc" id="aclassCGeomProfile_html_a8a29c3fa364ab1f7b3930b7a9c83f45f"><div class="ttname"><a href="../../da/dae/classCGeomProfile.html#a8a29c3fa364ab1f7b3930b7a9c83f45f">CGeomProfile::nGetNumCellsInProfile</a></div><div class="ttdeci">int nGetNumCellsInProfile(void) const</div><div class="ttdoc">Returns the number of cells in the profile.</div><div class="ttdef"><b>Definition</b> <a href="../../db/dfa/profile_8cpp_source.html#l00424">profile.cpp:424</a></div></div>
<div class="ttc" id="aclassCGeomProfile_html_a8dc4e3ce21668f7149ca11aeb7efadf7"><div class="ttname"><a href="../../da/dae/classCGeomProfile.html#a8dc4e3ce21668f7149ca11aeb7efadf7">CGeomProfile::bProfileOK</a></div><div class="ttdeci">bool bProfileOK(void) const</div><div class="ttdoc">Returns true if this is a problem-free profile, and is not a start-o-coast or an end-of-coast profile...</div><div class="ttdef"><b>Definition</b> <a href="../../db/dfa/profile_8cpp_source.html#l00148">profile.cpp:148</a></div></div>
<div class="ttc" id="aclassCGeomProfile_html_aaa8ddb9c775927bdb7940f7826f90a74"><div class="ttname"><a href="../../da/dae/classCGeomProfile.html#aaa8ddb9c775927bdb7940f7826f90a74">CGeomProfile::pPtGetPointInProfile</a></div><div class="ttdeci">CGeom2DPoint * pPtGetPointInProfile(int const)</div><div class="ttdoc">Returns a single point in the profile.</div><div class="ttdef"><b>Definition</b> <a href="../../db/dfa/profile_8cpp_source.html#l00263">profile.cpp:263</a></div></div>
<div class="ttc" id="aclassCGeomProfile_html_aac223e2610d50ca2c7eadaf8542e9498"><div class="ttname"><a href="../../da/dae/classCGeomProfile.html#aac223e2610d50ca2c7eadaf8542e9498">CGeomProfile::bOKIncStartAndEndOfCoast</a></div><div class="ttdeci">bool bOKIncStartAndEndOfCoast(void) const</div><div class="ttdoc">Returns true if this is a problem-free profile (however it could still be a start-of-coast or an end-...</div><div class="ttdef"><b>Definition</b> <a href="../../db/dfa/profile_8cpp_source.html#l00164">profile.cpp:164</a></div></div>
<div class="ttc" id="aclassCGeomProfile_html_abaf88697019588a2b0901bd19044aee4"><div class="ttname"><a href="../../da/dae/classCGeomProfile.html#abaf88697019588a2b0901bd19044aee4">CGeomProfile::nGetProfileSize</a></div><div class="ttdeci">int nGetProfileSize(void) const</div><div class="ttdoc">Returns the number of points in the profile.</div><div class="ttdef"><b>Definition</b> <a href="../../db/dfa/profile_8cpp_source.html#l00257">profile.cpp:257</a></div></div>
<div class="ttc" id="aclassCGeomRasterGrid_html_a1c337248d939a7775ffca16b86e7a93b"><div class="ttname"><a href="../../d6/d3e/classCGeomRasterGrid.html#a1c337248d939a7775ffca16b86e7a93b">CGeomRasterGrid::m_Cell</a></div><div class="ttdeci">CGeomCell ** m_Cell</div><div class="ttdoc">The 2D array of m_Cell objects. A c-style 2D array seems to be faster than using 2D STL vectors.</div><div class="ttdef"><b>Definition</b> <a href="../../db/d8c/raster__grid_8h_source.html#l00058">raster_grid.h:58</a></div></div>
<div class="ttc" id="aclassCRWCellLayer_html_a30800b5cd971976ffec36381d4e54342"><div class="ttname"><a href="../../d5/d6d/classCRWCellLayer.html#a30800b5cd971976ffec36381d4e54342">CRWCellLayer::pGetConsolidatedSediment</a></div><div class="ttdeci">CRWCellSediment * pGetConsolidatedSediment(void)</div><div class="ttdoc">Returns a pointer to the cell's consolidated sediment object.</div><div class="ttdef"><b>Definition</b> <a href="../../d3/d12/cell__layer_8cpp_source.html#l00042">cell_layer.cpp:42</a></div></div>
<div class="ttc" id="aclassCRWCellLayer_html_a6ee086df697edf497ddb97fe2f4adf53"><div class="ttname"><a href="../../d5/d6d/classCRWCellLayer.html#a6ee086df697edf497ddb97fe2f4adf53">CRWCellLayer::pGetUnconsolidatedSediment</a></div><div class="ttdeci">CRWCellSediment * pGetUnconsolidatedSediment(void)</div><div class="ttdoc">Returns a pointer to the cell's unconsolidated sediment object.</div><div class="ttdef"><b>Definition</b> <a href="../../d3/d12/cell__layer_8cpp_source.html#l00036">cell_layer.cpp:36</a></div></div>
<div class="ttc" id="aclassCRWCellSediment_html_a09e7de8337de200c1cc3991914b81e32"><div class="ttname"><a href="../../d5/dc6/classCRWCellSediment.html#a09e7de8337de200c1cc3991914b81e32">CRWCellSediment::dGetSandSedimentInputDepth</a></div><div class="ttdeci">double dGetSandSedimentInputDepth(void) const</div><div class="ttdoc">Returns the this-iteration total depth of sand sediment input (m)</div><div class="ttdef"><b>Definition</b> <a href="../../db/d2b/cell__sediment_8cpp_source.html#l00230">cell_sediment.cpp:230</a></div></div>
<div class="ttc" id="aclassCRWCellSediment_html_a0e040b4dea833e47bbeb7cd285941b89"><div class="ttname"><a href="../../d5/dc6/classCRWCellSediment.html#a0e040b4dea833e47bbeb7cd285941b89">CRWCellSediment::dGetCoarseDepth</a></div><div class="ttdeci">double dGetCoarseDepth(void) const</div><div class="ttdoc">Returns the coarse sediment depth equivalent for this sediment layer object.</div><div class="ttdef"><b>Definition</b> <a href="../../db/d2b/cell__sediment_8cpp_source.html#l00128">cell_sediment.cpp:128</a></div></div>
<div class="ttc" id="aclassCRWCellSediment_html_a37bcb7fc471a15c70f71ea583c7ff8e8"><div class="ttname"><a href="../../d5/dc6/classCRWCellSediment.html#a37bcb7fc471a15c70f71ea583c7ff8e8">CRWCellSediment::dGetFineDepth</a></div><div class="ttdeci">double dGetFineDepth(void) const</div><div class="ttdoc">Returns the fine sediment depth equivalent for this sediment layer object.</div><div class="ttdef"><b>Definition</b> <a href="../../db/d2b/cell__sediment_8cpp_source.html#l00091">cell_sediment.cpp:91</a></div></div>
<div class="ttc" id="aclassCRWCellSediment_html_abdbf4ca9108505d958aa7071d4cd1bf1"><div class="ttname"><a href="../../d5/dc6/classCRWCellSediment.html#abdbf4ca9108505d958aa7071d4cd1bf1">CRWCellSediment::dGetFineSedimentInputDepth</a></div><div class="ttdeci">double dGetFineSedimentInputDepth(void) const</div><div class="ttdoc">Returns the this-iteration total depth of fine sediment input (m)</div><div class="ttdef"><b>Definition</b> <a href="../../db/d2b/cell__sediment_8cpp_source.html#l00224">cell_sediment.cpp:224</a></div></div>
<div class="ttc" id="aclassCRWCellSediment_html_abf94c4b1d346d4746c1bfaf56ea3ebc5"><div class="ttname"><a href="../../d5/dc6/classCRWCellSediment.html#abf94c4b1d346d4746c1bfaf56ea3ebc5">CRWCellSediment::dGetCoarseSedimentInputDepth</a></div><div class="ttdeci">double dGetCoarseSedimentInputDepth(void) const</div><div class="ttdoc">Returns the this-iteration total depth of coarse sediment input (m)</div><div class="ttdef"><b>Definition</b> <a href="../../db/d2b/cell__sediment_8cpp_source.html#l00236">cell_sediment.cpp:236</a></div></div>
<div class="ttc" id="aclassCRWCellSediment_html_af6a401b3101e209ad9f77270cd7f3598"><div class="ttname"><a href="../../d5/dc6/classCRWCellSediment.html#af6a401b3101e209ad9f77270cd7f3598">CRWCellSediment::dGetSandDepth</a></div><div class="ttdeci">double dGetSandDepth(void) const</div><div class="ttdoc">Returns the sand sediment depth equivalent for this sediment layer.</div><div class="ttdef"><b>Definition</b> <a href="../../db/d2b/cell__sediment_8cpp_source.html#l00110">cell_sediment.cpp:110</a></div></div>
<div class="ttc" id="aclassCSimulation_html_a1312f0ac2c93a6cb2bc41c23eb01c293"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">CSimulation::m_pRasterGrid</a></div><div class="ttdeci">CGeomRasterGrid * m_pRasterGrid</div><div class="ttdoc">Pointer to the raster grid object.</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d6a/simulation_8h_source.html#l01485">simulation.h:1485</a></div></div>
<div class="ttc" id="aclassCSimulation_html_a1652253500dab35e6f6f9f734207e20b"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#a1652253500dab35e6f6f9f734207e20b">CSimulation::m_nXGridSize</a></div><div class="ttdeci">int m_nXGridSize</div><div class="ttdoc">The size of the grid in the x direction.</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d6a/simulation_8h_source.html#l00432">simulation.h:432</a></div></div>
<div class="ttc" id="aclassCSimulation_html_a1cdb36fc97d2f40d471edc2d59734960"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#a1cdb36fc97d2f40d471edc2d59734960">CSimulation::PtiExtCRSToGridRound</a></div><div class="ttdeci">CGeom2DIPoint PtiExtCRSToGridRound(CGeom2DPoint const *) const</div><div class="ttdoc">Transforms a pointer to a CGeom2DPoint in the external CRS to the equivalent CGeom2DIPoint in the ras...</div><div class="ttdef"><b>Definition</b> <a href="../../db/df7/gis__utils_8cpp_source.html#l00128">gis_utils.cpp:128</a></div></div>
<div class="ttc" id="aclassCSimulation_html_a222962121613613a48f518e0c2110f21"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#a222962121613613a48f518e0c2110f21">CSimulation::LogStream</a></div><div class="ttdeci">ofstream LogStream</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d6a/simulation_8h_source.html#l01789">simulation.h:1789</a></div></div>
<div class="ttc" id="aclassCSimulation_html_a25ada8139c82ca7beab3f279cff83184"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#a25ada8139c82ca7beab3f279cff83184">CSimulation::m_VCoast</a></div><div class="ttdeci">vector&lt; CRWCoast &gt; m_VCoast</div><div class="ttdoc">The coastline objects.</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d6a/simulation_8h_source.html#l01488">simulation.h:1488</a></div></div>
<div class="ttc" id="aclassCSimulation_html_a3755fdc07c0ac9f2ce6c2237cfef50ce"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#a3755fdc07c0ac9f2ce6c2237cfef50ce">CSimulation::m_nYGridSize</a></div><div class="ttdeci">int m_nYGridSize</div><div class="ttdoc">The size of the grid in the y direction.</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d6a/simulation_8h_source.html#l00435">simulation.h:435</a></div></div>
<div class="ttc" id="aclassCSimulation_html_a407e01ecfd7c564c74f4474216ce2e16"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#a407e01ecfd7c564c74f4474216ce2e16">CSimulation::dGetDistanceBetween</a></div><div class="ttdeci">static double dGetDistanceBetween(CGeom2DPoint const *, CGeom2DPoint const *)</div><div class="ttdoc">Returns the distance (in external CRS) between two points.</div><div class="ttdef"><b>Definition</b> <a href="../../db/df7/gis__utils_8cpp_source.html#l00140">gis_utils.cpp:140</a></div></div>
<div class="ttc" id="aclassCSimulation_html_a41d2806566f688547f97c0d573bb1611"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#a41d2806566f688547f97c0d573bb1611">CSimulation::PtAverage</a></div><div class="ttdeci">static CGeom2DPoint PtAverage(CGeom2DPoint const *, CGeom2DPoint const *)</div><div class="ttdoc">Returns a point (external CRS) which is the average of (i.e. is midway between) two other external CR...</div><div class="ttdef"><b>Definition</b> <a href="../../db/df7/gis__utils_8cpp_source.html#l00385">gis_utils.cpp:385</a></div></div>
<div class="ttc" id="aclassCSimulation_html_a45597177a9aecb40378ed4b9632008fd"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#a45597177a9aecb40378ed4b9632008fd">CSimulation::m_dStartIterSuspFineInPolygons</a></div><div class="ttdeci">double m_dStartIterSuspFineInPolygons</div><div class="ttdoc">Depth (m) of fine suspended sediment at the start of the simulation (only cells in polygons)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d6a/simulation_8h_source.html#l00935">simulation.h:935</a></div></div>
<div class="ttc" id="aclassCSimulation_html_a736d521c8e0c2b59218e5cc4af03818c"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#a736d521c8e0c2b59218e5cc4af03818c">CSimulation::nCreateAllPolygons</a></div><div class="ttdeci">int nCreateAllPolygons(void)</div><div class="ttdoc">Create polygons, and marks the polygon boundaries on the raster grid.</div><div class="ttdef"><b>Definition</b> <a href="#l00042">create_polygons.cpp:42</a></div></div>
<div class="ttc" id="aclassCSimulation_html_a9fbe52d4e0f26ad432f12b7154c599e4"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#a9fbe52d4e0f26ad432f12b7154c599e4">CSimulation::dExtCRSXToGridX</a></div><div class="ttdeci">double dExtCRSXToGridX(double const) const</div><div class="ttdoc">Transforms an X-axis ordinate in the external CRS to the equivalent X-axis ordinate in the raster-gri...</div><div class="ttdef"><b>Definition</b> <a href="../../db/df7/gis__utils_8cpp_source.html#l00110">gis_utils.cpp:110</a></div></div>
<div class="ttc" id="aclassCSimulation_html_aa0eddb8270d03b9c1a0a6e96254ebfed"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#aa0eddb8270d03b9c1a0a6e96254ebfed">CSimulation::KeepWithinValidGrid</a></div><div class="ttdeci">void KeepWithinValidGrid(int, int, int &amp;, int &amp;) const</div><div class="ttdoc">Given two points in the grid CRS (the points assumed not to be coincident), this routine modifies the...</div><div class="ttdef"><b>Definition</b> <a href="../../db/df7/gis__utils_8cpp_source.html#l00210">gis_utils.cpp:210</a></div></div>
<div class="ttc" id="aclassCSimulation_html_ab071e8422c990d7dff462e3eab8df941"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#ab071e8422c990d7dff462e3eab8df941">CSimulation::PtFindPointInPolygon</a></div><div class="ttdeci">static CGeom2DPoint PtFindPointInPolygon(vector&lt; CGeom2DPoint &gt; const *, int const)</div><div class="ttdoc">Finds a point in a polygon: is guaranteed to succeed, as every strictly closed polygon has at least o...</div><div class="ttdef"><b>Definition</b> <a href="#l00767">create_polygons.cpp:767</a></div></div>
<div class="ttc" id="aclassCSimulation_html_ab13fd70564940a88390f06694fe4a9ad"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#ab13fd70564940a88390f06694fe4a9ad">CSimulation::PtGetPerpendicular</a></div><div class="ttdeci">static CGeom2DPoint PtGetPerpendicular(CGeom2DPoint const *, CGeom2DPoint const *, double const, int const)</div><div class="ttdoc">Returns a CGeom2DPoint which is the 'other' point of a two-point vector passing through PtStart,...</div><div class="ttdef"><b>Definition</b> <a href="../../db/df7/gis__utils_8cpp_source.html#l00557">gis_utils.cpp:557</a></div></div>
<div class="ttc" id="aclassCSimulation_html_abdc9fa851fdb5b8cc64a707f450495c1"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#abdc9fa851fdb5b8cc64a707f450495c1">CSimulation::MarkPolygonCells</a></div><div class="ttdeci">void MarkPolygonCells(void)</div><div class="ttdoc">Marks cells of the raster grid that are within each coastal polygon. The flood fill code used here is...</div><div class="ttdef"><b>Definition</b> <a href="#l00268">create_polygons.cpp:268</a></div></div>
<div class="ttc" id="aclassCSimulation_html_ac2e7e204d9e9b527d0a4c941f2e525ad"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#ac2e7e204d9e9b527d0a4c941f2e525ad">CSimulation::dExtCRSYToGridY</a></div><div class="ttdeci">double dExtCRSYToGridY(double const) const</div><div class="ttdoc">Transforms a Y-axis ordinate in the external CRS to the equivalent Y-axis ordinate in the raster-grid...</div><div class="ttdef"><b>Definition</b> <a href="../../db/df7/gis__utils_8cpp_source.html#l00119">gis_utils.cpp:119</a></div></div>
<div class="ttc" id="aclassCSimulation_html_ac900a5701df97da22278fae928951f50"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#ac900a5701df97da22278fae928951f50">CSimulation::bIsWithinValidGrid</a></div><div class="ttdeci">bool bIsWithinValidGrid(int const, int const) const</div><div class="ttdoc">Checks whether the supplied point (an x-y pair, in the grid CRS) is within the raster grid,...</div><div class="ttdef"><b>Definition</b> <a href="../../db/df7/gis__utils_8cpp_source.html#l00170">gis_utils.cpp:170</a></div></div>
<div class="ttc" id="aclassCSimulation_html_ad67e8c5b30a0572f64ecfb5c062c2edc"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#ad67e8c5b30a0572f64ecfb5c062c2edc">CSimulation::m_ulIter</a></div><div class="ttdeci">unsigned long m_ulIter</div><div class="ttdoc">The number of the current iteration (time step)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d6a/simulation_8h_source.html#l00554">simulation.h:554</a></div></div>
<div class="ttc" id="aclassCSimulation_html_ad9eb8ca8551f4b8fe0d425f554881e46"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#ad9eb8ca8551f4b8fe0d425f554881e46">CSimulation::RasterizePolygonJoiningLine</a></div><div class="ttdeci">void RasterizePolygonJoiningLine(CGeom2DPoint const *, CGeom2DPoint const *)</div><div class="ttdoc">Puts a polygon 'joining line' (the line which is the seaward boundary of the polygon,...</div><div class="ttdef"><b>Definition</b> <a href="#l00221">create_polygons.cpp:221</a></div></div>
<div class="ttc" id="aclassCSimulation_html_adca826b2787fe966fbcb03aac09f9049"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#adca826b2787fe966fbcb03aac09f9049">CSimulation::m_nGlobalPolygonID</a></div><div class="ttdeci">int m_nGlobalPolygonID</div><div class="ttdoc">Global (all coasts) polygon ID. There are m_nGlobalPolygonID + 1 polygons at any time.</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d6a/simulation_8h_source.html#l00483">simulation.h:483</a></div></div>
<div class="ttc" id="aclassCSimulation_html_ae0de69c3d3acd6d52dc2ec2f456c0eb5"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#ae0de69c3d3acd6d52dc2ec2f456c0eb5">CSimulation::m_dCellSide</a></div><div class="ttdeci">double m_dCellSide</div><div class="ttdoc">Length of a cell side (in external CRS units)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d6a/simulation_8h_source.html#l00614">simulation.h:614</a></div></div>
<div class="ttc" id="aclassCSimulation_html_af103396c763e8526e49a977ee0e04ddb"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#af103396c763e8526e49a977ee0e04ddb">CSimulation::nDoPolygonSharedBoundaries</a></div><div class="ttdeci">int nDoPolygonSharedBoundaries(void)</div><div class="ttdoc">For between-polygon potential sediment routing: find which are the adjacent polygons,...</div><div class="ttdef"><b>Definition</b> <a href="#l00515">create_polygons.cpp:515</a></div></div>
<div class="ttc" id="aclassCSimulation_html_af26b975e1c0f041d6fdaaf83065ef2c8"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#af26b975e1c0f041d6fdaaf83065ef2c8">CSimulation::bIsWithinPolygon</a></div><div class="ttdeci">static bool bIsWithinPolygon(CGeom2DPoint const *, vector&lt; CGeom2DPoint &gt; const *)</div><div class="ttdoc">Determines whether a point is within a polygon: however if the point is exactly on the edge of the po...</div><div class="ttdef"><b>Definition</b> <a href="#l00730">create_polygons.cpp:730</a></div></div>
<div class="ttc" id="aclassCSimulation_html_afdf9931c6687dab00b0f48c0709d6c8a"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#afdf9931c6687dab00b0f48c0709d6c8a">CSimulation::m_pVCoastPolygon</a></div><div class="ttdeci">vector&lt; CGeomCoastPolygon * &gt; m_pVCoastPolygon</div><div class="ttdoc">Pointers to coast polygon objects.</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d6a/simulation_8h_source.html#l01497">simulation.h:1497</a></div></div>
<div class="ttc" id="acme_8h_html"><div class="ttname"><a href="../../d6/d2a/cme_8h.html">cme.h</a></div><div class="ttdoc">This file contains global definitions for CoastalME.</div></div>
<div class="ttc" id="acme_8h_html_a01aa8b423260b337ddff2016107b51a0"><div class="ttname"><a href="../../d6/d2a/cme_8h.html#a01aa8b423260b337ddff2016107b51a0">INT_NODATA</a></div><div class="ttdeci">int const INT_NODATA</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d2a/cme_8h_source.html#l00355">cme.h:355</a></div></div>
<div class="ttc" id="acme_8h_html_a08b1623863ee3bd4300a8892de323722"><div class="ttname"><a href="../../d6/d2a/cme_8h.html#a08b1623863ee3bd4300a8892de323722">TOLERANCE</a></div><div class="ttdeci">double const TOLERANCE</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d2a/cme_8h_source.html#l00688">cme.h:688</a></div></div>
<div class="ttc" id="acme_8h_html_a292fc90846543ca4814daa9f759feb05"><div class="ttname"><a href="../../d6/d2a/cme_8h.html#a292fc90846543ca4814daa9f759feb05">ERR</a></div><div class="ttdeci">string const ERR</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d2a/cme_8h_source.html#l00765">cme.h:765</a></div></div>
<div class="ttc" id="acme_8h_html_a61afa8560a3b39c80657661a1d8f76ab"><div class="ttname"><a href="../../d6/d2a/cme_8h.html#a61afa8560a3b39c80657661a1d8f76ab">bFPIsEqual</a></div><div class="ttdeci">bool bFPIsEqual(const T d1, const T d2, const T dEpsilon)</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d2a/cme_8h_source.html#l01166">cme.h:1166</a></div></div>
<div class="ttc" id="acme_8h_html_a7e895b460cef877dec4d12ead0c74f15"><div class="ttname"><a href="../../d6/d2a/cme_8h.html#a7e895b460cef877dec4d12ead0c74f15">tMax</a></div><div class="ttdeci">T tMax(T a, T b)</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d2a/cme_8h_source.html#l01113">cme.h:1113</a></div></div>
<div class="ttc" id="acme_8h_html_aa2941c3f10e5c29aa29a01fb6f7e91a6"><div class="ttname"><a href="../../d6/d2a/cme_8h.html#aa2941c3f10e5c29aa29a01fb6f7e91a6">RTN_ERR_BAD_MULTILINE</a></div><div class="ttdeci">int const RTN_ERR_BAD_MULTILINE</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d2a/cme_8h_source.html#l00618">cme.h:618</a></div></div>
<div class="ttc" id="acme_8h_html_aa768cb14b5c6123ee95e6e4ebd9fe331"><div class="ttname"><a href="../../d6/d2a/cme_8h.html#aa768cb14b5c6123ee95e6e4ebd9fe331">RTN_OK</a></div><div class="ttdeci">int const RTN_OK</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d2a/cme_8h_source.html#l00570">cme.h:570</a></div></div>
<div class="ttc" id="acme_8h_html_ac003bdff958dca839f5d274f15786e07"><div class="ttname"><a href="../../d6/d2a/cme_8h.html#ac003bdff958dca839f5d274f15786e07">DBL_NODATA</a></div><div class="ttdeci">double const DBL_NODATA</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d2a/cme_8h_source.html#l00697">cme.h:697</a></div></div>
<div class="ttc" id="acme_8h_html_ae3b6dc50cfc97050529faa5e0bd66136"><div class="ttname"><a href="../../d6/d2a/cme_8h.html#ae3b6dc50cfc97050529faa5e0bd66136">tAbs</a></div><div class="ttdeci">T tAbs(T a)</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d2a/cme_8h_source.html#l01138">cme.h:1138</a></div></div>
<div class="ttc" id="acoast_8h_html"><div class="ttname"><a href="../../de/d65/coast_8h.html">coast.h</a></div><div class="ttdoc">Contains CRWCoast definitions.</div></div>
<div class="ttc" id="asimulation_8h_html"><div class="ttname"><a href="../../dd/d6a/simulation_8h.html">simulation.h</a></div><div class="ttdoc">Contains CSimulation definitions.</div></div>
<div class="ttc" id="autils__global_8cpp_html_a20842d0a19d0ca952c91f3e1eb175fee"><div class="ttname"><a href="../../d2/dfd/utils__global_8cpp.html#a20842d0a19d0ca952c91f3e1eb175fee">nRound</a></div><div class="ttdeci">int nRound(double const d)</div><div class="ttdoc">Version of the above that returns an int.</div><div class="ttdef"><b>Definition</b> <a href="../../d2/dfd/utils__global_8cpp_source.html#l00051">utils_global.cpp:51</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="../../d6/d91/create__polygons_8cpp.html">create_polygons.cpp</a></li>
    <li class="footer">Generated on Thu Jan 2 2025 11:25:44 for CoastalME (Coastal Modelling Environment) by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0 </li>
  </ul>
</div>
</body>
</html>
