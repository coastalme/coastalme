<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>CoastalME (Coastal Modelling Environment): create_polygons.cpp Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<script type="text/javascript" src="../../clipboard.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../cookie.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">CoastalME (Coastal Modelling Environment)
   </div>
   <div id="projectbrief">Simulates the long-term behaviour of complex coastlines</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(1); });
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('d6/d91/create__polygons_8cpp_source.html','../../'); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">create_polygons.cpp</div></div>
</div><!--header-->
<div class="contents">
<a href="../../d6/d91/create__polygons_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno">    1</span></div>
<div class="line"><a id="l00013" name="l00013"></a><span class="lineno">   13</span> </div>
<div class="line"><a id="l00014" name="l00014"></a><span class="lineno">   14</span><span class="comment">/*==============================================================================================================================</span></div>
<div class="line"><a id="l00015" name="l00015"></a><span class="lineno">   15</span><span class="comment"></span> </div>
<div class="line"><a id="l00016" name="l00016"></a><span class="lineno">   16</span><span class="comment">This file is part of CoastalME, the Coastal Modelling Environment.</span></div>
<div class="line"><a id="l00017" name="l00017"></a><span class="lineno">   17</span><span class="comment"></span> </div>
<div class="line"><a id="l00018" name="l00018"></a><span class="lineno">   18</span><span class="comment">CoastalME is free software; you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation; either version 3 of the License, or (at your option) any later version.</span></div>
<div class="line"><a id="l00019" name="l00019"></a><span class="lineno">   19</span><span class="comment"></span> </div>
<div class="line"><a id="l00020" name="l00020"></a><span class="lineno">   20</span><span class="comment">This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.</span></div>
<div class="line"><a id="l00021" name="l00021"></a><span class="lineno">   21</span><span class="comment"></span> </div>
<div class="line"><a id="l00022" name="l00022"></a><span class="lineno">   22</span><span class="comment">You should have received a copy of the GNU General Public License along with this program; if not, write to the Free Software Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.</span></div>
<div class="line"><a id="l00023" name="l00023"></a><span class="lineno">   23</span><span class="comment"></span> </div>
<div class="line"><a id="l00024" name="l00024"></a><span class="lineno">   24</span><span class="comment">==============================================================================================================================*/</span></div>
<div class="line"><a id="l00025" name="l00025"></a><span class="lineno">   25</span><span class="preprocessor">#include &lt;assert.h&gt;</span></div>
<div class="line"><a id="l00026" name="l00026"></a><span class="lineno">   26</span><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><a id="l00027" name="l00027"></a><span class="lineno">   27</span><span class="keyword">using </span>std::endl;</div>
<div class="line"><a id="l00028" name="l00028"></a><span class="lineno">   28</span> </div>
<div class="line"><a id="l00029" name="l00029"></a><span class="lineno">   29</span><span class="preprocessor">#include &lt;string&gt;</span></div>
<div class="line"><a id="l00030" name="l00030"></a><span class="lineno">   30</span><span class="keyword">using </span>std::to_string;</div>
<div class="line"><a id="l00031" name="l00031"></a><span class="lineno">   31</span> </div>
<div class="line"><a id="l00032" name="l00032"></a><span class="lineno">   32</span><span class="preprocessor">#include &lt;stack&gt;</span></div>
<div class="line"><a id="l00033" name="l00033"></a><span class="lineno">   33</span><span class="keyword">using </span>std::stack;</div>
<div class="line"><a id="l00034" name="l00034"></a><span class="lineno">   34</span> </div>
<div class="line"><a id="l00035" name="l00035"></a><span class="lineno">   35</span><span class="preprocessor">#include &lt;algorithm&gt;</span></div>
<div class="line"><a id="l00036" name="l00036"></a><span class="lineno">   36</span><span class="keyword">using </span>std::remove;</div>
<div class="line"><a id="l00037" name="l00037"></a><span class="lineno">   37</span> </div>
<div class="line"><a id="l00038" name="l00038"></a><span class="lineno">   38</span><span class="preprocessor">#include &quot;<a class="code" href="../../d6/d2a/cme_8h.html">cme.h</a>&quot;</span></div>
<div class="line"><a id="l00039" name="l00039"></a><span class="lineno">   39</span><span class="preprocessor">#include &quot;<a class="code" href="../../dd/d6a/simulation_8h.html">simulation.h</a>&quot;</span></div>
<div class="line"><a id="l00040" name="l00040"></a><span class="lineno">   40</span><span class="preprocessor">#include &quot;<a class="code" href="../../de/d65/coast_8h.html">coast.h</a>&quot;</span></div>
<div class="line"><a id="l00041" name="l00041"></a><span class="lineno">   41</span> </div>
<div class="line"><a id="l00042" name="l00042"></a><span class="lineno">   42</span><span class="comment">//===============================================================================================================================</span></div>
<div class="line"><a id="l00044" name="l00044"></a><span class="lineno">   44</span><span class="comment">//===============================================================================================================================</span></div>
<div class="foldopen" id="foldopen00045" data-start="{" data-end="}">
<div class="line"><a id="l00045" name="l00045"></a><span class="lineno"><a class="line" href="../../d1/d98/classCSimulation.html#a736d521c8e0c2b59218e5cc4af03818c">   45</a></span><span class="keywordtype">int</span> <a class="code hl_function" href="../../d1/d98/classCSimulation.html#a736d521c8e0c2b59218e5cc4af03818c">CSimulation::nCreateAllPolygons</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a id="l00046" name="l00046"></a><span class="lineno">   46</span>{</div>
<div class="line"><a id="l00047" name="l00047"></a><span class="lineno">   47</span>   <span class="comment">// Global polygon count TODO 044</span></div>
<div class="line"><a id="l00048" name="l00048"></a><span class="lineno">   48</span>   <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#ad89a4ca2ea821f9853becbbce8af52b7">m_nNumPolygonGlobal</a> = 0;</div>
<div class="line"><a id="l00049" name="l00049"></a><span class="lineno">   49</span> </div>
<div class="line"><a id="l00050" name="l00050"></a><span class="lineno">   50</span>   <span class="comment">// Do this for each coast</span></div>
<div class="line"><a id="l00051" name="l00051"></a><span class="lineno">   51</span>   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> nCoast = 0; nCoast &lt; static_cast&lt;int&gt;(<a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a25ada8139c82ca7beab3f279cff83184">m_VCoast</a>.size()); nCoast++)</div>
<div class="line"><a id="l00052" name="l00052"></a><span class="lineno">   52</span>   {</div>
<div class="line"><a id="l00053" name="l00053"></a><span class="lineno">   53</span>      <span class="keywordtype">int</span> nNode = -1;</div>
<div class="line"><a id="l00054" name="l00054"></a><span class="lineno">   54</span>      <span class="keywordtype">int</span> nNextProfile = -1;</div>
<div class="line"><a id="l00055" name="l00055"></a><span class="lineno">   55</span>      <span class="keywordtype">int</span> nPolygon = -1;</div>
<div class="line"><a id="l00056" name="l00056"></a><span class="lineno">   56</span> </div>
<div class="line"><a id="l00057" name="l00057"></a><span class="lineno">   57</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; static_cast&lt;int&gt;(<a class="code hl_variable" href="../../d1/d98/classCSimulation.html#afdf9931c6687dab00b0f48c0709d6c8a">m_pVCoastPolygon</a>.size()); i++)</div>
<div class="line"><a id="l00058" name="l00058"></a><span class="lineno">   58</span>         <span class="keyword">delete</span> <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#afdf9931c6687dab00b0f48c0709d6c8a">m_pVCoastPolygon</a>[i];</div>
<div class="line"><a id="l00059" name="l00059"></a><span class="lineno">   59</span> </div>
<div class="line"><a id="l00060" name="l00060"></a><span class="lineno">   60</span>      <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#afdf9931c6687dab00b0f48c0709d6c8a">m_pVCoastPolygon</a>.clear();</div>
<div class="line"><a id="l00061" name="l00061"></a><span class="lineno">   61</span> </div>
<div class="line"><a id="l00062" name="l00062"></a><span class="lineno">   62</span>      <span class="comment">// Do this for every point on the coastline (except the last point)</span></div>
<div class="line"><a id="l00063" name="l00063"></a><span class="lineno">   63</span>      <span class="keywordtype">int</span> nCoastSize = <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a25ada8139c82ca7beab3f279cff83184">m_VCoast</a>[nCoast].nGetCoastlineSize();</div>
<div class="line"><a id="l00064" name="l00064"></a><span class="lineno">   64</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> nCoastPoint = 0; nCoastPoint &lt; nCoastSize-1; nCoastPoint++)</div>
<div class="line"><a id="l00065" name="l00065"></a><span class="lineno">   65</span>      {</div>
<div class="line"><a id="l00066" name="l00066"></a><span class="lineno">   66</span>         <span class="keywordflow">if</span> (! <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a25ada8139c82ca7beab3f279cff83184">m_VCoast</a>[nCoast].bIsProfileAtCoastPoint(nCoastPoint))</div>
<div class="line"><a id="l00067" name="l00067"></a><span class="lineno">   67</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l00068" name="l00068"></a><span class="lineno">   68</span> </div>
<div class="line"><a id="l00069" name="l00069"></a><span class="lineno">   69</span>         <span class="comment">// OK, this coast point is the start of a coastline-normal profile</span></div>
<div class="line"><a id="l00070" name="l00070"></a><span class="lineno">   70</span>         <a class="code hl_class" href="../../da/dae/classCGeomProfile.html">CGeomProfile</a>* pThisProfile = <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a25ada8139c82ca7beab3f279cff83184">m_VCoast</a>[nCoast].pGetProfileAtCoastPoint(nCoastPoint);</div>
<div class="line"><a id="l00071" name="l00071"></a><span class="lineno">   71</span> </div>
<div class="line"><a id="l00072" name="l00072"></a><span class="lineno">   72</span>         <span class="keywordflow">if</span> (pThisProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#aac223e2610d50ca2c7eadaf8542e9498">bOKIncStartAndEndOfCoast</a>())</div>
<div class="line"><a id="l00073" name="l00073"></a><span class="lineno">   73</span>         {</div>
<div class="line"><a id="l00074" name="l00074"></a><span class="lineno">   74</span>            <span class="comment">// This profile is OK, so we will start a polygon here and extend it down-coast</span></div>
<div class="line"><a id="l00075" name="l00075"></a><span class="lineno">   75</span>            <span class="keywordtype">int</span> nThisProfile = pThisProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#aacd98f9837c3c7cf7414764b73275fba">nGetCoastID</a>();</div>
<div class="line"><a id="l00076" name="l00076"></a><span class="lineno">   76</span> </div>
<div class="line"><a id="l00077" name="l00077"></a><span class="lineno">   77</span>            <span class="comment">// This will be the coast ID number, and also the along-coast sequence, of the polygon</span></div>
<div class="line"><a id="l00078" name="l00078"></a><span class="lineno">   78</span>            nPolygon++;</div>
<div class="line"><a id="l00079" name="l00079"></a><span class="lineno">   79</span> </div>
<div class="line"><a id="l00080" name="l00080"></a><span class="lineno">   80</span>            <span class="comment">// Now get a pointer to the next (down-coast) profile</span></div>
<div class="line"><a id="l00081" name="l00081"></a><span class="lineno">   81</span>            <a class="code hl_class" href="../../da/dae/classCGeomProfile.html">CGeomProfile</a>* pNextProfile = pThisProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#a60a83e788c19cfee1f79e44253e09fca">pGetDownCoastAdjacentProfile</a>();</div>
<div class="line"><a id="l00082" name="l00082"></a><span class="lineno">   82</span> </div>
<div class="line"><a id="l00083" name="l00083"></a><span class="lineno">   83</span>            <span class="keywordtype">bool</span> bNextProfileIsOK = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00084" name="l00084"></a><span class="lineno">   84</span>            <span class="keywordflow">do</span></div>
<div class="line"><a id="l00085" name="l00085"></a><span class="lineno">   85</span>            {</div>
<div class="line"><a id="l00086" name="l00086"></a><span class="lineno">   86</span>               <span class="comment">// if (pNextProfile == NULL)       // TODO THIS GIVES CPPCHECK ERROR</span></div>
<div class="line"><a id="l00087" name="l00087"></a><span class="lineno">   87</span>               <span class="comment">// {</span></div>
<div class="line"><a id="l00088" name="l00088"></a><span class="lineno">   88</span>               <span class="comment">//    LogStream &lt;&lt; m_ulIter &lt;&lt; &quot;: nThisProfile = &quot; &lt;&lt; nThisProfile &lt;&lt; &quot; invalid down-coast adjacent profile, trying next down-coast adjacent profile&quot; &lt;&lt; endl;</span></div>
<div class="line"><a id="l00089" name="l00089"></a><span class="lineno">   89</span>               <span class="comment">//</span></div>
<div class="line"><a id="l00090" name="l00090"></a><span class="lineno">   90</span>               <span class="comment">//    // Try the next-after-next profile</span></div>
<div class="line"><a id="l00091" name="l00091"></a><span class="lineno">   91</span>               <span class="comment">//    CGeomProfile* pNextNextProfile = pNextProfile-&gt;pGetDownCoastAdjacentProfile();</span></div>
<div class="line"><a id="l00092" name="l00092"></a><span class="lineno">   92</span>               <span class="comment">//    pNextProfile = pNextNextProfile;</span></div>
<div class="line"><a id="l00093" name="l00093"></a><span class="lineno">   93</span>               <span class="comment">//    continue;</span></div>
<div class="line"><a id="l00094" name="l00094"></a><span class="lineno">   94</span>               <span class="comment">// }</span></div>
<div class="line"><a id="l00095" name="l00095"></a><span class="lineno">   95</span> </div>
<div class="line"><a id="l00096" name="l00096"></a><span class="lineno">   96</span>               <span class="comment">// Get the ID of the next (down-coast) profile</span></div>
<div class="line"><a id="l00097" name="l00097"></a><span class="lineno">   97</span>               nNextProfile = pNextProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#aacd98f9837c3c7cf7414764b73275fba">nGetCoastID</a>();</div>
<div class="line"><a id="l00098" name="l00098"></a><span class="lineno">   98</span> </div>
<div class="line"><a id="l00099" name="l00099"></a><span class="lineno">   99</span>               <span class="comment">// Is the next profile OK?</span></div>
<div class="line"><a id="l00100" name="l00100"></a><span class="lineno">  100</span>               bNextProfileIsOK = pNextProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#aac223e2610d50ca2c7eadaf8542e9498">bOKIncStartAndEndOfCoast</a>();</div>
<div class="line"><a id="l00101" name="l00101"></a><span class="lineno">  101</span>               <span class="keywordflow">if</span> (! bNextProfileIsOK)</div>
<div class="line"><a id="l00102" name="l00102"></a><span class="lineno">  102</span>               {</div>
<div class="line"><a id="l00103" name="l00103"></a><span class="lineno">  103</span>                  <span class="comment">// Nope, the next profile is not OK</span></div>
<div class="line"><a id="l00104" name="l00104"></a><span class="lineno">  104</span>                  <span class="comment">// LogStream &lt;&lt; m_ulIter &lt;&lt; &quot;: down-coast adjacent profile = &quot; &lt;&lt; nNextProfile &lt;&lt; &quot; is not OK&quot; &lt;&lt; endl;</span></div>
<div class="line"><a id="l00105" name="l00105"></a><span class="lineno">  105</span> </div>
<div class="line"><a id="l00106" name="l00106"></a><span class="lineno">  106</span>                  <span class="comment">// So try the following profile</span></div>
<div class="line"><a id="l00107" name="l00107"></a><span class="lineno">  107</span>                  <a class="code hl_class" href="../../da/dae/classCGeomProfile.html">CGeomProfile</a>* pNextNextProfile = pNextProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#a60a83e788c19cfee1f79e44253e09fca">pGetDownCoastAdjacentProfile</a>();</div>
<div class="line"><a id="l00108" name="l00108"></a><span class="lineno">  108</span>                  pNextProfile = pNextNextProfile;</div>
<div class="line"><a id="l00109" name="l00109"></a><span class="lineno">  109</span>               }</div>
<div class="line"><a id="l00110" name="l00110"></a><span class="lineno">  110</span> </div>
<div class="line"><a id="l00111" name="l00111"></a><span class="lineno">  111</span>            } <span class="keywordflow">while</span> (! bNextProfileIsOK);</div>
<div class="line"><a id="l00112" name="l00112"></a><span class="lineno">  112</span> </div>
<div class="line"><a id="l00113" name="l00113"></a><span class="lineno">  113</span>            <span class="comment">// LogStream &lt;&lt; &quot;Profile &quot; &lt;&lt; pNextProfile-&gt;nGetCoastID() &lt;&lt; &quot; is OK&quot; &lt;&lt; endl;</span></div>
<div class="line"><a id="l00114" name="l00114"></a><span class="lineno">  114</span> </div>
<div class="line"><a id="l00115" name="l00115"></a><span class="lineno">  115</span>            <span class="comment">// Get the coast point at which this next profile starts</span></div>
<div class="line"><a id="l00116" name="l00116"></a><span class="lineno">  116</span>            <span class="keywordtype">int</span> nNextProfileCoastPoint = pNextProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#a343fd2b73e3a87cf425572860e79ebd6">nGetCoastPoint</a>();</div>
<div class="line"><a id="l00117" name="l00117"></a><span class="lineno">  117</span> </div>
<div class="line"><a id="l00118" name="l00118"></a><span class="lineno">  118</span>            <span class="comment">// Calculate half the along-coast distance (in coast points) between this profile and the next (i.e. down-coast) profile</span></div>
<div class="line"><a id="l00119" name="l00119"></a><span class="lineno">  119</span>            <span class="keywordtype">int</span> nDist = (nNextProfileCoastPoint - nCoastPoint) / 2;</div>
<div class="line"><a id="l00120" name="l00120"></a><span class="lineno">  120</span> </div>
<div class="line"><a id="l00121" name="l00121"></a><span class="lineno">  121</span>            <span class="comment">// OK, set the node point in the coast object. We do this now, instead of earlier on, since some profiles (i.e. polygon boundaries) may have been marked as invalid</span></div>
<div class="line"><a id="l00122" name="l00122"></a><span class="lineno">  122</span>            <span class="keywordtype">int</span> nNodePoint = nCoastPoint + nDist;</div>
<div class="line"><a id="l00123" name="l00123"></a><span class="lineno">  123</span>            <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a25ada8139c82ca7beab3f279cff83184">m_VCoast</a>[nCoast].SetPolygonNode(nNodePoint, ++nNode);</div>
<div class="line"><a id="l00124" name="l00124"></a><span class="lineno">  124</span> </div>
<div class="line"><a id="l00125" name="l00125"></a><span class="lineno">  125</span>            <span class="comment">// Get the grid CRS coordinates of the coast node</span></div>
<div class="line"><a id="l00126" name="l00126"></a><span class="lineno">  126</span>            <a class="code hl_class" href="../../d6/d0d/classCGeom2DIPoint.html">CGeom2DIPoint</a> PtiNode = *<a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a25ada8139c82ca7beab3f279cff83184">m_VCoast</a>[nCoast].pPtiGetCellMarkedAsCoastline(nNodePoint);</div>
<div class="line"><a id="l00127" name="l00127"></a><span class="lineno">  127</span> </div>
<div class="line"><a id="l00128" name="l00128"></a><span class="lineno">  128</span>            <span class="comment">// Get some defaults (assuming for now that this polygon is not approximately triangular i.e. both normals do not meet)</span></div>
<div class="line"><a id="l00129" name="l00129"></a><span class="lineno">  129</span>            <span class="keywordtype">int</span> nNextProfileEnd = pNextProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#abaf88697019588a2b0901bd19044aee4">nGetProfileSize</a>()-1;</div>
<div class="line"><a id="l00130" name="l00130"></a><span class="lineno">  130</span>            <span class="keywordtype">int</span> nThisProfileEnd = pThisProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#abaf88697019588a2b0901bd19044aee4">nGetProfileSize</a>()-1;</div>
<div class="line"><a id="l00131" name="l00131"></a><span class="lineno">  131</span>            <span class="keywordtype">bool</span> bMeetsAtAPoint = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00132" name="l00132"></a><span class="lineno">  132</span>            <a class="code hl_class" href="../../d5/d4e/classCGeom2DPoint.html">CGeom2DPoint</a> PtCoastwardTip;</div>
<div class="line"><a id="l00133" name="l00133"></a><span class="lineno">  133</span> </div>
<div class="line"><a id="l00134" name="l00134"></a><span class="lineno">  134</span><span class="comment">//                // DEBUG CODE =============================================================================================</span></div>
<div class="line"><a id="l00135" name="l00135"></a><span class="lineno">  135</span><span class="comment">//                CGeom2DPoint PtNextEndTmp = *pNextProfile-&gt;pPtGetPointInProfile(nNextProfileEnd);</span></div>
<div class="line"><a id="l00136" name="l00136"></a><span class="lineno">  136</span><span class="comment">//                double dXTmp = dExtCRSXToGridX(PtNextEndTmp.dGetX());</span></div>
<div class="line"><a id="l00137" name="l00137"></a><span class="lineno">  137</span><span class="comment">//                double dYTmp = dExtCRSYToGridY(PtNextEndTmp.dGetY());</span></div>
<div class="line"><a id="l00138" name="l00138"></a><span class="lineno">  138</span><span class="comment">//                assert(bIsWithinValidGrid(dXTmp, dYTmp));</span></div>
<div class="line"><a id="l00139" name="l00139"></a><span class="lineno">  139</span><span class="comment">//</span></div>
<div class="line"><a id="l00140" name="l00140"></a><span class="lineno">  140</span><span class="comment">//                CGeom2DPoint PtThisEndTmp = *pThisProfile-&gt;pPtGetPointInProfile(nThisProfileEnd);</span></div>
<div class="line"><a id="l00141" name="l00141"></a><span class="lineno">  141</span><span class="comment">//                dXTmp = dExtCRSXToGridX(PtThisEndTmp.dGetX());</span></div>
<div class="line"><a id="l00142" name="l00142"></a><span class="lineno">  142</span><span class="comment">//                dYTmp = dExtCRSYToGridY(PtThisEndTmp.dGetY());</span></div>
<div class="line"><a id="l00143" name="l00143"></a><span class="lineno">  143</span><span class="comment">//                assert(bIsWithinValidGrid(dXTmp, dYTmp));</span></div>
<div class="line"><a id="l00144" name="l00144"></a><span class="lineno">  144</span><span class="comment">//                // DEBUG CODE =============================================================================================</span></div>
<div class="line"><a id="l00145" name="l00145"></a><span class="lineno">  145</span> </div>
<div class="line"><a id="l00146" name="l00146"></a><span class="lineno">  146</span>            <span class="comment">// Now check to see if the two normals do meet i.e. if they are coincident</span></div>
<div class="line"><a id="l00147" name="l00147"></a><span class="lineno">  147</span>            <span class="keywordflow">if</span> (pThisProfile-&gt;<a class="code hl_function" href="../../d0/d89/classCGeomMultiLine.html#a397a6f2cc166220b5342cf3444e16753">bFindProfileInCoincidentProfiles</a>(nNextProfile))</div>
<div class="line"><a id="l00148" name="l00148"></a><span class="lineno">  148</span>            {</div>
<div class="line"><a id="l00149" name="l00149"></a><span class="lineno">  149</span>               <span class="comment">// Yes they do meet</span></div>
<div class="line"><a id="l00150" name="l00150"></a><span class="lineno">  150</span>               bMeetsAtAPoint = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00151" name="l00151"></a><span class="lineno">  151</span> </div>
<div class="line"><a id="l00152" name="l00152"></a><span class="lineno">  152</span>               <span class="comment">// Find the most coastward point at which this normal and the previous normal touch. If they do not touch, the polygon requires a &#39;joining line&#39;</span></div>
<div class="line"><a id="l00153" name="l00153"></a><span class="lineno">  153</span>               pThisProfile-&gt;<a class="code hl_function" href="../../d0/d89/classCGeomMultiLine.html#a6dd16a3f527b6a681fbddd8a68e9deaf">GetMostCoastwardSharedLineSegment</a>(nNextProfile, nThisProfileEnd, nNextProfileEnd);</div>
<div class="line"><a id="l00154" name="l00154"></a><span class="lineno">  154</span>               <span class="keywordflow">if</span> (nThisProfileEnd == -1)</div>
<div class="line"><a id="l00155" name="l00155"></a><span class="lineno">  155</span>               {</div>
<div class="line"><a id="l00156" name="l00156"></a><span class="lineno">  156</span>                  <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a222962121613613a48f518e0c2110f21">LogStream</a> &lt;&lt; <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#ad67e8c5b30a0572f64ecfb5c062c2edc">m_ulIter</a> &lt;&lt; <span class="stringliteral">&quot;: &quot;</span> &lt;&lt; <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#a292fc90846543ca4814daa9f759feb05">ERR</a> &lt;&lt; <span class="stringliteral">&quot;profile &quot;</span> &lt;&lt; nNextProfile &lt;&lt; <span class="stringliteral">&quot; should be coincident with profile &quot;</span> &lt;&lt; nThisProfile &lt;&lt; <span class="stringliteral">&quot; but was not found&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a id="l00157" name="l00157"></a><span class="lineno">  157</span>                  <span class="keywordflow">return</span> <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#aa2941c3f10e5c29aa29a01fb6f7e91a6">RTN_ERR_BAD_MULTILINE</a>;</div>
<div class="line"><a id="l00158" name="l00158"></a><span class="lineno">  158</span>               }</div>
<div class="line"><a id="l00159" name="l00159"></a><span class="lineno">  159</span> </div>
<div class="line"><a id="l00160" name="l00160"></a><span class="lineno">  160</span>               PtCoastwardTip = *pThisProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#aaa8ddb9c775927bdb7940f7826f90a74">pPtGetPointInProfile</a>(nThisProfileEnd);</div>
<div class="line"><a id="l00161" name="l00161"></a><span class="lineno">  161</span>            }</div>
<div class="line"><a id="l00162" name="l00162"></a><span class="lineno">  162</span> </div>
<div class="line"><a id="l00163" name="l00163"></a><span class="lineno">  163</span>            <span class="comment">// Create the vector in which to store the polygon&#39;s boundary (external CRS). Note that these points are not in sequence</span></div>
<div class="line"><a id="l00164" name="l00164"></a><span class="lineno">  164</span>            vector&lt;CGeom2DPoint&gt; PtVBoundary;</div>
<div class="line"><a id="l00165" name="l00165"></a><span class="lineno">  165</span> </div>
<div class="line"><a id="l00166" name="l00166"></a><span class="lineno">  166</span>            <span class="comment">// Start appending points: begin by appending the points in this normal, in reverse order</span></div>
<div class="line"><a id="l00167" name="l00167"></a><span class="lineno">  167</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = nThisProfileEnd; i &gt;= 0; i--)</div>
<div class="line"><a id="l00168" name="l00168"></a><span class="lineno">  168</span>            {</div>
<div class="line"><a id="l00169" name="l00169"></a><span class="lineno">  169</span>               <a class="code hl_class" href="../../d5/d4e/classCGeom2DPoint.html">CGeom2DPoint</a> PtThis = *pThisProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#aaa8ddb9c775927bdb7940f7826f90a74">pPtGetPointInProfile</a>(i);</div>
<div class="line"><a id="l00170" name="l00170"></a><span class="lineno">  170</span>               PtVBoundary.push_back(PtThis);</div>
<div class="line"><a id="l00171" name="l00171"></a><span class="lineno">  171</span>            }</div>
<div class="line"><a id="l00172" name="l00172"></a><span class="lineno">  172</span> </div>
<div class="line"><a id="l00173" name="l00173"></a><span class="lineno">  173</span>            <span class="comment">// Next add coast points: from the start point of this normal, moving down-coast as far as the down-coast norma</span></div>
<div class="line"><a id="l00174" name="l00174"></a><span class="lineno">  174</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = nCoastPoint; i &lt;= nNextProfileCoastPoint; i++)</div>
<div class="line"><a id="l00175" name="l00175"></a><span class="lineno">  175</span>            {</div>
<div class="line"><a id="l00176" name="l00176"></a><span class="lineno">  176</span>               <a class="code hl_class" href="../../d5/d4e/classCGeom2DPoint.html">CGeom2DPoint</a> PtThis = *<a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a25ada8139c82ca7beab3f279cff83184">m_VCoast</a>[nCoast].pPtGetCoastlinePointExtCRS(i);</div>
<div class="line"><a id="l00177" name="l00177"></a><span class="lineno">  177</span>               PtVBoundary.push_back(PtThis);</div>
<div class="line"><a id="l00178" name="l00178"></a><span class="lineno">  178</span>            }</div>
<div class="line"><a id="l00179" name="l00179"></a><span class="lineno">  179</span> </div>
<div class="line"><a id="l00180" name="l00180"></a><span class="lineno">  180</span>            <span class="comment">// Append the points in the down-coast (next) normal</span></div>
<div class="line"><a id="l00181" name="l00181"></a><span class="lineno">  181</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= nNextProfileEnd; i++)</div>
<div class="line"><a id="l00182" name="l00182"></a><span class="lineno">  182</span>            {</div>
<div class="line"><a id="l00183" name="l00183"></a><span class="lineno">  183</span>               <a class="code hl_class" href="../../d5/d4e/classCGeom2DPoint.html">CGeom2DPoint</a> PtThis = *pNextProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#aaa8ddb9c775927bdb7940f7826f90a74">pPtGetPointInProfile</a>(i);</div>
<div class="line"><a id="l00184" name="l00184"></a><span class="lineno">  184</span>               PtVBoundary.push_back(PtThis);</div>
<div class="line"><a id="l00185" name="l00185"></a><span class="lineno">  185</span>            }</div>
<div class="line"><a id="l00186" name="l00186"></a><span class="lineno">  186</span> </div>
<div class="line"><a id="l00187" name="l00187"></a><span class="lineno">  187</span>            <span class="comment">// Finally, append the end point of this normal</span></div>
<div class="line"><a id="l00188" name="l00188"></a><span class="lineno">  188</span>            <a class="code hl_class" href="../../d5/d4e/classCGeom2DPoint.html">CGeom2DPoint</a> PtThis = *pThisProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#aaa8ddb9c775927bdb7940f7826f90a74">pPtGetPointInProfile</a>(nThisProfileEnd);</div>
<div class="line"><a id="l00189" name="l00189"></a><span class="lineno">  189</span>            PtVBoundary.push_back(PtThis);</div>
<div class="line"><a id="l00190" name="l00190"></a><span class="lineno">  190</span> </div>
<div class="line"><a id="l00191" name="l00191"></a><span class="lineno">  191</span>            <span class="comment">// Now identify the &#39;anti-node&#39;, this is the seaward point &#39;opposite&#39; the polygon&#39;s coastal node</span></div>
<div class="line"><a id="l00192" name="l00192"></a><span class="lineno">  192</span>            <a class="code hl_class" href="../../d6/d0d/classCGeom2DIPoint.html">CGeom2DIPoint</a> PtiAntiNode;</div>
<div class="line"><a id="l00193" name="l00193"></a><span class="lineno">  193</span>            <span class="keywordflow">if</span> (bMeetsAtAPoint)</div>
<div class="line"><a id="l00194" name="l00194"></a><span class="lineno">  194</span>               PtiAntiNode = <a class="code hl_function" href="../../d1/d98/classCSimulation.html#a1cdb36fc97d2f40d471edc2d59734960">PtiExtCRSToGridRound</a>(&amp;PtCoastwardTip);</div>
<div class="line"><a id="l00195" name="l00195"></a><span class="lineno">  195</span>            <span class="keywordflow">else</span></div>
<div class="line"><a id="l00196" name="l00196"></a><span class="lineno">  196</span>            {</div>
<div class="line"><a id="l00197" name="l00197"></a><span class="lineno">  197</span>               <a class="code hl_class" href="../../d5/d4e/classCGeom2DPoint.html">CGeom2DPoint</a> PtAvg = <a class="code hl_function" href="../../d1/d98/classCSimulation.html#a41d2806566f688547f97c0d573bb1611">PtAverage</a>(pThisProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#aaa8ddb9c775927bdb7940f7826f90a74">pPtGetPointInProfile</a>(nThisProfileEnd), pNextProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#aaa8ddb9c775927bdb7940f7826f90a74">pPtGetPointInProfile</a>(nNextProfileEnd));</div>
<div class="line"><a id="l00198" name="l00198"></a><span class="lineno">  198</span>               PtiAntiNode = <a class="code hl_function" href="../../d1/d98/classCSimulation.html#a1cdb36fc97d2f40d471edc2d59734960">PtiExtCRSToGridRound</a>(&amp;PtAvg);</div>
<div class="line"><a id="l00199" name="l00199"></a><span class="lineno">  199</span>            }</div>
<div class="line"><a id="l00200" name="l00200"></a><span class="lineno">  200</span> </div>
<div class="line"><a id="l00201" name="l00201"></a><span class="lineno">  201</span>            <span class="comment">// Is this a start-of-coast or an end-of-coast polygon?</span></div>
<div class="line"><a id="l00202" name="l00202"></a><span class="lineno">  202</span>            <span class="keywordtype">bool</span> bStartCoast = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00203" name="l00203"></a><span class="lineno">  203</span>            <span class="keywordtype">bool</span> bEndCoast = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00204" name="l00204"></a><span class="lineno">  204</span>            <span class="keywordflow">if</span> (pThisProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#ac591314b290b032ffc8a70d22df64ec0">bStartOfCoast</a>())</div>
<div class="line"><a id="l00205" name="l00205"></a><span class="lineno">  205</span>               bStartCoast = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00206" name="l00206"></a><span class="lineno">  206</span>            <span class="keywordflow">if</span> (pNextProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#aec35bc03fc47a65349def96364c99bbd">bEndOfCoast</a>())</div>
<div class="line"><a id="l00207" name="l00207"></a><span class="lineno">  207</span>               bEndCoast = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00208" name="l00208"></a><span class="lineno">  208</span> </div>
<div class="line"><a id="l00209" name="l00209"></a><span class="lineno">  209</span>            <span class="comment">// Create the coast polygon object and get a pointer to it. TODO 044 the first parameter (global ID) will need to change when considering multiple coasts</span></div>
<div class="line"><a id="l00210" name="l00210"></a><span class="lineno">  210</span>            <a class="code hl_class" href="../../df/d45/classCGeomCoastPolygon.html">CGeomCoastPolygon</a>* pPolygon = <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a25ada8139c82ca7beab3f279cff83184">m_VCoast</a>[nCoast].pPolyCreatePolygon(nThisProfile, nPolygon, nNodePoint, &amp;PtiNode, &amp;PtiAntiNode, nThisProfile, nNextProfile, &amp;PtVBoundary, nThisProfileEnd+1, nNextProfileEnd+1, bStartCoast, bEndCoast);</div>
<div class="line"><a id="l00211" name="l00211"></a><span class="lineno">  211</span> </div>
<div class="line"><a id="l00212" name="l00212"></a><span class="lineno">  212</span>            <span class="comment">// And store this pointer for simulation-wide access, in along-coast sequence</span></div>
<div class="line"><a id="l00213" name="l00213"></a><span class="lineno">  213</span>            <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#afdf9931c6687dab00b0f48c0709d6c8a">m_pVCoastPolygon</a>.push_back(pPolygon);</div>
<div class="line"><a id="l00214" name="l00214"></a><span class="lineno">  214</span> </div>
<div class="line"><a id="l00215" name="l00215"></a><span class="lineno">  215</span>            <span class="comment">// Save the profile-end vertices (but omit the last one if the profiles meet at a point)</span></div>
<div class="line"><a id="l00216" name="l00216"></a><span class="lineno">  216</span>            pPolygon-&gt;<a class="code hl_function" href="../../df/d45/classCGeomCoastPolygon.html#ac3bc44b934d49de03631ea8ae2bdec0a">AppendVertex</a>(pThisProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#abe0557d3f6bd86e02facefb28b9fab41">pPtiGetStartPoint</a>());</div>
<div class="line"><a id="l00217" name="l00217"></a><span class="lineno">  217</span>            pPolygon-&gt;<a class="code hl_function" href="../../df/d45/classCGeomCoastPolygon.html#ac3bc44b934d49de03631ea8ae2bdec0a">AppendVertex</a>(pThisProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#aa6179cf07ded38813693a9c783149c62">pPtiGetEndPoint</a>());</div>
<div class="line"><a id="l00218" name="l00218"></a><span class="lineno">  218</span>            pPolygon-&gt;<a class="code hl_function" href="../../df/d45/classCGeomCoastPolygon.html#ac3bc44b934d49de03631ea8ae2bdec0a">AppendVertex</a>(pNextProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#abe0557d3f6bd86e02facefb28b9fab41">pPtiGetStartPoint</a>());</div>
<div class="line"><a id="l00219" name="l00219"></a><span class="lineno">  219</span>            <span class="keywordflow">if</span> (! bMeetsAtAPoint)</div>
<div class="line"><a id="l00220" name="l00220"></a><span class="lineno">  220</span>               pPolygon-&gt;<a class="code hl_function" href="../../df/d45/classCGeomCoastPolygon.html#ac3bc44b934d49de03631ea8ae2bdec0a">AppendVertex</a>(pNextProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#aa6179cf07ded38813693a9c783149c62">pPtiGetEndPoint</a>());</div>
<div class="line"><a id="l00221" name="l00221"></a><span class="lineno">  221</span> </div>
<div class="line"><a id="l00222" name="l00222"></a><span class="lineno">  222</span>            <span class="comment">// // DEBUG CODE =================================================================================</span></div>
<div class="line"><a id="l00223" name="l00223"></a><span class="lineno">  223</span>            <span class="comment">// LogStream &lt;&lt; m_ulIter &lt;&lt; &quot;: vertices for polygon = &quot; &lt;&lt; nPolygon &lt;&lt; &quot; (m_nNumPolygonGlobal = &quot; &lt;&lt; m_nNumPolygonGlobal &lt;&lt; &quot;)&quot; &lt;&lt; endl;</span></div>
<div class="line"><a id="l00224" name="l00224"></a><span class="lineno">  224</span>            <span class="comment">// for (int n = 0; n &lt; pPolygon-&gt;nGetNumVertices(); n++)</span></div>
<div class="line"><a id="l00225" name="l00225"></a><span class="lineno">  225</span>            <span class="comment">//    LogStream &lt;&lt; &quot;[&quot; &lt;&lt; pPolygon-&gt;PtiGetVertex(n).nGetX() &lt;&lt; &quot;][&quot; &lt;&lt; pPolygon-&gt;PtiGetVertex(n).nGetY() &lt;&lt; &quot;]\t&quot;;</span></div>
<div class="line"><a id="l00226" name="l00226"></a><span class="lineno">  226</span>            <span class="comment">// LogStream &lt;&lt; endl;</span></div>
<div class="line"><a id="l00227" name="l00227"></a><span class="lineno">  227</span>            <span class="comment">// // DEBUG CODE =================================================================================</span></div>
<div class="line"><a id="l00228" name="l00228"></a><span class="lineno">  228</span> </div>
<div class="line"><a id="l00229" name="l00229"></a><span class="lineno">  229</span>            <span class="comment">// Now rasterize the polygon boundaries: first, the coastline. This is necessary so that sand/coarse sediment derived from platform erosion of the coast cells is correctly added to the containing polygon&#39;s unconsolidated sediment</span></div>
<div class="line"><a id="l00230" name="l00230"></a><span class="lineno">  230</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = nCoastPoint; i &lt;= nNextProfileCoastPoint; i++)</div>
<div class="line"><a id="l00231" name="l00231"></a><span class="lineno">  231</span>            {</div>
<div class="line"><a id="l00232" name="l00232"></a><span class="lineno">  232</span>               <a class="code hl_class" href="../../d6/d0d/classCGeom2DIPoint.html">CGeom2DIPoint</a> PtiToMark = *<a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a25ada8139c82ca7beab3f279cff83184">m_VCoast</a>[nCoast].pPtiGetCellMarkedAsCoastline(i);</div>
<div class="line"><a id="l00233" name="l00233"></a><span class="lineno">  233</span>               <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[PtiToMark.<a class="code hl_function" href="../../d6/d0d/classCGeom2DIPoint.html#af84c687b2d0be01ab41cbcc0565f4f3f">nGetX</a>()][PtiToMark.<a class="code hl_function" href="../../d6/d0d/classCGeom2DIPoint.html#a4d9c20bcca90dcb9d519b664aba09cbd">nGetY</a>()].SetPolygonID(nPolygon);</div>
<div class="line"><a id="l00234" name="l00234"></a><span class="lineno">  234</span>            }</div>
<div class="line"><a id="l00235" name="l00235"></a><span class="lineno">  235</span> </div>
<div class="line"><a id="l00236" name="l00236"></a><span class="lineno">  236</span>            <span class="comment">// Do the down-coast normal profile (does the whole length, including any shared line segments. So some cells are marked twice, however this is not a problem)</span></div>
<div class="line"><a id="l00237" name="l00237"></a><span class="lineno">  237</span>            <span class="keywordtype">int</span> nCellsInProfile = pNextProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#a8a29c3fa364ab1f7b3930b7a9c83f45f">nGetNumCellsInProfile</a>();</div>
<div class="line"><a id="l00238" name="l00238"></a><span class="lineno">  238</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nCellsInProfile; i++)</div>
<div class="line"><a id="l00239" name="l00239"></a><span class="lineno">  239</span>            {</div>
<div class="line"><a id="l00240" name="l00240"></a><span class="lineno">  240</span>               <a class="code hl_class" href="../../d6/d0d/classCGeom2DIPoint.html">CGeom2DIPoint</a> PtiToMark = *pNextProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#a6d13079f744085f2d132405e0120ca54">pPtiGetCellInProfile</a>(i);</div>
<div class="line"><a id="l00241" name="l00241"></a><span class="lineno">  241</span>               <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[PtiToMark.<a class="code hl_function" href="../../d6/d0d/classCGeom2DIPoint.html#af84c687b2d0be01ab41cbcc0565f4f3f">nGetX</a>()][PtiToMark.<a class="code hl_function" href="../../d6/d0d/classCGeom2DIPoint.html#a4d9c20bcca90dcb9d519b664aba09cbd">nGetY</a>()].SetPolygonID(nPolygon);</div>
<div class="line"><a id="l00242" name="l00242"></a><span class="lineno">  242</span>            }</div>
<div class="line"><a id="l00243" name="l00243"></a><span class="lineno">  243</span> </div>
<div class="line"><a id="l00244" name="l00244"></a><span class="lineno">  244</span>            <span class="comment">// Do this normal profile (again does the whole length, including any shared line segments)</span></div>
<div class="line"><a id="l00245" name="l00245"></a><span class="lineno">  245</span>            nCellsInProfile = pThisProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#a8a29c3fa364ab1f7b3930b7a9c83f45f">nGetNumCellsInProfile</a>();</div>
<div class="line"><a id="l00246" name="l00246"></a><span class="lineno">  246</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nCellsInProfile; i++)</div>
<div class="line"><a id="l00247" name="l00247"></a><span class="lineno">  247</span>            {</div>
<div class="line"><a id="l00248" name="l00248"></a><span class="lineno">  248</span>               <a class="code hl_class" href="../../d6/d0d/classCGeom2DIPoint.html">CGeom2DIPoint</a> PtiToMark = *pThisProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#a6d13079f744085f2d132405e0120ca54">pPtiGetCellInProfile</a>(i);</div>
<div class="line"><a id="l00249" name="l00249"></a><span class="lineno">  249</span>               <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[PtiToMark.<a class="code hl_function" href="../../d6/d0d/classCGeom2DIPoint.html#af84c687b2d0be01ab41cbcc0565f4f3f">nGetX</a>()][PtiToMark.<a class="code hl_function" href="../../d6/d0d/classCGeom2DIPoint.html#a4d9c20bcca90dcb9d519b664aba09cbd">nGetY</a>()].SetPolygonID(nPolygon);</div>
<div class="line"><a id="l00250" name="l00250"></a><span class="lineno">  250</span>            }</div>
<div class="line"><a id="l00251" name="l00251"></a><span class="lineno">  251</span> </div>
<div class="line"><a id="l00252" name="l00252"></a><span class="lineno">  252</span>            <span class="comment">// If the polygon doesn&#39;t meet at a point at its seaward end, also need to rasterize the &#39;joining line&#39;</span></div>
<div class="line"><a id="l00253" name="l00253"></a><span class="lineno">  253</span>            <span class="keywordflow">if</span> (! bMeetsAtAPoint)</div>
<div class="line"><a id="l00254" name="l00254"></a><span class="lineno">  254</span>            {</div>
<div class="line"><a id="l00255" name="l00255"></a><span class="lineno">  255</span>               <a class="code hl_class" href="../../d6/d0d/classCGeom2DIPoint.html">CGeom2DIPoint</a> PtiDownCoastNormalEnd = *pNextProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#aa6179cf07ded38813693a9c783149c62">pPtiGetEndPoint</a>();       <span class="comment">// Grid CRS</span></div>
<div class="line"><a id="l00256" name="l00256"></a><span class="lineno">  256</span>               <a class="code hl_class" href="../../d6/d0d/classCGeom2DIPoint.html">CGeom2DIPoint</a> PtiUpCoastNormalEnd = *pThisProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#aa6179cf07ded38813693a9c783149c62">pPtiGetEndPoint</a>();         <span class="comment">// Grid CRS</span></div>
<div class="line"><a id="l00257" name="l00257"></a><span class="lineno">  257</span> </div>
<div class="line"><a id="l00258" name="l00258"></a><span class="lineno">  258</span>               <a class="code hl_function" href="../../d1/d98/classCSimulation.html#ab743d5627b1b3d7b9dd95e7110f29715">RasterizePolygonJoiningLine</a>(&amp;PtiUpCoastNormalEnd, &amp;PtiDownCoastNormalEnd, nPolygon);</div>
<div class="line"><a id="l00259" name="l00259"></a><span class="lineno">  259</span> </div>
<div class="line"><a id="l00260" name="l00260"></a><span class="lineno">  260</span><span class="comment">//                   pPolygon-&gt;SetNotPointed();</span></div>
<div class="line"><a id="l00261" name="l00261"></a><span class="lineno">  261</span>            }</div>
<div class="line"><a id="l00262" name="l00262"></a><span class="lineno">  262</span><span class="comment">//            }</span></div>
<div class="line"><a id="l00263" name="l00263"></a><span class="lineno">  263</span> </div>
<div class="line"><a id="l00264" name="l00264"></a><span class="lineno">  264</span>            nNextProfile = nThisProfile;</div>
<div class="line"><a id="l00265" name="l00265"></a><span class="lineno">  265</span>            nCoastPoint = nNextProfileCoastPoint-1;</div>
<div class="line"><a id="l00266" name="l00266"></a><span class="lineno">  266</span> </div>
<div class="line"><a id="l00267" name="l00267"></a><span class="lineno">  267</span>            <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#ad89a4ca2ea821f9853becbbce8af52b7">m_nNumPolygonGlobal</a>++;</div>
<div class="line"><a id="l00268" name="l00268"></a><span class="lineno">  268</span> </div>
<div class="line"><a id="l00269" name="l00269"></a><span class="lineno">  269</span>            <span class="keywordflow">if</span> (bEndCoast)</div>
<div class="line"><a id="l00270" name="l00270"></a><span class="lineno">  270</span>               <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00271" name="l00271"></a><span class="lineno">  271</span>         }</div>
<div class="line"><a id="l00272" name="l00272"></a><span class="lineno">  272</span>      }</div>
<div class="line"><a id="l00273" name="l00273"></a><span class="lineno">  273</span>   }</div>
<div class="line"><a id="l00274" name="l00274"></a><span class="lineno">  274</span> </div>
<div class="line"><a id="l00275" name="l00275"></a><span class="lineno">  275</span>   <span class="comment">// // DEBUG CODE =================================================================================</span></div>
<div class="line"><a id="l00276" name="l00276"></a><span class="lineno">  276</span>   <span class="comment">// int nNumUnusedPolygonCells = 0;</span></div>
<div class="line"><a id="l00277" name="l00277"></a><span class="lineno">  277</span>   <span class="comment">// int nNum23 = 0;</span></div>
<div class="line"><a id="l00278" name="l00278"></a><span class="lineno">  278</span>   <span class="comment">// int nNum24 = 0;</span></div>
<div class="line"><a id="l00279" name="l00279"></a><span class="lineno">  279</span>   <span class="comment">// for (int nY = 0; nY &lt; m_nYGridSize; nY++)</span></div>
<div class="line"><a id="l00280" name="l00280"></a><span class="lineno">  280</span>   <span class="comment">// {</span></div>
<div class="line"><a id="l00281" name="l00281"></a><span class="lineno">  281</span>   <span class="comment">//    for (int nX = 0; nX &lt; m_nXGridSize; nX++)</span></div>
<div class="line"><a id="l00282" name="l00282"></a><span class="lineno">  282</span>   <span class="comment">//    {</span></div>
<div class="line"><a id="l00283" name="l00283"></a><span class="lineno">  283</span>   <span class="comment">//       if (m_pRasterGrid-&gt;m_Cell[nX][nY].nGetPolygonID() == nUnusedPolygon)</span></div>
<div class="line"><a id="l00284" name="l00284"></a><span class="lineno">  284</span>   <span class="comment">//          nNumUnusedPolygonCells++;</span></div>
<div class="line"><a id="l00285" name="l00285"></a><span class="lineno">  285</span>   <span class="comment">//</span></div>
<div class="line"><a id="l00286" name="l00286"></a><span class="lineno">  286</span>   <span class="comment">//       if (m_pRasterGrid-&gt;m_Cell[nX][nY].nGetPolygonID() == 23)</span></div>
<div class="line"><a id="l00287" name="l00287"></a><span class="lineno">  287</span>   <span class="comment">//          nNum23++;</span></div>
<div class="line"><a id="l00288" name="l00288"></a><span class="lineno">  288</span>   <span class="comment">//</span></div>
<div class="line"><a id="l00289" name="l00289"></a><span class="lineno">  289</span>   <span class="comment">//       if (m_pRasterGrid-&gt;m_Cell[nX][nY].nGetPolygonID() == 24)</span></div>
<div class="line"><a id="l00290" name="l00290"></a><span class="lineno">  290</span>   <span class="comment">//          nNum24++;</span></div>
<div class="line"><a id="l00291" name="l00291"></a><span class="lineno">  291</span>   <span class="comment">//    }</span></div>
<div class="line"><a id="l00292" name="l00292"></a><span class="lineno">  292</span>   <span class="comment">// }</span></div>
<div class="line"><a id="l00293" name="l00293"></a><span class="lineno">  293</span>   <span class="comment">//</span></div>
<div class="line"><a id="l00294" name="l00294"></a><span class="lineno">  294</span>   <span class="comment">// LogStream &lt;&lt; m_ulIter &lt;&lt; &quot;: BEFORE CELL RE-NUMBERING&quot; &lt;&lt; endl;</span></div>
<div class="line"><a id="l00295" name="l00295"></a><span class="lineno">  295</span>   <span class="comment">// LogStream &lt;&lt; m_ulIter &lt;&lt; &quot;: &quot; &lt;&lt; nNumUnusedPolygonCells &lt;&lt; &quot; cells marked as unused profile &quot; &lt;&lt; nUnusedPolygon &lt;&lt; endl;</span></div>
<div class="line"><a id="l00296" name="l00296"></a><span class="lineno">  296</span>   <span class="comment">// LogStream &lt;&lt; m_ulIter &lt;&lt; &quot;: &quot; &lt;&lt; nNum23 &lt;&lt; &quot; cells marked as profile 23&quot; &lt;&lt; endl;</span></div>
<div class="line"><a id="l00297" name="l00297"></a><span class="lineno">  297</span>   <span class="comment">// LogStream &lt;&lt; m_ulIter &lt;&lt; &quot;: &quot; &lt;&lt; nNum24 &lt;&lt; &quot; cells marked as profile 24&quot; &lt;&lt; endl;</span></div>
<div class="line"><a id="l00298" name="l00298"></a><span class="lineno">  298</span>   <span class="comment">// // DEBUG CODE =================================================================================</span></div>
<div class="line"><a id="l00299" name="l00299"></a><span class="lineno">  299</span>   <span class="comment">//</span></div>
<div class="line"><a id="l00300" name="l00300"></a><span class="lineno">  300</span>   <span class="comment">//</span></div>
<div class="line"><a id="l00301" name="l00301"></a><span class="lineno">  301</span>   <span class="comment">// // int nPolygonToChange = nUnusedPolygon + 1;</span></div>
<div class="line"><a id="l00302" name="l00302"></a><span class="lineno">  302</span>   <span class="comment">// //</span></div>
<div class="line"><a id="l00303" name="l00303"></a><span class="lineno">  303</span>   <span class="comment">// // // CRUDE, IMPROVE</span></div>
<div class="line"><a id="l00304" name="l00304"></a><span class="lineno">  304</span>   <span class="comment">// // for (int nY = 0; nY &lt; m_nYGridSize; nY++)</span></div>
<div class="line"><a id="l00305" name="l00305"></a><span class="lineno">  305</span>   <span class="comment">// // {</span></div>
<div class="line"><a id="l00306" name="l00306"></a><span class="lineno">  306</span>   <span class="comment">// //    for (int nX = 0; nX &lt; m_nXGridSize; nX++)</span></div>
<div class="line"><a id="l00307" name="l00307"></a><span class="lineno">  307</span>   <span class="comment">// //    {</span></div>
<div class="line"><a id="l00308" name="l00308"></a><span class="lineno">  308</span>   <span class="comment">// //       if (m_pRasterGrid-&gt;m_Cell[nX][nY].nGetPolygonID() == nPolygonToChange)</span></div>
<div class="line"><a id="l00309" name="l00309"></a><span class="lineno">  309</span>   <span class="comment">// //          m_pRasterGrid-&gt;m_Cell[nX][nY].SetPolygonID(nUnusedPolygon);</span></div>
<div class="line"><a id="l00310" name="l00310"></a><span class="lineno">  310</span>   <span class="comment">// //    }</span></div>
<div class="line"><a id="l00311" name="l00311"></a><span class="lineno">  311</span>   <span class="comment">// // }</span></div>
<div class="line"><a id="l00312" name="l00312"></a><span class="lineno">  312</span>   <span class="comment">//</span></div>
<div class="line"><a id="l00313" name="l00313"></a><span class="lineno">  313</span>   <span class="comment">// // DEBUG CODE =================================================================================</span></div>
<div class="line"><a id="l00314" name="l00314"></a><span class="lineno">  314</span>   <span class="comment">// nNumUnusedPolygonCells = 0;</span></div>
<div class="line"><a id="l00315" name="l00315"></a><span class="lineno">  315</span>   <span class="comment">// nNum23 = 0;</span></div>
<div class="line"><a id="l00316" name="l00316"></a><span class="lineno">  316</span>   <span class="comment">// nNum24 = 0;</span></div>
<div class="line"><a id="l00317" name="l00317"></a><span class="lineno">  317</span>   <span class="comment">// for (int nY = 0; nY &lt; m_nYGridSize; nY++)</span></div>
<div class="line"><a id="l00318" name="l00318"></a><span class="lineno">  318</span>   <span class="comment">// {</span></div>
<div class="line"><a id="l00319" name="l00319"></a><span class="lineno">  319</span>   <span class="comment">//    for (int nX = 0; nX &lt; m_nXGridSize; nX++)</span></div>
<div class="line"><a id="l00320" name="l00320"></a><span class="lineno">  320</span>   <span class="comment">//    {</span></div>
<div class="line"><a id="l00321" name="l00321"></a><span class="lineno">  321</span>   <span class="comment">//       if (m_pRasterGrid-&gt;m_Cell[nX][nY].nGetPolygonID() == nUnusedPolygon)</span></div>
<div class="line"><a id="l00322" name="l00322"></a><span class="lineno">  322</span>   <span class="comment">//          nNumUnusedPolygonCells++;</span></div>
<div class="line"><a id="l00323" name="l00323"></a><span class="lineno">  323</span>   <span class="comment">//</span></div>
<div class="line"><a id="l00324" name="l00324"></a><span class="lineno">  324</span>   <span class="comment">//       if (m_pRasterGrid-&gt;m_Cell[nX][nY].nGetPolygonID() == 23)</span></div>
<div class="line"><a id="l00325" name="l00325"></a><span class="lineno">  325</span>   <span class="comment">//          nNum23++;</span></div>
<div class="line"><a id="l00326" name="l00326"></a><span class="lineno">  326</span>   <span class="comment">//</span></div>
<div class="line"><a id="l00327" name="l00327"></a><span class="lineno">  327</span>   <span class="comment">//       if (m_pRasterGrid-&gt;m_Cell[nX][nY].nGetPolygonID() == 24)</span></div>
<div class="line"><a id="l00328" name="l00328"></a><span class="lineno">  328</span>   <span class="comment">//          nNum24++;</span></div>
<div class="line"><a id="l00329" name="l00329"></a><span class="lineno">  329</span>   <span class="comment">//    }</span></div>
<div class="line"><a id="l00330" name="l00330"></a><span class="lineno">  330</span>   <span class="comment">// }</span></div>
<div class="line"><a id="l00331" name="l00331"></a><span class="lineno">  331</span>   <span class="comment">//</span></div>
<div class="line"><a id="l00332" name="l00332"></a><span class="lineno">  332</span>   <span class="comment">// LogStream &lt;&lt; m_ulIter &lt;&lt; &quot;: AFTER CELL RE-NUMBERING&quot; &lt;&lt; endl;</span></div>
<div class="line"><a id="l00333" name="l00333"></a><span class="lineno">  333</span>   <span class="comment">// LogStream &lt;&lt; m_ulIter &lt;&lt; &quot;: &quot; &lt;&lt; nNumUnusedPolygonCells &lt;&lt; &quot; cells marked as unused profile &quot; &lt;&lt; nUnusedPolygon &lt;&lt; endl;</span></div>
<div class="line"><a id="l00334" name="l00334"></a><span class="lineno">  334</span>   <span class="comment">// LogStream &lt;&lt; m_ulIter &lt;&lt; &quot;: &quot; &lt;&lt; nNum23 &lt;&lt; &quot; cells marked as profile 23&quot; &lt;&lt; endl;</span></div>
<div class="line"><a id="l00335" name="l00335"></a><span class="lineno">  335</span>   <span class="comment">// LogStream &lt;&lt; m_ulIter &lt;&lt; &quot;: &quot; &lt;&lt; nNum24 &lt;&lt; &quot; cells marked as profile 24&quot; &lt;&lt; endl;</span></div>
<div class="line"><a id="l00336" name="l00336"></a><span class="lineno">  336</span>   <span class="comment">// // DEBUG CODE =================================================================================</span></div>
<div class="line"><a id="l00337" name="l00337"></a><span class="lineno">  337</span> </div>
<div class="line"><a id="l00338" name="l00338"></a><span class="lineno">  338</span>   <span class="comment">// // OK so get the polygon to change</span></div>
<div class="line"><a id="l00339" name="l00339"></a><span class="lineno">  339</span>   <span class="comment">// CGeomCoastPolygon* pPolygon = m_pVCoastPolygon[nPolygonToChange];</span></div>
<div class="line"><a id="l00340" name="l00340"></a><span class="lineno">  340</span>   <span class="comment">//</span></div>
<div class="line"><a id="l00341" name="l00341"></a><span class="lineno">  341</span>   <span class="comment">// // Get the size of the polygon&#39;s boundary</span></div>
<div class="line"><a id="l00342" name="l00342"></a><span class="lineno">  342</span>   <span class="comment">// int nEdgeSize = pPolygon-&gt;nGetBoundarySize();</span></div>
<div class="line"><a id="l00343" name="l00343"></a><span class="lineno">  343</span>   <span class="comment">//</span></div>
<div class="line"><a id="l00344" name="l00344"></a><span class="lineno">  344</span>   <span class="comment">// // And change these cells</span></div>
<div class="line"><a id="l00345" name="l00345"></a><span class="lineno">  345</span>   <span class="comment">// for (int n = 0; n &lt; nEdgeSize; n++)</span></div>
<div class="line"><a id="l00346" name="l00346"></a><span class="lineno">  346</span>   <span class="comment">// {</span></div>
<div class="line"><a id="l00347" name="l00347"></a><span class="lineno">  347</span>   <span class="comment">//    CGeom2DPoint* pPt = pPolygon-&gt;pPtGetBoundaryPoint(n);    // External CRS</span></div>
<div class="line"><a id="l00348" name="l00348"></a><span class="lineno">  348</span>   <span class="comment">//    CGeom2DIPoint Pti = PtiExtCRSToGridRound(pPt);</span></div>
<div class="line"><a id="l00349" name="l00349"></a><span class="lineno">  349</span>   <span class="comment">//    m_pRasterGrid-&gt;m_Cell[Pti.nGetX()][Pti.nGetY()].SetPolygonID(nUnusedPolygon);</span></div>
<div class="line"><a id="l00350" name="l00350"></a><span class="lineno">  350</span>   <span class="comment">// }</span></div>
<div class="line"><a id="l00351" name="l00351"></a><span class="lineno">  351</span> </div>
<div class="line"><a id="l00352" name="l00352"></a><span class="lineno">  352</span>   <span class="comment">// // DEBUG CODE =================================================================================</span></div>
<div class="line"><a id="l00353" name="l00353"></a><span class="lineno">  353</span>   <span class="comment">// nNumUnusedPolygonCells = 0;</span></div>
<div class="line"><a id="l00354" name="l00354"></a><span class="lineno">  354</span>   <span class="comment">// nNum23 = 0;</span></div>
<div class="line"><a id="l00355" name="l00355"></a><span class="lineno">  355</span>   <span class="comment">// nNum24 = 0;</span></div>
<div class="line"><a id="l00356" name="l00356"></a><span class="lineno">  356</span>   <span class="comment">// for (int nY = 0; nY &lt; m_nYGridSize; nY++)</span></div>
<div class="line"><a id="l00357" name="l00357"></a><span class="lineno">  357</span>   <span class="comment">// {</span></div>
<div class="line"><a id="l00358" name="l00358"></a><span class="lineno">  358</span>   <span class="comment">//    for (int nX = 0; nX &lt; m_nXGridSize; nX++)</span></div>
<div class="line"><a id="l00359" name="l00359"></a><span class="lineno">  359</span>   <span class="comment">//    {</span></div>
<div class="line"><a id="l00360" name="l00360"></a><span class="lineno">  360</span>   <span class="comment">//       if (m_pRasterGrid-&gt;m_Cell[nX][nY].nGetPolygonID() == nUnusedPolygon)</span></div>
<div class="line"><a id="l00361" name="l00361"></a><span class="lineno">  361</span>   <span class="comment">//          nNumUnusedPolygonCells++;</span></div>
<div class="line"><a id="l00362" name="l00362"></a><span class="lineno">  362</span>   <span class="comment">//</span></div>
<div class="line"><a id="l00363" name="l00363"></a><span class="lineno">  363</span>   <span class="comment">//       if (m_pRasterGrid-&gt;m_Cell[nX][nY].nGetPolygonID() == 23)</span></div>
<div class="line"><a id="l00364" name="l00364"></a><span class="lineno">  364</span>   <span class="comment">//          nNum23++;</span></div>
<div class="line"><a id="l00365" name="l00365"></a><span class="lineno">  365</span>   <span class="comment">//</span></div>
<div class="line"><a id="l00366" name="l00366"></a><span class="lineno">  366</span>   <span class="comment">//       if (m_pRasterGrid-&gt;m_Cell[nX][nY].nGetPolygonID() == 24)</span></div>
<div class="line"><a id="l00367" name="l00367"></a><span class="lineno">  367</span>   <span class="comment">//          nNum24++;</span></div>
<div class="line"><a id="l00368" name="l00368"></a><span class="lineno">  368</span>   <span class="comment">//    }</span></div>
<div class="line"><a id="l00369" name="l00369"></a><span class="lineno">  369</span>   <span class="comment">// }</span></div>
<div class="line"><a id="l00370" name="l00370"></a><span class="lineno">  370</span>   <span class="comment">//</span></div>
<div class="line"><a id="l00371" name="l00371"></a><span class="lineno">  371</span>   <span class="comment">// LogStream &lt;&lt; m_ulIter &lt;&lt; &quot;: AFTER CELL RE-NUMBERING&quot; &lt;&lt; endl;</span></div>
<div class="line"><a id="l00372" name="l00372"></a><span class="lineno">  372</span>   <span class="comment">// LogStream &lt;&lt; m_ulIter &lt;&lt; &quot;: &quot; &lt;&lt; nNumUnusedPolygonCells &lt;&lt; &quot; cells marked as unused profile &quot; &lt;&lt; nUnusedPolygon &lt;&lt; endl;</span></div>
<div class="line"><a id="l00373" name="l00373"></a><span class="lineno">  373</span>   <span class="comment">// LogStream &lt;&lt; m_ulIter &lt;&lt; &quot;: &quot; &lt;&lt; nNum23 &lt;&lt; &quot; cells marked as profile 23&quot; &lt;&lt; endl;</span></div>
<div class="line"><a id="l00374" name="l00374"></a><span class="lineno">  374</span>   <span class="comment">// LogStream &lt;&lt; m_ulIter &lt;&lt; &quot;: &quot; &lt;&lt; nNum24 &lt;&lt; &quot; cells marked as profile 24&quot; &lt;&lt; endl;</span></div>
<div class="line"><a id="l00375" name="l00375"></a><span class="lineno">  375</span>   <span class="comment">// // DEBUG CODE =================================================================================</span></div>
<div class="line"><a id="l00376" name="l00376"></a><span class="lineno">  376</span> </div>
<div class="line"><a id="l00377" name="l00377"></a><span class="lineno">  377</span>   <span class="comment">// // DEBUG CODE ===========================================================================================================</span></div>
<div class="line"><a id="l00378" name="l00378"></a><span class="lineno">  378</span>   <span class="comment">// if (m_ulIter == 109)</span></div>
<div class="line"><a id="l00379" name="l00379"></a><span class="lineno">  379</span>   <span class="comment">// {</span></div>
<div class="line"><a id="l00380" name="l00380"></a><span class="lineno">  380</span>   <span class="comment">//    string strOutFile = m_strOutPath;</span></div>
<div class="line"><a id="l00381" name="l00381"></a><span class="lineno">  381</span>   <span class="comment">//    strOutFile += &quot;00_polygon_raster_&quot;;</span></div>
<div class="line"><a id="l00382" name="l00382"></a><span class="lineno">  382</span>   <span class="comment">//    strOutFile += to_string(m_ulIter);</span></div>
<div class="line"><a id="l00383" name="l00383"></a><span class="lineno">  383</span>   <span class="comment">//    strOutFile += &quot;.tif&quot;;</span></div>
<div class="line"><a id="l00384" name="l00384"></a><span class="lineno">  384</span>   <span class="comment">//</span></div>
<div class="line"><a id="l00385" name="l00385"></a><span class="lineno">  385</span>   <span class="comment">//    GDALDriver* pDriver = GetGDALDriverManager()-&gt;GetDriverByName(&quot;gtiff&quot;);</span></div>
<div class="line"><a id="l00386" name="l00386"></a><span class="lineno">  386</span>   <span class="comment">//    GDALDataset* pDataSet = pDriver-&gt;Create(strOutFile.c_str(), m_nXGridSize, m_nYGridSize, 1, GDT_Float64, m_papszGDALRasterOptions);</span></div>
<div class="line"><a id="l00387" name="l00387"></a><span class="lineno">  387</span>   <span class="comment">//    pDataSet-&gt;SetProjection(m_strGDALBasementDEMProjection.c_str());</span></div>
<div class="line"><a id="l00388" name="l00388"></a><span class="lineno">  388</span>   <span class="comment">//    pDataSet-&gt;SetGeoTransform(m_dGeoTransform);</span></div>
<div class="line"><a id="l00389" name="l00389"></a><span class="lineno">  389</span>   <span class="comment">//</span></div>
<div class="line"><a id="l00390" name="l00390"></a><span class="lineno">  390</span>   <span class="comment">//    int nn = 0;</span></div>
<div class="line"><a id="l00391" name="l00391"></a><span class="lineno">  391</span>   <span class="comment">//    double* pdRaster = new double[m_nXGridSize * m_nYGridSize];</span></div>
<div class="line"><a id="l00392" name="l00392"></a><span class="lineno">  392</span>   <span class="comment">//    for (int nY = 0; nY &lt; m_nYGridSize; nY++)</span></div>
<div class="line"><a id="l00393" name="l00393"></a><span class="lineno">  393</span>   <span class="comment">//    {</span></div>
<div class="line"><a id="l00394" name="l00394"></a><span class="lineno">  394</span>   <span class="comment">//       for (int nX = 0; nX &lt; m_nXGridSize; nX++)</span></div>
<div class="line"><a id="l00395" name="l00395"></a><span class="lineno">  395</span>   <span class="comment">//       {</span></div>
<div class="line"><a id="l00396" name="l00396"></a><span class="lineno">  396</span>   <span class="comment">//          pdRaster[nn++] = m_pRasterGrid-&gt;m_Cell[nX][nY].nGetPolygonID();</span></div>
<div class="line"><a id="l00397" name="l00397"></a><span class="lineno">  397</span>   <span class="comment">//       }</span></div>
<div class="line"><a id="l00398" name="l00398"></a><span class="lineno">  398</span>   <span class="comment">//    }</span></div>
<div class="line"><a id="l00399" name="l00399"></a><span class="lineno">  399</span>   <span class="comment">//</span></div>
<div class="line"><a id="l00400" name="l00400"></a><span class="lineno">  400</span>   <span class="comment">//    GDALRasterBand* pBand = pDataSet-&gt;GetRasterBand(1);</span></div>
<div class="line"><a id="l00401" name="l00401"></a><span class="lineno">  401</span>   <span class="comment">//    pBand-&gt;SetNoDataValue(m_dMissingValue);</span></div>
<div class="line"><a id="l00402" name="l00402"></a><span class="lineno">  402</span>   <span class="comment">//    int nRet = pBand-&gt;RasterIO(GF_Write, 0, 0, m_nXGridSize, m_nYGridSize, pdRaster, m_nXGridSize, m_nYGridSize, GDT_Float64, 0, 0, NULL);</span></div>
<div class="line"><a id="l00403" name="l00403"></a><span class="lineno">  403</span>   <span class="comment">//</span></div>
<div class="line"><a id="l00404" name="l00404"></a><span class="lineno">  404</span>   <span class="comment">//    if (nRet == CE_Failure)</span></div>
<div class="line"><a id="l00405" name="l00405"></a><span class="lineno">  405</span>   <span class="comment">//       return RTN_ERR_GRIDCREATE;</span></div>
<div class="line"><a id="l00406" name="l00406"></a><span class="lineno">  406</span>   <span class="comment">//</span></div>
<div class="line"><a id="l00407" name="l00407"></a><span class="lineno">  407</span>   <span class="comment">//    GDALClose(pDataSet);</span></div>
<div class="line"><a id="l00408" name="l00408"></a><span class="lineno">  408</span>   <span class="comment">//    delete[] pdRaster;</span></div>
<div class="line"><a id="l00409" name="l00409"></a><span class="lineno">  409</span>   <span class="comment">// }</span></div>
<div class="line"><a id="l00410" name="l00410"></a><span class="lineno">  410</span>   <span class="comment">// // DEBUG CODE ===========================================================================================================</span></div>
<div class="line"><a id="l00411" name="l00411"></a><span class="lineno">  411</span> </div>
<div class="line"><a id="l00412" name="l00412"></a><span class="lineno">  412</span>   <span class="comment">// // DEBUG CODE =================================================================================</span></div>
<div class="line"><a id="l00413" name="l00413"></a><span class="lineno">  413</span>   <span class="comment">// nNum23 = 0;</span></div>
<div class="line"><a id="l00414" name="l00414"></a><span class="lineno">  414</span>   <span class="comment">// nNum24 = 0;</span></div>
<div class="line"><a id="l00415" name="l00415"></a><span class="lineno">  415</span>   <span class="comment">// for (int nY = 0; nY &lt; m_nYGridSize; nY++)</span></div>
<div class="line"><a id="l00416" name="l00416"></a><span class="lineno">  416</span>   <span class="comment">// {</span></div>
<div class="line"><a id="l00417" name="l00417"></a><span class="lineno">  417</span>   <span class="comment">//    for (int nX = 0; nX &lt; m_nXGridSize; nX++)</span></div>
<div class="line"><a id="l00418" name="l00418"></a><span class="lineno">  418</span>   <span class="comment">//    {</span></div>
<div class="line"><a id="l00419" name="l00419"></a><span class="lineno">  419</span>   <span class="comment">//</span></div>
<div class="line"><a id="l00420" name="l00420"></a><span class="lineno">  420</span>   <span class="comment">//       if (m_pRasterGrid-&gt;m_Cell[nX][nY].nGetPolygonID() == 23)</span></div>
<div class="line"><a id="l00421" name="l00421"></a><span class="lineno">  421</span>   <span class="comment">//          nNum23++;</span></div>
<div class="line"><a id="l00422" name="l00422"></a><span class="lineno">  422</span>   <span class="comment">//</span></div>
<div class="line"><a id="l00423" name="l00423"></a><span class="lineno">  423</span>   <span class="comment">//       if (m_pRasterGrid-&gt;m_Cell[nX][nY].nGetPolygonID() == 24)</span></div>
<div class="line"><a id="l00424" name="l00424"></a><span class="lineno">  424</span>   <span class="comment">//          nNum24++;</span></div>
<div class="line"><a id="l00425" name="l00425"></a><span class="lineno">  425</span>   <span class="comment">//    }</span></div>
<div class="line"><a id="l00426" name="l00426"></a><span class="lineno">  426</span>   <span class="comment">// }</span></div>
<div class="line"><a id="l00427" name="l00427"></a><span class="lineno">  427</span>   <span class="comment">//</span></div>
<div class="line"><a id="l00428" name="l00428"></a><span class="lineno">  428</span>   <span class="comment">// LogStream &lt;&lt; m_ulIter &lt;&lt; &quot;: AFTER 00_polygon_raster&quot; &lt;&lt; endl;</span></div>
<div class="line"><a id="l00429" name="l00429"></a><span class="lineno">  429</span>   <span class="comment">// LogStream &lt;&lt; m_ulIter &lt;&lt; &quot;: &quot; &lt;&lt; nNum23 &lt;&lt; &quot; cells marked as profile 23&quot; &lt;&lt; endl;</span></div>
<div class="line"><a id="l00430" name="l00430"></a><span class="lineno">  430</span>   <span class="comment">// LogStream &lt;&lt; m_ulIter &lt;&lt; &quot;: &quot; &lt;&lt; nNum24 &lt;&lt; &quot; cells marked as profile 24&quot; &lt;&lt; endl;</span></div>
<div class="line"><a id="l00431" name="l00431"></a><span class="lineno">  431</span>   <span class="comment">// // DEBUG CODE =================================================================================</span></div>
<div class="line"><a id="l00432" name="l00432"></a><span class="lineno">  432</span> </div>
<div class="line"><a id="l00433" name="l00433"></a><span class="lineno">  433</span>   <span class="keywordflow">return</span> <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#aa768cb14b5c6123ee95e6e4ebd9fe331">RTN_OK</a>;</div>
<div class="line"><a id="l00434" name="l00434"></a><span class="lineno">  434</span>}</div>
</div>
<div class="line"><a id="l00435" name="l00435"></a><span class="lineno">  435</span> </div>
<div class="line"><a id="l00436" name="l00436"></a><span class="lineno">  436</span><span class="comment">//===============================================================================================================================</span></div>
<div class="line"><a id="l00438" name="l00438"></a><span class="lineno">  438</span><span class="comment">//===============================================================================================================================</span></div>
<div class="foldopen" id="foldopen00439" data-start="{" data-end="}">
<div class="line"><a id="l00439" name="l00439"></a><span class="lineno"><a class="line" href="../../d1/d98/classCSimulation.html#ab743d5627b1b3d7b9dd95e7110f29715">  439</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="../../d1/d98/classCSimulation.html#ab743d5627b1b3d7b9dd95e7110f29715">CSimulation::RasterizePolygonJoiningLine</a>(<a class="code hl_class" href="../../d6/d0d/classCGeom2DIPoint.html">CGeom2DIPoint</a> <span class="keyword">const</span>* pPt1, <a class="code hl_class" href="../../d6/d0d/classCGeom2DIPoint.html">CGeom2DIPoint</a> <span class="keyword">const</span>* pPt2, <span class="keywordtype">int</span> <span class="keyword">const</span> nPoly)</div>
<div class="line"><a id="l00440" name="l00440"></a><span class="lineno">  440</span>{</div>
<div class="line"><a id="l00441" name="l00441"></a><span class="lineno">  441</span>   <span class="comment">// The start point of the line (grid CRS)</span></div>
<div class="line"><a id="l00442" name="l00442"></a><span class="lineno">  442</span>   <span class="keywordtype">int</span> nXStart = pPt1-&gt;<a class="code hl_function" href="../../d6/d0d/classCGeom2DIPoint.html#af84c687b2d0be01ab41cbcc0565f4f3f">nGetX</a>();</div>
<div class="line"><a id="l00443" name="l00443"></a><span class="lineno">  443</span>   <span class="keywordtype">int</span> nYStart = pPt1-&gt;<a class="code hl_function" href="../../d6/d0d/classCGeom2DIPoint.html#a4d9c20bcca90dcb9d519b664aba09cbd">nGetY</a>();</div>
<div class="line"><a id="l00444" name="l00444"></a><span class="lineno">  444</span> </div>
<div class="line"><a id="l00445" name="l00445"></a><span class="lineno">  445</span>   <span class="comment">// The end point of the line (grid CRS)</span></div>
<div class="line"><a id="l00446" name="l00446"></a><span class="lineno">  446</span>   <span class="keywordtype">int</span> nXEnd = pPt2-&gt;<a class="code hl_function" href="../../d6/d0d/classCGeom2DIPoint.html#af84c687b2d0be01ab41cbcc0565f4f3f">nGetX</a>();</div>
<div class="line"><a id="l00447" name="l00447"></a><span class="lineno">  447</span>   <span class="keywordtype">int</span> nYEnd = pPt2-&gt;<a class="code hl_function" href="../../d6/d0d/classCGeom2DIPoint.html#a4d9c20bcca90dcb9d519b664aba09cbd">nGetY</a>();</div>
<div class="line"><a id="l00448" name="l00448"></a><span class="lineno">  448</span> </div>
<div class="line"><a id="l00449" name="l00449"></a><span class="lineno">  449</span>   <span class="comment">// Safety check, in case the two points are identical (can happen due to rounding errors)</span></div>
<div class="line"><a id="l00450" name="l00450"></a><span class="lineno">  450</span>   <span class="keywordflow">if</span> ((nXStart == nXEnd) &amp;&amp; (nYStart == nYEnd))</div>
<div class="line"><a id="l00451" name="l00451"></a><span class="lineno">  451</span>      <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00452" name="l00452"></a><span class="lineno">  452</span> </div>
<div class="line"><a id="l00453" name="l00453"></a><span class="lineno">  453</span>   <span class="comment">// Interpolate between cells by a simple DDA line algorithm, see http://en.wikipedia.org/wiki/Digital_differential_analyzer_(graphics_algorithm) Note that Bresenham&#39;s algorithm gave occasional gaps</span></div>
<div class="line"><a id="l00454" name="l00454"></a><span class="lineno">  454</span>   <span class="keywordtype">double</span> dXInc = nXEnd - nXStart;</div>
<div class="line"><a id="l00455" name="l00455"></a><span class="lineno">  455</span>   <span class="keywordtype">double</span> dYInc = nYEnd - nYStart;</div>
<div class="line"><a id="l00456" name="l00456"></a><span class="lineno">  456</span>   <span class="keywordtype">double</span> dLength = <a class="code hl_function" href="../../d6/d2a/cme_8h.html#a7e895b460cef877dec4d12ead0c74f15">tMax</a>(<a class="code hl_function" href="../../d6/d2a/cme_8h.html#ae3b6dc50cfc97050529faa5e0bd66136">tAbs</a>(dXInc), <a class="code hl_function" href="../../d6/d2a/cme_8h.html#ae3b6dc50cfc97050529faa5e0bd66136">tAbs</a>(dYInc));</div>
<div class="line"><a id="l00457" name="l00457"></a><span class="lineno">  457</span> </div>
<div class="line"><a id="l00458" name="l00458"></a><span class="lineno">  458</span>   dXInc /= dLength;</div>
<div class="line"><a id="l00459" name="l00459"></a><span class="lineno">  459</span>   dYInc /= dLength;</div>
<div class="line"><a id="l00460" name="l00460"></a><span class="lineno">  460</span> </div>
<div class="line"><a id="l00461" name="l00461"></a><span class="lineno">  461</span>   <span class="keywordtype">double</span> dX = nXStart;</div>
<div class="line"><a id="l00462" name="l00462"></a><span class="lineno">  462</span>   <span class="keywordtype">double</span> dY = nYStart;</div>
<div class="line"><a id="l00463" name="l00463"></a><span class="lineno">  463</span> </div>
<div class="line"><a id="l00464" name="l00464"></a><span class="lineno">  464</span>   <span class="comment">// Process each interpolated point</span></div>
<div class="line"><a id="l00465" name="l00465"></a><span class="lineno">  465</span>   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> m = 0; m &lt;= <a class="code hl_function" href="../../d2/dfd/utils__global_8cpp.html#a20842d0a19d0ca952c91f3e1eb175fee">nRound</a>(dLength); m++)</div>
<div class="line"><a id="l00466" name="l00466"></a><span class="lineno">  466</span>   {</div>
<div class="line"><a id="l00467" name="l00467"></a><span class="lineno">  467</span>      <span class="keywordtype">int</span> nX = <a class="code hl_function" href="../../d2/dfd/utils__global_8cpp.html#a20842d0a19d0ca952c91f3e1eb175fee">nRound</a>(dX);</div>
<div class="line"><a id="l00468" name="l00468"></a><span class="lineno">  468</span>      <span class="keywordtype">int</span> nY = <a class="code hl_function" href="../../d2/dfd/utils__global_8cpp.html#a20842d0a19d0ca952c91f3e1eb175fee">nRound</a>(dY);</div>
<div class="line"><a id="l00469" name="l00469"></a><span class="lineno">  469</span> </div>
<div class="line"><a id="l00470" name="l00470"></a><span class="lineno">  470</span>      <span class="comment">// Safety check</span></div>
<div class="line"><a id="l00471" name="l00471"></a><span class="lineno">  471</span>      <span class="keywordflow">if</span> (! <a class="code hl_function" href="../../d1/d98/classCSimulation.html#ac900a5701df97da22278fae928951f50">bIsWithinValidGrid</a>(nX, nY))</div>
<div class="line"><a id="l00472" name="l00472"></a><span class="lineno">  472</span>         <a class="code hl_function" href="../../d1/d98/classCSimulation.html#aa0eddb8270d03b9c1a0a6e96254ebfed">KeepWithinValidGrid</a>(nXStart, nYStart, nX, nY);</div>
<div class="line"><a id="l00473" name="l00473"></a><span class="lineno">  473</span> </div>
<div class="line"><a id="l00474" name="l00474"></a><span class="lineno">  474</span>      <span class="comment">// Mark this point on the raster grid</span></div>
<div class="line"><a id="l00475" name="l00475"></a><span class="lineno">  475</span>      <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[nX][nY].SetPolygonID(nPoly);</div>
<div class="line"><a id="l00476" name="l00476"></a><span class="lineno">  476</span> </div>
<div class="line"><a id="l00477" name="l00477"></a><span class="lineno">  477</span>      <span class="comment">// And increment for next time</span></div>
<div class="line"><a id="l00478" name="l00478"></a><span class="lineno">  478</span>      dX += dXInc;</div>
<div class="line"><a id="l00479" name="l00479"></a><span class="lineno">  479</span>      dY += dYInc;</div>
<div class="line"><a id="l00480" name="l00480"></a><span class="lineno">  480</span>   }</div>
<div class="line"><a id="l00481" name="l00481"></a><span class="lineno">  481</span>}</div>
</div>
<div class="line"><a id="l00482" name="l00482"></a><span class="lineno">  482</span> </div>
<div class="line"><a id="l00483" name="l00483"></a><span class="lineno">  483</span><span class="comment">//===============================================================================================================================</span></div>
<div class="line"><a id="l00485" name="l00485"></a><span class="lineno">  485</span><span class="comment">//===============================================================================================================================</span></div>
<div class="foldopen" id="foldopen00486" data-start="{" data-end="}">
<div class="line"><a id="l00486" name="l00486"></a><span class="lineno"><a class="line" href="../../d1/d98/classCSimulation.html#abdc9fa851fdb5b8cc64a707f450495c1">  486</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="../../d1/d98/classCSimulation.html#abdc9fa851fdb5b8cc64a707f450495c1">CSimulation::MarkPolygonCells</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a id="l00487" name="l00487"></a><span class="lineno">  487</span>{</div>
<div class="line"><a id="l00488" name="l00488"></a><span class="lineno">  488</span>   <span class="comment">// // DEBUG CODE =================================================================================</span></div>
<div class="line"><a id="l00489" name="l00489"></a><span class="lineno">  489</span>   <span class="comment">// vector&lt;CGeom2DIPoint&gt; VPtiCentroids;</span></div>
<div class="line"><a id="l00490" name="l00490"></a><span class="lineno">  490</span>   <span class="comment">// vector&lt;int&gt; VnID;</span></div>
<div class="line"><a id="l00491" name="l00491"></a><span class="lineno">  491</span>   <span class="comment">//</span></div>
<div class="line"><a id="l00492" name="l00492"></a><span class="lineno">  492</span>   <span class="comment">// // Do this for each coast</span></div>
<div class="line"><a id="l00493" name="l00493"></a><span class="lineno">  493</span>   <span class="comment">// for (int nCoast = 0; nCoast &lt; static_cast&lt;int&gt;(m_VCoast.size()); nCoast++)</span></div>
<div class="line"><a id="l00494" name="l00494"></a><span class="lineno">  494</span>   <span class="comment">// {</span></div>
<div class="line"><a id="l00495" name="l00495"></a><span class="lineno">  495</span>   <span class="comment">//    // Do this for every coastal polygon</span></div>
<div class="line"><a id="l00496" name="l00496"></a><span class="lineno">  496</span>   <span class="comment">//    for (int nPoly = 0; nPoly &lt; m_VCoast[nCoast].nGetNumPolygons(); nPoly++)</span></div>
<div class="line"><a id="l00497" name="l00497"></a><span class="lineno">  497</span>   <span class="comment">//    {</span></div>
<div class="line"><a id="l00498" name="l00498"></a><span class="lineno">  498</span>   <span class="comment">//       CGeomCoastPolygon* pPolygon = m_VCoast[nCoast].pGetPolygon(nPoly);</span></div>
<div class="line"><a id="l00499" name="l00499"></a><span class="lineno">  499</span>   <span class="comment">//</span></div>
<div class="line"><a id="l00500" name="l00500"></a><span class="lineno">  500</span>   <span class="comment">//       int nPolyID = pPolygon-&gt;nGetCoastID();</span></div>
<div class="line"><a id="l00501" name="l00501"></a><span class="lineno">  501</span>   <span class="comment">//       VnID.push_back(nPolyID);</span></div>
<div class="line"><a id="l00502" name="l00502"></a><span class="lineno">  502</span>   <span class="comment">//</span></div>
<div class="line"><a id="l00503" name="l00503"></a><span class="lineno">  503</span>   <span class="comment">//       CGeom2DIPoint PtiStart = pPolygon-&gt;PtiGetFillStartPoint();</span></div>
<div class="line"><a id="l00504" name="l00504"></a><span class="lineno">  504</span>   <span class="comment">//       VPtiCentroids.push_back(PtiStart);</span></div>
<div class="line"><a id="l00505" name="l00505"></a><span class="lineno">  505</span>   <span class="comment">//    }</span></div>
<div class="line"><a id="l00506" name="l00506"></a><span class="lineno">  506</span>   <span class="comment">// }</span></div>
<div class="line"><a id="l00507" name="l00507"></a><span class="lineno">  507</span>   <span class="comment">//</span></div>
<div class="line"><a id="l00508" name="l00508"></a><span class="lineno">  508</span>   <span class="comment">// string strOutFile = m_strOutPath;</span></div>
<div class="line"><a id="l00509" name="l00509"></a><span class="lineno">  509</span>   <span class="comment">// strOutFile += &quot;00_polygon_flood_fill_start_point_&quot;;</span></div>
<div class="line"><a id="l00510" name="l00510"></a><span class="lineno">  510</span>   <span class="comment">// strOutFile += to_string(m_ulIter);</span></div>
<div class="line"><a id="l00511" name="l00511"></a><span class="lineno">  511</span>   <span class="comment">// strOutFile += &quot;.tif&quot;;</span></div>
<div class="line"><a id="l00512" name="l00512"></a><span class="lineno">  512</span>   <span class="comment">//</span></div>
<div class="line"><a id="l00513" name="l00513"></a><span class="lineno">  513</span>   <span class="comment">// GDALDriver* pDriver = GetGDALDriverManager()-&gt;GetDriverByName(&quot;gtiff&quot;);</span></div>
<div class="line"><a id="l00514" name="l00514"></a><span class="lineno">  514</span>   <span class="comment">// GDALDataset* pDataSet = pDriver-&gt;Create(strOutFile.c_str(), m_nXGridSize, m_nYGridSize, 1, GDT_Float64, m_papszGDALRasterOptions);</span></div>
<div class="line"><a id="l00515" name="l00515"></a><span class="lineno">  515</span>   <span class="comment">// pDataSet-&gt;SetProjection(m_strGDALBasementDEMProjection.c_str());</span></div>
<div class="line"><a id="l00516" name="l00516"></a><span class="lineno">  516</span>   <span class="comment">// pDataSet-&gt;SetGeoTransform(m_dGeoTransform);</span></div>
<div class="line"><a id="l00517" name="l00517"></a><span class="lineno">  517</span>   <span class="comment">//</span></div>
<div class="line"><a id="l00518" name="l00518"></a><span class="lineno">  518</span>   <span class="comment">// int nn = 0;</span></div>
<div class="line"><a id="l00519" name="l00519"></a><span class="lineno">  519</span>   <span class="comment">// double* pdRaster = new double[m_nXGridSize * m_nYGridSize];</span></div>
<div class="line"><a id="l00520" name="l00520"></a><span class="lineno">  520</span>   <span class="comment">// for (int nY = 0; nY &lt; m_nYGridSize; nY++)</span></div>
<div class="line"><a id="l00521" name="l00521"></a><span class="lineno">  521</span>   <span class="comment">// {</span></div>
<div class="line"><a id="l00522" name="l00522"></a><span class="lineno">  522</span>   <span class="comment">//    for (int nX = 0; nX &lt; m_nXGridSize; nX++)</span></div>
<div class="line"><a id="l00523" name="l00523"></a><span class="lineno">  523</span>   <span class="comment">//    {</span></div>
<div class="line"><a id="l00524" name="l00524"></a><span class="lineno">  524</span>   <span class="comment">//       pdRaster[nn] = INT_NODATA;</span></div>
<div class="line"><a id="l00525" name="l00525"></a><span class="lineno">  525</span>   <span class="comment">//</span></div>
<div class="line"><a id="l00526" name="l00526"></a><span class="lineno">  526</span>   <span class="comment">//       for (int n = 0; n &lt; static_cast&lt;int&gt;(VPtiCentroids.size()); n++)</span></div>
<div class="line"><a id="l00527" name="l00527"></a><span class="lineno">  527</span>   <span class="comment">//       {</span></div>
<div class="line"><a id="l00528" name="l00528"></a><span class="lineno">  528</span>   <span class="comment">//          if ((VPtiCentroids[n].nGetX() == nX) &amp;&amp; (VPtiCentroids[n].nGetY() == nY))</span></div>
<div class="line"><a id="l00529" name="l00529"></a><span class="lineno">  529</span>   <span class="comment">//          {</span></div>
<div class="line"><a id="l00530" name="l00530"></a><span class="lineno">  530</span>   <span class="comment">//             pdRaster[nn] = VnID[n];</span></div>
<div class="line"><a id="l00531" name="l00531"></a><span class="lineno">  531</span>   <span class="comment">//             LogStream &lt;&lt; m_ulIter &lt;&lt; &quot;: flood fill start point for polygon &quot; &lt;&lt; VnID[n] &lt;&lt; &quot; is [&quot; &lt;&lt; nX &lt;&lt; &quot;][&quot; &lt;&lt; nY &lt;&lt; &quot;]&quot; &lt;&lt; endl;</span></div>
<div class="line"><a id="l00532" name="l00532"></a><span class="lineno">  532</span>   <span class="comment">//             break;</span></div>
<div class="line"><a id="l00533" name="l00533"></a><span class="lineno">  533</span>   <span class="comment">//          }</span></div>
<div class="line"><a id="l00534" name="l00534"></a><span class="lineno">  534</span>   <span class="comment">//       }</span></div>
<div class="line"><a id="l00535" name="l00535"></a><span class="lineno">  535</span>   <span class="comment">//       nn++;</span></div>
<div class="line"><a id="l00536" name="l00536"></a><span class="lineno">  536</span>   <span class="comment">//    }</span></div>
<div class="line"><a id="l00537" name="l00537"></a><span class="lineno">  537</span>   <span class="comment">// }</span></div>
<div class="line"><a id="l00538" name="l00538"></a><span class="lineno">  538</span>   <span class="comment">//</span></div>
<div class="line"><a id="l00539" name="l00539"></a><span class="lineno">  539</span>   <span class="comment">// GDALRasterBand* pBand = pDataSet-&gt;GetRasterBand(1);</span></div>
<div class="line"><a id="l00540" name="l00540"></a><span class="lineno">  540</span>   <span class="comment">// pBand-&gt;SetNoDataValue(m_dMissingValue);</span></div>
<div class="line"><a id="l00541" name="l00541"></a><span class="lineno">  541</span>   <span class="comment">// int nRet = pBand-&gt;RasterIO(GF_Write, 0, 0, m_nXGridSize, m_nYGridSize, pdRaster, m_nXGridSize, m_nYGridSize, GDT_Float64, 0, 0, NULL);</span></div>
<div class="line"><a id="l00542" name="l00542"></a><span class="lineno">  542</span>   <span class="comment">//</span></div>
<div class="line"><a id="l00543" name="l00543"></a><span class="lineno">  543</span>   <span class="comment">// if (nRet == CE_Failure)</span></div>
<div class="line"><a id="l00544" name="l00544"></a><span class="lineno">  544</span>   <span class="comment">//    LogStream &lt;&lt; nRet &lt;&lt; endl;</span></div>
<div class="line"><a id="l00545" name="l00545"></a><span class="lineno">  545</span>   <span class="comment">//</span></div>
<div class="line"><a id="l00546" name="l00546"></a><span class="lineno">  546</span>   <span class="comment">// GDALClose(pDataSet);</span></div>
<div class="line"><a id="l00547" name="l00547"></a><span class="lineno">  547</span>   <span class="comment">// delete[] pdRaster;</span></div>
<div class="line"><a id="l00548" name="l00548"></a><span class="lineno">  548</span>   <span class="comment">// // DEBUG CODE ===========================================================================================================</span></div>
<div class="line"><a id="l00549" name="l00549"></a><span class="lineno">  549</span> </div>
<div class="line"><a id="l00550" name="l00550"></a><span class="lineno">  550</span>   <span class="comment">// Do this for each coast</span></div>
<div class="line"><a id="l00551" name="l00551"></a><span class="lineno">  551</span>   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> nCoast = 0; nCoast &lt; static_cast&lt;int&gt;(<a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a25ada8139c82ca7beab3f279cff83184">m_VCoast</a>.size()); nCoast++)</div>
<div class="line"><a id="l00552" name="l00552"></a><span class="lineno">  552</span>   {</div>
<div class="line"><a id="l00553" name="l00553"></a><span class="lineno">  553</span>      <span class="comment">// Do this for every coastal polygon, in along-coast sequence</span></div>
<div class="line"><a id="l00554" name="l00554"></a><span class="lineno">  554</span>      <span class="keywordtype">int</span> nPolygons = <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a25ada8139c82ca7beab3f279cff83184">m_VCoast</a>[nCoast].nGetNumPolygons();</div>
<div class="line"><a id="l00555" name="l00555"></a><span class="lineno">  555</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> nPoly = 0; nPoly &lt; nPolygons; nPoly++)</div>
<div class="line"><a id="l00556" name="l00556"></a><span class="lineno">  556</span>      {</div>
<div class="line"><a id="l00557" name="l00557"></a><span class="lineno">  557</span>         <span class="keywordtype">int</span> nCellsInPolygon = 0;</div>
<div class="line"><a id="l00558" name="l00558"></a><span class="lineno">  558</span>         <span class="keywordtype">double</span> dTotDepth = 0;</div>
<div class="line"><a id="l00559" name="l00559"></a><span class="lineno">  559</span>         <span class="keywordtype">double</span> dStoredUnconsFine = 0;</div>
<div class="line"><a id="l00560" name="l00560"></a><span class="lineno">  560</span>         <span class="keywordtype">double</span> dStoredUnconsSand = 0;</div>
<div class="line"><a id="l00561" name="l00561"></a><span class="lineno">  561</span>         <span class="keywordtype">double</span> dStoredUnconsCoarse = 0;</div>
<div class="line"><a id="l00562" name="l00562"></a><span class="lineno">  562</span>         <span class="keywordtype">double</span> dStoredConsFine = 0;</div>
<div class="line"><a id="l00563" name="l00563"></a><span class="lineno">  563</span>         <span class="keywordtype">double</span> dStoredConsSand = 0;</div>
<div class="line"><a id="l00564" name="l00564"></a><span class="lineno">  564</span>         <span class="keywordtype">double</span> dStoredConsCoarse = 0;</div>
<div class="line"><a id="l00565" name="l00565"></a><span class="lineno">  565</span>         <span class="keywordtype">double</span> dSedimentInputFine = 0;</div>
<div class="line"><a id="l00566" name="l00566"></a><span class="lineno">  566</span>         <span class="keywordtype">double</span> dSedimentInputSand = 0;</div>
<div class="line"><a id="l00567" name="l00567"></a><span class="lineno">  567</span>         <span class="keywordtype">double</span> dSedimentInputCoarse = 0;</div>
<div class="line"><a id="l00568" name="l00568"></a><span class="lineno">  568</span> </div>
<div class="line"><a id="l00569" name="l00569"></a><span class="lineno">  569</span>         <a class="code hl_class" href="../../df/d45/classCGeomCoastPolygon.html">CGeomCoastPolygon</a>* pPolygon = <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a25ada8139c82ca7beab3f279cff83184">m_VCoast</a>[nCoast].pGetPolygon(nPoly);</div>
<div class="line"><a id="l00570" name="l00570"></a><span class="lineno">  570</span>         <span class="keywordtype">int</span> nPolyID = pPolygon-&gt;<a class="code hl_function" href="../../df/d45/classCGeomCoastPolygon.html#ae97ed135e92d392e9b72f83feee59b2b">nGetCoastID</a>();    <span class="comment">// TODO 044</span></div>
<div class="line"><a id="l00571" name="l00571"></a><span class="lineno">  571</span> </div>
<div class="line"><a id="l00572" name="l00572"></a><span class="lineno">  572</span>         <span class="comment">// LogStream &lt;&lt; m_ulIter &lt;&lt; &quot;: in MarkPolygonCells() nPoly = &quot; &lt;&lt; nPoly &lt;&lt; &quot; nPolyID = &quot; &lt;&lt; nPolyID &lt;&lt; endl;</span></div>
<div class="line"><a id="l00573" name="l00573"></a><span class="lineno">  573</span> </div>
<div class="line"><a id="l00574" name="l00574"></a><span class="lineno">  574</span>         <span class="comment">// Create an empty stack</span></div>
<div class="line"><a id="l00575" name="l00575"></a><span class="lineno">  575</span>         stack&lt;CGeom2DIPoint&gt; PtiStack;</div>
<div class="line"><a id="l00576" name="l00576"></a><span class="lineno">  576</span> </div>
<div class="line"><a id="l00577" name="l00577"></a><span class="lineno">  577</span><span class="comment">//          // Since the polygon&#39;s vector boundary does not coincide exactly with the polygon&#39;s raster boundary, and the point-in-polygon check gives an indeterminate result if the point is exactly on the polygon&#39;s boundary, for safety we must construct a vector &#39;inner buffer&#39; which is smaller than, and inside, the vector boundary TODO *** STILL NEEDED?</span></div>
<div class="line"><a id="l00578" name="l00578"></a><span class="lineno">  578</span><span class="comment">//          int nHand = m_VCoast[nCoast].nGetSeaHandedness();</span></div>
<div class="line"><a id="l00579" name="l00579"></a><span class="lineno">  579</span><span class="comment">//          int nSize = pPolygon-&gt;nGetBoundarySize();</span></div>
<div class="line"><a id="l00580" name="l00580"></a><span class="lineno">  580</span><span class="comment">//          vector&lt;CGeom2DPoint&gt; PtVInnerBuffer;</span></div>
<div class="line"><a id="l00581" name="l00581"></a><span class="lineno">  581</span><span class="comment">//</span></div>
<div class="line"><a id="l00582" name="l00582"></a><span class="lineno">  582</span><span class="comment">//          for (int i = 0; i &lt; nSize-1; i++)</span></div>
<div class="line"><a id="l00583" name="l00583"></a><span class="lineno">  583</span><span class="comment">//          {</span></div>
<div class="line"><a id="l00584" name="l00584"></a><span class="lineno">  584</span><span class="comment">//             int j = i + 1;</span></div>
<div class="line"><a id="l00585" name="l00585"></a><span class="lineno">  585</span><span class="comment">//             if (i == nSize-2)       // We must ignore the duplicated node point</span></div>
<div class="line"><a id="l00586" name="l00586"></a><span class="lineno">  586</span><span class="comment">//                j = 0;</span></div>
<div class="line"><a id="l00587" name="l00587"></a><span class="lineno">  587</span><span class="comment">//</span></div>
<div class="line"><a id="l00588" name="l00588"></a><span class="lineno">  588</span><span class="comment">//             CGeom2DPoint PtThis = *pPolygon-&gt;pPtGetBoundaryPoint(i);</span></div>
<div class="line"><a id="l00589" name="l00589"></a><span class="lineno">  589</span><span class="comment">//             CGeom2DPoint PtNext = *pPolygon-&gt;pPtGetBoundaryPoint(j);</span></div>
<div class="line"><a id="l00590" name="l00590"></a><span class="lineno">  590</span><span class="comment">//</span></div>
<div class="line"><a id="l00591" name="l00591"></a><span class="lineno">  591</span><span class="comment">//             // Safety check</span></div>
<div class="line"><a id="l00592" name="l00592"></a><span class="lineno">  592</span><span class="comment">//             if (PtThis == PtNext)</span></div>
<div class="line"><a id="l00593" name="l00593"></a><span class="lineno">  593</span><span class="comment">//                continue;</span></div>
<div class="line"><a id="l00594" name="l00594"></a><span class="lineno">  594</span><span class="comment">//</span></div>
<div class="line"><a id="l00595" name="l00595"></a><span class="lineno">  595</span><span class="comment">//             CGeom2DPoint PtBuffer = PtGetPerpendicular(&amp;PtThis, &amp;PtNext, m_dCellSide, nHand);</span></div>
<div class="line"><a id="l00596" name="l00596"></a><span class="lineno">  596</span><span class="comment">//</span></div>
<div class="line"><a id="l00597" name="l00597"></a><span class="lineno">  597</span><span class="comment">//             PtVInnerBuffer.push_back(PtBuffer);</span></div>
<div class="line"><a id="l00598" name="l00598"></a><span class="lineno">  598</span><span class="comment">//          }</span></div>
<div class="line"><a id="l00599" name="l00599"></a><span class="lineno">  599</span> </div>
<div class="line"><a id="l00600" name="l00600"></a><span class="lineno">  600</span>         <span class="comment">// // DEBUG CODE ==============================================================================================</span></div>
<div class="line"><a id="l00601" name="l00601"></a><span class="lineno">  601</span>         <span class="comment">// LogStream &lt;&lt; endl &lt;&lt; m_ulIter &lt;&lt; &quot;: coast &quot; &lt;&lt; nCoast &lt;&lt; &quot;, polygon &quot; &lt;&lt; nPoly &lt;&lt; endl;</span></div>
<div class="line"><a id="l00602" name="l00602"></a><span class="lineno">  602</span>         <span class="comment">// LogStream &lt;&lt; &quot;Boundary\t\t\tBuffer&quot; &lt;&lt; endl;</span></div>
<div class="line"><a id="l00603" name="l00603"></a><span class="lineno">  603</span>         <span class="comment">// for (int i = 0; i &lt; pPolygon-&gt;nGetBoundarySize()-1; i++)</span></div>
<div class="line"><a id="l00604" name="l00604"></a><span class="lineno">  604</span>         <span class="comment">//    LogStream &lt;&lt; &quot;{&quot; &lt;&lt; pPolygon-&gt;pPtGetBoundaryPoint(i)-&gt;dGetX() &lt;&lt; &quot;, &quot; &lt;&lt; pPolygon-&gt;pPtGetBoundaryPoint(i)-&gt;dGetY() &lt;&lt; &quot;}\t{&quot; &lt;&lt; PtVInnerBuffer[i].dGetX() &lt;&lt; &quot;, &quot; &lt;&lt; PtVInnerBuffer[i].dGetY() &lt;&lt; &quot;}&quot; &lt;&lt; endl;</span></div>
<div class="line"><a id="l00605" name="l00605"></a><span class="lineno">  605</span>         <span class="comment">// LogStream &lt;&lt; endl;</span></div>
<div class="line"><a id="l00606" name="l00606"></a><span class="lineno">  606</span>         <span class="comment">// // DEBUG CODE ==============================================================================================</span></div>
<div class="line"><a id="l00607" name="l00607"></a><span class="lineno">  607</span> </div>
<div class="line"><a id="l00608" name="l00608"></a><span class="lineno">  608</span>         <span class="comment">// Use the centroid as the start point for the flood fill procedure</span></div>
<div class="line"><a id="l00609" name="l00609"></a><span class="lineno">  609</span>         <a class="code hl_class" href="../../d6/d0d/classCGeom2DIPoint.html">CGeom2DIPoint</a> PtiStart = pPolygon-&gt;<a class="code hl_function" href="../../df/d45/classCGeomCoastPolygon.html#a5a20c8589bae2a636e1c7667e5c4fe56">PtiGetFillStartPoint</a>();</div>
<div class="line"><a id="l00610" name="l00610"></a><span class="lineno">  610</span> </div>
<div class="line"><a id="l00611" name="l00611"></a><span class="lineno">  611</span>         <span class="comment">// // Is the centroid within the inner buffer?</span></div>
<div class="line"><a id="l00612" name="l00612"></a><span class="lineno">  612</span>         <span class="comment">// if (! bIsWithinPolygon(&amp;PtStart, &amp;PtVInnerBuffer))</span></div>
<div class="line"><a id="l00613" name="l00613"></a><span class="lineno">  613</span>         <span class="comment">// {</span></div>
<div class="line"><a id="l00614" name="l00614"></a><span class="lineno">  614</span>         <span class="comment">//    // No, it is not: the polygon must be a concave polygon. So keep looking for a point which is definitely inside the polygon, using an alternative method</span></div>
<div class="line"><a id="l00615" name="l00615"></a><span class="lineno">  615</span>         <span class="comment">//    PtStart = PtFindPointInPolygon(&amp;PtVInnerBuffer, pPolygon-&gt;nGetPointInPolygonSearchStartPoint());</span></div>
<div class="line"><a id="l00616" name="l00616"></a><span class="lineno">  616</span>         <span class="comment">// }</span></div>
<div class="line"><a id="l00617" name="l00617"></a><span class="lineno">  617</span>         <span class="comment">//</span></div>
<div class="line"><a id="l00618" name="l00618"></a><span class="lineno">  618</span>         <span class="comment">// // Safety check (PtFindPointInPolygon() returns CGeom2DPoint(DBL_NODATA, DBL_NODATA) if it cannot find a valid start point)</span></div>
<div class="line"><a id="l00619" name="l00619"></a><span class="lineno">  619</span>         <span class="comment">// if (bFPIsEqual(PtStart.dGetX(), DBL_NODATA, TOLERANCE))</span></div>
<div class="line"><a id="l00620" name="l00620"></a><span class="lineno">  620</span>         <span class="comment">// {</span></div>
<div class="line"><a id="l00621" name="l00621"></a><span class="lineno">  621</span>         <span class="comment">//    LogStream &lt;&lt; m_ulIter &lt;&lt; &quot;: &quot; &lt;&lt; ERR &lt;&lt; &quot;could not find a flood fill start point for coast &quot; &lt;&lt; nCoast &lt;&lt; &quot;, polygon &quot; &lt;&lt; nPoly &lt;&lt; endl;</span></div>
<div class="line"><a id="l00622" name="l00622"></a><span class="lineno">  622</span>         <span class="comment">//    break;</span></div>
<div class="line"><a id="l00623" name="l00623"></a><span class="lineno">  623</span>         <span class="comment">// }</span></div>
<div class="line"><a id="l00624" name="l00624"></a><span class="lineno">  624</span> </div>
<div class="line"><a id="l00625" name="l00625"></a><span class="lineno">  625</span>         <span class="comment">// We have a flood fill start point which is definitely within the polygon so push this point onto the stack</span></div>
<div class="line"><a id="l00626" name="l00626"></a><span class="lineno">  626</span>         <span class="comment">// CGeom2DIPoint PtiStart;</span></div>
<div class="line"><a id="l00627" name="l00627"></a><span class="lineno">  627</span>         <span class="comment">// PtiStart.SetX(nRound(PtStart.dGetX()));               // Grid CRS</span></div>
<div class="line"><a id="l00628" name="l00628"></a><span class="lineno">  628</span>         <span class="comment">// PtiStart.SetY(nRound(PtStart.dGetY()));               // Grid CRS</span></div>
<div class="line"><a id="l00629" name="l00629"></a><span class="lineno">  629</span> </div>
<div class="line"><a id="l00630" name="l00630"></a><span class="lineno">  630</span>         PtiStack.push(PtiStart);</div>
<div class="line"><a id="l00631" name="l00631"></a><span class="lineno">  631</span> </div>
<div class="line"><a id="l00632" name="l00632"></a><span class="lineno">  632</span>         <span class="comment">// LogStream &lt;&lt; m_ulIter &lt;&lt; &quot;: filling polygon &quot; &lt;&lt; nPoly &lt;&lt; &quot; from [&quot; &lt;&lt; PtiStart.nGetX() &lt;&lt; &quot;][&quot; &lt;&lt; PtiStart.nGetY() &lt;&lt; &quot;] = {&quot; &lt;&lt; dGridCentroidXToExtCRSX(PtiStart.nGetX()) &lt;&lt; &quot;, &quot; &lt;&lt; dGridCentroidYToExtCRSY(PtiStart.nGetY()) &lt;&lt; &quot;}&quot; &lt;&lt; endl;</span></div>
<div class="line"><a id="l00633" name="l00633"></a><span class="lineno">  633</span> </div>
<div class="line"><a id="l00634" name="l00634"></a><span class="lineno">  634</span>         <span class="comment">// Then do the flood fill: loop until there are no more cell coordinates on the stack</span></div>
<div class="line"><a id="l00635" name="l00635"></a><span class="lineno">  635</span>         <span class="keywordflow">while</span> (! PtiStack.empty())</div>
<div class="line"><a id="l00636" name="l00636"></a><span class="lineno">  636</span>         {</div>
<div class="line"><a id="l00637" name="l00637"></a><span class="lineno">  637</span>            <a class="code hl_class" href="../../d6/d0d/classCGeom2DIPoint.html">CGeom2DIPoint</a> Pti = PtiStack.top();</div>
<div class="line"><a id="l00638" name="l00638"></a><span class="lineno">  638</span>            PtiStack.pop();</div>
<div class="line"><a id="l00639" name="l00639"></a><span class="lineno">  639</span> </div>
<div class="line"><a id="l00640" name="l00640"></a><span class="lineno">  640</span>            <span class="keywordtype">int</span> nX = Pti.<a class="code hl_function" href="../../d6/d0d/classCGeom2DIPoint.html#af84c687b2d0be01ab41cbcc0565f4f3f">nGetX</a>();</div>
<div class="line"><a id="l00641" name="l00641"></a><span class="lineno">  641</span>            <span class="keywordtype">int</span> nY = Pti.<a class="code hl_function" href="../../d6/d0d/classCGeom2DIPoint.html#a4d9c20bcca90dcb9d519b664aba09cbd">nGetY</a>();</div>
<div class="line"><a id="l00642" name="l00642"></a><span class="lineno">  642</span>               </div>
<div class="line"><a id="l00643" name="l00643"></a><span class="lineno">  643</span>            <span class="keywordflow">while</span> ((nX &gt;= 0) &amp;&amp; (<a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[nX][nY].nGetPolygonID() == <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#a01aa8b423260b337ddff2016107b51a0">INT_NODATA</a>))</div>
<div class="line"><a id="l00644" name="l00644"></a><span class="lineno">  644</span>            <span class="comment">// while ((nX &gt;= 0) &amp;&amp; (m_pRasterGrid-&gt;m_Cell[nX][nY].nGetPolygonID() != (nUpCoastBoundary || nDownCoastBoundary)))</span></div>
<div class="line"><a id="l00645" name="l00645"></a><span class="lineno">  645</span>               nX--;</div>
<div class="line"><a id="l00646" name="l00646"></a><span class="lineno">  646</span> </div>
<div class="line"><a id="l00647" name="l00647"></a><span class="lineno">  647</span>            nX++;</div>
<div class="line"><a id="l00648" name="l00648"></a><span class="lineno">  648</span>            </div>
<div class="line"><a id="l00649" name="l00649"></a><span class="lineno">  649</span>            <span class="keywordtype">bool</span> bSpanAbove = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00650" name="l00650"></a><span class="lineno">  650</span>            <span class="keywordtype">bool</span> bSpanBelow = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00651" name="l00651"></a><span class="lineno">  651</span> </div>
<div class="line"><a id="l00652" name="l00652"></a><span class="lineno">  652</span>            <span class="keywordflow">while</span> ((nX &lt; <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1652253500dab35e6f6f9f734207e20b">m_nXGridSize</a>) &amp;&amp; (<a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[nX][nY].nGetPolygonID() == <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#a01aa8b423260b337ddff2016107b51a0">INT_NODATA</a>))</div>
<div class="line"><a id="l00653" name="l00653"></a><span class="lineno">  653</span>            <span class="comment">// while ((nX &lt; m_nXGridSize) &amp;&amp; (m_pRasterGrid-&gt;m_Cell[nX][nY].nGetPolygonID() != (nUpCoastBoundary || nDownCoastBoundary)))</span></div>
<div class="line"><a id="l00654" name="l00654"></a><span class="lineno">  654</span>            {</div>
<div class="line"><a id="l00655" name="l00655"></a><span class="lineno">  655</span>               <span class="comment">// Mark the cell as being in this polygon</span></div>
<div class="line"><a id="l00656" name="l00656"></a><span class="lineno">  656</span>               <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[nX][nY].SetPolygonID(nPolyID);</div>
<div class="line"><a id="l00657" name="l00657"></a><span class="lineno">  657</span> </div>
<div class="line"><a id="l00658" name="l00658"></a><span class="lineno">  658</span>               <span class="comment">// LogStream &lt;&lt; &quot;Marked [&quot; &lt;&lt; nX &lt;&lt; &quot;][&quot; &lt;&lt; nY &lt;&lt; &quot;] = {&quot; &lt;&lt; dGridCentroidXToExtCRSX(nX) &lt;&lt; &quot;, &quot; &lt;&lt; dGridCentroidYToExtCRSY(nY) &lt;&lt; &quot;}&quot; &lt;&lt; endl;</span></div>
<div class="line"><a id="l00659" name="l00659"></a><span class="lineno">  659</span>               </div>
<div class="line"><a id="l00660" name="l00660"></a><span class="lineno">  660</span>               <span class="comment">// Increment the running totals for this polygon</span></div>
<div class="line"><a id="l00661" name="l00661"></a><span class="lineno">  661</span>               <span class="comment">// dCliffCollapseErosionFine += m_pRasterGrid-&gt;m_Cell[nX][nY].dGetThisIterCliffCollapseErosionFine();</span></div>
<div class="line"><a id="l00662" name="l00662"></a><span class="lineno">  662</span>               <span class="comment">// dCliffCollapseErosionSand += m_pRasterGrid-&gt;m_Cell[nX][nY].dGetThisIterCliffCollapseErosionSand();</span></div>
<div class="line"><a id="l00663" name="l00663"></a><span class="lineno">  663</span>               <span class="comment">// dCliffCollapseErosionCoarse += m_pRasterGrid-&gt;m_Cell[nX][nY].dGetThisIterCliffCollapseErosionCoarse();</span></div>
<div class="line"><a id="l00664" name="l00664"></a><span class="lineno">  664</span>               <span class="comment">// dCliffCollapseTalusSand += m_pRasterGrid-&gt;m_Cell[nX][nY].dGetThisIterCliffCollapseSandTalusDeposition();</span></div>
<div class="line"><a id="l00665" name="l00665"></a><span class="lineno">  665</span>               <span class="comment">// dCliffCollapseTalusCoarse += m_pRasterGrid-&gt;m_Cell[nX][nY].dGetThisIterCliffCollapseCoarseTalusDeposition();</span></div>
<div class="line"><a id="l00666" name="l00666"></a><span class="lineno">  666</span>               </div>
<div class="line"><a id="l00667" name="l00667"></a><span class="lineno">  667</span>               <span class="comment">// Get the number of the highest layer with non-zero thickness</span></div>
<div class="line"><a id="l00668" name="l00668"></a><span class="lineno">  668</span>               <span class="keywordtype">int</span> nThisLayer = <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[nX][nY].nGetTopNonZeroLayerAboveBasement();</div>
<div class="line"><a id="l00669" name="l00669"></a><span class="lineno">  669</span>               </div>
<div class="line"><a id="l00670" name="l00670"></a><span class="lineno">  670</span>               <span class="comment">// And increment some more running totals for this polygon TODO 066 should this be for ALL layers above the basement?</span></div>
<div class="line"><a id="l00671" name="l00671"></a><span class="lineno">  671</span>               dStoredUnconsFine += <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[nX][nY].pGetLayerAboveBasement(nThisLayer)-&gt;pGetUnconsolidatedSediment()-&gt;dGetFineDepth();</div>
<div class="line"><a id="l00672" name="l00672"></a><span class="lineno">  672</span>               dStoredUnconsSand += <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[nX][nY].pGetLayerAboveBasement(nThisLayer)-&gt;pGetUnconsolidatedSediment()-&gt;dGetSandDepth();</div>
<div class="line"><a id="l00673" name="l00673"></a><span class="lineno">  673</span>               dStoredUnconsCoarse += <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[nX][nY].pGetLayerAboveBasement(nThisLayer)-&gt;pGetUnconsolidatedSediment()-&gt;dGetCoarseDepth();</div>
<div class="line"><a id="l00674" name="l00674"></a><span class="lineno">  674</span> </div>
<div class="line"><a id="l00675" name="l00675"></a><span class="lineno">  675</span>               dStoredConsFine += <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[nX][nY].pGetLayerAboveBasement(nThisLayer)-&gt;pGetConsolidatedSediment()-&gt;dGetFineDepth();</div>
<div class="line"><a id="l00676" name="l00676"></a><span class="lineno">  676</span>               dStoredConsSand += <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[nX][nY].pGetLayerAboveBasement(nThisLayer)-&gt;pGetConsolidatedSediment()-&gt;dGetSandDepth();</div>
<div class="line"><a id="l00677" name="l00677"></a><span class="lineno">  677</span>               dStoredConsCoarse += <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[nX][nY].pGetLayerAboveBasement(nThisLayer)-&gt;pGetConsolidatedSediment()-&gt;dGetCoarseDepth();</div>
<div class="line"><a id="l00678" name="l00678"></a><span class="lineno">  678</span> </div>
<div class="line"><a id="l00679" name="l00679"></a><span class="lineno">  679</span>               <span class="comment">// Add to the start-iteration total of suspended fine sediment within polygons</span></div>
<div class="line"><a id="l00680" name="l00680"></a><span class="lineno">  680</span>               <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a45597177a9aecb40378ed4b9632008fd">m_dStartIterSuspFineInPolygons</a> += <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[nX][nY].dGetSuspendedSediment();</div>
<div class="line"><a id="l00681" name="l00681"></a><span class="lineno">  681</span> </div>
<div class="line"><a id="l00682" name="l00682"></a><span class="lineno">  682</span>               <span class="comment">// Add to the total of sediment derived from sediment input events</span></div>
<div class="line"><a id="l00683" name="l00683"></a><span class="lineno">  683</span>               dSedimentInputFine += <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[nX][nY].pGetLayerAboveBasement(nThisLayer)-&gt;pGetUnconsolidatedSediment()-&gt;dGetFineSedimentInputDepth();</div>
<div class="line"><a id="l00684" name="l00684"></a><span class="lineno">  684</span>               dSedimentInputSand += <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[nX][nY].pGetLayerAboveBasement(nThisLayer)-&gt;pGetUnconsolidatedSediment()-&gt;dGetSandSedimentInputDepth();</div>
<div class="line"><a id="l00685" name="l00685"></a><span class="lineno">  685</span>               dSedimentInputCoarse += <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[nX][nY].pGetLayerAboveBasement(nThisLayer)-&gt;pGetUnconsolidatedSediment()-&gt;dGetCoarseSedimentInputDepth();</div>
<div class="line"><a id="l00686" name="l00686"></a><span class="lineno">  686</span> </div>
<div class="line"><a id="l00687" name="l00687"></a><span class="lineno">  687</span>               nCellsInPolygon++;</div>
<div class="line"><a id="l00688" name="l00688"></a><span class="lineno">  688</span>               dTotDepth += <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[nX][nY].dGetSeaDepth();</div>
<div class="line"><a id="l00689" name="l00689"></a><span class="lineno">  689</span> </div>
<div class="line"><a id="l00690" name="l00690"></a><span class="lineno">  690</span>               <span class="keywordflow">if</span> ((! bSpanAbove) &amp;&amp; (nY &gt; 0) &amp;&amp; (<a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[nX][nY-1].nGetPolygonID() == <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#a01aa8b423260b337ddff2016107b51a0">INT_NODATA</a>))</div>
<div class="line"><a id="l00691" name="l00691"></a><span class="lineno">  691</span>               {</div>
<div class="line"><a id="l00692" name="l00692"></a><span class="lineno">  692</span>                  PtiStack.push(<a class="code hl_class" href="../../d6/d0d/classCGeom2DIPoint.html">CGeom2DIPoint</a>(nX, nY-1));</div>
<div class="line"><a id="l00693" name="l00693"></a><span class="lineno">  693</span>                  bSpanAbove = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00694" name="l00694"></a><span class="lineno">  694</span>               }</div>
<div class="line"><a id="l00695" name="l00695"></a><span class="lineno">  695</span>               <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bSpanAbove &amp;&amp; (nY &gt; 0) &amp;&amp; (<a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[nX][nY-1].nGetPolygonID() != <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#a01aa8b423260b337ddff2016107b51a0">INT_NODATA</a>))</div>
<div class="line"><a id="l00696" name="l00696"></a><span class="lineno">  696</span>               {</div>
<div class="line"><a id="l00697" name="l00697"></a><span class="lineno">  697</span>                  bSpanAbove = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00698" name="l00698"></a><span class="lineno">  698</span>               }</div>
<div class="line"><a id="l00699" name="l00699"></a><span class="lineno">  699</span> </div>
<div class="line"><a id="l00700" name="l00700"></a><span class="lineno">  700</span>               <span class="keywordflow">if</span> ((! bSpanBelow) &amp;&amp; (nY &lt; <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a3755fdc07c0ac9f2ce6c2237cfef50ce">m_nYGridSize</a>-1) &amp;&amp; (<a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[nX][nY+1].nGetPolygonID() == <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#a01aa8b423260b337ddff2016107b51a0">INT_NODATA</a>))</div>
<div class="line"><a id="l00701" name="l00701"></a><span class="lineno">  701</span>               {</div>
<div class="line"><a id="l00702" name="l00702"></a><span class="lineno">  702</span>                  PtiStack.push(<a class="code hl_class" href="../../d6/d0d/classCGeom2DIPoint.html">CGeom2DIPoint</a>(nX, nY+1));</div>
<div class="line"><a id="l00703" name="l00703"></a><span class="lineno">  703</span>                  bSpanBelow = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00704" name="l00704"></a><span class="lineno">  704</span>               }</div>
<div class="line"><a id="l00705" name="l00705"></a><span class="lineno">  705</span>               <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bSpanBelow &amp;&amp; (nY &lt; <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a3755fdc07c0ac9f2ce6c2237cfef50ce">m_nYGridSize</a>-1) &amp;&amp; (<a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[nX][nY+1].nGetPolygonID() != <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#a01aa8b423260b337ddff2016107b51a0">INT_NODATA</a>))</div>
<div class="line"><a id="l00706" name="l00706"></a><span class="lineno">  706</span>               {</div>
<div class="line"><a id="l00707" name="l00707"></a><span class="lineno">  707</span>                  bSpanBelow = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00708" name="l00708"></a><span class="lineno">  708</span>               }</div>
<div class="line"><a id="l00709" name="l00709"></a><span class="lineno">  709</span> </div>
<div class="line"><a id="l00710" name="l00710"></a><span class="lineno">  710</span>               nX++;</div>
<div class="line"><a id="l00711" name="l00711"></a><span class="lineno">  711</span>            }</div>
<div class="line"><a id="l00712" name="l00712"></a><span class="lineno">  712</span>         }</div>
<div class="line"><a id="l00713" name="l00713"></a><span class="lineno">  713</span>         </div>
<div class="line"><a id="l00714" name="l00714"></a><span class="lineno">  714</span>         <span class="comment">// Store this polygon&#39;s stored unconsolidated sediment depths</span></div>
<div class="line"><a id="l00715" name="l00715"></a><span class="lineno">  715</span>         pPolygon-&gt;<a class="code hl_function" href="../../df/d45/classCGeomCoastPolygon.html#a34cf2701da81a0b72365b1fa7fa855b4">SetPreExistingUnconsFine</a>(dStoredUnconsFine);</div>
<div class="line"><a id="l00716" name="l00716"></a><span class="lineno">  716</span>         pPolygon-&gt;<a class="code hl_function" href="../../df/d45/classCGeomCoastPolygon.html#a41ffd18c3a9539811aeb120f6886e6da">SetPreExistingUnconsSand</a>(dStoredUnconsSand);</div>
<div class="line"><a id="l00717" name="l00717"></a><span class="lineno">  717</span>         pPolygon-&gt;<a class="code hl_function" href="../../df/d45/classCGeomCoastPolygon.html#abdb77248b1f7a026e656bf4e4e08696b">SetPreExistingUnconsCoarse</a>(dStoredUnconsCoarse);</div>
<div class="line"><a id="l00718" name="l00718"></a><span class="lineno">  718</span> </div>
<div class="line"><a id="l00719" name="l00719"></a><span class="lineno">  719</span>         <span class="comment">// Store this polygon&#39;s values for unconsolidated sediment derived from sediment input event(s)</span></div>
<div class="line"><a id="l00720" name="l00720"></a><span class="lineno">  720</span>         pPolygon-&gt;<a class="code hl_function" href="../../df/d45/classCGeomCoastPolygon.html#a35df99fb60cac21d4f6c42218f8169d2">SetSedimentInputUnconsFine</a>(dSedimentInputFine);</div>
<div class="line"><a id="l00721" name="l00721"></a><span class="lineno">  721</span>         pPolygon-&gt;<a class="code hl_function" href="../../df/d45/classCGeomCoastPolygon.html#a33b5ee96a889a83c8aa34399f3f15c12">SetSedimentInputUnconsSand</a>(dSedimentInputSand);</div>
<div class="line"><a id="l00722" name="l00722"></a><span class="lineno">  722</span>         pPolygon-&gt;<a class="code hl_function" href="../../df/d45/classCGeomCoastPolygon.html#a6b42ec53178379945ca004050f30f039">SetSedimentInputUnconsCoarse</a>(dSedimentInputCoarse);</div>
<div class="line"><a id="l00723" name="l00723"></a><span class="lineno">  723</span> </div>
<div class="line"><a id="l00724" name="l00724"></a><span class="lineno">  724</span>         <span class="comment">// Store this polygon&#39;s stored consolidated sediment depths</span></div>
<div class="line"><a id="l00725" name="l00725"></a><span class="lineno">  725</span>         pPolygon-&gt;<a class="code hl_function" href="../../df/d45/classCGeomCoastPolygon.html#a3d3d6e36327eed01f632184ccdade662">SetPreExistingConsFine</a>(dStoredConsFine);</div>
<div class="line"><a id="l00726" name="l00726"></a><span class="lineno">  726</span>         pPolygon-&gt;<a class="code hl_function" href="../../df/d45/classCGeomCoastPolygon.html#ae15a709df66f5ca57b9b2c9115f2d354">SetPreExistingConsSand</a>(dStoredConsSand);</div>
<div class="line"><a id="l00727" name="l00727"></a><span class="lineno">  727</span>         pPolygon-&gt;<a class="code hl_function" href="../../df/d45/classCGeomCoastPolygon.html#ab02a39464ee62ca5ec8b7b3a556153bf">SetPreExistingConsCoarse</a>(dStoredConsCoarse);</div>
<div class="line"><a id="l00728" name="l00728"></a><span class="lineno">  728</span> </div>
<div class="line"><a id="l00729" name="l00729"></a><span class="lineno">  729</span>         <span class="comment">// Store the number of cells in the interior of the polygon</span></div>
<div class="line"><a id="l00730" name="l00730"></a><span class="lineno">  730</span>         pPolygon-&gt;<a class="code hl_function" href="../../df/d45/classCGeomCoastPolygon.html#aea28877120b36563169e11c9cdcf2294">SetNumCellsInPolygon</a>(nCellsInPolygon);</div>
<div class="line"><a id="l00731" name="l00731"></a><span class="lineno">  731</span>         <span class="comment">// LogStream &lt;&lt; m_ulIter &lt;&lt; &quot;: in MarkPolygonCells() N cells = &quot; &lt;&lt; nCellsInPolygon &lt;&lt; &quot; in polygon &quot; &lt;&lt; nPolyID &lt;&lt; endl;</span></div>
<div class="line"><a id="l00732" name="l00732"></a><span class="lineno">  732</span> </div>
<div class="line"><a id="l00733" name="l00733"></a><span class="lineno">  733</span>         <span class="comment">// Calculate the total volume of seawater on the polygon (m3) and store it</span></div>
<div class="line"><a id="l00734" name="l00734"></a><span class="lineno">  734</span>         <span class="keywordtype">double</span> dSeaVolume = dTotDepth * <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#ae0de69c3d3acd6d52dc2ec2f456c0eb5">m_dCellSide</a>;</div>
<div class="line"><a id="l00735" name="l00735"></a><span class="lineno">  735</span>         pPolygon-&gt;<a class="code hl_function" href="../../df/d45/classCGeomCoastPolygon.html#a440264eb31972f7f9ce65de909d61832">SetSeawaterVolume</a>(dSeaVolume);</div>
<div class="line"><a id="l00736" name="l00736"></a><span class="lineno">  736</span>      }</div>
<div class="line"><a id="l00737" name="l00737"></a><span class="lineno">  737</span>   }</div>
<div class="line"><a id="l00738" name="l00738"></a><span class="lineno">  738</span> </div>
<div class="line"><a id="l00739" name="l00739"></a><span class="lineno">  739</span>   <span class="comment">// // DEBUG CODE ===========================================================================================================</span></div>
<div class="line"><a id="l00740" name="l00740"></a><span class="lineno">  740</span>   <span class="comment">// if (m_ulIter == 109)</span></div>
<div class="line"><a id="l00741" name="l00741"></a><span class="lineno">  741</span>   <span class="comment">// {</span></div>
<div class="line"><a id="l00742" name="l00742"></a><span class="lineno">  742</span>   <span class="comment">//    string strOutFile = m_strOutPath + &quot;00_polygon_fill_&quot;;</span></div>
<div class="line"><a id="l00743" name="l00743"></a><span class="lineno">  743</span>   <span class="comment">//    strOutFile += to_string(m_ulIter);</span></div>
<div class="line"><a id="l00744" name="l00744"></a><span class="lineno">  744</span>   <span class="comment">//    strOutFile += &quot;.tif&quot;;</span></div>
<div class="line"><a id="l00745" name="l00745"></a><span class="lineno">  745</span>   <span class="comment">//</span></div>
<div class="line"><a id="l00746" name="l00746"></a><span class="lineno">  746</span>   <span class="comment">//    GDALDriver* pDriver = GetGDALDriverManager()-&gt;GetDriverByName(&quot;gtiff&quot;);</span></div>
<div class="line"><a id="l00747" name="l00747"></a><span class="lineno">  747</span>   <span class="comment">//    GDALDataset* pDataSet = pDriver-&gt;Create(strOutFile.c_str(), m_nXGridSize, m_nYGridSize, 1, GDT_Float64, m_papszGDALRasterOptions);</span></div>
<div class="line"><a id="l00748" name="l00748"></a><span class="lineno">  748</span>   <span class="comment">//    pDataSet-&gt;SetProjection(m_strGDALBasementDEMProjection.c_str());</span></div>
<div class="line"><a id="l00749" name="l00749"></a><span class="lineno">  749</span>   <span class="comment">//    pDataSet-&gt;SetGeoTransform(m_dGeoTransform);</span></div>
<div class="line"><a id="l00750" name="l00750"></a><span class="lineno">  750</span>   <span class="comment">//    double* pdRaster = new double[m_nXGridSize * m_nYGridSize];</span></div>
<div class="line"><a id="l00751" name="l00751"></a><span class="lineno">  751</span>   <span class="comment">//    int n = 0;</span></div>
<div class="line"><a id="l00752" name="l00752"></a><span class="lineno">  752</span>   <span class="comment">//</span></div>
<div class="line"><a id="l00753" name="l00753"></a><span class="lineno">  753</span>   <span class="comment">//    int nNumPoly = m_VCoast[0].nGetNumPolygons();</span></div>
<div class="line"><a id="l00754" name="l00754"></a><span class="lineno">  754</span>   <span class="comment">//    vector&lt;int&gt; nVPerPoly(nNumPoly, 0);</span></div>
<div class="line"><a id="l00755" name="l00755"></a><span class="lineno">  755</span>   <span class="comment">//    int nNotInPoly = 0;</span></div>
<div class="line"><a id="l00756" name="l00756"></a><span class="lineno">  756</span>   <span class="comment">//</span></div>
<div class="line"><a id="l00757" name="l00757"></a><span class="lineno">  757</span>   <span class="comment">//    for (int nY = 0; nY &lt; m_nYGridSize; nY++)</span></div>
<div class="line"><a id="l00758" name="l00758"></a><span class="lineno">  758</span>   <span class="comment">//    {</span></div>
<div class="line"><a id="l00759" name="l00759"></a><span class="lineno">  759</span>   <span class="comment">//       for (int nX = 0; nX &lt; m_nXGridSize; nX++)</span></div>
<div class="line"><a id="l00760" name="l00760"></a><span class="lineno">  760</span>   <span class="comment">//       {</span></div>
<div class="line"><a id="l00761" name="l00761"></a><span class="lineno">  761</span>   <span class="comment">//          int nID = m_pRasterGrid-&gt;m_Cell[nX][nY].nGetPolygonID();</span></div>
<div class="line"><a id="l00762" name="l00762"></a><span class="lineno">  762</span>   <span class="comment">//          if (nID == INT_NODATA)</span></div>
<div class="line"><a id="l00763" name="l00763"></a><span class="lineno">  763</span>   <span class="comment">//             nNotInPoly++;</span></div>
<div class="line"><a id="l00764" name="l00764"></a><span class="lineno">  764</span>   <span class="comment">//          else</span></div>
<div class="line"><a id="l00765" name="l00765"></a><span class="lineno">  765</span>   <span class="comment">//             nVPerPoly[nID]++;</span></div>
<div class="line"><a id="l00766" name="l00766"></a><span class="lineno">  766</span>   <span class="comment">//</span></div>
<div class="line"><a id="l00767" name="l00767"></a><span class="lineno">  767</span>   <span class="comment">//          pdRaster[n++] = nID;</span></div>
<div class="line"><a id="l00768" name="l00768"></a><span class="lineno">  768</span>   <span class="comment">//       }</span></div>
<div class="line"><a id="l00769" name="l00769"></a><span class="lineno">  769</span>   <span class="comment">//    }</span></div>
<div class="line"><a id="l00770" name="l00770"></a><span class="lineno">  770</span>   <span class="comment">//</span></div>
<div class="line"><a id="l00771" name="l00771"></a><span class="lineno">  771</span>   <span class="comment">//    GDALRasterBand* pBand = pDataSet-&gt;GetRasterBand(1);</span></div>
<div class="line"><a id="l00772" name="l00772"></a><span class="lineno">  772</span>   <span class="comment">//    pBand-&gt;SetNoDataValue(m_dMissingValue);</span></div>
<div class="line"><a id="l00773" name="l00773"></a><span class="lineno">  773</span>   <span class="comment">//    int nRet = pBand-&gt;RasterIO(GF_Write, 0, 0, m_nXGridSize, m_nYGridSize, pdRaster, m_nXGridSize, m_nYGridSize, GDT_Float64, 0, 0, NULL);</span></div>
<div class="line"><a id="l00774" name="l00774"></a><span class="lineno">  774</span>   <span class="comment">//    if (nRet == CE_Failure)</span></div>
<div class="line"><a id="l00775" name="l00775"></a><span class="lineno">  775</span>   <span class="comment">//       return;</span></div>
<div class="line"><a id="l00776" name="l00776"></a><span class="lineno">  776</span>   <span class="comment">//</span></div>
<div class="line"><a id="l00777" name="l00777"></a><span class="lineno">  777</span>   <span class="comment">//    GDALClose(pDataSet);</span></div>
<div class="line"><a id="l00778" name="l00778"></a><span class="lineno">  778</span>   <span class="comment">//    delete[] pdRaster;</span></div>
<div class="line"><a id="l00779" name="l00779"></a><span class="lineno">  779</span>   <span class="comment">//</span></div>
<div class="line"><a id="l00780" name="l00780"></a><span class="lineno">  780</span>   <span class="comment">//    for (int nn = 0; nn &lt; nNumPoly; nn++)</span></div>
<div class="line"><a id="l00781" name="l00781"></a><span class="lineno">  781</span>   <span class="comment">//       LogStream &lt;&lt; m_ulIter &lt;&lt; &quot;: polygon &quot; &lt;&lt; nn &lt;&lt; &quot; has &quot; &lt;&lt; nVPerPoly[nn] &lt;&lt; &quot; cells&quot; &lt;&lt; endl;</span></div>
<div class="line"><a id="l00782" name="l00782"></a><span class="lineno">  782</span>   <span class="comment">//    LogStream &lt;&lt; m_ulIter &lt;&lt; &quot; Number of cells not in any polygon = &quot; &lt;&lt; nNotInPoly &lt;&lt; endl;</span></div>
<div class="line"><a id="l00783" name="l00783"></a><span class="lineno">  783</span>   <span class="comment">//    LogStream &lt;&lt; &quot;==================&quot; &lt;&lt; endl;</span></div>
<div class="line"><a id="l00784" name="l00784"></a><span class="lineno">  784</span>   <span class="comment">// }</span></div>
<div class="line"><a id="l00785" name="l00785"></a><span class="lineno">  785</span>   <span class="comment">// // DEBUG CODE ===========================================================================================================</span></div>
<div class="line"><a id="l00786" name="l00786"></a><span class="lineno">  786</span>}</div>
</div>
<div class="line"><a id="l00787" name="l00787"></a><span class="lineno">  787</span> </div>
<div class="line"><a id="l00788" name="l00788"></a><span class="lineno">  788</span><span class="comment">//===============================================================================================================================</span></div>
<div class="line"><a id="l00790" name="l00790"></a><span class="lineno">  790</span><span class="comment">//===============================================================================================================================</span></div>
<div class="foldopen" id="foldopen00791" data-start="{" data-end="}">
<div class="line"><a id="l00791" name="l00791"></a><span class="lineno"><a class="line" href="../../d1/d98/classCSimulation.html#af103396c763e8526e49a977ee0e04ddb">  791</a></span><span class="keywordtype">int</span> <a class="code hl_function" href="../../d1/d98/classCSimulation.html#af103396c763e8526e49a977ee0e04ddb">CSimulation::nDoPolygonSharedBoundaries</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a id="l00792" name="l00792"></a><span class="lineno">  792</span>{</div>
<div class="line"><a id="l00793" name="l00793"></a><span class="lineno">  793</span>   <span class="comment">// Do this for every coast</span></div>
<div class="line"><a id="l00794" name="l00794"></a><span class="lineno">  794</span>   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> nCoast = 0; nCoast &lt; static_cast&lt;int&gt;(<a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a25ada8139c82ca7beab3f279cff83184">m_VCoast</a>.size()); nCoast++)</div>
<div class="line"><a id="l00795" name="l00795"></a><span class="lineno">  795</span>   {</div>
<div class="line"><a id="l00796" name="l00796"></a><span class="lineno">  796</span>      <span class="keywordtype">int</span> nNumPolygons = <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a25ada8139c82ca7beab3f279cff83184">m_VCoast</a>[nCoast].nGetNumPolygons();</div>
<div class="line"><a id="l00797" name="l00797"></a><span class="lineno">  797</span> </div>
<div class="line"><a id="l00798" name="l00798"></a><span class="lineno">  798</span>      <span class="comment">// // DEBUG CODE =================</span></div>
<div class="line"><a id="l00799" name="l00799"></a><span class="lineno">  799</span>      <span class="comment">// for (int m = 0; m &lt; m_VCoast[nCoast].nGetNumProfiles(); m++)</span></div>
<div class="line"><a id="l00800" name="l00800"></a><span class="lineno">  800</span>      <span class="comment">// {</span></div>
<div class="line"><a id="l00801" name="l00801"></a><span class="lineno">  801</span>      <span class="comment">//    CGeomProfile* pProfile = m_VCoast[nCoast].pGetProfile(m);</span></div>
<div class="line"><a id="l00802" name="l00802"></a><span class="lineno">  802</span>      <span class="comment">//</span></div>
<div class="line"><a id="l00803" name="l00803"></a><span class="lineno">  803</span>      <span class="comment">//    LogStream &lt;&lt; m &lt;&lt; &quot;\t&quot; &lt;&lt; pProfile-&gt;nGetCoastID() &lt;&lt; &quot;\t&quot; &lt;&lt; pProfile-&gt;nGetGlobalID() &lt;&lt; &quot;\t&quot;;</span></div>
<div class="line"><a id="l00804" name="l00804"></a><span class="lineno">  804</span>      <span class="comment">//</span></div>
<div class="line"><a id="l00805" name="l00805"></a><span class="lineno">  805</span>      <span class="comment">//    int nPointsInProfile = pProfile-&gt;nGetProfileSize();</span></div>
<div class="line"><a id="l00806" name="l00806"></a><span class="lineno">  806</span>      <span class="comment">//</span></div>
<div class="line"><a id="l00807" name="l00807"></a><span class="lineno">  807</span>      <span class="comment">//    for (int nPoint = 0; nPoint &lt; nPointsInProfile; nPoint++)</span></div>
<div class="line"><a id="l00808" name="l00808"></a><span class="lineno">  808</span>      <span class="comment">//    {</span></div>
<div class="line"><a id="l00809" name="l00809"></a><span class="lineno">  809</span>      <span class="comment">//       CGeom2DPoint Pt = *pProfile-&gt;pPtGetPointInProfile(nPoint);</span></div>
<div class="line"><a id="l00810" name="l00810"></a><span class="lineno">  810</span>      <span class="comment">//       LogStream &lt;&lt; &quot;{&quot; &lt;&lt; Pt.dGetX() &lt;&lt; &quot;, &quot; &lt;&lt; Pt.dGetY() &lt;&lt; &quot;}&quot;;</span></div>
<div class="line"><a id="l00811" name="l00811"></a><span class="lineno">  811</span>      <span class="comment">//    }</span></div>
<div class="line"><a id="l00812" name="l00812"></a><span class="lineno">  812</span>      <span class="comment">//    LogStream &lt;&lt; endl;</span></div>
<div class="line"><a id="l00813" name="l00813"></a><span class="lineno">  813</span>      <span class="comment">// }</span></div>
<div class="line"><a id="l00814" name="l00814"></a><span class="lineno">  814</span>      <span class="comment">// // DEBUG CODE =================</span></div>
<div class="line"><a id="l00815" name="l00815"></a><span class="lineno">  815</span> </div>
<div class="line"><a id="l00816" name="l00816"></a><span class="lineno">  816</span>      <span class="comment">// Do this for every coastal polygon, in down-coast sequence</span></div>
<div class="line"><a id="l00817" name="l00817"></a><span class="lineno">  817</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> nn = 0; nn &lt; nNumPolygons; nn++)</div>
<div class="line"><a id="l00818" name="l00818"></a><span class="lineno">  818</span>      {</div>
<div class="line"><a id="l00819" name="l00819"></a><span class="lineno">  819</span>         <a class="code hl_class" href="../../df/d45/classCGeomCoastPolygon.html">CGeomCoastPolygon</a>* pThisPolygon = <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a25ada8139c82ca7beab3f279cff83184">m_VCoast</a>[nCoast].pGetPolygon(nn);</div>
<div class="line"><a id="l00820" name="l00820"></a><span class="lineno">  820</span>         <span class="keywordtype">int</span> nThisPolygon = pThisPolygon-&gt;<a class="code hl_function" href="../../df/d45/classCGeomCoastPolygon.html#ae97ed135e92d392e9b72f83feee59b2b">nGetCoastID</a>();</div>
<div class="line"><a id="l00821" name="l00821"></a><span class="lineno">  821</span> </div>
<div class="line"><a id="l00822" name="l00822"></a><span class="lineno">  822</span>         vector&lt;int&gt; nVUpCoastAdjacentPolygon;</div>
<div class="line"><a id="l00823" name="l00823"></a><span class="lineno">  823</span>         vector&lt;int&gt; nVDownCoastAdjacentPolygon;</div>
<div class="line"><a id="l00824" name="l00824"></a><span class="lineno">  824</span> </div>
<div class="line"><a id="l00825" name="l00825"></a><span class="lineno">  825</span>         vector&lt;double&gt; dVUpCoastBoundaryShare;</div>
<div class="line"><a id="l00826" name="l00826"></a><span class="lineno">  826</span>         vector&lt;double&gt; dVDownCoastBoundaryShare;</div>
<div class="line"><a id="l00827" name="l00827"></a><span class="lineno">  827</span> </div>
<div class="line"><a id="l00828" name="l00828"></a><span class="lineno">  828</span>         <span class="comment">// First deal with down-coast adjacent polygons</span></div>
<div class="line"><a id="l00829" name="l00829"></a><span class="lineno">  829</span>         <span class="keywordflow">if</span> (pThisPolygon-&gt;<a class="code hl_function" href="../../df/d45/classCGeomCoastPolygon.html#a33507ab0cc5f495919d06befd56223c4">bIsCoastEndPolygon</a>())</div>
<div class="line"><a id="l00830" name="l00830"></a><span class="lineno">  830</span>         {</div>
<div class="line"><a id="l00831" name="l00831"></a><span class="lineno">  831</span>            <span class="comment">// We are at the end of the coastline, no other polygon is adjacent to the down-coast profile of the end-of-coast polygon</span></div>
<div class="line"><a id="l00832" name="l00832"></a><span class="lineno">  832</span>            nVDownCoastAdjacentPolygon.push_back(<a class="code hl_variable" href="../../d6/d2a/cme_8h.html#a01aa8b423260b337ddff2016107b51a0">INT_NODATA</a>);</div>
<div class="line"><a id="l00833" name="l00833"></a><span class="lineno">  833</span>            dVDownCoastBoundaryShare.push_back(1);</div>
<div class="line"><a id="l00834" name="l00834"></a><span class="lineno">  834</span> </div>
<div class="line"><a id="l00835" name="l00835"></a><span class="lineno">  835</span>            <span class="comment">// Store in the polygon</span></div>
<div class="line"><a id="l00836" name="l00836"></a><span class="lineno">  836</span>            pThisPolygon-&gt;<a class="code hl_function" href="../../df/d45/classCGeomCoastPolygon.html#ad1df78c11a625b56a193cd5a0ae54192">SetDownCoastAdjacentPolygons</a>(&amp;nVDownCoastAdjacentPolygon);</div>
<div class="line"><a id="l00837" name="l00837"></a><span class="lineno">  837</span>            pThisPolygon-&gt;<a class="code hl_function" href="../../df/d45/classCGeomCoastPolygon.html#a9d56bad783aec1a119fddde1743c50a9">SetDownCoastAdjacentPolygonBoundaryShares</a>(&amp;dVDownCoastBoundaryShare);</div>
<div class="line"><a id="l00838" name="l00838"></a><span class="lineno">  838</span>         }</div>
<div class="line"><a id="l00839" name="l00839"></a><span class="lineno">  839</span>         <span class="keywordflow">else</span></div>
<div class="line"><a id="l00840" name="l00840"></a><span class="lineno">  840</span>         {</div>
<div class="line"><a id="l00841" name="l00841"></a><span class="lineno">  841</span>            <span class="comment">// We are not at the end of the coastline, so there is at least one other polygon adjacent to the down-coast profile of this polygon</span></div>
<div class="line"><a id="l00842" name="l00842"></a><span class="lineno">  842</span>            <span class="keywordtype">int</span> nDownCoastProfile = pThisPolygon-&gt;<a class="code hl_function" href="../../df/d45/classCGeomCoastPolygon.html#ae2119674d8d0b78f27bc53ed463fead2">nGetDownCoastProfile</a>();</div>
<div class="line"><a id="l00843" name="l00843"></a><span class="lineno">  843</span>            <span class="keywordtype">int</span> nPointsInProfile = pThisPolygon-&gt;<a class="code hl_function" href="../../df/d45/classCGeomCoastPolygon.html#a19a835fe7c493f6853cf118fd3584847">nGetNumPointsUsedDownCoastProfile</a>();</div>
<div class="line"><a id="l00844" name="l00844"></a><span class="lineno">  844</span> </div>
<div class="line"><a id="l00845" name="l00845"></a><span class="lineno">  845</span>            <span class="keywordtype">double</span> dDownCoastTotBoundaryLen = 0;</div>
<div class="line"><a id="l00846" name="l00846"></a><span class="lineno">  846</span> </div>
<div class="line"><a id="l00847" name="l00847"></a><span class="lineno">  847</span>            <a class="code hl_class" href="../../da/dae/classCGeomProfile.html">CGeomProfile</a>* pProfile = <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a25ada8139c82ca7beab3f279cff83184">m_VCoast</a>[nCoast].pGetProfile(nDownCoastProfile);</div>
<div class="line"><a id="l00848" name="l00848"></a><span class="lineno">  848</span> </div>
<div class="line"><a id="l00849" name="l00849"></a><span class="lineno">  849</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> nPoint = 0; nPoint &lt; nPointsInProfile-1; nPoint++)</div>
<div class="line"><a id="l00850" name="l00850"></a><span class="lineno">  850</span>            {</div>
<div class="line"><a id="l00851" name="l00851"></a><span class="lineno">  851</span>               <a class="code hl_class" href="../../d5/d4e/classCGeom2DPoint.html">CGeom2DPoint</a> PtStart = *pProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#aaa8ddb9c775927bdb7940f7826f90a74">pPtGetPointInProfile</a>(nPoint);</div>
<div class="line"><a id="l00852" name="l00852"></a><span class="lineno">  852</span>               <a class="code hl_class" href="../../d5/d4e/classCGeom2DPoint.html">CGeom2DPoint</a> PtEnd = *pProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#aaa8ddb9c775927bdb7940f7826f90a74">pPtGetPointInProfile</a>(nPoint+1);</div>
<div class="line"><a id="l00853" name="l00853"></a><span class="lineno">  853</span> </div>
<div class="line"><a id="l00854" name="l00854"></a><span class="lineno">  854</span>               <span class="comment">// Calculate the length of this segment of the normal profile. Note that it should not be zero, since we checked for duplicate points when creating profiles</span></div>
<div class="line"><a id="l00855" name="l00855"></a><span class="lineno">  855</span>               <span class="keywordtype">double</span> dDistBetween = <a class="code hl_function" href="../../d1/d98/classCSimulation.html#a407e01ecfd7c564c74f4474216ce2e16">dGetDistanceBetween</a>(&amp;PtStart, &amp;PtEnd);</div>
<div class="line"><a id="l00856" name="l00856"></a><span class="lineno">  856</span> </div>
<div class="line"><a id="l00857" name="l00857"></a><span class="lineno">  857</span>               <span class="comment">// Find out which polygon is adjacent to each line segment of the polygon&#39;s down-coast profile boundary. The basic approach used is to count the number of coincident profiles in each line segment, and (because we are going down-coast) add this number to &#39;this&#39; polygon&#39;s number. However, some of these coincident profiles may be invalid, so we must count only the valid co-incident profiles</span></div>
<div class="line"><a id="l00858" name="l00858"></a><span class="lineno">  858</span>               <span class="keywordtype">int</span> nNumCoinc = pProfile-&gt;<a class="code hl_function" href="../../d0/d89/classCGeomMultiLine.html#a3516022bd96ee15709653b3bb7cc0155">nGetNumCoincidentProfilesInLineSegment</a>(nPoint);</div>
<div class="line"><a id="l00859" name="l00859"></a><span class="lineno">  859</span>               <span class="keywordtype">int</span> nNumValidCoinc = 0;</div>
<div class="line"><a id="l00860" name="l00860"></a><span class="lineno">  860</span> </div>
<div class="line"><a id="l00861" name="l00861"></a><span class="lineno">  861</span>               <span class="keywordflow">for</span> (<span class="keywordtype">int</span> nCoinc = 0; nCoinc &lt; nNumCoinc; nCoinc++)</div>
<div class="line"><a id="l00862" name="l00862"></a><span class="lineno">  862</span>               {</div>
<div class="line"><a id="l00863" name="l00863"></a><span class="lineno">  863</span>                  <span class="keywordtype">int</span> nProf = pProfile-&gt;<a class="code hl_function" href="../../d0/d89/classCGeomMultiLine.html#a4aef627971905a6679ea17401ad8a4d3">nGetCoincidentProfileForLineSegment</a>(nPoint, nCoinc);</div>
<div class="line"><a id="l00864" name="l00864"></a><span class="lineno">  864</span> </div>
<div class="line"><a id="l00865" name="l00865"></a><span class="lineno">  865</span>                  <span class="comment">// Safety check</span></div>
<div class="line"><a id="l00866" name="l00866"></a><span class="lineno">  866</span>                  <span class="keywordflow">if</span> (nProf == -1)</div>
<div class="line"><a id="l00867" name="l00867"></a><span class="lineno">  867</span>                     <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l00868" name="l00868"></a><span class="lineno">  868</span> </div>
<div class="line"><a id="l00869" name="l00869"></a><span class="lineno">  869</span>                  <a class="code hl_class" href="../../da/dae/classCGeomProfile.html">CGeomProfile</a> <span class="keyword">const</span>* pProf = <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a25ada8139c82ca7beab3f279cff83184">m_VCoast</a>[nCoast].pGetProfile(nProf);</div>
<div class="line"><a id="l00870" name="l00870"></a><span class="lineno">  870</span> </div>
<div class="line"><a id="l00871" name="l00871"></a><span class="lineno">  871</span>                  <span class="keywordflow">if</span> (pProf-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#a8dc4e3ce21668f7149ca11aeb7efadf7">bProfileOK</a>())</div>
<div class="line"><a id="l00872" name="l00872"></a><span class="lineno">  872</span>                     nNumValidCoinc++;</div>
<div class="line"><a id="l00873" name="l00873"></a><span class="lineno">  873</span>               }</div>
<div class="line"><a id="l00874" name="l00874"></a><span class="lineno">  874</span> </div>
<div class="line"><a id="l00875" name="l00875"></a><span class="lineno">  875</span>               <span class="comment">// First stab at calculating the number of the adjacent polygon</span></div>
<div class="line"><a id="l00876" name="l00876"></a><span class="lineno">  876</span>               <span class="keywordtype">int</span> nAdj = nThisPolygon + nNumValidCoinc;</div>
<div class="line"><a id="l00877" name="l00877"></a><span class="lineno">  877</span> </div>
<div class="line"><a id="l00878" name="l00878"></a><span class="lineno">  878</span>               <span class="comment">// However, if &#39;this&#39; polygon is close to the end of the coastline, we get polygon numbers greater than the number of polygons i.e. beyond the end of the coastline. If this happens, set the adjacent polygon to &#39;off-edge&#39;</span></div>
<div class="line"><a id="l00879" name="l00879"></a><span class="lineno">  879</span>               <span class="keywordflow">if</span> (nAdj &gt;= nNumPolygons)</div>
<div class="line"><a id="l00880" name="l00880"></a><span class="lineno">  880</span>                  nAdj = <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#a01aa8b423260b337ddff2016107b51a0">INT_NODATA</a>;</div>
<div class="line"><a id="l00881" name="l00881"></a><span class="lineno">  881</span> </div>
<div class="line"><a id="l00882" name="l00882"></a><span class="lineno">  882</span>               nVDownCoastAdjacentPolygon.push_back(nAdj);</div>
<div class="line"><a id="l00883" name="l00883"></a><span class="lineno">  883</span> </div>
<div class="line"><a id="l00884" name="l00884"></a><span class="lineno">  884</span>               dDownCoastTotBoundaryLen += dDistBetween;</div>
<div class="line"><a id="l00885" name="l00885"></a><span class="lineno">  885</span>               dVDownCoastBoundaryShare.push_back(dDistBetween);</div>
<div class="line"><a id="l00886" name="l00886"></a><span class="lineno">  886</span>            }</div>
<div class="line"><a id="l00887" name="l00887"></a><span class="lineno">  887</span> </div>
<div class="line"><a id="l00888" name="l00888"></a><span class="lineno">  888</span>            <span class="comment">// Calculate the down-coast boundary share</span></div>
<div class="line"><a id="l00889" name="l00889"></a><span class="lineno">  889</span>            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n = 0; n &lt; dVDownCoastBoundaryShare.size(); n++)</div>
<div class="line"><a id="l00890" name="l00890"></a><span class="lineno">  890</span>            {</div>
<div class="line"><a id="l00891" name="l00891"></a><span class="lineno">  891</span>               dVDownCoastBoundaryShare[n] /= dDownCoastTotBoundaryLen;</div>
<div class="line"><a id="l00892" name="l00892"></a><span class="lineno">  892</span> </div>
<div class="line"><a id="l00893" name="l00893"></a><span class="lineno">  893</span>               <span class="comment">// // Safety check</span></div>
<div class="line"><a id="l00894" name="l00894"></a><span class="lineno">  894</span>               <span class="comment">// dVDownCoastBoundaryShare[n] = tMin(dVDownCoastBoundaryShare[n], 1.0);</span></div>
<div class="line"><a id="l00895" name="l00895"></a><span class="lineno">  895</span>            }</div>
<div class="line"><a id="l00896" name="l00896"></a><span class="lineno">  896</span> </div>
<div class="line"><a id="l00897" name="l00897"></a><span class="lineno">  897</span>            <span class="comment">// Store in the polygon</span></div>
<div class="line"><a id="l00898" name="l00898"></a><span class="lineno">  898</span>            pThisPolygon-&gt;<a class="code hl_function" href="../../df/d45/classCGeomCoastPolygon.html#ad1df78c11a625b56a193cd5a0ae54192">SetDownCoastAdjacentPolygons</a>(&amp;nVDownCoastAdjacentPolygon);</div>
<div class="line"><a id="l00899" name="l00899"></a><span class="lineno">  899</span>            pThisPolygon-&gt;<a class="code hl_function" href="../../df/d45/classCGeomCoastPolygon.html#a9d56bad783aec1a119fddde1743c50a9">SetDownCoastAdjacentPolygonBoundaryShares</a>(&amp;dVDownCoastBoundaryShare);</div>
<div class="line"><a id="l00900" name="l00900"></a><span class="lineno">  900</span>         }</div>
<div class="line"><a id="l00901" name="l00901"></a><span class="lineno">  901</span> </div>
<div class="line"><a id="l00902" name="l00902"></a><span class="lineno">  902</span>         <span class="comment">// Now deal with up-coast adjacent polygons</span></div>
<div class="line"><a id="l00903" name="l00903"></a><span class="lineno">  903</span>         <span class="keywordflow">if</span> (pThisPolygon-&gt;<a class="code hl_function" href="../../df/d45/classCGeomCoastPolygon.html#a0bb71766112920d4ac411703bb3ea853">bIsCoastStartPolygon</a>())</div>
<div class="line"><a id="l00904" name="l00904"></a><span class="lineno">  904</span>         {</div>
<div class="line"><a id="l00905" name="l00905"></a><span class="lineno">  905</span>            <span class="comment">// We are at the start of the coastline, no other polygon is adjacent to the up-coast profile of the start-of-coast polygon</span></div>
<div class="line"><a id="l00906" name="l00906"></a><span class="lineno">  906</span>            nVUpCoastAdjacentPolygon.push_back(<a class="code hl_variable" href="../../d6/d2a/cme_8h.html#a01aa8b423260b337ddff2016107b51a0">INT_NODATA</a>);</div>
<div class="line"><a id="l00907" name="l00907"></a><span class="lineno">  907</span>            dVUpCoastBoundaryShare.push_back(1);</div>
<div class="line"><a id="l00908" name="l00908"></a><span class="lineno">  908</span> </div>
<div class="line"><a id="l00909" name="l00909"></a><span class="lineno">  909</span>            <span class="comment">// Store in the polygon</span></div>
<div class="line"><a id="l00910" name="l00910"></a><span class="lineno">  910</span>            pThisPolygon-&gt;<a class="code hl_function" href="../../df/d45/classCGeomCoastPolygon.html#adbd8b304081b250addc82262b474ed08">SetUpCoastAdjacentPolygons</a>(&amp;nVUpCoastAdjacentPolygon);</div>
<div class="line"><a id="l00911" name="l00911"></a><span class="lineno">  911</span>            pThisPolygon-&gt;<a class="code hl_function" href="../../df/d45/classCGeomCoastPolygon.html#ad68047ef4a4f8e908858e960a0be4b05">SetUpCoastAdjacentPolygonBoundaryShares</a>(&amp;dVUpCoastBoundaryShare);</div>
<div class="line"><a id="l00912" name="l00912"></a><span class="lineno">  912</span>         }</div>
<div class="line"><a id="l00913" name="l00913"></a><span class="lineno">  913</span>         <span class="keywordflow">else</span></div>
<div class="line"><a id="l00914" name="l00914"></a><span class="lineno">  914</span>         {</div>
<div class="line"><a id="l00915" name="l00915"></a><span class="lineno">  915</span>            <span class="comment">// We are not at the start of the coastline, so there is at least one other polygon adjacent to the up-coast profile of this polygon</span></div>
<div class="line"><a id="l00916" name="l00916"></a><span class="lineno">  916</span>            <span class="keywordtype">int</span> nUpCoastProfile = pThisPolygon-&gt;<a class="code hl_function" href="../../df/d45/classCGeomCoastPolygon.html#aa717d51fde4419cad26236395d047b71">nGetUpCoastProfile</a>();</div>
<div class="line"><a id="l00917" name="l00917"></a><span class="lineno">  917</span>            <span class="keywordtype">int</span> nPointsInProfile = pThisPolygon-&gt;<a class="code hl_function" href="../../df/d45/classCGeomCoastPolygon.html#a4a4ebf349a33da816f84f7b3f84c1b1e">nGetNumPointsUsedUpCoastProfile</a>();</div>
<div class="line"><a id="l00918" name="l00918"></a><span class="lineno">  918</span> </div>
<div class="line"><a id="l00919" name="l00919"></a><span class="lineno">  919</span>            <span class="keywordtype">double</span> dUpCoastTotBoundaryLen = 0;</div>
<div class="line"><a id="l00920" name="l00920"></a><span class="lineno">  920</span> </div>
<div class="line"><a id="l00921" name="l00921"></a><span class="lineno">  921</span>            <a class="code hl_class" href="../../da/dae/classCGeomProfile.html">CGeomProfile</a>* pProfile = <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a25ada8139c82ca7beab3f279cff83184">m_VCoast</a>[nCoast].pGetProfile(nUpCoastProfile);</div>
<div class="line"><a id="l00922" name="l00922"></a><span class="lineno">  922</span> </div>
<div class="line"><a id="l00923" name="l00923"></a><span class="lineno">  923</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> nPoint = 0; nPoint &lt; nPointsInProfile-1; nPoint++)</div>
<div class="line"><a id="l00924" name="l00924"></a><span class="lineno">  924</span>            {</div>
<div class="line"><a id="l00925" name="l00925"></a><span class="lineno">  925</span>               <a class="code hl_class" href="../../d5/d4e/classCGeom2DPoint.html">CGeom2DPoint</a> PtStart = *pProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#aaa8ddb9c775927bdb7940f7826f90a74">pPtGetPointInProfile</a>(nPoint);</div>
<div class="line"><a id="l00926" name="l00926"></a><span class="lineno">  926</span>               <a class="code hl_class" href="../../d5/d4e/classCGeom2DPoint.html">CGeom2DPoint</a> PtEnd = *pProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#aaa8ddb9c775927bdb7940f7826f90a74">pPtGetPointInProfile</a>(nPoint+1);</div>
<div class="line"><a id="l00927" name="l00927"></a><span class="lineno">  927</span> </div>
<div class="line"><a id="l00928" name="l00928"></a><span class="lineno">  928</span>               <span class="comment">// Calculate the length of this segment of the normal profile. Note that it should not be zero, since we checked for duplicate points when creating profiles</span></div>
<div class="line"><a id="l00929" name="l00929"></a><span class="lineno">  929</span>               <span class="keywordtype">double</span> dDistBetween = <a class="code hl_function" href="../../d1/d98/classCSimulation.html#a407e01ecfd7c564c74f4474216ce2e16">dGetDistanceBetween</a>(&amp;PtStart, &amp;PtEnd);</div>
<div class="line"><a id="l00930" name="l00930"></a><span class="lineno">  930</span> </div>
<div class="line"><a id="l00931" name="l00931"></a><span class="lineno">  931</span>               <span class="comment">// Find out which polygon is adjacent to each line segment of the polygon&#39;s up-coast profile boundary. The basic approach used is to count the number of coincident profiles in each line segment, and (because we are going up-coast) subtract this number from &#39;this&#39; polygon&#39;s number. However, some of these coincident profiles may be invalid, so we must count only the valid co-incident profiles</span></div>
<div class="line"><a id="l00932" name="l00932"></a><span class="lineno">  932</span>               <span class="keywordtype">int</span> nNumCoinc = pProfile-&gt;<a class="code hl_function" href="../../d0/d89/classCGeomMultiLine.html#a3516022bd96ee15709653b3bb7cc0155">nGetNumCoincidentProfilesInLineSegment</a>(nPoint);</div>
<div class="line"><a id="l00933" name="l00933"></a><span class="lineno">  933</span>               <span class="keywordtype">int</span> nNumValidCoinc = 0;</div>
<div class="line"><a id="l00934" name="l00934"></a><span class="lineno">  934</span> </div>
<div class="line"><a id="l00935" name="l00935"></a><span class="lineno">  935</span>               <span class="keywordflow">for</span> (<span class="keywordtype">int</span> nCoinc = 0; nCoinc &lt; nNumCoinc; nCoinc++)</div>
<div class="line"><a id="l00936" name="l00936"></a><span class="lineno">  936</span>               {</div>
<div class="line"><a id="l00937" name="l00937"></a><span class="lineno">  937</span>                  <span class="keywordtype">int</span> nProf = pProfile-&gt;<a class="code hl_function" href="../../d0/d89/classCGeomMultiLine.html#a4aef627971905a6679ea17401ad8a4d3">nGetCoincidentProfileForLineSegment</a>(nPoint, nCoinc);</div>
<div class="line"><a id="l00938" name="l00938"></a><span class="lineno">  938</span> </div>
<div class="line"><a id="l00939" name="l00939"></a><span class="lineno">  939</span>                  <span class="comment">// Safety check</span></div>
<div class="line"><a id="l00940" name="l00940"></a><span class="lineno">  940</span>                  <span class="keywordflow">if</span> (nProf == -1)</div>
<div class="line"><a id="l00941" name="l00941"></a><span class="lineno">  941</span>                     <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l00942" name="l00942"></a><span class="lineno">  942</span> </div>
<div class="line"><a id="l00943" name="l00943"></a><span class="lineno">  943</span>                  <a class="code hl_class" href="../../da/dae/classCGeomProfile.html">CGeomProfile</a> <span class="keyword">const</span>* pProf = <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a25ada8139c82ca7beab3f279cff83184">m_VCoast</a>[nCoast].pGetProfile(nProf);</div>
<div class="line"><a id="l00944" name="l00944"></a><span class="lineno">  944</span> </div>
<div class="line"><a id="l00945" name="l00945"></a><span class="lineno">  945</span>                  <span class="keywordflow">if</span> (pProf-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#a8dc4e3ce21668f7149ca11aeb7efadf7">bProfileOK</a>())</div>
<div class="line"><a id="l00946" name="l00946"></a><span class="lineno">  946</span>                     nNumValidCoinc++;</div>
<div class="line"><a id="l00947" name="l00947"></a><span class="lineno">  947</span>               }</div>
<div class="line"><a id="l00948" name="l00948"></a><span class="lineno">  948</span> </div>
<div class="line"><a id="l00949" name="l00949"></a><span class="lineno">  949</span>               <span class="comment">// First stab at calculating the number of the adjacent polygon</span></div>
<div class="line"><a id="l00950" name="l00950"></a><span class="lineno">  950</span>               <span class="keywordtype">int</span> nAdj = nThisPolygon - nNumValidCoinc;</div>
<div class="line"><a id="l00951" name="l00951"></a><span class="lineno">  951</span> </div>
<div class="line"><a id="l00952" name="l00952"></a><span class="lineno">  952</span>               <span class="comment">// However, if &#39;this&#39; polygon is close to the start of the coastline, we get polygon numbers below zero i.e. beyond the start of the coastline. If this happens, set the adjacent polygon to &#39;off-edge&#39;</span></div>
<div class="line"><a id="l00953" name="l00953"></a><span class="lineno">  953</span>               <span class="keywordflow">if</span> (nAdj &lt; 0)</div>
<div class="line"><a id="l00954" name="l00954"></a><span class="lineno">  954</span>                  nAdj = <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#a01aa8b423260b337ddff2016107b51a0">INT_NODATA</a>;</div>
<div class="line"><a id="l00955" name="l00955"></a><span class="lineno">  955</span> </div>
<div class="line"><a id="l00956" name="l00956"></a><span class="lineno">  956</span>               nVUpCoastAdjacentPolygon.push_back(nAdj);</div>
<div class="line"><a id="l00957" name="l00957"></a><span class="lineno">  957</span> </div>
<div class="line"><a id="l00958" name="l00958"></a><span class="lineno">  958</span>               dUpCoastTotBoundaryLen += dDistBetween;</div>
<div class="line"><a id="l00959" name="l00959"></a><span class="lineno">  959</span>               dVUpCoastBoundaryShare.push_back(dDistBetween);</div>
<div class="line"><a id="l00960" name="l00960"></a><span class="lineno">  960</span>            }</div>
<div class="line"><a id="l00961" name="l00961"></a><span class="lineno">  961</span> </div>
<div class="line"><a id="l00962" name="l00962"></a><span class="lineno">  962</span>            <span class="comment">// Calculate the up-coast boundary share</span></div>
<div class="line"><a id="l00963" name="l00963"></a><span class="lineno">  963</span>            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n = 0; n &lt; dVUpCoastBoundaryShare.size(); n++)</div>
<div class="line"><a id="l00964" name="l00964"></a><span class="lineno">  964</span>            {</div>
<div class="line"><a id="l00965" name="l00965"></a><span class="lineno">  965</span>               dVUpCoastBoundaryShare[n] /= dUpCoastTotBoundaryLen;</div>
<div class="line"><a id="l00966" name="l00966"></a><span class="lineno">  966</span> </div>
<div class="line"><a id="l00967" name="l00967"></a><span class="lineno">  967</span>               <span class="comment">// // Safety check</span></div>
<div class="line"><a id="l00968" name="l00968"></a><span class="lineno">  968</span>               <span class="comment">// dVUpCoastBoundaryShare[n] = tMin(dVUpCoastBoundaryShare[n], 1.0);</span></div>
<div class="line"><a id="l00969" name="l00969"></a><span class="lineno">  969</span>            }</div>
<div class="line"><a id="l00970" name="l00970"></a><span class="lineno">  970</span> </div>
<div class="line"><a id="l00971" name="l00971"></a><span class="lineno">  971</span>            <span class="comment">// Store in the polygon</span></div>
<div class="line"><a id="l00972" name="l00972"></a><span class="lineno">  972</span>            pThisPolygon-&gt;<a class="code hl_function" href="../../df/d45/classCGeomCoastPolygon.html#adbd8b304081b250addc82262b474ed08">SetUpCoastAdjacentPolygons</a>(&amp;nVUpCoastAdjacentPolygon);</div>
<div class="line"><a id="l00973" name="l00973"></a><span class="lineno">  973</span>            pThisPolygon-&gt;<a class="code hl_function" href="../../df/d45/classCGeomCoastPolygon.html#ad68047ef4a4f8e908858e960a0be4b05">SetUpCoastAdjacentPolygonBoundaryShares</a>(&amp;dVUpCoastBoundaryShare);</div>
<div class="line"><a id="l00974" name="l00974"></a><span class="lineno">  974</span>         }</div>
<div class="line"><a id="l00975" name="l00975"></a><span class="lineno">  975</span> </div>
<div class="line"><a id="l00976" name="l00976"></a><span class="lineno">  976</span>         <span class="comment">// Finally, calculate the distance between the coast node and the antinode of the polygon</span></div>
<div class="line"><a id="l00977" name="l00977"></a><span class="lineno">  977</span>         <span class="keywordtype">double</span> dPolygonSeawardLen = <a class="code hl_function" href="../../d1/d98/classCSimulation.html#a407e01ecfd7c564c74f4474216ce2e16">dGetDistanceBetween</a>(pThisPolygon-&gt;<a class="code hl_function" href="../../df/d45/classCGeomCoastPolygon.html#afc6527b76b30e3b0205c65212db99619">pPtiGetNode</a>(), pThisPolygon-&gt;<a class="code hl_function" href="../../df/d45/classCGeomCoastPolygon.html#a26cb239af6081440054114897f4e9332">pPtiGetAntiNode</a>());</div>
<div class="line"><a id="l00978" name="l00978"></a><span class="lineno">  978</span> </div>
<div class="line"><a id="l00979" name="l00979"></a><span class="lineno">  979</span>         <span class="comment">// And store it</span></div>
<div class="line"><a id="l00980" name="l00980"></a><span class="lineno">  980</span>         pThisPolygon-&gt;<a class="code hl_function" href="../../df/d45/classCGeomCoastPolygon.html#aa8f98c270b2bc6e4a5665bf60a41c8af">SetLength</a>(dPolygonSeawardLen);</div>
<div class="line"><a id="l00981" name="l00981"></a><span class="lineno">  981</span> </div>
<div class="line"><a id="l00982" name="l00982"></a><span class="lineno">  982</span>         <span class="comment">// // DEBUG CODE ======================================================================================================================</span></div>
<div class="line"><a id="l00983" name="l00983"></a><span class="lineno">  983</span>         <span class="comment">// assert(dVUpCoastBoundaryShare.size() == nVUpCoastAdjacentPolygon.size());</span></div>
<div class="line"><a id="l00984" name="l00984"></a><span class="lineno">  984</span>         <span class="comment">// assert(dVDownCoastBoundaryShare.size() == nVDownCoastAdjacentPolygon.size());</span></div>
<div class="line"><a id="l00985" name="l00985"></a><span class="lineno">  985</span>         <span class="comment">//</span></div>
<div class="line"><a id="l00986" name="l00986"></a><span class="lineno">  986</span>         <span class="comment">//             LogStream &lt;&lt; m_ulIter &lt;&lt; &quot;: polygon = &quot; &lt;&lt; nPoly &lt;&lt; (pPolygon-&gt;bIsPointed() ? &quot; IS TRIANGULAR&quot; : &quot;&quot;) &lt;&lt; endl;</span></div>
<div class="line"><a id="l00987" name="l00987"></a><span class="lineno">  987</span>         <span class="comment">// LogStream &lt;&lt; m_ulIter &lt;&lt; &quot;: coast &quot; &lt;&lt; nCoast &lt;&lt; &quot; polygon &quot; &lt;&lt; nThisPolygon &lt;&lt; endl;</span></div>
<div class="line"><a id="l00988" name="l00988"></a><span class="lineno">  988</span>         <span class="comment">//</span></div>
<div class="line"><a id="l00989" name="l00989"></a><span class="lineno">  989</span>         <span class="comment">// int nUpCoastProfile = pThisPolygon-&gt;nGetUpCoastProfile();</span></div>
<div class="line"><a id="l00990" name="l00990"></a><span class="lineno">  990</span>         <span class="comment">// CGeomProfile* pUpCoastProfile = m_VCoast[0].pGetProfile(nUpCoastProfile);</span></div>
<div class="line"><a id="l00991" name="l00991"></a><span class="lineno">  991</span>         <span class="comment">// int nUpCoastProfileCells = pUpCoastProfile-&gt;nGetNumCellsInProfile();</span></div>
<div class="line"><a id="l00992" name="l00992"></a><span class="lineno">  992</span>         <span class="comment">//</span></div>
<div class="line"><a id="l00993" name="l00993"></a><span class="lineno">  993</span>         <span class="comment">// int nDownCoastProfile = pThisPolygon-&gt;nGetDownCoastProfile();</span></div>
<div class="line"><a id="l00994" name="l00994"></a><span class="lineno">  994</span>         <span class="comment">// CGeomProfile* pDownCoastProfile = m_VCoast[0].pGetProfile(nDownCoastProfile);</span></div>
<div class="line"><a id="l00995" name="l00995"></a><span class="lineno">  995</span>         <span class="comment">// int nDownCoastProfileCells = pDownCoastProfile-&gt;nGetNumCellsInProfile();</span></div>
<div class="line"><a id="l00996" name="l00996"></a><span class="lineno">  996</span>         <span class="comment">//</span></div>
<div class="line"><a id="l00997" name="l00997"></a><span class="lineno">  997</span>         <span class="comment">// LogStream &lt;&lt; &quot;\tUp-coast profile = &quot; &lt;&lt; nUpCoastProfile &lt;&lt; &quot; down-coast profile = &quot; &lt;&lt; nDownCoastProfile &lt;&lt; endl;</span></div>
<div class="line"><a id="l00998" name="l00998"></a><span class="lineno">  998</span>         <span class="comment">// LogStream &lt;&lt; &quot;\tN cells in up-coast profile = &quot; &lt;&lt; nUpCoastProfileCells &lt;&lt; &quot; N cells in down-coast profile = &quot; &lt;&lt; nDownCoastProfileCells &lt;&lt; endl;</span></div>
<div class="line"><a id="l00999" name="l00999"></a><span class="lineno">  999</span>         <span class="comment">//</span></div>
<div class="line"><a id="l01000" name="l01000"></a><span class="lineno"> 1000</span>         <span class="comment">// LogStream &lt;&lt; &quot;\tThere are &quot; &lt;&lt; nVUpCoastAdjacentPolygon.size() &lt;&lt; &quot; UP-COAST adjacent polygon(s) = &quot;;</span></div>
<div class="line"><a id="l01001" name="l01001"></a><span class="lineno"> 1001</span>         <span class="comment">// for (unsigned int n = 0; n &lt; nVUpCoastAdjacentPolygon.size(); n++)</span></div>
<div class="line"><a id="l01002" name="l01002"></a><span class="lineno"> 1002</span>         <span class="comment">//    LogStream &lt;&lt; nVUpCoastAdjacentPolygon[n] &lt;&lt; &quot; &quot;;</span></div>
<div class="line"><a id="l01003" name="l01003"></a><span class="lineno"> 1003</span>         <span class="comment">// LogStream &lt;&lt; endl;</span></div>
<div class="line"><a id="l01004" name="l01004"></a><span class="lineno"> 1004</span>         <span class="comment">//</span></div>
<div class="line"><a id="l01005" name="l01005"></a><span class="lineno"> 1005</span>         <span class="comment">// LogStream &lt;&lt; &quot;\tThere are &quot; &lt;&lt; nVDownCoastAdjacentPolygon.size() &lt;&lt; &quot; DOWN-COAST adjacent polygon(s) = &quot;;</span></div>
<div class="line"><a id="l01006" name="l01006"></a><span class="lineno"> 1006</span>         <span class="comment">// for (unsigned int n = 0; n &lt; nVDownCoastAdjacentPolygon.size(); n++)</span></div>
<div class="line"><a id="l01007" name="l01007"></a><span class="lineno"> 1007</span>         <span class="comment">//    LogStream &lt;&lt; nVDownCoastAdjacentPolygon[n] &lt;&lt; &quot; &quot;;</span></div>
<div class="line"><a id="l01008" name="l01008"></a><span class="lineno"> 1008</span>         <span class="comment">// LogStream &lt;&lt; endl;</span></div>
<div class="line"><a id="l01009" name="l01009"></a><span class="lineno"> 1009</span>         <span class="comment">//</span></div>
<div class="line"><a id="l01010" name="l01010"></a><span class="lineno"> 1010</span>         <span class="comment">// double dUpCoastTotBoundaryLen = 0;</span></div>
<div class="line"><a id="l01011" name="l01011"></a><span class="lineno"> 1011</span>         <span class="comment">// LogStream &lt;&lt; &quot;\tUP-COAST boundary share(s) = &quot;;</span></div>
<div class="line"><a id="l01012" name="l01012"></a><span class="lineno"> 1012</span>         <span class="comment">// for (unsigned int n = 0; n &lt; dVUpCoastBoundaryShare.size(); n++)</span></div>
<div class="line"><a id="l01013" name="l01013"></a><span class="lineno"> 1013</span>         <span class="comment">// {</span></div>
<div class="line"><a id="l01014" name="l01014"></a><span class="lineno"> 1014</span>         <span class="comment">//    dUpCoastTotBoundaryLen += dVUpCoastBoundaryShare[n];</span></div>
<div class="line"><a id="l01015" name="l01015"></a><span class="lineno"> 1015</span>         <span class="comment">//    LogStream &lt;&lt; dVUpCoastBoundaryShare[n] &lt;&lt; &quot; &quot;;</span></div>
<div class="line"><a id="l01016" name="l01016"></a><span class="lineno"> 1016</span>         <span class="comment">// }</span></div>
<div class="line"><a id="l01017" name="l01017"></a><span class="lineno"> 1017</span>         <span class="comment">// LogStream &lt;&lt; endl;</span></div>
<div class="line"><a id="l01018" name="l01018"></a><span class="lineno"> 1018</span>         <span class="comment">// LogStream &lt;&lt; &quot;\tTotal UP-COAST boundary length = &quot; &lt;&lt; dUpCoastTotBoundaryLen &lt;&lt; endl;</span></div>
<div class="line"><a id="l01019" name="l01019"></a><span class="lineno"> 1019</span>         <span class="comment">//</span></div>
<div class="line"><a id="l01020" name="l01020"></a><span class="lineno"> 1020</span>         <span class="comment">// double dDownCoastTotBoundaryLen = 0;</span></div>
<div class="line"><a id="l01021" name="l01021"></a><span class="lineno"> 1021</span>         <span class="comment">// LogStream &lt;&lt; &quot;\tDOWN-COAST boundary share(s) = &quot;;</span></div>
<div class="line"><a id="l01022" name="l01022"></a><span class="lineno"> 1022</span>         <span class="comment">// for (unsigned int n = 0; n &lt; dVDownCoastBoundaryShare.size(); n++)</span></div>
<div class="line"><a id="l01023" name="l01023"></a><span class="lineno"> 1023</span>         <span class="comment">// {</span></div>
<div class="line"><a id="l01024" name="l01024"></a><span class="lineno"> 1024</span>         <span class="comment">//    dDownCoastTotBoundaryLen += dVDownCoastBoundaryShare[n];</span></div>
<div class="line"><a id="l01025" name="l01025"></a><span class="lineno"> 1025</span>         <span class="comment">//    LogStream &lt;&lt; dVDownCoastBoundaryShare[n] &lt;&lt; &quot; &quot;;</span></div>
<div class="line"><a id="l01026" name="l01026"></a><span class="lineno"> 1026</span>         <span class="comment">// }</span></div>
<div class="line"><a id="l01027" name="l01027"></a><span class="lineno"> 1027</span>         <span class="comment">// LogStream &lt;&lt; endl;</span></div>
<div class="line"><a id="l01028" name="l01028"></a><span class="lineno"> 1028</span>         <span class="comment">// LogStream &lt;&lt; &quot;\tTotal DOWN-COAST boundary length = &quot; &lt;&lt; dDownCoastTotBoundaryLen &lt;&lt; endl;</span></div>
<div class="line"><a id="l01029" name="l01029"></a><span class="lineno"> 1029</span>         <span class="comment">// // DEBUG CODE ======================================================================================================================</span></div>
<div class="line"><a id="l01030" name="l01030"></a><span class="lineno"> 1030</span>      }</div>
<div class="line"><a id="l01031" name="l01031"></a><span class="lineno"> 1031</span>   }</div>
<div class="line"><a id="l01032" name="l01032"></a><span class="lineno"> 1032</span> </div>
<div class="line"><a id="l01033" name="l01033"></a><span class="lineno"> 1033</span>   <span class="comment">// // DEBUG CODE =================================================================================</span></div>
<div class="line"><a id="l01034" name="l01034"></a><span class="lineno"> 1034</span>   <span class="comment">// for (int nCoast = 0; nCoast &lt; static_cast&lt;int&gt;(m_VCoast.size()); nCoast++)</span></div>
<div class="line"><a id="l01035" name="l01035"></a><span class="lineno"> 1035</span>   <span class="comment">// {</span></div>
<div class="line"><a id="l01036" name="l01036"></a><span class="lineno"> 1036</span>   <span class="comment">//    int nNumPoly = m_VCoast[nCoast].nGetNumPolygons();</span></div>
<div class="line"><a id="l01037" name="l01037"></a><span class="lineno"> 1037</span>   <span class="comment">//    for (int nPoly = 0; nPoly &lt; nNumPoly; nPoly++)</span></div>
<div class="line"><a id="l01038" name="l01038"></a><span class="lineno"> 1038</span>   <span class="comment">//    {</span></div>
<div class="line"><a id="l01039" name="l01039"></a><span class="lineno"> 1039</span>   <span class="comment">//       CGeomCoastPolygon const* pPolygon = m_VCoast[nCoast].pGetPolygon(nPoly);</span></div>
<div class="line"><a id="l01040" name="l01040"></a><span class="lineno"> 1040</span>   <span class="comment">//</span></div>
<div class="line"><a id="l01041" name="l01041"></a><span class="lineno"> 1041</span>   <span class="comment">//       int nNumUpCoastPolygons = pPolygon-&gt;nGetNumUpCoastAdjacentPolygons();</span></div>
<div class="line"><a id="l01042" name="l01042"></a><span class="lineno"> 1042</span>   <span class="comment">//       LogStream &lt;&lt; &quot;Polygon &quot; &lt;&lt; nPoly &lt;&lt; &quot; up-coast polygon(s) = &quot;;</span></div>
<div class="line"><a id="l01043" name="l01043"></a><span class="lineno"> 1043</span>   <span class="comment">//       for (int nAdj = 0; nAdj &lt; nNumUpCoastPolygons; nAdj++)</span></div>
<div class="line"><a id="l01044" name="l01044"></a><span class="lineno"> 1044</span>   <span class="comment">//       {</span></div>
<div class="line"><a id="l01045" name="l01045"></a><span class="lineno"> 1045</span>   <span class="comment">//          int nAdjPoly = pPolygon-&gt;nGetUpCoastAdjacentPolygon(nAdj);</span></div>
<div class="line"><a id="l01046" name="l01046"></a><span class="lineno"> 1046</span>   <span class="comment">//          LogStream &lt;&lt; nAdjPoly;</span></div>
<div class="line"><a id="l01047" name="l01047"></a><span class="lineno"> 1047</span>   <span class="comment">//          if (nAdjPoly &gt; nNumPoly-1)</span></div>
<div class="line"><a id="l01048" name="l01048"></a><span class="lineno"> 1048</span>   <span class="comment">//             LogStream &lt;&lt; &quot;***&quot;;</span></div>
<div class="line"><a id="l01049" name="l01049"></a><span class="lineno"> 1049</span>   <span class="comment">//       }</span></div>
<div class="line"><a id="l01050" name="l01050"></a><span class="lineno"> 1050</span>   <span class="comment">//</span></div>
<div class="line"><a id="l01051" name="l01051"></a><span class="lineno"> 1051</span>   <span class="comment">//       int nNumDownCoastPolygons = pPolygon-&gt;nGetNumDownCoastAdjacentPolygons();</span></div>
<div class="line"><a id="l01052" name="l01052"></a><span class="lineno"> 1052</span>   <span class="comment">//       LogStream &lt;&lt; &quot; down-coast polygon(s) = &quot;;</span></div>
<div class="line"><a id="l01053" name="l01053"></a><span class="lineno"> 1053</span>   <span class="comment">//       for (int nAdj = 0; nAdj &lt; nNumDownCoastPolygons; nAdj++)</span></div>
<div class="line"><a id="l01054" name="l01054"></a><span class="lineno"> 1054</span>   <span class="comment">//       {</span></div>
<div class="line"><a id="l01055" name="l01055"></a><span class="lineno"> 1055</span>   <span class="comment">//          int nAdjPoly = pPolygon-&gt;nGetDownCoastAdjacentPolygon(nAdj);</span></div>
<div class="line"><a id="l01056" name="l01056"></a><span class="lineno"> 1056</span>   <span class="comment">//          LogStream &lt;&lt; nAdjPoly;</span></div>
<div class="line"><a id="l01057" name="l01057"></a><span class="lineno"> 1057</span>   <span class="comment">//          if (nAdjPoly &gt; nNumPoly-1)</span></div>
<div class="line"><a id="l01058" name="l01058"></a><span class="lineno"> 1058</span>   <span class="comment">//             LogStream &lt;&lt; &quot;***&quot;;</span></div>
<div class="line"><a id="l01059" name="l01059"></a><span class="lineno"> 1059</span>   <span class="comment">//       }</span></div>
<div class="line"><a id="l01060" name="l01060"></a><span class="lineno"> 1060</span>   <span class="comment">//       LogStream &lt;&lt; endl;</span></div>
<div class="line"><a id="l01061" name="l01061"></a><span class="lineno"> 1061</span>   <span class="comment">//    }</span></div>
<div class="line"><a id="l01062" name="l01062"></a><span class="lineno"> 1062</span>   <span class="comment">// }</span></div>
<div class="line"><a id="l01063" name="l01063"></a><span class="lineno"> 1063</span>   <span class="comment">// // DEBUG CODE =================================================================================</span></div>
<div class="line"><a id="l01064" name="l01064"></a><span class="lineno"> 1064</span> </div>
<div class="line"><a id="l01065" name="l01065"></a><span class="lineno"> 1065</span>   <span class="keywordflow">return</span> <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#aa768cb14b5c6123ee95e6e4ebd9fe331">RTN_OK</a>;</div>
<div class="line"><a id="l01066" name="l01066"></a><span class="lineno"> 1066</span>}</div>
</div>
<div class="line"><a id="l01067" name="l01067"></a><span class="lineno"> 1067</span> </div>
<div class="line"><a id="l01068" name="l01068"></a><span class="lineno"> 1068</span><span class="comment">//===============================================================================================================================</span></div>
<div class="line"><a id="l01070" name="l01070"></a><span class="lineno"> 1070</span><span class="comment">//===============================================================================================================================</span></div>
<div class="foldopen" id="foldopen01071" data-start="{" data-end="}">
<div class="line"><a id="l01071" name="l01071"></a><span class="lineno"><a class="line" href="../../d1/d98/classCSimulation.html#af26b975e1c0f041d6fdaaf83065ef2c8"> 1071</a></span><span class="keywordtype">bool</span> <a class="code hl_function" href="../../d1/d98/classCSimulation.html#af26b975e1c0f041d6fdaaf83065ef2c8">CSimulation::bIsWithinPolygon</a>(<a class="code hl_class" href="../../d5/d4e/classCGeom2DPoint.html">CGeom2DPoint</a> <span class="keyword">const</span>* pPtStart, vector&lt;CGeom2DPoint&gt; <span class="keyword">const</span>* pPtPoints)</div>
<div class="line"><a id="l01072" name="l01072"></a><span class="lineno"> 1072</span>{</div>
<div class="line"><a id="l01073" name="l01073"></a><span class="lineno"> 1073</span>   <span class="keywordtype">bool</span> bOddNodes = <span class="keyword">false</span>;</div>
<div class="line"><a id="l01074" name="l01074"></a><span class="lineno"> 1074</span> </div>
<div class="line"><a id="l01075" name="l01075"></a><span class="lineno"> 1075</span>   <span class="keywordtype">int</span> nPolyCorners = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(pPtPoints-&gt;size());</div>
<div class="line"><a id="l01076" name="l01076"></a><span class="lineno"> 1076</span>   <span class="keywordtype">int</span> j = nPolyCorners-1;</div>
<div class="line"><a id="l01077" name="l01077"></a><span class="lineno"> 1077</span> </div>
<div class="line"><a id="l01078" name="l01078"></a><span class="lineno"> 1078</span>   <span class="keywordtype">double</span> dX = pPtStart-&gt;<a class="code hl_function" href="../../d5/d4e/classCGeom2DPoint.html#a250f937d03cfdf6e0244b74ad2bf96a4">dGetX</a>();</div>
<div class="line"><a id="l01079" name="l01079"></a><span class="lineno"> 1079</span>   <span class="keywordtype">double</span> dY = pPtStart-&gt;<a class="code hl_function" href="../../d5/d4e/classCGeom2DPoint.html#a216921dc2c592d9468e6430fee7c7719">dGetY</a>();</div>
<div class="line"><a id="l01080" name="l01080"></a><span class="lineno"> 1080</span> </div>
<div class="line"><a id="l01081" name="l01081"></a><span class="lineno"> 1081</span>   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nPolyCorners; i++)</div>
<div class="line"><a id="l01082" name="l01082"></a><span class="lineno"> 1082</span>   {</div>
<div class="line"><a id="l01083" name="l01083"></a><span class="lineno"> 1083</span>      <span class="keywordtype">double</span> dCorneriX = pPtPoints-&gt;at(i).dGetX();</div>
<div class="line"><a id="l01084" name="l01084"></a><span class="lineno"> 1084</span>      <span class="keywordtype">double</span> dCorneriY = pPtPoints-&gt;at(i).dGetY();</div>
<div class="line"><a id="l01085" name="l01085"></a><span class="lineno"> 1085</span>      <span class="keywordtype">double</span> dCornerjX = pPtPoints-&gt;at(j).dGetX();</div>
<div class="line"><a id="l01086" name="l01086"></a><span class="lineno"> 1086</span>      <span class="keywordtype">double</span> dCornerjY = pPtPoints-&gt;at(j).dGetY();</div>
<div class="line"><a id="l01087" name="l01087"></a><span class="lineno"> 1087</span> </div>
<div class="line"><a id="l01088" name="l01088"></a><span class="lineno"> 1088</span>      <span class="keywordflow">if</span> ((dCorneriY &lt; dY &amp;&amp; dCornerjY &gt;= dY) || (dCornerjY &lt; dY &amp;&amp; dCorneriY &gt;= dY))</div>
<div class="line"><a id="l01089" name="l01089"></a><span class="lineno"> 1089</span>      {</div>
<div class="line"><a id="l01090" name="l01090"></a><span class="lineno"> 1090</span>         <span class="keywordflow">if</span> (dCorneriX + (dY - dCorneriY) / (dCornerjY - dCorneriY) * (dCornerjX - dCorneriX) &lt; dX)</div>
<div class="line"><a id="l01091" name="l01091"></a><span class="lineno"> 1091</span>         {</div>
<div class="line"><a id="l01092" name="l01092"></a><span class="lineno"> 1092</span>            bOddNodes = ! bOddNodes;</div>
<div class="line"><a id="l01093" name="l01093"></a><span class="lineno"> 1093</span>         }</div>
<div class="line"><a id="l01094" name="l01094"></a><span class="lineno"> 1094</span>      }</div>
<div class="line"><a id="l01095" name="l01095"></a><span class="lineno"> 1095</span> </div>
<div class="line"><a id="l01096" name="l01096"></a><span class="lineno"> 1096</span>      j = i;</div>
<div class="line"><a id="l01097" name="l01097"></a><span class="lineno"> 1097</span>   }</div>
<div class="line"><a id="l01098" name="l01098"></a><span class="lineno"> 1098</span> </div>
<div class="line"><a id="l01099" name="l01099"></a><span class="lineno"> 1099</span>  <span class="keywordflow">return</span> bOddNodes;</div>
<div class="line"><a id="l01100" name="l01100"></a><span class="lineno"> 1100</span>}</div>
</div>
<div class="line"><a id="l01101" name="l01101"></a><span class="lineno"> 1101</span> </div>
<div class="line"><a id="l01102" name="l01102"></a><span class="lineno"> 1102</span><span class="comment">//===============================================================================================================================</span></div>
<div class="line"><a id="l01104" name="l01104"></a><span class="lineno"> 1104</span><span class="comment">//===============================================================================================================================</span></div>
<div class="foldopen" id="foldopen01105" data-start="{" data-end="}">
<div class="line"><a id="l01105" name="l01105"></a><span class="lineno"><a class="line" href="../../d1/d98/classCSimulation.html#ab071e8422c990d7dff462e3eab8df941"> 1105</a></span><a class="code hl_class" href="../../d5/d4e/classCGeom2DPoint.html">CGeom2DPoint</a> <a class="code hl_function" href="../../d1/d98/classCSimulation.html#ab071e8422c990d7dff462e3eab8df941">CSimulation::PtFindPointInPolygon</a>(vector&lt;CGeom2DPoint&gt; <span class="keyword">const</span>* pPtPoints, <span class="keywordtype">int</span> <span class="keyword">const</span> nStartPoint)</div>
<div class="line"><a id="l01106" name="l01106"></a><span class="lineno"> 1106</span>{</div>
<div class="line"><a id="l01107" name="l01107"></a><span class="lineno"> 1107</span>   <span class="keywordtype">int</span> nPolySize = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(pPtPoints-&gt;size());</div>
<div class="line"><a id="l01108" name="l01108"></a><span class="lineno"> 1108</span>   <span class="keywordtype">int</span> nOffSet = 0;</div>
<div class="line"><a id="l01109" name="l01109"></a><span class="lineno"> 1109</span>   <a class="code hl_class" href="../../d5/d4e/classCGeom2DPoint.html">CGeom2DPoint</a> PtStart;</div>
<div class="line"><a id="l01110" name="l01110"></a><span class="lineno"> 1110</span> </div>
<div class="line"><a id="l01111" name="l01111"></a><span class="lineno"> 1111</span>   <span class="keywordflow">do</span></div>
<div class="line"><a id="l01112" name="l01112"></a><span class="lineno"> 1112</span>   {</div>
<div class="line"><a id="l01113" name="l01113"></a><span class="lineno"> 1113</span>      <span class="comment">// Choose three consecutive points from the polygon</span></div>
<div class="line"><a id="l01114" name="l01114"></a><span class="lineno"> 1114</span>      vector &lt;CGeom2DPoint&gt; nVTestPoints;</div>
<div class="line"><a id="l01115" name="l01115"></a><span class="lineno"> 1115</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n = 0; n &lt; 3; n++)</div>
<div class="line"><a id="l01116" name="l01116"></a><span class="lineno"> 1116</span>      {</div>
<div class="line"><a id="l01117" name="l01117"></a><span class="lineno"> 1117</span>         <span class="keywordtype">int</span> nIndex = n + nStartPoint + nOffSet;</div>
<div class="line"><a id="l01118" name="l01118"></a><span class="lineno"> 1118</span>         <span class="keywordflow">if</span> (nIndex &gt; nPolySize-1)</div>
<div class="line"><a id="l01119" name="l01119"></a><span class="lineno"> 1119</span>            nIndex -= nPolySize;</div>
<div class="line"><a id="l01120" name="l01120"></a><span class="lineno"> 1120</span> </div>
<div class="line"><a id="l01121" name="l01121"></a><span class="lineno"> 1121</span>         <span class="comment">// Safety check</span></div>
<div class="line"><a id="l01122" name="l01122"></a><span class="lineno"> 1122</span>         <span class="keywordflow">if</span> (nIndex &lt; 0)</div>
<div class="line"><a id="l01123" name="l01123"></a><span class="lineno"> 1123</span>            <span class="keywordflow">return</span> <a class="code hl_class" href="../../d5/d4e/classCGeom2DPoint.html">CGeom2DPoint</a>(<a class="code hl_variable" href="../../d6/d2a/cme_8h.html#ac003bdff958dca839f5d274f15786e07">DBL_NODATA</a>, <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#ac003bdff958dca839f5d274f15786e07">DBL_NODATA</a>);</div>
<div class="line"><a id="l01124" name="l01124"></a><span class="lineno"> 1124</span> </div>
<div class="line"><a id="l01125" name="l01125"></a><span class="lineno"> 1125</span>         nVTestPoints.push_back(pPtPoints-&gt;at(nIndex));</div>
<div class="line"><a id="l01126" name="l01126"></a><span class="lineno"> 1126</span>      }</div>
<div class="line"><a id="l01127" name="l01127"></a><span class="lineno"> 1127</span> </div>
<div class="line"><a id="l01128" name="l01128"></a><span class="lineno"> 1128</span>      <span class="comment">// Increment ready for next time</span></div>
<div class="line"><a id="l01129" name="l01129"></a><span class="lineno"> 1129</span>      nOffSet++;</div>
<div class="line"><a id="l01130" name="l01130"></a><span class="lineno"> 1130</span> </div>
<div class="line"><a id="l01131" name="l01131"></a><span class="lineno"> 1131</span>      <span class="comment">// Safety check</span></div>
<div class="line"><a id="l01132" name="l01132"></a><span class="lineno"> 1132</span>      <span class="keywordflow">if</span> (nOffSet &gt;= (nPolySize + 3))</div>
<div class="line"><a id="l01133" name="l01133"></a><span class="lineno"> 1133</span>         <span class="keywordflow">return</span> <a class="code hl_class" href="../../d5/d4e/classCGeom2DPoint.html">CGeom2DPoint</a>(<a class="code hl_variable" href="../../d6/d2a/cme_8h.html#ac003bdff958dca839f5d274f15786e07">DBL_NODATA</a>, <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#ac003bdff958dca839f5d274f15786e07">DBL_NODATA</a>);</div>
<div class="line"><a id="l01134" name="l01134"></a><span class="lineno"> 1134</span> </div>
<div class="line"><a id="l01135" name="l01135"></a><span class="lineno"> 1135</span>      <span class="comment">// Check if the halfway point between the first and the third point is inside the polygon</span></div>
<div class="line"><a id="l01136" name="l01136"></a><span class="lineno"> 1136</span>      PtStart = <a class="code hl_function" href="../../d1/d98/classCSimulation.html#a41d2806566f688547f97c0d573bb1611">PtAverage</a>(&amp;nVTestPoints[0], &amp;nVTestPoints[2]);</div>
<div class="line"><a id="l01137" name="l01137"></a><span class="lineno"> 1137</span>   }</div>
<div class="line"><a id="l01138" name="l01138"></a><span class="lineno"> 1138</span>   <span class="keywordflow">while</span> (! <a class="code hl_function" href="../../d1/d98/classCSimulation.html#af26b975e1c0f041d6fdaaf83065ef2c8">bIsWithinPolygon</a>(&amp;PtStart, pPtPoints));</div>
<div class="line"><a id="l01139" name="l01139"></a><span class="lineno"> 1139</span> </div>
<div class="line"><a id="l01140" name="l01140"></a><span class="lineno"> 1140</span>   <span class="keywordflow">return</span> PtStart;</div>
<div class="line"><a id="l01141" name="l01141"></a><span class="lineno"> 1141</span>}</div>
</div>
<div class="ttc" id="aclassCGeom2DIPoint_html"><div class="ttname"><a href="../../d6/d0d/classCGeom2DIPoint.html">CGeom2DIPoint</a></div><div class="ttdoc">Geometry class used to represent 2D point objects with integer coordinates.</div><div class="ttdef"><b>Definition</b> <a href="../../d2/d66/2di__point_8h_source.html#l00029">2di_point.h:30</a></div></div>
<div class="ttc" id="aclassCGeom2DIPoint_html_a4d9c20bcca90dcb9d519b664aba09cbd"><div class="ttname"><a href="../../d6/d0d/classCGeom2DIPoint.html#a4d9c20bcca90dcb9d519b664aba09cbd">CGeom2DIPoint::nGetY</a></div><div class="ttdeci">int nGetY(void) const</div><div class="ttdoc">Returns the CGeom2DIPoint object&#39;s integer Y coordinate.</div><div class="ttdef"><b>Definition</b> <a href="../../d8/dc5/2di__point_8cpp_source.html#l00048">2di_point.cpp:48</a></div></div>
<div class="ttc" id="aclassCGeom2DIPoint_html_af84c687b2d0be01ab41cbcc0565f4f3f"><div class="ttname"><a href="../../d6/d0d/classCGeom2DIPoint.html#af84c687b2d0be01ab41cbcc0565f4f3f">CGeom2DIPoint::nGetX</a></div><div class="ttdeci">int nGetX(void) const</div><div class="ttdoc">Returns the CGeom2DIPoint object&#39;s integer X coordinate.</div><div class="ttdef"><b>Definition</b> <a href="../../d8/dc5/2di__point_8cpp_source.html#l00042">2di_point.cpp:42</a></div></div>
<div class="ttc" id="aclassCGeom2DPoint_html"><div class="ttname"><a href="../../d5/d4e/classCGeom2DPoint.html">CGeom2DPoint</a></div><div class="ttdoc">Geometry class used to represent 2D point objects with floating-point coordinates.</div><div class="ttdef"><b>Definition</b> <a href="../../d0/dee/2d__point_8h_source.html#l00025">2d_point.h:26</a></div></div>
<div class="ttc" id="aclassCGeom2DPoint_html_a216921dc2c592d9468e6430fee7c7719"><div class="ttname"><a href="../../d5/d4e/classCGeom2DPoint.html#a216921dc2c592d9468e6430fee7c7719">CGeom2DPoint::dGetY</a></div><div class="ttdeci">double dGetY(void) const</div><div class="ttdoc">Returns the CGeom2DPoint object&#39;s double Y coordinate.</div><div class="ttdef"><b>Definition</b> <a href="../../d2/d81/2d__point_8cpp_source.html#l00044">2d_point.cpp:44</a></div></div>
<div class="ttc" id="aclassCGeom2DPoint_html_a250f937d03cfdf6e0244b74ad2bf96a4"><div class="ttname"><a href="../../d5/d4e/classCGeom2DPoint.html#a250f937d03cfdf6e0244b74ad2bf96a4">CGeom2DPoint::dGetX</a></div><div class="ttdeci">double dGetX(void) const</div><div class="ttdoc">Returns the CGeom2DPoint object&#39;s double X coordinate.</div><div class="ttdef"><b>Definition</b> <a href="../../d2/d81/2d__point_8cpp_source.html#l00038">2d_point.cpp:38</a></div></div>
<div class="ttc" id="aclassCGeomCoastPolygon_html"><div class="ttname"><a href="../../df/d45/classCGeomCoastPolygon.html">CGeomCoastPolygon</a></div><div class="ttdoc">Geometry class used for coast polygon objects.</div><div class="ttdef"><b>Definition</b> <a href="../../d6/db2/coast__polygon_8h_source.html#l00031">coast_polygon.h:32</a></div></div>
<div class="ttc" id="aclassCGeomCoastPolygon_html_a0bb71766112920d4ac411703bb3ea853"><div class="ttname"><a href="../../df/d45/classCGeomCoastPolygon.html#a0bb71766112920d4ac411703bb3ea853">CGeomCoastPolygon::bIsCoastStartPolygon</a></div><div class="ttdeci">bool bIsCoastStartPolygon(void) const</div><div class="ttdoc">Is this polygon the coast-start polygon?</div><div class="ttdef"><b>Definition</b> <a href="../../df/d30/coast__polygon_8cpp_source.html#l00133">coast_polygon.cpp:133</a></div></div>
<div class="ttc" id="aclassCGeomCoastPolygon_html_a19a835fe7c493f6853cf118fd3584847"><div class="ttname"><a href="../../df/d45/classCGeomCoastPolygon.html#a19a835fe7c493f6853cf118fd3584847">CGeomCoastPolygon::nGetNumPointsUsedDownCoastProfile</a></div><div class="ttdeci">int nGetNumPointsUsedDownCoastProfile(void) const</div><div class="ttdoc">Return the number of points in the down-coast profile.</div><div class="ttdef"><b>Definition</b> <a href="../../df/d30/coast__polygon_8cpp_source.html#l00240">coast_polygon.cpp:240</a></div></div>
<div class="ttc" id="aclassCGeomCoastPolygon_html_a26cb239af6081440054114897f4e9332"><div class="ttname"><a href="../../df/d45/classCGeomCoastPolygon.html#a26cb239af6081440054114897f4e9332">CGeomCoastPolygon::pPtiGetAntiNode</a></div><div class="ttdeci">CGeom2DIPoint * pPtiGetAntiNode(void)</div><div class="ttdoc">Get the anti-node (raster grid CRS) which is at other (seaward) end of the polygon from the node.</div><div class="ttdef"><b>Definition</b> <a href="../../df/d30/coast__polygon_8cpp_source.html#l00169">coast_polygon.cpp:169</a></div></div>
<div class="ttc" id="aclassCGeomCoastPolygon_html_a33507ab0cc5f495919d06befd56223c4"><div class="ttname"><a href="../../df/d45/classCGeomCoastPolygon.html#a33507ab0cc5f495919d06befd56223c4">CGeomCoastPolygon::bIsCoastEndPolygon</a></div><div class="ttdeci">bool bIsCoastEndPolygon(void) const</div><div class="ttdoc">Is this polygon the coast-end polygon?</div><div class="ttdef"><b>Definition</b> <a href="../../df/d30/coast__polygon_8cpp_source.html#l00121">coast_polygon.cpp:121</a></div></div>
<div class="ttc" id="aclassCGeomCoastPolygon_html_a33b5ee96a889a83c8aa34399f3f15c12"><div class="ttname"><a href="../../df/d45/classCGeomCoastPolygon.html#a33b5ee96a889a83c8aa34399f3f15c12">CGeomCoastPolygon::SetSedimentInputUnconsSand</a></div><div class="ttdeci">void SetSedimentInputUnconsSand(double const)</div><div class="ttdoc">Set the value of sand sediment on the polygon derived from sediment input events(s)</div><div class="ttdef"><b>Definition</b> <a href="../../df/d30/coast__polygon_8cpp_source.html#l00729">coast_polygon.cpp:729</a></div></div>
<div class="ttc" id="aclassCGeomCoastPolygon_html_a34cf2701da81a0b72365b1fa7fa855b4"><div class="ttname"><a href="../../df/d45/classCGeomCoastPolygon.html#a34cf2701da81a0b72365b1fa7fa855b4">CGeomCoastPolygon::SetPreExistingUnconsFine</a></div><div class="ttdeci">void SetPreExistingUnconsFine(double const)</div><div class="ttdoc">Set the value of pre-existing unconsolidated fine sediment stored on this polygon.</div><div class="ttdef"><b>Definition</b> <a href="../../df/d30/coast__polygon_8cpp_source.html#l00645">coast_polygon.cpp:645</a></div></div>
<div class="ttc" id="aclassCGeomCoastPolygon_html_a35df99fb60cac21d4f6c42218f8169d2"><div class="ttname"><a href="../../df/d45/classCGeomCoastPolygon.html#a35df99fb60cac21d4f6c42218f8169d2">CGeomCoastPolygon::SetSedimentInputUnconsFine</a></div><div class="ttdeci">void SetSedimentInputUnconsFine(double const)</div><div class="ttdoc">Set the value of fine sediment on the polygon derived from sediment input events(s)</div><div class="ttdef"><b>Definition</b> <a href="../../df/d30/coast__polygon_8cpp_source.html#l00717">coast_polygon.cpp:717</a></div></div>
<div class="ttc" id="aclassCGeomCoastPolygon_html_a3d3d6e36327eed01f632184ccdade662"><div class="ttname"><a href="../../df/d45/classCGeomCoastPolygon.html#a3d3d6e36327eed01f632184ccdade662">CGeomCoastPolygon::SetPreExistingConsFine</a></div><div class="ttdeci">void SetPreExistingConsFine(double const)</div><div class="ttdoc">Set the value of pre-existing consolidated fine sediment stored on this polygon.</div><div class="ttdef"><b>Definition</b> <a href="../../df/d30/coast__polygon_8cpp_source.html#l00681">coast_polygon.cpp:681</a></div></div>
<div class="ttc" id="aclassCGeomCoastPolygon_html_a41ffd18c3a9539811aeb120f6886e6da"><div class="ttname"><a href="../../df/d45/classCGeomCoastPolygon.html#a41ffd18c3a9539811aeb120f6886e6da">CGeomCoastPolygon::SetPreExistingUnconsSand</a></div><div class="ttdeci">void SetPreExistingUnconsSand(double const)</div><div class="ttdoc">Set the value of pre-existing unconsolidated sand sediment stored on this polygon.</div><div class="ttdef"><b>Definition</b> <a href="../../df/d30/coast__polygon_8cpp_source.html#l00657">coast_polygon.cpp:657</a></div></div>
<div class="ttc" id="aclassCGeomCoastPolygon_html_a440264eb31972f7f9ce65de909d61832"><div class="ttname"><a href="../../df/d45/classCGeomCoastPolygon.html#a440264eb31972f7f9ce65de909d61832">CGeomCoastPolygon::SetSeawaterVolume</a></div><div class="ttdeci">void SetSeawaterVolume(const double)</div><div class="ttdoc">Set the volume of seawater in the coast polygon.</div><div class="ttdef"><b>Definition</b> <a href="../../df/d30/coast__polygon_8cpp_source.html#l00246">coast_polygon.cpp:246</a></div></div>
<div class="ttc" id="aclassCGeomCoastPolygon_html_a4a4ebf349a33da816f84f7b3f84c1b1e"><div class="ttname"><a href="../../df/d45/classCGeomCoastPolygon.html#a4a4ebf349a33da816f84f7b3f84c1b1e">CGeomCoastPolygon::nGetNumPointsUsedUpCoastProfile</a></div><div class="ttdeci">int nGetNumPointsUsedUpCoastProfile(void) const</div><div class="ttdoc">Return the number of points in the up-coast profile.</div><div class="ttdef"><b>Definition</b> <a href="../../df/d30/coast__polygon_8cpp_source.html#l00234">coast_polygon.cpp:234</a></div></div>
<div class="ttc" id="aclassCGeomCoastPolygon_html_a5a20c8589bae2a636e1c7667e5c4fe56"><div class="ttname"><a href="../../df/d45/classCGeomCoastPolygon.html#a5a20c8589bae2a636e1c7667e5c4fe56">CGeomCoastPolygon::PtiGetFillStartPoint</a></div><div class="ttdeci">CGeom2DIPoint PtiGetFillStartPoint(void)</div><div class="ttdef"><b>Definition</b> <a href="../../df/d30/coast__polygon_8cpp_source.html#l00771">coast_polygon.cpp:771</a></div></div>
<div class="ttc" id="aclassCGeomCoastPolygon_html_a6b42ec53178379945ca004050f30f039"><div class="ttname"><a href="../../df/d45/classCGeomCoastPolygon.html#a6b42ec53178379945ca004050f30f039">CGeomCoastPolygon::SetSedimentInputUnconsCoarse</a></div><div class="ttdeci">void SetSedimentInputUnconsCoarse(double const)</div><div class="ttdoc">Set the value of coarse sediment on the polygon derived from sediment input events(s)</div><div class="ttdef"><b>Definition</b> <a href="../../df/d30/coast__polygon_8cpp_source.html#l00741">coast_polygon.cpp:741</a></div></div>
<div class="ttc" id="aclassCGeomCoastPolygon_html_a9d56bad783aec1a119fddde1743c50a9"><div class="ttname"><a href="../../df/d45/classCGeomCoastPolygon.html#a9d56bad783aec1a119fddde1743c50a9">CGeomCoastPolygon::SetDownCoastAdjacentPolygonBoundaryShares</a></div><div class="ttdeci">void SetDownCoastAdjacentPolygonBoundaryShares(vector&lt; double &gt; const *)</div><div class="ttdoc">Sets the boundary shares for all down-coast adjacent polygons.</div><div class="ttdef"><b>Definition</b> <a href="../../df/d30/coast__polygon_8cpp_source.html#l00471">coast_polygon.cpp:471</a></div></div>
<div class="ttc" id="aclassCGeomCoastPolygon_html_aa717d51fde4419cad26236395d047b71"><div class="ttname"><a href="../../df/d45/classCGeomCoastPolygon.html#aa717d51fde4419cad26236395d047b71">CGeomCoastPolygon::nGetUpCoastProfile</a></div><div class="ttdeci">int nGetUpCoastProfile(void) const</div><div class="ttdoc">Return the number of the up-coast profile.</div><div class="ttdef"><b>Definition</b> <a href="../../df/d30/coast__polygon_8cpp_source.html#l00199">coast_polygon.cpp:199</a></div></div>
<div class="ttc" id="aclassCGeomCoastPolygon_html_aa8f98c270b2bc6e4a5665bf60a41c8af"><div class="ttname"><a href="../../df/d45/classCGeomCoastPolygon.html#aa8f98c270b2bc6e4a5665bf60a41c8af">CGeomCoastPolygon::SetLength</a></div><div class="ttdeci">void SetLength(double const)</div><div class="ttdoc">Sets the polygon&#39;s length.</div><div class="ttdef"><b>Definition</b> <a href="../../df/d30/coast__polygon_8cpp_source.html#l00175">coast_polygon.cpp:175</a></div></div>
<div class="ttc" id="aclassCGeomCoastPolygon_html_ab02a39464ee62ca5ec8b7b3a556153bf"><div class="ttname"><a href="../../df/d45/classCGeomCoastPolygon.html#ab02a39464ee62ca5ec8b7b3a556153bf">CGeomCoastPolygon::SetPreExistingConsCoarse</a></div><div class="ttdeci">void SetPreExistingConsCoarse(double const)</div><div class="ttdoc">Set the value of pre-existing consolidated coarse sediment stored on this polygon.</div><div class="ttdef"><b>Definition</b> <a href="../../df/d30/coast__polygon_8cpp_source.html#l00705">coast_polygon.cpp:705</a></div></div>
<div class="ttc" id="aclassCGeomCoastPolygon_html_abdb77248b1f7a026e656bf4e4e08696b"><div class="ttname"><a href="../../df/d45/classCGeomCoastPolygon.html#abdb77248b1f7a026e656bf4e4e08696b">CGeomCoastPolygon::SetPreExistingUnconsCoarse</a></div><div class="ttdeci">void SetPreExistingUnconsCoarse(double const)</div><div class="ttdoc">Set the value of pre-existing unconsolidated coarse sediment stored on this polygon.</div><div class="ttdef"><b>Definition</b> <a href="../../df/d30/coast__polygon_8cpp_source.html#l00669">coast_polygon.cpp:669</a></div></div>
<div class="ttc" id="aclassCGeomCoastPolygon_html_ac3bc44b934d49de03631ea8ae2bdec0a"><div class="ttname"><a href="../../df/d45/classCGeomCoastPolygon.html#ac3bc44b934d49de03631ea8ae2bdec0a">CGeomCoastPolygon::AppendVertex</a></div><div class="ttdeci">void AppendVertex(CGeom2DIPoint const *)</div><div class="ttdoc">Appends the point cordinates (grid CRS) for a polygon vertex.</div><div class="ttdef"><b>Definition</b> <a href="../../df/d30/coast__polygon_8cpp_source.html#l00753">coast_polygon.cpp:753</a></div></div>
<div class="ttc" id="aclassCGeomCoastPolygon_html_ad1df78c11a625b56a193cd5a0ae54192"><div class="ttname"><a href="../../df/d45/classCGeomCoastPolygon.html#ad1df78c11a625b56a193cd5a0ae54192">CGeomCoastPolygon::SetDownCoastAdjacentPolygons</a></div><div class="ttdeci">void SetDownCoastAdjacentPolygons(vector&lt; int &gt; const *)</div><div class="ttdoc">Sets all down-coast adjacent polygons.</div><div class="ttdef"><b>Definition</b> <a href="../../df/d30/coast__polygon_8cpp_source.html#l00439">coast_polygon.cpp:439</a></div></div>
<div class="ttc" id="aclassCGeomCoastPolygon_html_ad68047ef4a4f8e908858e960a0be4b05"><div class="ttname"><a href="../../df/d45/classCGeomCoastPolygon.html#ad68047ef4a4f8e908858e960a0be4b05">CGeomCoastPolygon::SetUpCoastAdjacentPolygonBoundaryShares</a></div><div class="ttdeci">void SetUpCoastAdjacentPolygonBoundaryShares(vector&lt; double &gt; const *)</div><div class="ttdoc">Sets the boundary shares for all up-coast adjacent polygons.</div><div class="ttdef"><b>Definition</b> <a href="../../df/d30/coast__polygon_8cpp_source.html#l00458">coast_polygon.cpp:458</a></div></div>
<div class="ttc" id="aclassCGeomCoastPolygon_html_adbd8b304081b250addc82262b474ed08"><div class="ttname"><a href="../../df/d45/classCGeomCoastPolygon.html#adbd8b304081b250addc82262b474ed08">CGeomCoastPolygon::SetUpCoastAdjacentPolygons</a></div><div class="ttdeci">void SetUpCoastAdjacentPolygons(vector&lt; int &gt; const *)</div><div class="ttdoc">Sets all up-coast adjacent polygons.</div><div class="ttdef"><b>Definition</b> <a href="../../df/d30/coast__polygon_8cpp_source.html#l00420">coast_polygon.cpp:420</a></div></div>
<div class="ttc" id="aclassCGeomCoastPolygon_html_ae15a709df66f5ca57b9b2c9115f2d354"><div class="ttname"><a href="../../df/d45/classCGeomCoastPolygon.html#ae15a709df66f5ca57b9b2c9115f2d354">CGeomCoastPolygon::SetPreExistingConsSand</a></div><div class="ttdeci">void SetPreExistingConsSand(double const)</div><div class="ttdoc">Set the value of pre-existing consolidated sand sediment stored on this polygon.</div><div class="ttdef"><b>Definition</b> <a href="../../df/d30/coast__polygon_8cpp_source.html#l00693">coast_polygon.cpp:693</a></div></div>
<div class="ttc" id="aclassCGeomCoastPolygon_html_ae2119674d8d0b78f27bc53ed463fead2"><div class="ttname"><a href="../../df/d45/classCGeomCoastPolygon.html#ae2119674d8d0b78f27bc53ed463fead2">CGeomCoastPolygon::nGetDownCoastProfile</a></div><div class="ttdeci">int nGetDownCoastProfile(void) const</div><div class="ttdoc">Return the number of the down-coast profile.</div><div class="ttdef"><b>Definition</b> <a href="../../df/d30/coast__polygon_8cpp_source.html#l00205">coast_polygon.cpp:205</a></div></div>
<div class="ttc" id="aclassCGeomCoastPolygon_html_ae97ed135e92d392e9b72f83feee59b2b"><div class="ttname"><a href="../../df/d45/classCGeomCoastPolygon.html#ae97ed135e92d392e9b72f83feee59b2b">CGeomCoastPolygon::nGetCoastID</a></div><div class="ttdeci">int nGetCoastID(void) const</div><div class="ttdoc">Get the coast ID, this is the same as the down-coast sequence.</div><div class="ttdef"><b>Definition</b> <a href="../../df/d30/coast__polygon_8cpp_source.html#l00145">coast_polygon.cpp:145</a></div></div>
<div class="ttc" id="aclassCGeomCoastPolygon_html_aea28877120b36563169e11c9cdcf2294"><div class="ttname"><a href="../../df/d45/classCGeomCoastPolygon.html#aea28877120b36563169e11c9cdcf2294">CGeomCoastPolygon::SetNumCellsInPolygon</a></div><div class="ttdeci">void SetNumCellsInPolygon(int const)</div><div class="ttdoc">Set the number of cells in the polygon.</div><div class="ttdef"><b>Definition</b> <a href="../../df/d30/coast__polygon_8cpp_source.html#l00187">coast_polygon.cpp:187</a></div></div>
<div class="ttc" id="aclassCGeomCoastPolygon_html_afc6527b76b30e3b0205c65212db99619"><div class="ttname"><a href="../../df/d45/classCGeomCoastPolygon.html#afc6527b76b30e3b0205c65212db99619">CGeomCoastPolygon::pPtiGetNode</a></div><div class="ttdeci">CGeom2DIPoint * pPtiGetNode(void)</div><div class="ttdoc">Get the grid coordinates of the cell on which the node sits.</div><div class="ttdef"><b>Definition</b> <a href="../../df/d30/coast__polygon_8cpp_source.html#l00162">coast_polygon.cpp:162</a></div></div>
<div class="ttc" id="aclassCGeomMultiLine_html_a3516022bd96ee15709653b3bb7cc0155"><div class="ttname"><a href="../../d0/d89/classCGeomMultiLine.html#a3516022bd96ee15709653b3bb7cc0155">CGeomMultiLine::nGetNumCoincidentProfilesInLineSegment</a></div><div class="ttdeci">int nGetNumCoincidentProfilesInLineSegment(int const)</div><div class="ttdoc">Returns the count of coincident profiles in a specified line segment.</div><div class="ttdef"><b>Definition</b> <a href="../../db/d80/multi__line_8cpp_source.html#l00170">multi_line.cpp:170</a></div></div>
<div class="ttc" id="aclassCGeomMultiLine_html_a397a6f2cc166220b5342cf3444e16753"><div class="ttname"><a href="../../d0/d89/classCGeomMultiLine.html#a397a6f2cc166220b5342cf3444e16753">CGeomMultiLine::bFindProfileInCoincidentProfiles</a></div><div class="ttdeci">bool bFindProfileInCoincidentProfiles(int const)</div><div class="ttdoc">Returns true if the given profile number is one of the coincident profiles of the a specified line se...</div><div class="ttdef"><b>Definition</b> <a href="../../db/d80/multi__line_8cpp_source.html#l00206">multi_line.cpp:206</a></div></div>
<div class="ttc" id="aclassCGeomMultiLine_html_a4aef627971905a6679ea17401ad8a4d3"><div class="ttname"><a href="../../d0/d89/classCGeomMultiLine.html#a4aef627971905a6679ea17401ad8a4d3">CGeomMultiLine::nGetCoincidentProfileForLineSegment</a></div><div class="ttdeci">int nGetCoincidentProfileForLineSegment(int const, int const) const</div><div class="ttdoc">Returns the numbers of coincident profiles.</div><div class="ttdef"><b>Definition</b> <a href="../../db/d80/multi__line_8cpp_source.html#l00156">multi_line.cpp:156</a></div></div>
<div class="ttc" id="aclassCGeomMultiLine_html_a6dd16a3f527b6a681fbddd8a68e9deaf"><div class="ttname"><a href="../../d0/d89/classCGeomMultiLine.html#a6dd16a3f527b6a681fbddd8a68e9deaf">CGeomMultiLine::GetMostCoastwardSharedLineSegment</a></div><div class="ttdeci">void GetMostCoastwardSharedLineSegment(int const, int &amp;, int &amp;)</div><div class="ttdoc">Finds the number of the most coastward line segment for which the two profiles are coincident,...</div><div class="ttdef"><b>Definition</b> <a href="../../db/d80/multi__line_8cpp_source.html#l00225">multi_line.cpp:225</a></div></div>
<div class="ttc" id="aclassCGeomProfile_html"><div class="ttname"><a href="../../da/dae/classCGeomProfile.html">CGeomProfile</a></div><div class="ttdoc">Geometry class used to represent coast profile objects.</div><div class="ttdef"><b>Definition</b> <a href="../../de/d45/profile_8h_source.html#l00036">profile.h:37</a></div></div>
<div class="ttc" id="aclassCGeomProfile_html_a343fd2b73e3a87cf425572860e79ebd6"><div class="ttname"><a href="../../da/dae/classCGeomProfile.html#a343fd2b73e3a87cf425572860e79ebd6">CGeomProfile::nGetCoastPoint</a></div><div class="ttdeci">int nGetCoastPoint(void) const</div><div class="ttdoc">Returns the coast point at which the profile starts.</div><div class="ttdef"><b>Definition</b> <a href="../../db/dfa/profile_8cpp_source.html#l00079">profile.cpp:79</a></div></div>
<div class="ttc" id="aclassCGeomProfile_html_a60a83e788c19cfee1f79e44253e09fca"><div class="ttname"><a href="../../da/dae/classCGeomProfile.html#a60a83e788c19cfee1f79e44253e09fca">CGeomProfile::pGetDownCoastAdjacentProfile</a></div><div class="ttdeci">CGeomProfile * pGetDownCoastAdjacentProfile(void) const</div><div class="ttdef"><b>Definition</b> <a href="../../db/dfa/profile_8cpp_source.html#l00449">profile.cpp:449</a></div></div>
<div class="ttc" id="aclassCGeomProfile_html_a6d13079f744085f2d132405e0120ca54"><div class="ttname"><a href="../../da/dae/classCGeomProfile.html#a6d13079f744085f2d132405e0120ca54">CGeomProfile::pPtiGetCellInProfile</a></div><div class="ttdeci">CGeom2DIPoint * pPtiGetCellInProfile(int const)</div><div class="ttdoc">Returns a single cell in the profile.</div><div class="ttdef"><b>Definition</b> <a href="../../db/dfa/profile_8cpp_source.html#l00482">profile.cpp:482</a></div></div>
<div class="ttc" id="aclassCGeomProfile_html_a8a29c3fa364ab1f7b3930b7a9c83f45f"><div class="ttname"><a href="../../da/dae/classCGeomProfile.html#a8a29c3fa364ab1f7b3930b7a9c83f45f">CGeomProfile::nGetNumCellsInProfile</a></div><div class="ttdeci">int nGetNumCellsInProfile(void) const</div><div class="ttdoc">Returns the number of cells in the profile.</div><div class="ttdef"><b>Definition</b> <a href="../../db/dfa/profile_8cpp_source.html#l00489">profile.cpp:489</a></div></div>
<div class="ttc" id="aclassCGeomProfile_html_a8dc4e3ce21668f7149ca11aeb7efadf7"><div class="ttname"><a href="../../da/dae/classCGeomProfile.html#a8dc4e3ce21668f7149ca11aeb7efadf7">CGeomProfile::bProfileOK</a></div><div class="ttdeci">bool bProfileOK(void) const</div><div class="ttdoc">Returns true if this is a problem-free profile, and is not a start-of-coast or an end-of-coast profil...</div><div class="ttdef"><b>Definition</b> <a href="../../db/dfa/profile_8cpp_source.html#l00199">profile.cpp:199</a></div></div>
<div class="ttc" id="aclassCGeomProfile_html_aa6179cf07ded38813693a9c783149c62"><div class="ttname"><a href="../../da/dae/classCGeomProfile.html#aa6179cf07ded38813693a9c783149c62">CGeomProfile::pPtiGetEndPoint</a></div><div class="ttdeci">CGeom2DIPoint * pPtiGetEndPoint(void)</div><div class="ttdoc">Returns a pointer to the location of the cell (grid CRS) on which the profile ends.</div><div class="ttdef"><b>Definition</b> <a href="../../db/dfa/profile_8cpp_source.html#l00097">profile.cpp:97</a></div></div>
<div class="ttc" id="aclassCGeomProfile_html_aaa8ddb9c775927bdb7940f7826f90a74"><div class="ttname"><a href="../../da/dae/classCGeomProfile.html#aaa8ddb9c775927bdb7940f7826f90a74">CGeomProfile::pPtGetPointInProfile</a></div><div class="ttdeci">CGeom2DPoint * pPtGetPointInProfile(int const)</div><div class="ttdoc">Returns a single point in the profile.</div><div class="ttdef"><b>Definition</b> <a href="../../db/dfa/profile_8cpp_source.html#l00332">profile.cpp:332</a></div></div>
<div class="ttc" id="aclassCGeomProfile_html_aac223e2610d50ca2c7eadaf8542e9498"><div class="ttname"><a href="../../da/dae/classCGeomProfile.html#aac223e2610d50ca2c7eadaf8542e9498">CGeomProfile::bOKIncStartAndEndOfCoast</a></div><div class="ttdeci">bool bOKIncStartAndEndOfCoast(void) const</div><div class="ttdoc">Returns true if this is a problem-free profile (however it could be a start-of-coast or an end-of-coa...</div><div class="ttdef"><b>Definition</b> <a href="../../db/dfa/profile_8cpp_source.html#l00231">profile.cpp:231</a></div></div>
<div class="ttc" id="aclassCGeomProfile_html_aacd98f9837c3c7cf7414764b73275fba"><div class="ttname"><a href="../../da/dae/classCGeomProfile.html#aacd98f9837c3c7cf7414764b73275fba">CGeomProfile::nGetCoastID</a></div><div class="ttdeci">int nGetCoastID(void) const</div><div class="ttdoc">Returns the profile&#39;s coast ID.</div><div class="ttdef"><b>Definition</b> <a href="../../db/dfa/profile_8cpp_source.html#l00067">profile.cpp:67</a></div></div>
<div class="ttc" id="aclassCGeomProfile_html_abaf88697019588a2b0901bd19044aee4"><div class="ttname"><a href="../../da/dae/classCGeomProfile.html#abaf88697019588a2b0901bd19044aee4">CGeomProfile::nGetProfileSize</a></div><div class="ttdeci">int nGetProfileSize(void) const</div><div class="ttdoc">Returns the number of points in the profile.</div><div class="ttdef"><b>Definition</b> <a href="../../db/dfa/profile_8cpp_source.html#l00325">profile.cpp:325</a></div></div>
<div class="ttc" id="aclassCGeomProfile_html_abe0557d3f6bd86e02facefb28b9fab41"><div class="ttname"><a href="../../da/dae/classCGeomProfile.html#abe0557d3f6bd86e02facefb28b9fab41">CGeomProfile::pPtiGetStartPoint</a></div><div class="ttdeci">CGeom2DIPoint * pPtiGetStartPoint(void)</div><div class="ttdoc">Returns a pointer to the location of the cell (grid CRS) on which the profile starts.</div><div class="ttdef"><b>Definition</b> <a href="../../db/dfa/profile_8cpp_source.html#l00085">profile.cpp:85</a></div></div>
<div class="ttc" id="aclassCGeomProfile_html_ac591314b290b032ffc8a70d22df64ec0"><div class="ttname"><a href="../../da/dae/classCGeomProfile.html#ac591314b290b032ffc8a70d22df64ec0">CGeomProfile::bStartOfCoast</a></div><div class="ttdeci">bool bStartOfCoast(void) const</div><div class="ttdoc">Returns the switch to indicate whether this is a start-of-coast profile.</div><div class="ttdef"><b>Definition</b> <a href="../../db/dfa/profile_8cpp_source.html#l00109">profile.cpp:109</a></div></div>
<div class="ttc" id="aclassCGeomProfile_html_aec35bc03fc47a65349def96364c99bbd"><div class="ttname"><a href="../../da/dae/classCGeomProfile.html#aec35bc03fc47a65349def96364c99bbd">CGeomProfile::bEndOfCoast</a></div><div class="ttdeci">bool bEndOfCoast(void) const</div><div class="ttdoc">Returns the switch to indicate whether this is an end-of-coast profile.</div><div class="ttdef"><b>Definition</b> <a href="../../db/dfa/profile_8cpp_source.html#l00121">profile.cpp:121</a></div></div>
<div class="ttc" id="aclassCSimulation_html_a1312f0ac2c93a6cb2bc41c23eb01c293"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">CSimulation::m_pRasterGrid</a></div><div class="ttdeci">CGeomRasterGrid * m_pRasterGrid</div><div class="ttdoc">Pointer to the raster grid object.</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d6a/simulation_8h_source.html#l01482">simulation.h:1482</a></div></div>
<div class="ttc" id="aclassCSimulation_html_a1652253500dab35e6f6f9f734207e20b"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#a1652253500dab35e6f6f9f734207e20b">CSimulation::m_nXGridSize</a></div><div class="ttdeci">int m_nXGridSize</div><div class="ttdoc">The size of the grid in the x direction.</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d6a/simulation_8h_source.html#l00429">simulation.h:429</a></div></div>
<div class="ttc" id="aclassCSimulation_html_a1cdb36fc97d2f40d471edc2d59734960"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#a1cdb36fc97d2f40d471edc2d59734960">CSimulation::PtiExtCRSToGridRound</a></div><div class="ttdeci">CGeom2DIPoint PtiExtCRSToGridRound(CGeom2DPoint const *) const</div><div class="ttdoc">Transforms a pointer to a CGeom2DPoint in the external CRS to the equivalent CGeom2DIPoint in the ras...</div><div class="ttdef"><b>Definition</b> <a href="../../db/df7/gis__utils_8cpp_source.html#l00128">gis_utils.cpp:128</a></div></div>
<div class="ttc" id="aclassCSimulation_html_a222962121613613a48f518e0c2110f21"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#a222962121613613a48f518e0c2110f21">CSimulation::LogStream</a></div><div class="ttdeci">ofstream LogStream</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d6a/simulation_8h_source.html#l01784">simulation.h:1784</a></div></div>
<div class="ttc" id="aclassCSimulation_html_a25ada8139c82ca7beab3f279cff83184"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#a25ada8139c82ca7beab3f279cff83184">CSimulation::m_VCoast</a></div><div class="ttdeci">vector&lt; CRWCoast &gt; m_VCoast</div><div class="ttdoc">The coastline objects.</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d6a/simulation_8h_source.html#l01485">simulation.h:1485</a></div></div>
<div class="ttc" id="aclassCSimulation_html_a3755fdc07c0ac9f2ce6c2237cfef50ce"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#a3755fdc07c0ac9f2ce6c2237cfef50ce">CSimulation::m_nYGridSize</a></div><div class="ttdeci">int m_nYGridSize</div><div class="ttdoc">The size of the grid in the y direction.</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d6a/simulation_8h_source.html#l00432">simulation.h:432</a></div></div>
<div class="ttc" id="aclassCSimulation_html_a407e01ecfd7c564c74f4474216ce2e16"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#a407e01ecfd7c564c74f4474216ce2e16">CSimulation::dGetDistanceBetween</a></div><div class="ttdeci">static double dGetDistanceBetween(CGeom2DPoint const *, CGeom2DPoint const *)</div><div class="ttdoc">Returns the distance (in external CRS) between two points.</div><div class="ttdef"><b>Definition</b> <a href="../../db/df7/gis__utils_8cpp_source.html#l00140">gis_utils.cpp:140</a></div></div>
<div class="ttc" id="aclassCSimulation_html_a41d2806566f688547f97c0d573bb1611"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#a41d2806566f688547f97c0d573bb1611">CSimulation::PtAverage</a></div><div class="ttdeci">static CGeom2DPoint PtAverage(CGeom2DPoint const *, CGeom2DPoint const *)</div><div class="ttdoc">Returns a point (external CRS) which is the average of (i.e. is midway between) two other external CR...</div><div class="ttdef"><b>Definition</b> <a href="../../db/df7/gis__utils_8cpp_source.html#l00385">gis_utils.cpp:385</a></div></div>
<div class="ttc" id="aclassCSimulation_html_a45597177a9aecb40378ed4b9632008fd"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#a45597177a9aecb40378ed4b9632008fd">CSimulation::m_dStartIterSuspFineInPolygons</a></div><div class="ttdeci">double m_dStartIterSuspFineInPolygons</div><div class="ttdoc">Depth (m) of fine suspended sediment at the start of the simulation (only cells in polygons)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d6a/simulation_8h_source.html#l00932">simulation.h:932</a></div></div>
<div class="ttc" id="aclassCSimulation_html_a736d521c8e0c2b59218e5cc4af03818c"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#a736d521c8e0c2b59218e5cc4af03818c">CSimulation::nCreateAllPolygons</a></div><div class="ttdeci">int nCreateAllPolygons(void)</div><div class="ttdoc">Create polygons, and mark the polygon boundaries on the raster grid.</div><div class="ttdef"><b>Definition</b> <a href="#l00045">create_polygons.cpp:45</a></div></div>
<div class="ttc" id="aclassCSimulation_html_aa0eddb8270d03b9c1a0a6e96254ebfed"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#aa0eddb8270d03b9c1a0a6e96254ebfed">CSimulation::KeepWithinValidGrid</a></div><div class="ttdeci">void KeepWithinValidGrid(int, int, int &amp;, int &amp;) const</div><div class="ttdoc">Given two points in the grid CRS (the points assumed not to be coincident), this routine modifies the...</div><div class="ttdef"><b>Definition</b> <a href="../../db/df7/gis__utils_8cpp_source.html#l00210">gis_utils.cpp:210</a></div></div>
<div class="ttc" id="aclassCSimulation_html_ab071e8422c990d7dff462e3eab8df941"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#ab071e8422c990d7dff462e3eab8df941">CSimulation::PtFindPointInPolygon</a></div><div class="ttdeci">static CGeom2DPoint PtFindPointInPolygon(vector&lt; CGeom2DPoint &gt; const *, int const)</div><div class="ttdoc">Finds a point in a polygon: is guaranteed to succeed, as every strictly closed polygon has at least o...</div><div class="ttdef"><b>Definition</b> <a href="#l01105">create_polygons.cpp:1105</a></div></div>
<div class="ttc" id="aclassCSimulation_html_ab743d5627b1b3d7b9dd95e7110f29715"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#ab743d5627b1b3d7b9dd95e7110f29715">CSimulation::RasterizePolygonJoiningLine</a></div><div class="ttdeci">void RasterizePolygonJoiningLine(CGeom2DIPoint const *, CGeom2DIPoint const *, int const)</div><div class="ttdoc">Puts a polygon &#39;joining line&#39; (the line which is the seaward boundary of the polygon,...</div><div class="ttdef"><b>Definition</b> <a href="#l00439">create_polygons.cpp:439</a></div></div>
<div class="ttc" id="aclassCSimulation_html_abdc9fa851fdb5b8cc64a707f450495c1"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#abdc9fa851fdb5b8cc64a707f450495c1">CSimulation::MarkPolygonCells</a></div><div class="ttdeci">void MarkPolygonCells(void)</div><div class="ttdoc">Marks cells of the raster grid that are within each coastal polygon. The flood fill code used here is...</div><div class="ttdef"><b>Definition</b> <a href="#l00486">create_polygons.cpp:486</a></div></div>
<div class="ttc" id="aclassCSimulation_html_ac900a5701df97da22278fae928951f50"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#ac900a5701df97da22278fae928951f50">CSimulation::bIsWithinValidGrid</a></div><div class="ttdeci">bool bIsWithinValidGrid(int const, int const) const</div><div class="ttdoc">Checks whether the supplied point (an x-y pair, in the grid CRS) is within the raster grid,...</div><div class="ttdef"><b>Definition</b> <a href="../../db/df7/gis__utils_8cpp_source.html#l00170">gis_utils.cpp:170</a></div></div>
<div class="ttc" id="aclassCSimulation_html_ad67e8c5b30a0572f64ecfb5c062c2edc"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#ad67e8c5b30a0572f64ecfb5c062c2edc">CSimulation::m_ulIter</a></div><div class="ttdeci">unsigned long m_ulIter</div><div class="ttdoc">The number of the current iteration (time step)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d6a/simulation_8h_source.html#l00551">simulation.h:551</a></div></div>
<div class="ttc" id="aclassCSimulation_html_ad89a4ca2ea821f9853becbbce8af52b7"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#ad89a4ca2ea821f9853becbbce8af52b7">CSimulation::m_nNumPolygonGlobal</a></div><div class="ttdeci">int m_nNumPolygonGlobal</div><div class="ttdoc">Number of global (all coasts) polygons.</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d6a/simulation_8h_source.html#l00480">simulation.h:480</a></div></div>
<div class="ttc" id="aclassCSimulation_html_ae0de69c3d3acd6d52dc2ec2f456c0eb5"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#ae0de69c3d3acd6d52dc2ec2f456c0eb5">CSimulation::m_dCellSide</a></div><div class="ttdeci">double m_dCellSide</div><div class="ttdoc">Length of a cell side (in external CRS units)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d6a/simulation_8h_source.html#l00611">simulation.h:611</a></div></div>
<div class="ttc" id="aclassCSimulation_html_af103396c763e8526e49a977ee0e04ddb"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#af103396c763e8526e49a977ee0e04ddb">CSimulation::nDoPolygonSharedBoundaries</a></div><div class="ttdeci">int nDoPolygonSharedBoundaries(void)</div><div class="ttdoc">For between-polygon potential sediment routing: find which are the adjacent polygons,...</div><div class="ttdef"><b>Definition</b> <a href="#l00791">create_polygons.cpp:791</a></div></div>
<div class="ttc" id="aclassCSimulation_html_af26b975e1c0f041d6fdaaf83065ef2c8"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#af26b975e1c0f041d6fdaaf83065ef2c8">CSimulation::bIsWithinPolygon</a></div><div class="ttdeci">static bool bIsWithinPolygon(CGeom2DPoint const *, vector&lt; CGeom2DPoint &gt; const *)</div><div class="ttdoc">Determines whether a point is within a polygon: however if the point is exactly on the edge of the po...</div><div class="ttdef"><b>Definition</b> <a href="#l01071">create_polygons.cpp:1071</a></div></div>
<div class="ttc" id="aclassCSimulation_html_afdf9931c6687dab00b0f48c0709d6c8a"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#afdf9931c6687dab00b0f48c0709d6c8a">CSimulation::m_pVCoastPolygon</a></div><div class="ttdeci">vector&lt; CGeomCoastPolygon * &gt; m_pVCoastPolygon</div><div class="ttdoc">Pointers to coast polygon objects, in down-coast sequence TODO 044 Will need to use global polygon ID...</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d6a/simulation_8h_source.html#l01494">simulation.h:1494</a></div></div>
<div class="ttc" id="acme_8h_html"><div class="ttname"><a href="../../d6/d2a/cme_8h.html">cme.h</a></div><div class="ttdoc">This file contains global definitions for CoastalME.</div></div>
<div class="ttc" id="acme_8h_html_a01aa8b423260b337ddff2016107b51a0"><div class="ttname"><a href="../../d6/d2a/cme_8h.html#a01aa8b423260b337ddff2016107b51a0">INT_NODATA</a></div><div class="ttdeci">int const INT_NODATA</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d2a/cme_8h_source.html#l00358">cme.h:358</a></div></div>
<div class="ttc" id="acme_8h_html_a292fc90846543ca4814daa9f759feb05"><div class="ttname"><a href="../../d6/d2a/cme_8h.html#a292fc90846543ca4814daa9f759feb05">ERR</a></div><div class="ttdeci">string const ERR</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d2a/cme_8h_source.html#l00771">cme.h:771</a></div></div>
<div class="ttc" id="acme_8h_html_a7e895b460cef877dec4d12ead0c74f15"><div class="ttname"><a href="../../d6/d2a/cme_8h.html#a7e895b460cef877dec4d12ead0c74f15">tMax</a></div><div class="ttdeci">T tMax(T a, T b)</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d2a/cme_8h_source.html#l01119">cme.h:1119</a></div></div>
<div class="ttc" id="acme_8h_html_aa2941c3f10e5c29aa29a01fb6f7e91a6"><div class="ttname"><a href="../../d6/d2a/cme_8h.html#aa2941c3f10e5c29aa29a01fb6f7e91a6">RTN_ERR_BAD_MULTILINE</a></div><div class="ttdeci">int const RTN_ERR_BAD_MULTILINE</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d2a/cme_8h_source.html#l00621">cme.h:621</a></div></div>
<div class="ttc" id="acme_8h_html_aa768cb14b5c6123ee95e6e4ebd9fe331"><div class="ttname"><a href="../../d6/d2a/cme_8h.html#aa768cb14b5c6123ee95e6e4ebd9fe331">RTN_OK</a></div><div class="ttdeci">int const RTN_OK</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d2a/cme_8h_source.html#l00573">cme.h:573</a></div></div>
<div class="ttc" id="acme_8h_html_ac003bdff958dca839f5d274f15786e07"><div class="ttname"><a href="../../d6/d2a/cme_8h.html#ac003bdff958dca839f5d274f15786e07">DBL_NODATA</a></div><div class="ttdeci">double const DBL_NODATA</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d2a/cme_8h_source.html#l00703">cme.h:703</a></div></div>
<div class="ttc" id="acme_8h_html_ae3b6dc50cfc97050529faa5e0bd66136"><div class="ttname"><a href="../../d6/d2a/cme_8h.html#ae3b6dc50cfc97050529faa5e0bd66136">tAbs</a></div><div class="ttdeci">T tAbs(T a)</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d2a/cme_8h_source.html#l01144">cme.h:1144</a></div></div>
<div class="ttc" id="acoast_8h_html"><div class="ttname"><a href="../../de/d65/coast_8h.html">coast.h</a></div><div class="ttdoc">Contains CRWCoast definitions.</div></div>
<div class="ttc" id="asimulation_8h_html"><div class="ttname"><a href="../../dd/d6a/simulation_8h.html">simulation.h</a></div><div class="ttdoc">Contains CSimulation definitions.</div></div>
<div class="ttc" id="autils__global_8cpp_html_a20842d0a19d0ca952c91f3e1eb175fee"><div class="ttname"><a href="../../d2/dfd/utils__global_8cpp.html#a20842d0a19d0ca952c91f3e1eb175fee">nRound</a></div><div class="ttdeci">int nRound(double const d)</div><div class="ttdoc">Version of the above that returns an int.</div><div class="ttdef"><b>Definition</b> <a href="../../d2/dfd/utils__global_8cpp_source.html#l00056">utils_global.cpp:56</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="../../d6/d91/create__polygons_8cpp.html">create_polygons.cpp</a></li>
    <li class="footer">Generated on Tue Feb 11 2025 16:26:18 for CoastalME (Coastal Modelling Environment) by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
</body>
</html>
