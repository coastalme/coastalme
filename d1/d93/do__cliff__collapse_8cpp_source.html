<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>CoastalME (Coastal Modelling Environment): do_cliff_collapse.cpp Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<script type="text/javascript" src="../../clipboard.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../cookie.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">CoastalME (Coastal Modelling Environment)
   </div>
   <div id="projectbrief">Simulates the long-term behaviour of complex coastlines</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(1); });
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('d1/d93/do__cliff__collapse_8cpp_source.html','../../'); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">do_cliff_collapse.cpp</div></div>
</div><!--header-->
<div class="contents">
<a href="../../d1/d93/do__cliff__collapse_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno">    1</span></div>
<div class="line"><a id="l00012" name="l00012"></a><span class="lineno">   12</span> </div>
<div class="line"><a id="l00013" name="l00013"></a><span class="lineno">   13</span><span class="comment">/*==============================================================================================================================</span></div>
<div class="line"><a id="l00014" name="l00014"></a><span class="lineno">   14</span><span class="comment"></span> </div>
<div class="line"><a id="l00015" name="l00015"></a><span class="lineno">   15</span><span class="comment">This file is part of CoastalME, the Coastal Modelling Environment.</span></div>
<div class="line"><a id="l00016" name="l00016"></a><span class="lineno">   16</span><span class="comment"></span> </div>
<div class="line"><a id="l00017" name="l00017"></a><span class="lineno">   17</span><span class="comment">CoastalME is free software; you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation; either version 3 of the License, or (at your option) any later version.</span></div>
<div class="line"><a id="l00018" name="l00018"></a><span class="lineno">   18</span><span class="comment"></span> </div>
<div class="line"><a id="l00019" name="l00019"></a><span class="lineno">   19</span><span class="comment">This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.</span></div>
<div class="line"><a id="l00020" name="l00020"></a><span class="lineno">   20</span><span class="comment"></span> </div>
<div class="line"><a id="l00021" name="l00021"></a><span class="lineno">   21</span><span class="comment">You should have received a copy of the GNU General Public License along with this program; if not, write to the Free Software Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.</span></div>
<div class="line"><a id="l00022" name="l00022"></a><span class="lineno">   22</span><span class="comment"></span> </div>
<div class="line"><a id="l00023" name="l00023"></a><span class="lineno">   23</span><span class="comment">==============================================================================================================================*/</span></div>
<div class="line"><a id="l00024" name="l00024"></a><span class="lineno">   24</span><span class="preprocessor">#include &lt;assert.h&gt;</span></div>
<div class="line"><a id="l00025" name="l00025"></a><span class="lineno">   25</span> </div>
<div class="line"><a id="l00026" name="l00026"></a><span class="lineno">   26</span><span class="preprocessor">#include &lt;cmath&gt;</span></div>
<div class="line"><a id="l00027" name="l00027"></a><span class="lineno">   27</span> </div>
<div class="line"><a id="l00028" name="l00028"></a><span class="lineno">   28</span><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><a id="l00029" name="l00029"></a><span class="lineno">   29</span><span class="keyword">using </span>std::cerr;</div>
<div class="line"><a id="l00030" name="l00030"></a><span class="lineno">   30</span><span class="keyword">using </span>std::cout;</div>
<div class="line"><a id="l00031" name="l00031"></a><span class="lineno">   31</span><span class="keyword">using </span>std::endl;</div>
<div class="line"><a id="l00032" name="l00032"></a><span class="lineno">   32</span><span class="keyword">using </span>std::ios;</div>
<div class="line"><a id="l00033" name="l00033"></a><span class="lineno">   33</span> </div>
<div class="line"><a id="l00034" name="l00034"></a><span class="lineno">   34</span><span class="preprocessor">#include &quot;<a class="code" href="../../d6/d2a/cme_8h.html">cme.h</a>&quot;</span></div>
<div class="line"><a id="l00035" name="l00035"></a><span class="lineno">   35</span><span class="preprocessor">#include &quot;<a class="code" href="../../dd/d6a/simulation_8h.html">simulation.h</a>&quot;</span></div>
<div class="line"><a id="l00036" name="l00036"></a><span class="lineno">   36</span><span class="preprocessor">#include &quot;<a class="code" href="../../db/df0/cliff_8h.html">cliff.h</a>&quot;</span></div>
<div class="line"><a id="l00037" name="l00037"></a><span class="lineno">   37</span> </div>
<div class="line"><a id="l00038" name="l00038"></a><span class="lineno">   38</span><span class="comment">//===============================================================================================================================</span></div>
<div class="line"><a id="l00040" name="l00040"></a><span class="lineno">   40</span><span class="comment">//===============================================================================================================================</span></div>
<div class="foldopen" id="foldopen00041" data-start="{" data-end="}">
<div class="line"><a id="l00041" name="l00041"></a><span class="lineno"><a class="line" href="../../d1/d98/classCSimulation.html#a9ffa887989f66980ea60a8bea69b1e6e">   41</a></span><span class="keywordtype">int</span> <a class="code hl_function" href="../../d1/d98/classCSimulation.html#a9ffa887989f66980ea60a8bea69b1e6e">CSimulation::nDoAllWaveEnergyToCoastLandforms</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a id="l00042" name="l00042"></a><span class="lineno">   42</span>{</div>
<div class="line"><a id="l00043" name="l00043"></a><span class="lineno">   43</span>   <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a0245d3cbdd603fbeced6ca1465eb3f16">m_nLogFileDetail</a> &gt;= <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#a540d8a94fc09b0b14fd8ab657445b67a">LOG_FILE_MIDDLE_DETAIL</a>)</div>
<div class="line"><a id="l00044" name="l00044"></a><span class="lineno">   44</span>      <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a222962121613613a48f518e0c2110f21">LogStream</a> &lt;&lt; <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#ad67e8c5b30a0572f64ecfb5c062c2edc">m_ulIter</a> &lt;&lt; <span class="stringliteral">&quot;: Calculating cliff collapse&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a id="l00045" name="l00045"></a><span class="lineno">   45</span>   </div>
<div class="line"><a id="l00046" name="l00046"></a><span class="lineno">   46</span>   <span class="keywordtype">int</span> nRet;</div>
<div class="line"><a id="l00047" name="l00047"></a><span class="lineno">   47</span> </div>
<div class="line"><a id="l00048" name="l00048"></a><span class="lineno">   48</span>   <span class="comment">// First go along each coastline and update the total wave energy which it has experienced</span></div>
<div class="line"><a id="l00049" name="l00049"></a><span class="lineno">   49</span>   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; static_cast&lt;int&gt;(<a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a25ada8139c82ca7beab3f279cff83184">m_VCoast</a>.size()); i++)</div>
<div class="line"><a id="l00050" name="l00050"></a><span class="lineno">   50</span>   {</div>
<div class="line"><a id="l00051" name="l00051"></a><span class="lineno">   51</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a25ada8139c82ca7beab3f279cff83184">m_VCoast</a>[i].nGetCoastlineSize(); j++)</div>
<div class="line"><a id="l00052" name="l00052"></a><span class="lineno">   52</span>      {</div>
<div class="line"><a id="l00053" name="l00053"></a><span class="lineno">   53</span>         <a class="code hl_class" href="../../d2/de0/classCACoastLandform.html">CACoastLandform</a>* pCoastLandform = <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a25ada8139c82ca7beab3f279cff83184">m_VCoast</a>[i].pGetCoastLandform(j);</div>
<div class="line"><a id="l00054" name="l00054"></a><span class="lineno">   54</span> </div>
<div class="line"><a id="l00055" name="l00055"></a><span class="lineno">   55</span>         <span class="comment">// First get wave energy for the coastal landform object</span></div>
<div class="line"><a id="l00056" name="l00056"></a><span class="lineno">   56</span>         <span class="keywordtype">double</span> dWaveHeightAtCoast = <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a25ada8139c82ca7beab3f279cff83184">m_VCoast</a>[i].dGetCoastWaveHeight(j);</div>
<div class="line"><a id="l00057" name="l00057"></a><span class="lineno">   57</span>             </div>
<div class="line"><a id="l00058" name="l00058"></a><span class="lineno">   58</span>         <span class="comment">// If the waves at this point are off-shore, then do nothing, just move to next coast point</span></div>
<div class="line"><a id="l00059" name="l00059"></a><span class="lineno">   59</span>         <span class="keywordflow">if</span> (<a class="code hl_function" href="../../d6/d2a/cme_8h.html#a61afa8560a3b39c80657661a1d8f76ab">bFPIsEqual</a>(dWaveHeightAtCoast, <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#ac003bdff958dca839f5d274f15786e07">DBL_NODATA</a>, <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#a08b1623863ee3bd4300a8892de323722">TOLERANCE</a>))</div>
<div class="line"><a id="l00060" name="l00060"></a><span class="lineno">   60</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l00061" name="l00061"></a><span class="lineno">   61</span>         </div>
<div class="line"><a id="l00062" name="l00062"></a><span class="lineno">   62</span>         <span class="comment">// OK we have on-shore waves so get the previously-calculated wave energy</span></div>
<div class="line"><a id="l00063" name="l00063"></a><span class="lineno">   63</span>         <span class="keywordtype">double</span> dWaveEnergy = <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a25ada8139c82ca7beab3f279cff83184">m_VCoast</a>[i].dGetWaveEnergyAtBreaking(j);    </div>
<div class="line"><a id="l00064" name="l00064"></a><span class="lineno">   64</span><span class="comment">//          assert(isfinite(dWaveEnergy));</span></div>
<div class="line"><a id="l00065" name="l00065"></a><span class="lineno">   65</span> </div>
<div class="line"><a id="l00066" name="l00066"></a><span class="lineno">   66</span>         <span class="comment">// And save the accumulated value</span></div>
<div class="line"><a id="l00067" name="l00067"></a><span class="lineno">   67</span>         pCoastLandform-&gt;<a class="code hl_function" href="../../d2/de0/classCACoastLandform.html#ac850dc100a259660040b3b29c86a5057">IncTotAccumWaveEnergy</a>(dWaveEnergy);</div>
<div class="line"><a id="l00068" name="l00068"></a><span class="lineno">   68</span> </div>
<div class="line"><a id="l00069" name="l00069"></a><span class="lineno">   69</span>         <span class="comment">// Now simulate how the coastal landform responds to this wave energy</span></div>
<div class="line"><a id="l00070" name="l00070"></a><span class="lineno">   70</span>         <span class="keywordtype">int</span> nCategory = pCoastLandform-&gt;<a class="code hl_function" href="../../d2/de0/classCACoastLandform.html#ac161cb56a83d653b651aa08173a1f1ca">nGetLandFormCategory</a>();</div>
<div class="line"><a id="l00071" name="l00071"></a><span class="lineno">   71</span>         <span class="keywordflow">if</span> (nCategory == <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#ad6be96d3be217d31a74c2412d7e6cbbb">LF_CAT_CLIFF</a>)</div>
<div class="line"><a id="l00072" name="l00072"></a><span class="lineno">   72</span>         {</div>
<div class="line"><a id="l00073" name="l00073"></a><span class="lineno">   73</span>            <span class="comment">// This is a cliff</span></div>
<div class="line"><a id="l00074" name="l00074"></a><span class="lineno">   74</span>            <a class="code hl_class" href="../../d9/d8b/classCRWCliff.html">CRWCliff</a>* pCliff = <span class="keyword">reinterpret_cast&lt;</span><a class="code hl_class" href="../../d9/d8b/classCRWCliff.html">CRWCliff</a>*<span class="keyword">&gt;</span>(pCoastLandform);</div>
<div class="line"><a id="l00075" name="l00075"></a><span class="lineno">   75</span> </div>
<div class="line"><a id="l00076" name="l00076"></a><span class="lineno">   76</span>            <span class="comment">// Calculate this-timestep cliff notch erosion (is a length in external CRS units). Only consolidated sediment can have a cliff notch</span></div>
<div class="line"><a id="l00077" name="l00077"></a><span class="lineno">   77</span>            <span class="keywordtype">double</span> dNotchExtension = dWaveEnergy / <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a7c3995b189dcff813dfbfcc7c285e205">m_dCliffErosionResistance</a>;</div>
<div class="line"><a id="l00078" name="l00078"></a><span class="lineno">   78</span> </div>
<div class="line"><a id="l00079" name="l00079"></a><span class="lineno">   79</span>            <span class="comment">// Deepen the cliff object&#39;s erosional notch as a result of wave energy during this timestep. Note that notch deepening may be constrained, since this-timestep notch extension cannot exceed the length (i.e. cellside minus notch depth) of sediment remaining on the cell</span></div>
<div class="line"><a id="l00080" name="l00080"></a><span class="lineno">   80</span>            pCliff-&gt;<a class="code hl_function" href="../../d9/d8b/classCRWCliff.html#a6ded2d94f7a674e8a6d8315e5f301a6f">DeepenErosionalNotch</a>(dNotchExtension);</div>
<div class="line"><a id="l00081" name="l00081"></a><span class="lineno">   81</span>            </div>
<div class="line"><a id="l00082" name="l00082"></a><span class="lineno">   82</span>            <span class="comment">// OK, is the notch now extended enough to cause collapse (either because the overhang is greater than the threshold overhang, or because there is no sediment remaining)?</span></div>
<div class="line"><a id="l00083" name="l00083"></a><span class="lineno">   83</span>            <span class="keywordflow">if</span> (pCliff-&gt;<a class="code hl_function" href="../../d9/d8b/classCRWCliff.html#a230895c26a89fb53f0160d59e156137c">bReadyToCollapse</a>(<a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a0dae0444cb7c9f54e4109cfaa054f6fc">m_dNotchDepthAtCollapse</a>))</div>
<div class="line"><a id="l00084" name="l00084"></a><span class="lineno">   84</span>            {</div>
<div class="line"><a id="l00085" name="l00085"></a><span class="lineno">   85</span>               <span class="comment">// // DEBUG CODE ============================================================================================================================================</span></div>
<div class="line"><a id="l00086" name="l00086"></a><span class="lineno">   86</span>               <span class="comment">// // Get total depths of sand consolidated and unconsolidated for every cell</span></div>
<div class="line"><a id="l00087" name="l00087"></a><span class="lineno">   87</span>               <span class="comment">// if (m_ulIter == 5)</span></div>
<div class="line"><a id="l00088" name="l00088"></a><span class="lineno">   88</span>               <span class="comment">// {</span></div>
<div class="line"><a id="l00089" name="l00089"></a><span class="lineno">   89</span>               <span class="comment">//    double dTmpSandCons = 0;</span></div>
<div class="line"><a id="l00090" name="l00090"></a><span class="lineno">   90</span>               <span class="comment">//    double dTmpSandUncons = 0;</span></div>
<div class="line"><a id="l00091" name="l00091"></a><span class="lineno">   91</span>               <span class="comment">//    for (int nX1 = 0; nX1 &lt; m_nXGridSize; nX1++)</span></div>
<div class="line"><a id="l00092" name="l00092"></a><span class="lineno">   92</span>               <span class="comment">//    {</span></div>
<div class="line"><a id="l00093" name="l00093"></a><span class="lineno">   93</span>               <span class="comment">//       for (int nY1 = 0; nY1 &lt; m_nYGridSize; nY1++)</span></div>
<div class="line"><a id="l00094" name="l00094"></a><span class="lineno">   94</span>               <span class="comment">//       {</span></div>
<div class="line"><a id="l00095" name="l00095"></a><span class="lineno">   95</span>               <span class="comment">//          dTmpSandCons += m_pRasterGrid-&gt;m_Cell[nX1][nY1].dGetTotConsSandThickConsiderNotch();</span></div>
<div class="line"><a id="l00096" name="l00096"></a><span class="lineno">   96</span>               <span class="comment">//</span></div>
<div class="line"><a id="l00097" name="l00097"></a><span class="lineno">   97</span>               <span class="comment">//          dTmpSandUncons += m_pRasterGrid-&gt;m_Cell[nX1][nY1].dGetTotUnconsSand();</span></div>
<div class="line"><a id="l00098" name="l00098"></a><span class="lineno">   98</span>               <span class="comment">//       }</span></div>
<div class="line"><a id="l00099" name="l00099"></a><span class="lineno">   99</span>               <span class="comment">//    }</span></div>
<div class="line"><a id="l00100" name="l00100"></a><span class="lineno">  100</span>               <span class="comment">//</span></div>
<div class="line"><a id="l00101" name="l00101"></a><span class="lineno">  101</span>               <span class="comment">//    // Get the cliff cell&#39;s grid coords</span></div>
<div class="line"><a id="l00102" name="l00102"></a><span class="lineno">  102</span>               <span class="comment">//    int nXCliff = pCliff-&gt;pPtiGetCellMarkedAsLF()-&gt;nGetX();</span></div>
<div class="line"><a id="l00103" name="l00103"></a><span class="lineno">  103</span>               <span class="comment">//    int nYCliff = pCliff-&gt;pPtiGetCellMarkedAsLF()-&gt;nGetY();</span></div>
<div class="line"><a id="l00104" name="l00104"></a><span class="lineno">  104</span>               <span class="comment">//</span></div>
<div class="line"><a id="l00105" name="l00105"></a><span class="lineno">  105</span>               <span class="comment">//    // Get this cell&#39;s polygon</span></div>
<div class="line"><a id="l00106" name="l00106"></a><span class="lineno">  106</span>               <span class="comment">//    int nPoly = m_pRasterGrid-&gt;m_Cell[nXCliff][nYCliff].nGetPolygonID();</span></div>
<div class="line"><a id="l00107" name="l00107"></a><span class="lineno">  107</span>               <span class="comment">//</span></div>
<div class="line"><a id="l00108" name="l00108"></a><span class="lineno">  108</span>               <span class="comment">//    LogStream &lt;&lt; endl;</span></div>
<div class="line"><a id="l00109" name="l00109"></a><span class="lineno">  109</span>               <span class="comment">//    LogStream &lt;&lt; &quot;*****************************&quot; &lt;&lt; endl;</span></div>
<div class="line"><a id="l00110" name="l00110"></a><span class="lineno">  110</span>               <span class="comment">//    LogStream &lt;&lt; m_ulIter &lt;&lt; &quot;: before cliff collapse on nPoly = &quot; &lt;&lt; nPoly &lt;&lt; &quot; total consolidated sand = &quot; &lt;&lt; dTmpSandCons * m_dCellArea &lt;&lt; &quot; total unconsolidated sand = &quot; &lt;&lt; dTmpSandUncons * m_dCellArea &lt;&lt; endl;</span></div>
<div class="line"><a id="l00111" name="l00111"></a><span class="lineno">  111</span>               <span class="comment">// }</span></div>
<div class="line"><a id="l00112" name="l00112"></a><span class="lineno">  112</span>               <span class="comment">// // DEBUG CODE ============================================================================================================================================</span></div>
<div class="line"><a id="l00113" name="l00113"></a><span class="lineno">  113</span> </div>
<div class="line"><a id="l00114" name="l00114"></a><span class="lineno">  114</span>               <span class="comment">// It is ready to collapse</span></div>
<div class="line"><a id="l00115" name="l00115"></a><span class="lineno">  115</span>               <span class="keywordtype">double</span> dCliffElevPreCollapse = 0;</div>
<div class="line"><a id="l00116" name="l00116"></a><span class="lineno">  116</span>               <span class="keywordtype">double</span> dCliffElevPostCollapse = 0;</div>
<div class="line"><a id="l00117" name="l00117"></a><span class="lineno">  117</span>               <span class="keywordtype">double</span> dFineCollapse = 0;</div>
<div class="line"><a id="l00118" name="l00118"></a><span class="lineno">  118</span>               <span class="keywordtype">double</span> dSandCollapse = 0;</div>
<div class="line"><a id="l00119" name="l00119"></a><span class="lineno">  119</span>               <span class="keywordtype">double</span> dCoarseCollapse = 0;</div>
<div class="line"><a id="l00120" name="l00120"></a><span class="lineno">  120</span>                  </div>
<div class="line"><a id="l00121" name="l00121"></a><span class="lineno">  121</span>               <span class="comment">// So do the cliff collapse</span></div>
<div class="line"><a id="l00122" name="l00122"></a><span class="lineno">  122</span>               nRet = <a class="code hl_function" href="../../d1/d98/classCSimulation.html#aa49a03295b1c3da6f5be1cfbf6af02fc">nDoCliffCollapse</a>(i, pCliff, dFineCollapse, dSandCollapse, dCoarseCollapse, dCliffElevPreCollapse, dCliffElevPostCollapse);</div>
<div class="line"><a id="l00123" name="l00123"></a><span class="lineno">  123</span>               <span class="keywordflow">if</span> (nRet != <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#aa768cb14b5c6123ee95e6e4ebd9fe331">RTN_OK</a>)</div>
<div class="line"><a id="l00124" name="l00124"></a><span class="lineno">  124</span>               {</div>
<div class="line"><a id="l00125" name="l00125"></a><span class="lineno">  125</span>                  <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a0245d3cbdd603fbeced6ca1465eb3f16">m_nLogFileDetail</a> &gt;= <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#a540d8a94fc09b0b14fd8ab657445b67a">LOG_FILE_MIDDLE_DETAIL</a>)</div>
<div class="line"><a id="l00126" name="l00126"></a><span class="lineno">  126</span>                     <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a222962121613613a48f518e0c2110f21">LogStream</a> &lt;&lt; <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#ad67e8c5b30a0572f64ecfb5c062c2edc">m_ulIter</a> &lt;&lt; <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#a957ca99e98618160534cafb0929f743d">WARN</a> &lt;&lt; <span class="stringliteral">&quot; problem with cliff collapse, continuing however&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a id="l00127" name="l00127"></a><span class="lineno">  127</span>               }</div>
<div class="line"><a id="l00128" name="l00128"></a><span class="lineno">  128</span> </div>
<div class="line"><a id="l00129" name="l00129"></a><span class="lineno">  129</span>               <span class="comment">// Deposit all sand and/or coarse sediment derived from this cliff collapse as unconsolidated sediment (talus)</span></div>
<div class="line"><a id="l00130" name="l00130"></a><span class="lineno">  130</span>               nRet = <a class="code hl_function" href="../../d1/d98/classCSimulation.html#a1af38849a4694be096d76c39c1281f09">nDoCliffCollapseDeposition</a>(i, pCliff, dSandCollapse, dCoarseCollapse, dCliffElevPreCollapse, dCliffElevPostCollapse);</div>
<div class="line"><a id="l00131" name="l00131"></a><span class="lineno">  131</span>               <span class="keywordflow">if</span> (nRet != <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#aa768cb14b5c6123ee95e6e4ebd9fe331">RTN_OK</a>)</div>
<div class="line"><a id="l00132" name="l00132"></a><span class="lineno">  132</span>                  <span class="keywordflow">return</span> nRet;</div>
<div class="line"><a id="l00133" name="l00133"></a><span class="lineno">  133</span> </div>
<div class="line"><a id="l00134" name="l00134"></a><span class="lineno">  134</span>               <span class="comment">// // DEBUG CODE ============================================================================================================================================</span></div>
<div class="line"><a id="l00135" name="l00135"></a><span class="lineno">  135</span>               <span class="comment">// // Get total depths of sand consolidated and unconsolidated for every cell</span></div>
<div class="line"><a id="l00136" name="l00136"></a><span class="lineno">  136</span>               <span class="comment">// if (m_ulIter == 5)</span></div>
<div class="line"><a id="l00137" name="l00137"></a><span class="lineno">  137</span>               <span class="comment">// {</span></div>
<div class="line"><a id="l00138" name="l00138"></a><span class="lineno">  138</span>               <span class="comment">//    double dTmpSandCons = 0;</span></div>
<div class="line"><a id="l00139" name="l00139"></a><span class="lineno">  139</span>               <span class="comment">//    double dTmpSandUncons = 0;</span></div>
<div class="line"><a id="l00140" name="l00140"></a><span class="lineno">  140</span>               <span class="comment">//    for (int nX1 = 0; nX1 &lt; m_nXGridSize; nX1++)</span></div>
<div class="line"><a id="l00141" name="l00141"></a><span class="lineno">  141</span>               <span class="comment">//    {</span></div>
<div class="line"><a id="l00142" name="l00142"></a><span class="lineno">  142</span>               <span class="comment">//       for (int nY1 = 0; nY1 &lt; m_nYGridSize; nY1++)</span></div>
<div class="line"><a id="l00143" name="l00143"></a><span class="lineno">  143</span>               <span class="comment">//       {</span></div>
<div class="line"><a id="l00144" name="l00144"></a><span class="lineno">  144</span>               <span class="comment">//          dTmpSandCons += m_pRasterGrid-&gt;m_Cell[nX1][nY1].dGetTotConsSandThickConsiderNotch();</span></div>
<div class="line"><a id="l00145" name="l00145"></a><span class="lineno">  145</span>               <span class="comment">//</span></div>
<div class="line"><a id="l00146" name="l00146"></a><span class="lineno">  146</span>               <span class="comment">//          dTmpSandUncons += m_pRasterGrid-&gt;m_Cell[nX1][nY1].dGetTotUnconsSand();</span></div>
<div class="line"><a id="l00147" name="l00147"></a><span class="lineno">  147</span>               <span class="comment">//       }</span></div>
<div class="line"><a id="l00148" name="l00148"></a><span class="lineno">  148</span>               <span class="comment">//    }</span></div>
<div class="line"><a id="l00149" name="l00149"></a><span class="lineno">  149</span>               <span class="comment">//</span></div>
<div class="line"><a id="l00150" name="l00150"></a><span class="lineno">  150</span>               <span class="comment">//    // Get the cliff cell&#39;s grid coords</span></div>
<div class="line"><a id="l00151" name="l00151"></a><span class="lineno">  151</span>               <span class="comment">//    int nXCliff = pCliff-&gt;pPtiGetCellMarkedAsLF()-&gt;nGetX();</span></div>
<div class="line"><a id="l00152" name="l00152"></a><span class="lineno">  152</span>               <span class="comment">//    int nYCliff = pCliff-&gt;pPtiGetCellMarkedAsLF()-&gt;nGetY();</span></div>
<div class="line"><a id="l00153" name="l00153"></a><span class="lineno">  153</span>               <span class="comment">//</span></div>
<div class="line"><a id="l00154" name="l00154"></a><span class="lineno">  154</span>               <span class="comment">//    // Get this cell&#39;s polygon</span></div>
<div class="line"><a id="l00155" name="l00155"></a><span class="lineno">  155</span>               <span class="comment">//    int nPoly = m_pRasterGrid-&gt;m_Cell[nXCliff][nYCliff].nGetPolygonID();</span></div>
<div class="line"><a id="l00156" name="l00156"></a><span class="lineno">  156</span>               <span class="comment">//</span></div>
<div class="line"><a id="l00157" name="l00157"></a><span class="lineno">  157</span>               <span class="comment">//    LogStream &lt;&lt; endl;</span></div>
<div class="line"><a id="l00158" name="l00158"></a><span class="lineno">  158</span>               <span class="comment">//    LogStream &lt;&lt; &quot;*****************************&quot; &lt;&lt; endl;</span></div>
<div class="line"><a id="l00159" name="l00159"></a><span class="lineno">  159</span>               <span class="comment">//    LogStream &lt;&lt; m_ulIter &lt;&lt; &quot;: after cliff collapse on nPoly = &quot; &lt;&lt; nPoly &lt;&lt; &quot; total consolidated sand = &quot; &lt;&lt; dTmpSandCons * m_dCellArea &lt;&lt; &quot; total unconsolidated sand = &quot; &lt;&lt; dTmpSandUncons * m_dCellArea &lt;&lt; endl;</span></div>
<div class="line"><a id="l00160" name="l00160"></a><span class="lineno">  160</span>               <span class="comment">//    LogStream &lt;&lt; m_ulIter &lt;&lt; &quot;: total consolidated sand lost this iteration =  &quot; &lt;&lt; (m_dStartIterConsSandAllCells - dTmpSandCons) * m_dCellArea &lt;&lt; endl;</span></div>
<div class="line"><a id="l00161" name="l00161"></a><span class="lineno">  161</span>               <span class="comment">//    LogStream &lt;&lt; m_ulIter &lt;&lt; &quot;: total unconsolidated sand added this iteration =  &quot; &lt;&lt; (dTmpSandUncons - m_dStartIterUnconsSandAllCells) * m_dCellArea &lt;&lt; endl;</span></div>
<div class="line"><a id="l00162" name="l00162"></a><span class="lineno">  162</span>               <span class="comment">//</span></div>
<div class="line"><a id="l00163" name="l00163"></a><span class="lineno">  163</span>               <span class="comment">//    double dTmpAllPolySandErosion = 0;</span></div>
<div class="line"><a id="l00164" name="l00164"></a><span class="lineno">  164</span>               <span class="comment">//    double dTmpAllPolySandDeposition = 0;</span></div>
<div class="line"><a id="l00165" name="l00165"></a><span class="lineno">  165</span>               <span class="comment">//    for (unsigned int n = 0; n &lt; m_pVCoastPolygon.size(); n++)</span></div>
<div class="line"><a id="l00166" name="l00166"></a><span class="lineno">  166</span>               <span class="comment">//    {</span></div>
<div class="line"><a id="l00167" name="l00167"></a><span class="lineno">  167</span>               <span class="comment">//       double dTmpSandErosion = m_pVCoastPolygon[n]-&gt;dGetCliffCollapseErosionSand() * m_dCellArea ;</span></div>
<div class="line"><a id="l00168" name="l00168"></a><span class="lineno">  168</span>               <span class="comment">//       double dTmpSandDeposition = m_pVCoastPolygon[n]-&gt;dGetCliffCollapseUnconsSandDeposition() * m_dCellArea ;</span></div>
<div class="line"><a id="l00169" name="l00169"></a><span class="lineno">  169</span>               <span class="comment">//</span></div>
<div class="line"><a id="l00170" name="l00170"></a><span class="lineno">  170</span>               <span class="comment">//       LogStream &lt;&lt; m_ulIter &lt;&lt; &quot;: polygon = &quot; &lt;&lt; m_pVCoastPolygon[n]-&gt;nGetCoastID() &lt;&lt; &quot; sand erosion = &quot; &lt;&lt; dTmpSandErosion &lt;&lt; &quot; sand deposition = &quot; &lt;&lt; dTmpSandDeposition &lt;&lt; endl;</span></div>
<div class="line"><a id="l00171" name="l00171"></a><span class="lineno">  171</span>               <span class="comment">//</span></div>
<div class="line"><a id="l00172" name="l00172"></a><span class="lineno">  172</span>               <span class="comment">//       dTmpAllPolySandErosion += dTmpSandErosion;</span></div>
<div class="line"><a id="l00173" name="l00173"></a><span class="lineno">  173</span>               <span class="comment">//       dTmpAllPolySandDeposition += dTmpSandDeposition;</span></div>
<div class="line"><a id="l00174" name="l00174"></a><span class="lineno">  174</span>               <span class="comment">//    }</span></div>
<div class="line"><a id="l00175" name="l00175"></a><span class="lineno">  175</span>               <span class="comment">//</span></div>
<div class="line"><a id="l00176" name="l00176"></a><span class="lineno">  176</span>               <span class="comment">//    LogStream &lt;&lt; &quot;-------------------------------------------&quot; &lt;&lt; endl;</span></div>
<div class="line"><a id="l00177" name="l00177"></a><span class="lineno">  177</span>               <span class="comment">//    LogStream &lt;&lt; m_ulIter &lt;&lt; &quot;: all polygons, sand erosion = &quot; &lt;&lt; dTmpAllPolySandErosion &lt;&lt; &quot; sand deposition = &quot; &lt;&lt; dTmpAllPolySandDeposition &lt;&lt; endl;</span></div>
<div class="line"><a id="l00178" name="l00178"></a><span class="lineno">  178</span>               <span class="comment">//    LogStream &lt;&lt; &quot;*****************************&quot; &lt;&lt; endl;</span></div>
<div class="line"><a id="l00179" name="l00179"></a><span class="lineno">  179</span>               <span class="comment">// }</span></div>
<div class="line"><a id="l00180" name="l00180"></a><span class="lineno">  180</span>               <span class="comment">// // DEBUG CODE ============================================================================================================================================</span></div>
<div class="line"><a id="l00181" name="l00181"></a><span class="lineno">  181</span>            }</div>
<div class="line"><a id="l00182" name="l00182"></a><span class="lineno">  182</span>         }</div>
<div class="line"><a id="l00183" name="l00183"></a><span class="lineno">  183</span>      }</div>
<div class="line"><a id="l00184" name="l00184"></a><span class="lineno">  184</span>   }</div>
<div class="line"><a id="l00185" name="l00185"></a><span class="lineno">  185</span> </div>
<div class="line"><a id="l00186" name="l00186"></a><span class="lineno">  186</span>   <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a0245d3cbdd603fbeced6ca1465eb3f16">m_nLogFileDetail</a> &gt;= <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#aa58b13ad2e88aaa20449bfea242396a4">LOG_FILE_ALL</a>)</div>
<div class="line"><a id="l00187" name="l00187"></a><span class="lineno">  187</span>      <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a222962121613613a48f518e0c2110f21">LogStream</a> &lt;&lt; <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#ad67e8c5b30a0572f64ecfb5c062c2edc">m_ulIter</a> &lt;&lt; <span class="stringliteral">&quot;: total cliff collapse (m^3) = &quot;</span> &lt;&lt; (<a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a534390d32312d83a3564afd2f6fddc4e">m_dThisIterCliffCollapseErosionFineUncons</a> + <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#aad28423979cf34cb63c4e02e0260c4bb">m_dThisIterCliffCollapseErosionFineCons</a> + <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#ad241bd6dbff1824ca6f8fb6280f4d960">m_dThisIterCliffCollapseErosionSandUncons</a> + <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#acc2add764952e52de17425ae15c07219">m_dThisIterCliffCollapseErosionSandCons</a> + <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a495b588ec7b6b6440675712123870303">m_dThisIterCliffCollapseErosionCoarseUncons</a> + <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#aec4061ede2955755db0a1d4e5a1bfc36">m_dThisIterCliffCollapseErosionCoarseCons</a>) * <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#ac26ef813bdee563625a9a7be573a3741">m_dCellArea</a> &lt;&lt; <span class="stringliteral">&quot; (fine = &quot;</span> &lt;&lt; (<a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a534390d32312d83a3564afd2f6fddc4e">m_dThisIterCliffCollapseErosionFineUncons</a> + <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#aad28423979cf34cb63c4e02e0260c4bb">m_dThisIterCliffCollapseErosionFineCons</a>) * <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#ac26ef813bdee563625a9a7be573a3741">m_dCellArea</a> &lt;&lt; <span class="stringliteral">&quot;, sand = &quot;</span> &lt;&lt; (<a class="code hl_variable" href="../../d1/d98/classCSimulation.html#ad241bd6dbff1824ca6f8fb6280f4d960">m_dThisIterCliffCollapseErosionSandUncons</a> + <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#acc2add764952e52de17425ae15c07219">m_dThisIterCliffCollapseErosionSandCons</a>) * <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#ac26ef813bdee563625a9a7be573a3741">m_dCellArea</a> &lt;&lt; <span class="stringliteral">&quot;, coarse = &quot;</span> &lt;&lt; (<a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a495b588ec7b6b6440675712123870303">m_dThisIterCliffCollapseErosionCoarseUncons</a> + <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#aec4061ede2955755db0a1d4e5a1bfc36">m_dThisIterCliffCollapseErosionCoarseCons</a>) * <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#ac26ef813bdee563625a9a7be573a3741">m_dCellArea</a> &lt;&lt; <span class="stringliteral">&quot;), talus deposition (m^3) = &quot;</span> &lt;&lt; (<a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a90adbbfff9b8ce4f40ce6010657b375b">m_dThisIterUnconsSandCliffDeposition</a> + <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a89aac08d3cfa2f5f5793b3ca6400e868">m_dThisIterUnconsCoarseCliffDeposition</a>) * <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#ac26ef813bdee563625a9a7be573a3741">m_dCellArea</a> &lt;&lt; <span class="stringliteral">&quot; (sand = &quot;</span> &lt;&lt; <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a90adbbfff9b8ce4f40ce6010657b375b">m_dThisIterUnconsSandCliffDeposition</a> * <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#ac26ef813bdee563625a9a7be573a3741">m_dCellArea</a> &lt;&lt; <span class="stringliteral">&quot;, coarse = &quot;</span> &lt;&lt; <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a90adbbfff9b8ce4f40ce6010657b375b">m_dThisIterUnconsSandCliffDeposition</a> * <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#ac26ef813bdee563625a9a7be573a3741">m_dCellArea</a> &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a id="l00188" name="l00188"></a><span class="lineno">  188</span> </div>
<div class="line"><a id="l00189" name="l00189"></a><span class="lineno">  189</span>   <span class="keywordflow">return</span> <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#aa768cb14b5c6123ee95e6e4ebd9fe331">RTN_OK</a>;</div>
<div class="line"><a id="l00190" name="l00190"></a><span class="lineno">  190</span>}</div>
</div>
<div class="line"><a id="l00191" name="l00191"></a><span class="lineno">  191</span> </div>
<div class="line"><a id="l00192" name="l00192"></a><span class="lineno">  192</span><span class="comment">//===============================================================================================================================</span></div>
<div class="line"><a id="l00194" name="l00194"></a><span class="lineno">  194</span><span class="comment">//===============================================================================================================================</span></div>
<div class="foldopen" id="foldopen00195" data-start="{" data-end="}">
<div class="line"><a id="l00195" name="l00195"></a><span class="lineno"><a class="line" href="../../d1/d98/classCSimulation.html#aa49a03295b1c3da6f5be1cfbf6af02fc">  195</a></span><span class="keywordtype">int</span> <a class="code hl_function" href="../../d1/d98/classCSimulation.html#aa49a03295b1c3da6f5be1cfbf6af02fc">CSimulation::nDoCliffCollapse</a>(<span class="keywordtype">int</span> <span class="keyword">const</span> nCoast, <a class="code hl_class" href="../../d9/d8b/classCRWCliff.html">CRWCliff</a>* pCliff, <span class="keywordtype">double</span>&amp; dFineCollapse, <span class="keywordtype">double</span>&amp; dSandCollapse, <span class="keywordtype">double</span>&amp; dCoarseCollapse, <span class="keywordtype">double</span>&amp; dPreCollapseCliffElev, <span class="keywordtype">double</span>&amp; dPostCollapseCliffElev)</div>
<div class="line"><a id="l00196" name="l00196"></a><span class="lineno">  196</span>{</div>
<div class="line"><a id="l00197" name="l00197"></a><span class="lineno">  197</span>   <span class="comment">// Get the cliff cell&#39;s grid coords</span></div>
<div class="line"><a id="l00198" name="l00198"></a><span class="lineno">  198</span>   <span class="keywordtype">int</span> nX = pCliff-&gt;<a class="code hl_function" href="../../d2/de0/classCACoastLandform.html#afd4b936869e33c47d2a741ff6404abf3">pPtiGetCellMarkedAsLF</a>()-&gt;<a class="code hl_function" href="../../d6/d0d/classCGeom2DIPoint.html#af84c687b2d0be01ab41cbcc0565f4f3f">nGetX</a>();</div>
<div class="line"><a id="l00199" name="l00199"></a><span class="lineno">  199</span>   <span class="keywordtype">int</span> nY = pCliff-&gt;<a class="code hl_function" href="../../d2/de0/classCACoastLandform.html#afd4b936869e33c47d2a741ff6404abf3">pPtiGetCellMarkedAsLF</a>()-&gt;<a class="code hl_function" href="../../d6/d0d/classCGeom2DIPoint.html#a4d9c20bcca90dcb9d519b664aba09cbd">nGetY</a>();</div>
<div class="line"><a id="l00200" name="l00200"></a><span class="lineno">  200</span>    </div>
<div class="line"><a id="l00201" name="l00201"></a><span class="lineno">  201</span>   <span class="comment">// Get this cell&#39;s polygon</span></div>
<div class="line"><a id="l00202" name="l00202"></a><span class="lineno">  202</span>   <span class="keywordtype">int</span> nPoly = <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[nX][nY].nGetPolygonID();</div>
<div class="line"><a id="l00203" name="l00203"></a><span class="lineno">  203</span>   <span class="keywordflow">if</span> (nPoly == <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#a01aa8b423260b337ddff2016107b51a0">INT_NODATA</a>)</div>
<div class="line"><a id="l00204" name="l00204"></a><span class="lineno">  204</span>   {</div>
<div class="line"><a id="l00205" name="l00205"></a><span class="lineno">  205</span>      <span class="comment">// This cell isn&#39;t in a polygon</span></div>
<div class="line"><a id="l00206" name="l00206"></a><span class="lineno">  206</span>      <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a222962121613613a48f518e0c2110f21">LogStream</a> &lt;&lt; <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#ad67e8c5b30a0572f64ecfb5c062c2edc">m_ulIter</a> &lt;&lt; <span class="stringliteral">&quot; : in nDoCliffCollapse(), [&quot;</span> &lt;&lt; nX &lt;&lt; <span class="stringliteral">&quot;][&quot;</span> &lt;&lt; nY &lt;&lt; <span class="stringliteral">&quot;] = {&quot;</span> &lt;&lt; <a class="code hl_function" href="../../d1/d98/classCSimulation.html#ad79b925ac5f358c6f867b6e47dad74bd">dGridCentroidXToExtCRSX</a>(nX) &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; <a class="code hl_function" href="../../d1/d98/classCSimulation.html#a7e2a4bd69ce79377fee86aa5598903f8">dGridCentroidYToExtCRSY</a>(nY) &lt;&lt; <span class="stringliteral">&quot;} is not in a polygon&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a id="l00207" name="l00207"></a><span class="lineno">  207</span>      </div>
<div class="line"><a id="l00208" name="l00208"></a><span class="lineno">  208</span>      <span class="keywordflow">return</span> <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#a8e182d96bc7134148551c890343aef9b">RTN_ERR_CLIFF_NOT_IN_POLYGON</a>;</div>
<div class="line"><a id="l00209" name="l00209"></a><span class="lineno">  209</span>   }</div>
<div class="line"><a id="l00210" name="l00210"></a><span class="lineno">  210</span> </div>
<div class="line"><a id="l00211" name="l00211"></a><span class="lineno">  211</span>   <a class="code hl_class" href="../../df/d45/classCGeomCoastPolygon.html">CGeomCoastPolygon</a>* pPolygon = <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a25ada8139c82ca7beab3f279cff83184">m_VCoast</a>[nCoast].pGetPolygon(nPoly);</div>
<div class="line"><a id="l00212" name="l00212"></a><span class="lineno">  212</span>       </div>
<div class="line"><a id="l00213" name="l00213"></a><span class="lineno">  213</span>   <span class="comment">// Get the elevation of the base of the notch from the cliff object</span></div>
<div class="line"><a id="l00214" name="l00214"></a><span class="lineno">  214</span>   <span class="keywordtype">double</span> dNotchElev = pCliff-&gt;<a class="code hl_function" href="../../d9/d8b/classCRWCliff.html#a70151d708b933a25eb7836d63cea7f8b">dGetNotchBaseElev</a>() - <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a67be223b916774e3eabb4bc5bf232eda">m_dNotchBaseBelowSWL</a>;</div>
<div class="line"><a id="l00215" name="l00215"></a><span class="lineno">  215</span> </div>
<div class="line"><a id="l00216" name="l00216"></a><span class="lineno">  216</span>   <span class="comment">// Get the index of the layer containing the notch (layer 0 being just above basement)</span></div>
<div class="line"><a id="l00217" name="l00217"></a><span class="lineno">  217</span>   <span class="keywordtype">int</span> nNotchLayer = <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[nX][nY].nGetLayerAtElev(dNotchElev);</div>
<div class="line"><a id="l00218" name="l00218"></a><span class="lineno">  218</span>   <span class="keywordflow">if</span> (nNotchLayer == <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#a1a0f3745fbc2e50a9f483893339c9f75">ELEV_ABOVE_SEDIMENT_TOP</a>)</div>
<div class="line"><a id="l00219" name="l00219"></a><span class="lineno">  219</span>   {</div>
<div class="line"><a id="l00220" name="l00220"></a><span class="lineno">  220</span>      <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a0245d3cbdd603fbeced6ca1465eb3f16">m_nLogFileDetail</a> &gt;= <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#a85da1142fa4655ec66f1e391444a6d9a">LOG_FILE_HIGH_DETAIL</a>)</div>
<div class="line"><a id="l00221" name="l00221"></a><span class="lineno">  221</span>         <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a222962121613613a48f518e0c2110f21">LogStream</a> &lt;&lt; <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#ad67e8c5b30a0572f64ecfb5c062c2edc">m_ulIter</a> &lt;&lt; <span class="stringliteral">&quot;: &quot;</span> &lt;&lt; <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#a292fc90846543ca4814daa9f759feb05">ERR</a> &lt;&lt; <span class="stringliteral">&quot; cell [&quot;</span> &lt;&lt; nX &lt;&lt; <span class="stringliteral">&quot;][&quot;</span> &lt;&lt; nY &lt;&lt; <span class="stringliteral">&quot;] has dNotchElev (&quot;</span> &lt;&lt; dNotchElev &lt;&lt; <span class="stringliteral">&quot;) above sediment top elevation (&quot;</span> &lt;&lt; <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[nX][nY].dGetSedimentTopElev() &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a id="l00222" name="l00222"></a><span class="lineno">  222</span> </div>
<div class="line"><a id="l00223" name="l00223"></a><span class="lineno">  223</span>      <span class="keywordflow">return</span> <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#a073ffbb4921531737dc0dee04bdcbe11">RTN_ERR_CLIFFNOTCH</a>;</div>
<div class="line"><a id="l00224" name="l00224"></a><span class="lineno">  224</span>   }</div>
<div class="line"><a id="l00225" name="l00225"></a><span class="lineno">  225</span> </div>
<div class="line"><a id="l00226" name="l00226"></a><span class="lineno">  226</span>   <span class="comment">// Flag the coastline cliff object as having collapsed</span></div>
<div class="line"><a id="l00227" name="l00227"></a><span class="lineno">  227</span>   pCliff-&gt;<a class="code hl_function" href="../../d9/d8b/classCRWCliff.html#ab7084345058193f7084d7fcaecb9ea1b">SetCliffCollapsed</a>();</div>
<div class="line"><a id="l00228" name="l00228"></a><span class="lineno">  228</span> </div>
<div class="line"><a id="l00229" name="l00229"></a><span class="lineno">  229</span>   <span class="keywordtype">int</span> nTopLayer = <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[nX][nY].nGetTopLayerAboveBasement();</div>
<div class="line"><a id="l00230" name="l00230"></a><span class="lineno">  230</span> </div>
<div class="line"><a id="l00231" name="l00231"></a><span class="lineno">  231</span>   <span class="comment">// Safety check</span></div>
<div class="line"><a id="l00232" name="l00232"></a><span class="lineno">  232</span>   <span class="keywordflow">if</span> (nTopLayer == <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#a01aa8b423260b337ddff2016107b51a0">INT_NODATA</a>)</div>
<div class="line"><a id="l00233" name="l00233"></a><span class="lineno">  233</span>      <span class="keywordflow">return</span> <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#a0af2b64c1c33dbf4d223944b0bf234e6">RTN_ERR_NO_TOP_LAYER</a>;</div>
<div class="line"><a id="l00234" name="l00234"></a><span class="lineno">  234</span> </div>
<div class="line"><a id="l00235" name="l00235"></a><span class="lineno">  235</span>   <span class="comment">// Set the base of the collapse (see above)</span></div>
<div class="line"><a id="l00236" name="l00236"></a><span class="lineno">  236</span>   pCliff-&gt;<a class="code hl_function" href="../../d9/d8b/classCRWCliff.html#a73acc82455562b794d027455c1b8c3d5">SetNotchBaseElev</a>(dNotchElev);</div>
<div class="line"><a id="l00237" name="l00237"></a><span class="lineno">  237</span>   </div>
<div class="line"><a id="l00238" name="l00238"></a><span class="lineno">  238</span>   <span class="comment">// Set flags to say that the top layer has changed</span></div>
<div class="line"><a id="l00239" name="l00239"></a><span class="lineno">  239</span>   <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#aee72433983f1b26c0b734ee7b0d26014">m_bConsChangedThisIter</a>[nTopLayer] = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00240" name="l00240"></a><span class="lineno">  240</span>   <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#aa6ebdb3d36ad3cea05ec1446f20cacb8">m_bUnconsChangedThisIter</a>[nTopLayer] = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00241" name="l00241"></a><span class="lineno">  241</span>   </div>
<div class="line"><a id="l00242" name="l00242"></a><span class="lineno">  242</span>   <span class="comment">// Get the pre-collapse cliff elevation</span></div>
<div class="line"><a id="l00243" name="l00243"></a><span class="lineno">  243</span>   dPreCollapseCliffElev = <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[nX][nY].dGetSedimentTopElev();</div>
<div class="line"><a id="l00244" name="l00244"></a><span class="lineno">  244</span> </div>
<div class="line"><a id="l00245" name="l00245"></a><span class="lineno">  245</span>   <span class="comment">// Now calculate the vertical depth of sediment lost in this cliff collapse. In CoastalME, all depth equivalents are assumed to be a depth upon the whole of a cell i.e. upon the area of a whole cell. So to keep the depth of cliff collapse consistent with all other depth equivalents, weight it by the fraction of the cell&#39;s area which is being removed</span></div>
<div class="line"><a id="l00246" name="l00246"></a><span class="lineno">  246</span>   <span class="keywordtype">double</span> dAvailable = 0;</div>
<div class="line"><a id="l00247" name="l00247"></a><span class="lineno">  247</span>   <span class="keywordtype">double</span> dFineConsLost = 0;</div>
<div class="line"><a id="l00248" name="l00248"></a><span class="lineno">  248</span>   <span class="keywordtype">double</span> dFineUnconsLost = 0;</div>
<div class="line"><a id="l00249" name="l00249"></a><span class="lineno">  249</span>   <span class="keywordtype">double</span> dSandConsLost = 0;</div>
<div class="line"><a id="l00250" name="l00250"></a><span class="lineno">  250</span>   <span class="keywordtype">double</span> dSandUnconsLost = 0;</div>
<div class="line"><a id="l00251" name="l00251"></a><span class="lineno">  251</span>   <span class="keywordtype">double</span> dCoarseConsLost = 0;</div>
<div class="line"><a id="l00252" name="l00252"></a><span class="lineno">  252</span>   <span class="keywordtype">double</span> dCoarseUnconsLost = 0;</div>
<div class="line"><a id="l00253" name="l00253"></a><span class="lineno">  253</span> </div>
<div class="line"><a id="l00254" name="l00254"></a><span class="lineno">  254</span>   <span class="comment">// Now update the cell&#39;s sediment. If there are sediment layers above the notched layer, we must remove sediment from the whole depth of each layer</span></div>
<div class="line"><a id="l00255" name="l00255"></a><span class="lineno">  255</span>   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n = nTopLayer; n &gt; nNotchLayer; n--)</div>
<div class="line"><a id="l00256" name="l00256"></a><span class="lineno">  256</span>   {</div>
<div class="line"><a id="l00257" name="l00257"></a><span class="lineno">  257</span>      <span class="comment">// Start with the unconsolidated sediment</span></div>
<div class="line"><a id="l00258" name="l00258"></a><span class="lineno">  258</span>      dAvailable = <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[nX][nY].pGetLayerAboveBasement(n)-&gt;pGetUnconsolidatedSediment()-&gt;dGetFineDepth() - <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[nX][nY].pGetLayerAboveBasement(n)-&gt;pGetUnconsolidatedSediment()-&gt;dGetNotchFineLost();</div>
<div class="line"><a id="l00259" name="l00259"></a><span class="lineno">  259</span>      <span class="keywordflow">if</span> (dAvailable &gt; 0)</div>
<div class="line"><a id="l00260" name="l00260"></a><span class="lineno">  260</span>      {</div>
<div class="line"><a id="l00261" name="l00261"></a><span class="lineno">  261</span>         dFineCollapse += dAvailable;</div>
<div class="line"><a id="l00262" name="l00262"></a><span class="lineno">  262</span>         dFineUnconsLost += dAvailable;</div>
<div class="line"><a id="l00263" name="l00263"></a><span class="lineno">  263</span>         <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[nX][nY].pGetLayerAboveBasement(n)-&gt;pGetUnconsolidatedSediment()-&gt;SetFineDepth(0);</div>
<div class="line"><a id="l00264" name="l00264"></a><span class="lineno">  264</span>         <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[nX][nY].pGetLayerAboveBasement(n)-&gt;pGetUnconsolidatedSediment()-&gt;SetNotchFineLost(0);         </div>
<div class="line"><a id="l00265" name="l00265"></a><span class="lineno">  265</span>      }</div>
<div class="line"><a id="l00266" name="l00266"></a><span class="lineno">  266</span> </div>
<div class="line"><a id="l00267" name="l00267"></a><span class="lineno">  267</span>      dAvailable = <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[nX][nY].pGetLayerAboveBasement(n)-&gt;pGetUnconsolidatedSediment()-&gt;dGetSandDepth() - <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[nX][nY].pGetLayerAboveBasement(n)-&gt;pGetUnconsolidatedSediment()-&gt;dGetNotchSandLost();</div>
<div class="line"><a id="l00268" name="l00268"></a><span class="lineno">  268</span>      <span class="keywordflow">if</span> (dAvailable &gt; 0)</div>
<div class="line"><a id="l00269" name="l00269"></a><span class="lineno">  269</span>      {</div>
<div class="line"><a id="l00270" name="l00270"></a><span class="lineno">  270</span>         dSandCollapse += dAvailable;</div>
<div class="line"><a id="l00271" name="l00271"></a><span class="lineno">  271</span>         dSandUnconsLost += dAvailable;</div>
<div class="line"><a id="l00272" name="l00272"></a><span class="lineno">  272</span>         <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[nX][nY].pGetLayerAboveBasement(n)-&gt;pGetUnconsolidatedSediment()-&gt;SetSandDepth(0);</div>
<div class="line"><a id="l00273" name="l00273"></a><span class="lineno">  273</span>         <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[nX][nY].pGetLayerAboveBasement(n)-&gt;pGetUnconsolidatedSediment()-&gt;SetNotchSandLost(0);         </div>
<div class="line"><a id="l00274" name="l00274"></a><span class="lineno">  274</span>      }</div>
<div class="line"><a id="l00275" name="l00275"></a><span class="lineno">  275</span> </div>
<div class="line"><a id="l00276" name="l00276"></a><span class="lineno">  276</span>      dAvailable = <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[nX][nY].pGetLayerAboveBasement(n)-&gt;pGetUnconsolidatedSediment()-&gt;dGetCoarseDepth() - <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[nX][nY].pGetLayerAboveBasement(n)-&gt;pGetUnconsolidatedSediment()-&gt;dGetNotchCoarseLost();</div>
<div class="line"><a id="l00277" name="l00277"></a><span class="lineno">  277</span>      <span class="keywordflow">if</span> (dAvailable &gt; 0)</div>
<div class="line"><a id="l00278" name="l00278"></a><span class="lineno">  278</span>      {</div>
<div class="line"><a id="l00279" name="l00279"></a><span class="lineno">  279</span>         dCoarseCollapse += dAvailable;</div>
<div class="line"><a id="l00280" name="l00280"></a><span class="lineno">  280</span>         dCoarseUnconsLost += dAvailable;</div>
<div class="line"><a id="l00281" name="l00281"></a><span class="lineno">  281</span>         <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[nX][nY].pGetLayerAboveBasement(n)-&gt;pGetUnconsolidatedSediment()-&gt;SetCoarseDepth(0);</div>
<div class="line"><a id="l00282" name="l00282"></a><span class="lineno">  282</span>         <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[nX][nY].pGetLayerAboveBasement(n)-&gt;pGetUnconsolidatedSediment()-&gt;SetNotchCoarseLost(0);         </div>
<div class="line"><a id="l00283" name="l00283"></a><span class="lineno">  283</span>      }</div>
<div class="line"><a id="l00284" name="l00284"></a><span class="lineno">  284</span> </div>
<div class="line"><a id="l00285" name="l00285"></a><span class="lineno">  285</span>      <span class="comment">// Now get the consolidated sediment</span></div>
<div class="line"><a id="l00286" name="l00286"></a><span class="lineno">  286</span>      dAvailable = <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[nX][nY].pGetLayerAboveBasement(n)-&gt;pGetConsolidatedSediment()-&gt;dGetFineDepth() - <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[nX][nY].pGetLayerAboveBasement(n)-&gt;pGetConsolidatedSediment()-&gt;dGetNotchFineLost();</div>
<div class="line"><a id="l00287" name="l00287"></a><span class="lineno">  287</span>      <span class="keywordflow">if</span> (dAvailable &gt; 0)</div>
<div class="line"><a id="l00288" name="l00288"></a><span class="lineno">  288</span>      {</div>
<div class="line"><a id="l00289" name="l00289"></a><span class="lineno">  289</span>         dFineCollapse += dAvailable;</div>
<div class="line"><a id="l00290" name="l00290"></a><span class="lineno">  290</span>         dFineConsLost += dAvailable;</div>
<div class="line"><a id="l00291" name="l00291"></a><span class="lineno">  291</span>         <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[nX][nY].pGetLayerAboveBasement(n)-&gt;pGetConsolidatedSediment()-&gt;SetFineDepth(0);</div>
<div class="line"><a id="l00292" name="l00292"></a><span class="lineno">  292</span>         <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[nX][nY].pGetLayerAboveBasement(n)-&gt;pGetConsolidatedSediment()-&gt;SetNotchFineLost(0);         </div>
<div class="line"><a id="l00293" name="l00293"></a><span class="lineno">  293</span>      }</div>
<div class="line"><a id="l00294" name="l00294"></a><span class="lineno">  294</span> </div>
<div class="line"><a id="l00295" name="l00295"></a><span class="lineno">  295</span>      dAvailable = <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[nX][nY].pGetLayerAboveBasement(n)-&gt;pGetConsolidatedSediment()-&gt;dGetSandDepth() - <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[nX][nY].pGetLayerAboveBasement(n)-&gt;pGetConsolidatedSediment()-&gt;dGetNotchSandLost();</div>
<div class="line"><a id="l00296" name="l00296"></a><span class="lineno">  296</span>      <span class="keywordflow">if</span> (dAvailable &gt; 0)</div>
<div class="line"><a id="l00297" name="l00297"></a><span class="lineno">  297</span>      {</div>
<div class="line"><a id="l00298" name="l00298"></a><span class="lineno">  298</span>         dSandCollapse += dAvailable;</div>
<div class="line"><a id="l00299" name="l00299"></a><span class="lineno">  299</span>         dSandConsLost += dAvailable;</div>
<div class="line"><a id="l00300" name="l00300"></a><span class="lineno">  300</span>         <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[nX][nY].pGetLayerAboveBasement(n)-&gt;pGetConsolidatedSediment()-&gt;SetSandDepth(0);</div>
<div class="line"><a id="l00301" name="l00301"></a><span class="lineno">  301</span>         <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[nX][nY].pGetLayerAboveBasement(n)-&gt;pGetConsolidatedSediment()-&gt;SetNotchSandLost(0);         </div>
<div class="line"><a id="l00302" name="l00302"></a><span class="lineno">  302</span>      }</div>
<div class="line"><a id="l00303" name="l00303"></a><span class="lineno">  303</span> </div>
<div class="line"><a id="l00304" name="l00304"></a><span class="lineno">  304</span>      dAvailable = <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[nX][nY].pGetLayerAboveBasement(n)-&gt;pGetConsolidatedSediment()-&gt;dGetCoarseDepth() - <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[nX][nY].pGetLayerAboveBasement(n)-&gt;pGetConsolidatedSediment()-&gt;dGetNotchCoarseLost();</div>
<div class="line"><a id="l00305" name="l00305"></a><span class="lineno">  305</span>      <span class="keywordflow">if</span> (dAvailable &gt; 0)</div>
<div class="line"><a id="l00306" name="l00306"></a><span class="lineno">  306</span>      {</div>
<div class="line"><a id="l00307" name="l00307"></a><span class="lineno">  307</span>         dCoarseCollapse += dAvailable;</div>
<div class="line"><a id="l00308" name="l00308"></a><span class="lineno">  308</span>         dCoarseConsLost += dAvailable;</div>
<div class="line"><a id="l00309" name="l00309"></a><span class="lineno">  309</span>         <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[nX][nY].pGetLayerAboveBasement(n)-&gt;pGetConsolidatedSediment()-&gt;SetCoarseDepth(0);</div>
<div class="line"><a id="l00310" name="l00310"></a><span class="lineno">  310</span>         <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[nX][nY].pGetLayerAboveBasement(n)-&gt;pGetConsolidatedSediment()-&gt;SetNotchCoarseLost(0);         </div>
<div class="line"><a id="l00311" name="l00311"></a><span class="lineno">  311</span>      }</div>
<div class="line"><a id="l00312" name="l00312"></a><span class="lineno">  312</span>   }</div>
<div class="line"><a id="l00313" name="l00313"></a><span class="lineno">  313</span> </div>
<div class="line"><a id="l00314" name="l00314"></a><span class="lineno">  314</span>   <span class="comment">// Now sort out the sediment lost from the consolidated layer into which the erosional notch was incised</span></div>
<div class="line"><a id="l00315" name="l00315"></a><span class="lineno">  315</span>   <span class="keywordtype">double</span> dNotchLayerTop = <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[nX][nY].dCalcLayerElev(nNotchLayer);</div>
<div class="line"><a id="l00316" name="l00316"></a><span class="lineno">  316</span>   <span class="keywordtype">double</span> dNotchLayerThickness = <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[nX][nY].pGetLayerAboveBasement(nNotchLayer)-&gt;dGetTotalThickness();</div>
<div class="line"><a id="l00317" name="l00317"></a><span class="lineno">  317</span>   <span class="keywordtype">double</span> dNotchLayerFracRemoved = (dNotchLayerTop - dNotchElev) / dNotchLayerThickness;</div>
<div class="line"><a id="l00318" name="l00318"></a><span class="lineno">  318</span> </div>
<div class="line"><a id="l00319" name="l00319"></a><span class="lineno">  319</span>   <span class="comment">// Sort out the notched layer&#39;s sediment, both consolidated and unconsolidated, for this cell. First the unconsolidated sediment</span></div>
<div class="line"><a id="l00320" name="l00320"></a><span class="lineno">  320</span>   <span class="keywordtype">double</span> dFineDepth = <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[nX][nY].pGetLayerAboveBasement(nNotchLayer)-&gt;pGetUnconsolidatedSediment()-&gt;dGetFineDepth();</div>
<div class="line"><a id="l00321" name="l00321"></a><span class="lineno">  321</span>   dAvailable = dFineDepth - <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[nX][nY].pGetLayerAboveBasement(nNotchLayer)-&gt;pGetUnconsolidatedSediment()-&gt;dGetNotchFineLost();</div>
<div class="line"><a id="l00322" name="l00322"></a><span class="lineno">  322</span>   <span class="keywordflow">if</span> (dAvailable &gt; 0)</div>
<div class="line"><a id="l00323" name="l00323"></a><span class="lineno">  323</span>   {</div>
<div class="line"><a id="l00324" name="l00324"></a><span class="lineno">  324</span>      <span class="comment">// Some unconsolidated fine sediment is available for collapse</span></div>
<div class="line"><a id="l00325" name="l00325"></a><span class="lineno">  325</span>      <span class="keywordtype">double</span> dLost = dAvailable * dNotchLayerFracRemoved;</div>
<div class="line"><a id="l00326" name="l00326"></a><span class="lineno">  326</span>      dFineCollapse += dLost;</div>
<div class="line"><a id="l00327" name="l00327"></a><span class="lineno">  327</span>      dFineUnconsLost += dLost;</div>
<div class="line"><a id="l00328" name="l00328"></a><span class="lineno">  328</span>      <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[nX][nY].pGetLayerAboveBasement(nNotchLayer)-&gt;pGetUnconsolidatedSediment()-&gt;SetFineDepth(dFineDepth - dLost);</div>
<div class="line"><a id="l00329" name="l00329"></a><span class="lineno">  329</span>      <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[nX][nY].pGetLayerAboveBasement(nNotchLayer)-&gt;pGetUnconsolidatedSediment()-&gt;SetNotchFineLost(0);</div>
<div class="line"><a id="l00330" name="l00330"></a><span class="lineno">  330</span>   }</div>
<div class="line"><a id="l00331" name="l00331"></a><span class="lineno">  331</span> </div>
<div class="line"><a id="l00332" name="l00332"></a><span class="lineno">  332</span>   <span class="keywordtype">double</span> dSandDepth = <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[nX][nY].pGetLayerAboveBasement(nNotchLayer)-&gt;pGetUnconsolidatedSediment()-&gt;dGetSandDepth();</div>
<div class="line"><a id="l00333" name="l00333"></a><span class="lineno">  333</span>   dAvailable = dSandDepth - <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[nX][nY].pGetLayerAboveBasement(nNotchLayer)-&gt;pGetUnconsolidatedSediment()-&gt;dGetNotchSandLost();</div>
<div class="line"><a id="l00334" name="l00334"></a><span class="lineno">  334</span>   <span class="keywordflow">if</span> (dAvailable &gt; 0)</div>
<div class="line"><a id="l00335" name="l00335"></a><span class="lineno">  335</span>   {</div>
<div class="line"><a id="l00336" name="l00336"></a><span class="lineno">  336</span>      <span class="comment">// Some unconsolidated sand sediment is available for collapse</span></div>
<div class="line"><a id="l00337" name="l00337"></a><span class="lineno">  337</span>      <span class="keywordtype">double</span> dLost = dAvailable * dNotchLayerFracRemoved;</div>
<div class="line"><a id="l00338" name="l00338"></a><span class="lineno">  338</span>      dSandCollapse += dLost;</div>
<div class="line"><a id="l00339" name="l00339"></a><span class="lineno">  339</span>      dSandUnconsLost += dLost;</div>
<div class="line"><a id="l00340" name="l00340"></a><span class="lineno">  340</span>      <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[nX][nY].pGetLayerAboveBasement(nNotchLayer)-&gt;pGetUnconsolidatedSediment()-&gt;SetSandDepth(dSandDepth - dLost);</div>
<div class="line"><a id="l00341" name="l00341"></a><span class="lineno">  341</span>      <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[nX][nY].pGetLayerAboveBasement(nNotchLayer)-&gt;pGetUnconsolidatedSediment()-&gt;SetNotchSandLost(0);</div>
<div class="line"><a id="l00342" name="l00342"></a><span class="lineno">  342</span>   }</div>
<div class="line"><a id="l00343" name="l00343"></a><span class="lineno">  343</span> </div>
<div class="line"><a id="l00344" name="l00344"></a><span class="lineno">  344</span>   <span class="keywordtype">double</span> dCoarseDepth = <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[nX][nY].pGetLayerAboveBasement(nNotchLayer)-&gt;pGetUnconsolidatedSediment()-&gt;dGetCoarseDepth();</div>
<div class="line"><a id="l00345" name="l00345"></a><span class="lineno">  345</span>   dAvailable = dCoarseDepth - <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[nX][nY].pGetLayerAboveBasement(nNotchLayer)-&gt;pGetUnconsolidatedSediment()-&gt;dGetNotchCoarseLost();</div>
<div class="line"><a id="l00346" name="l00346"></a><span class="lineno">  346</span>   <span class="keywordflow">if</span> (dAvailable &gt; 0)</div>
<div class="line"><a id="l00347" name="l00347"></a><span class="lineno">  347</span>   {</div>
<div class="line"><a id="l00348" name="l00348"></a><span class="lineno">  348</span>      <span class="comment">// Some unconsolidated coarse sediment is available for collapse</span></div>
<div class="line"><a id="l00349" name="l00349"></a><span class="lineno">  349</span>      <span class="keywordtype">double</span> dLost = dAvailable * dNotchLayerFracRemoved;</div>
<div class="line"><a id="l00350" name="l00350"></a><span class="lineno">  350</span>      dCoarseCollapse += dLost;</div>
<div class="line"><a id="l00351" name="l00351"></a><span class="lineno">  351</span>      dCoarseUnconsLost += dLost;</div>
<div class="line"><a id="l00352" name="l00352"></a><span class="lineno">  352</span>      <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[nX][nY].pGetLayerAboveBasement(nNotchLayer)-&gt;pGetUnconsolidatedSediment()-&gt;SetCoarseDepth(dCoarseDepth - dLost);</div>
<div class="line"><a id="l00353" name="l00353"></a><span class="lineno">  353</span>      <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[nX][nY].pGetLayerAboveBasement(nNotchLayer)-&gt;pGetUnconsolidatedSediment()-&gt;SetNotchCoarseLost(0);</div>
<div class="line"><a id="l00354" name="l00354"></a><span class="lineno">  354</span>   }</div>
<div class="line"><a id="l00355" name="l00355"></a><span class="lineno">  355</span> </div>
<div class="line"><a id="l00356" name="l00356"></a><span class="lineno">  356</span>   <span class="comment">// Now do the consolidated sediment</span></div>
<div class="line"><a id="l00357" name="l00357"></a><span class="lineno">  357</span>   dFineDepth = <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[nX][nY].pGetLayerAboveBasement(nNotchLayer)-&gt;pGetConsolidatedSediment()-&gt;dGetFineDepth();</div>
<div class="line"><a id="l00358" name="l00358"></a><span class="lineno">  358</span>   dAvailable = dFineDepth - <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[nX][nY].pGetLayerAboveBasement(nNotchLayer)-&gt;pGetConsolidatedSediment()-&gt;dGetNotchFineLost();</div>
<div class="line"><a id="l00359" name="l00359"></a><span class="lineno">  359</span>   <span class="keywordflow">if</span> (dAvailable &gt; 0)</div>
<div class="line"><a id="l00360" name="l00360"></a><span class="lineno">  360</span>   {</div>
<div class="line"><a id="l00361" name="l00361"></a><span class="lineno">  361</span>      <span class="comment">// Some consolidated fine sediment is available for collapse</span></div>
<div class="line"><a id="l00362" name="l00362"></a><span class="lineno">  362</span>      <span class="keywordtype">double</span> dLost = dAvailable * dNotchLayerFracRemoved;</div>
<div class="line"><a id="l00363" name="l00363"></a><span class="lineno">  363</span>      dFineCollapse += dLost;</div>
<div class="line"><a id="l00364" name="l00364"></a><span class="lineno">  364</span>      dFineConsLost += dLost;</div>
<div class="line"><a id="l00365" name="l00365"></a><span class="lineno">  365</span>      <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[nX][nY].pGetLayerAboveBasement(nNotchLayer)-&gt;pGetConsolidatedSediment()-&gt;SetFineDepth(dFineDepth - dLost);</div>
<div class="line"><a id="l00366" name="l00366"></a><span class="lineno">  366</span>      <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[nX][nY].pGetLayerAboveBasement(nNotchLayer)-&gt;pGetConsolidatedSediment()-&gt;SetNotchFineLost(0);</div>
<div class="line"><a id="l00367" name="l00367"></a><span class="lineno">  367</span>   }</div>
<div class="line"><a id="l00368" name="l00368"></a><span class="lineno">  368</span> </div>
<div class="line"><a id="l00369" name="l00369"></a><span class="lineno">  369</span>   dSandDepth = <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[nX][nY].pGetLayerAboveBasement(nNotchLayer)-&gt;pGetConsolidatedSediment()-&gt;dGetSandDepth();</div>
<div class="line"><a id="l00370" name="l00370"></a><span class="lineno">  370</span>   dAvailable = dSandDepth - <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[nX][nY].pGetLayerAboveBasement(nNotchLayer)-&gt;pGetConsolidatedSediment()-&gt;dGetNotchSandLost();</div>
<div class="line"><a id="l00371" name="l00371"></a><span class="lineno">  371</span>   <span class="keywordflow">if</span> (dAvailable &gt; 0)</div>
<div class="line"><a id="l00372" name="l00372"></a><span class="lineno">  372</span>   {</div>
<div class="line"><a id="l00373" name="l00373"></a><span class="lineno">  373</span>      <span class="comment">// Some consolidated sand sediment is available for collapse</span></div>
<div class="line"><a id="l00374" name="l00374"></a><span class="lineno">  374</span>      <span class="keywordtype">double</span> dLost = dAvailable * dNotchLayerFracRemoved;</div>
<div class="line"><a id="l00375" name="l00375"></a><span class="lineno">  375</span>      dSandCollapse += dLost;</div>
<div class="line"><a id="l00376" name="l00376"></a><span class="lineno">  376</span>      dSandConsLost += dLost;</div>
<div class="line"><a id="l00377" name="l00377"></a><span class="lineno">  377</span>      <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[nX][nY].pGetLayerAboveBasement(nNotchLayer)-&gt;pGetConsolidatedSediment()-&gt;SetSandDepth(dSandDepth - dLost);</div>
<div class="line"><a id="l00378" name="l00378"></a><span class="lineno">  378</span>      <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[nX][nY].pGetLayerAboveBasement(nNotchLayer)-&gt;pGetConsolidatedSediment()-&gt;SetNotchSandLost(0);</div>
<div class="line"><a id="l00379" name="l00379"></a><span class="lineno">  379</span>   }</div>
<div class="line"><a id="l00380" name="l00380"></a><span class="lineno">  380</span> </div>
<div class="line"><a id="l00381" name="l00381"></a><span class="lineno">  381</span>   dCoarseDepth = <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[nX][nY].pGetLayerAboveBasement(nNotchLayer)-&gt;pGetConsolidatedSediment()-&gt;dGetCoarseDepth();</div>
<div class="line"><a id="l00382" name="l00382"></a><span class="lineno">  382</span>   dAvailable = dCoarseDepth - <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[nX][nY].pGetLayerAboveBasement(nNotchLayer)-&gt;pGetConsolidatedSediment()-&gt;dGetNotchCoarseLost();</div>
<div class="line"><a id="l00383" name="l00383"></a><span class="lineno">  383</span>   <span class="keywordflow">if</span> (dAvailable &gt; 0)</div>
<div class="line"><a id="l00384" name="l00384"></a><span class="lineno">  384</span>   {</div>
<div class="line"><a id="l00385" name="l00385"></a><span class="lineno">  385</span>      <span class="comment">// Some consolidated coarse sediment is available for collapse</span></div>
<div class="line"><a id="l00386" name="l00386"></a><span class="lineno">  386</span>      <span class="keywordtype">double</span> dLost = dAvailable * dNotchLayerFracRemoved;</div>
<div class="line"><a id="l00387" name="l00387"></a><span class="lineno">  387</span>      dCoarseCollapse += dLost;</div>
<div class="line"><a id="l00388" name="l00388"></a><span class="lineno">  388</span>      dCoarseConsLost += dLost;</div>
<div class="line"><a id="l00389" name="l00389"></a><span class="lineno">  389</span>      <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[nX][nY].pGetLayerAboveBasement(nNotchLayer)-&gt;pGetConsolidatedSediment()-&gt;SetCoarseDepth(dCoarseDepth - dLost);</div>
<div class="line"><a id="l00390" name="l00390"></a><span class="lineno">  390</span>      <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[nX][nY].pGetLayerAboveBasement(nNotchLayer)-&gt;pGetConsolidatedSediment()-&gt;SetNotchCoarseLost(0);</div>
<div class="line"><a id="l00391" name="l00391"></a><span class="lineno">  391</span>   }</div>
<div class="line"><a id="l00392" name="l00392"></a><span class="lineno">  392</span>   </div>
<div class="line"><a id="l00393" name="l00393"></a><span class="lineno">  393</span>   <span class="comment">// Update the cell&#39;s totals for cliff collapse erosion</span></div>
<div class="line"><a id="l00394" name="l00394"></a><span class="lineno">  394</span>   <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[nX][nY].IncrCliffCollapseErosion(dFineCollapse, dSandCollapse, dCoarseCollapse);</div>
<div class="line"><a id="l00395" name="l00395"></a><span class="lineno">  395</span> </div>
<div class="line"><a id="l00396" name="l00396"></a><span class="lineno">  396</span>   <span class="comment">// Update the cell&#39;s layer elevations and d50</span></div>
<div class="line"><a id="l00397" name="l00397"></a><span class="lineno">  397</span>   <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[nX][nY].CalcAllLayerElevsAndD50();</div>
<div class="line"><a id="l00398" name="l00398"></a><span class="lineno">  398</span>   </div>
<div class="line"><a id="l00399" name="l00399"></a><span class="lineno">  399</span>   <span class="comment">// Get the post-collapse cliff elevation</span></div>
<div class="line"><a id="l00400" name="l00400"></a><span class="lineno">  400</span>   dPostCollapseCliffElev = <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[nX][nY].dGetSedimentTopElev();</div>
<div class="line"><a id="l00401" name="l00401"></a><span class="lineno">  401</span> </div>
<div class="line"><a id="l00402" name="l00402"></a><span class="lineno">  402</span>   <span class="comment">// And update the cell&#39;s sea depth</span></div>
<div class="line"><a id="l00403" name="l00403"></a><span class="lineno">  403</span>   <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[nX][nY].SetSeaDepth();</div>
<div class="line"><a id="l00404" name="l00404"></a><span class="lineno">  404</span> </div>
<div class="line"><a id="l00405" name="l00405"></a><span class="lineno">  405</span>   <span class="comment">// LogStream &lt;&lt; m_ulIter &lt;&lt; &quot;: cell [&quot; &lt;&lt; nX &lt;&lt; &quot;][&quot; &lt;&lt; nY &lt;&lt; &quot;] after removing sediment, dGetVolEquivSedTopElev() = &quot; &lt;&lt; m_pRasterGrid-&gt;m_Cell[nX][nY].dGetVolEquivSedTopElev() &lt;&lt; &quot;, dGetSedimentTopElev() = &quot; &lt;&lt; m_pRasterGrid-&gt;m_Cell[nX][nY].dGetSedimentTopElev() &lt;&lt; endl &lt;&lt; endl;</span></div>
<div class="line"><a id="l00406" name="l00406"></a><span class="lineno">  406</span>   </div>
<div class="line"><a id="l00407" name="l00407"></a><span class="lineno">  407</span>   <span class="comment">// Update this-polygon totals: add to the depths of cliff collapse erosion for this polygon</span></div>
<div class="line"><a id="l00408" name="l00408"></a><span class="lineno">  408</span>   pPolygon-&gt;<a class="code hl_function" href="../../df/d45/classCGeomCoastPolygon.html#a7adb4ed4f436b869cd05f1b8c66e08de">AddCliffCollapseErosionFine</a>(dFineCollapse);</div>
<div class="line"><a id="l00409" name="l00409"></a><span class="lineno">  409</span>   pPolygon-&gt;<a class="code hl_function" href="../../df/d45/classCGeomCoastPolygon.html#a0fd90dff4fa857f2012826e2fb1977c5">AddCliffCollapseToSuspensionFine</a>(dFineCollapse);</div>
<div class="line"><a id="l00410" name="l00410"></a><span class="lineno">  410</span>   pPolygon-&gt;<a class="code hl_function" href="../../df/d45/classCGeomCoastPolygon.html#ace19eeda9ceb7f1d729cbfad37148237">AddCliffCollapseErosionSand</a>(dSandCollapse);</div>
<div class="line"><a id="l00411" name="l00411"></a><span class="lineno">  411</span>   pPolygon-&gt;<a class="code hl_function" href="../../df/d45/classCGeomCoastPolygon.html#a49edc7f56745b394ca3090eee2ec73b7">AddCliffCollapseErosionCoarse</a>(dCoarseCollapse);</div>
<div class="line"><a id="l00412" name="l00412"></a><span class="lineno">  412</span>         </div>
<div class="line"><a id="l00413" name="l00413"></a><span class="lineno">  413</span>   <span class="comment">// And update the this-timestep totals and the grand totals for collapse</span></div>
<div class="line"><a id="l00414" name="l00414"></a><span class="lineno">  414</span>   <span class="comment">// m_nNThisIterCliffCollapse++;</span></div>
<div class="line"><a id="l00415" name="l00415"></a><span class="lineno">  415</span>   <span class="comment">// m_nNTotCliffCollapse++;</span></div>
<div class="line"><a id="l00416" name="l00416"></a><span class="lineno">  416</span> </div>
<div class="line"><a id="l00417" name="l00417"></a><span class="lineno">  417</span>   <span class="comment">// Add to this-iteration totals</span></div>
<div class="line"><a id="l00418" name="l00418"></a><span class="lineno">  418</span>   <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a534390d32312d83a3564afd2f6fddc4e">m_dThisIterCliffCollapseErosionFineUncons</a> += dFineUnconsLost;</div>
<div class="line"><a id="l00419" name="l00419"></a><span class="lineno">  419</span>   <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#aad28423979cf34cb63c4e02e0260c4bb">m_dThisIterCliffCollapseErosionFineCons</a> += dFineConsLost;</div>
<div class="line"><a id="l00420" name="l00420"></a><span class="lineno">  420</span> </div>
<div class="line"><a id="l00421" name="l00421"></a><span class="lineno">  421</span>   <span class="comment">// Also add to the total suspended load. Note that this addition to the suspended load has not yet been added to all cells, this happens in nUpdateGrid()</span></div>
<div class="line"><a id="l00422" name="l00422"></a><span class="lineno">  422</span>   <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a9ff982b02c96da7af9df717158907d43">m_dThisIterFineSedimentToSuspension</a> += (dFineConsLost + dFineUnconsLost);</div>
<div class="line"><a id="l00423" name="l00423"></a><span class="lineno">  423</span>   </div>
<div class="line"><a id="l00424" name="l00424"></a><span class="lineno">  424</span>   <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#ad241bd6dbff1824ca6f8fb6280f4d960">m_dThisIterCliffCollapseErosionSandUncons</a> += dSandUnconsLost;</div>
<div class="line"><a id="l00425" name="l00425"></a><span class="lineno">  425</span>   <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#acc2add764952e52de17425ae15c07219">m_dThisIterCliffCollapseErosionSandCons</a> += dSandConsLost;</div>
<div class="line"><a id="l00426" name="l00426"></a><span class="lineno">  426</span>   <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a495b588ec7b6b6440675712123870303">m_dThisIterCliffCollapseErosionCoarseUncons</a> += dCoarseUnconsLost;</div>
<div class="line"><a id="l00427" name="l00427"></a><span class="lineno">  427</span>   <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#aec4061ede2955755db0a1d4e5a1bfc36">m_dThisIterCliffCollapseErosionCoarseCons</a> += dCoarseConsLost;</div>
<div class="line"><a id="l00428" name="l00428"></a><span class="lineno">  428</span> </div>
<div class="line"><a id="l00429" name="l00429"></a><span class="lineno">  429</span>   <span class="keywordflow">return</span> <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#aa768cb14b5c6123ee95e6e4ebd9fe331">RTN_OK</a>;</div>
<div class="line"><a id="l00430" name="l00430"></a><span class="lineno">  430</span>}</div>
</div>
<div class="line"><a id="l00431" name="l00431"></a><span class="lineno">  431</span> </div>
<div class="line"><a id="l00432" name="l00432"></a><span class="lineno">  432</span><span class="comment">//===============================================================================================================================</span></div>
<div class="line"><a id="l00434" name="l00434"></a><span class="lineno">  434</span><span class="comment">//===============================================================================================================================</span></div>
<div class="foldopen" id="foldopen00435" data-start="{" data-end="}">
<div class="line"><a id="l00435" name="l00435"></a><span class="lineno"><a class="line" href="../../d1/d98/classCSimulation.html#a1af38849a4694be096d76c39c1281f09">  435</a></span><span class="keywordtype">int</span> <a class="code hl_function" href="../../d1/d98/classCSimulation.html#a1af38849a4694be096d76c39c1281f09">CSimulation::nDoCliffCollapseDeposition</a>(<span class="keywordtype">int</span> <span class="keyword">const</span> nCoast, <a class="code hl_class" href="../../d9/d8b/classCRWCliff.html">CRWCliff</a> <span class="keyword">const</span>* pCliff, <span class="keywordtype">double</span> <span class="keyword">const</span> dSandFromCollapse, <span class="keywordtype">double</span> <span class="keyword">const</span> dCoarseFromCollapse, <span class="keywordtype">double</span> <span class="keyword">const</span> dPreCollapseCliffElev, <span class="keywordtype">double</span> <span class="keyword">const</span> dPostCollapseCliffElev)</div>
<div class="line"><a id="l00436" name="l00436"></a><span class="lineno">  436</span>{</div>
<div class="line"><a id="l00437" name="l00437"></a><span class="lineno">  437</span>   <span class="comment">// Check: is there some sand- or coarse-sized sediment to deposit?</span></div>
<div class="line"><a id="l00438" name="l00438"></a><span class="lineno">  438</span>   <span class="keywordflow">if</span> ((dSandFromCollapse + dCoarseFromCollapse) &lt; <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#a992c7916632c97c6c1fa25fd5a788282">SEDIMENT_ELEV_TOLERANCE</a>)</div>
<div class="line"><a id="l00439" name="l00439"></a><span class="lineno">  439</span>      <span class="keywordflow">return</span> <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#aa768cb14b5c6123ee95e6e4ebd9fe331">RTN_OK</a>;</div>
<div class="line"><a id="l00440" name="l00440"></a><span class="lineno">  440</span> </div>
<div class="line"><a id="l00441" name="l00441"></a><span class="lineno">  441</span>   <span class="comment">// LogStream &lt;&lt; &quot;\tdSandFromCollapse = &quot; &lt;&lt; dSandFromCollapse &lt;&lt; &quot; dCoarseFromCollapse = &quot; &lt;&lt; dCoarseFromCollapse &lt;&lt; endl;</span></div>
<div class="line"><a id="l00442" name="l00442"></a><span class="lineno">  442</span>   </div>
<div class="line"><a id="l00443" name="l00443"></a><span class="lineno">  443</span>   <span class="comment">// OK, we have some sand- and/or coarse-sized sediment to deposit</span></div>
<div class="line"><a id="l00444" name="l00444"></a><span class="lineno">  444</span>   <span class="keywordtype">int</span> nStartPoint = pCliff-&gt;<a class="code hl_function" href="../../d2/de0/classCACoastLandform.html#a6a0284350c5965932c7cc74156ceadec">nGetPointOnCoast</a>();</div>
<div class="line"><a id="l00445" name="l00445"></a><span class="lineno">  445</span>   <span class="keywordtype">int</span> nCoastSize = <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a25ada8139c82ca7beab3f279cff83184">m_VCoast</a>[nCoast].nGetCoastlineSize();</div>
<div class="line"><a id="l00446" name="l00446"></a><span class="lineno">  446</span>       </div>
<div class="line"><a id="l00447" name="l00447"></a><span class="lineno">  447</span>   <span class="comment">// Get the cliff cell&#39;s grid coords</span></div>
<div class="line"><a id="l00448" name="l00448"></a><span class="lineno">  448</span>   <span class="keywordtype">int</span> nXCliff = pCliff-&gt;<a class="code hl_function" href="../../d2/de0/classCACoastLandform.html#afd4b936869e33c47d2a741ff6404abf3">pPtiGetCellMarkedAsLF</a>()-&gt;<a class="code hl_function" href="../../d6/d0d/classCGeom2DIPoint.html#af84c687b2d0be01ab41cbcc0565f4f3f">nGetX</a>();</div>
<div class="line"><a id="l00449" name="l00449"></a><span class="lineno">  449</span>   <span class="keywordtype">int</span> nYCliff = pCliff-&gt;<a class="code hl_function" href="../../d2/de0/classCACoastLandform.html#afd4b936869e33c47d2a741ff6404abf3">pPtiGetCellMarkedAsLF</a>()-&gt;<a class="code hl_function" href="../../d6/d0d/classCGeom2DIPoint.html#a4d9c20bcca90dcb9d519b664aba09cbd">nGetY</a>();</div>
<div class="line"><a id="l00450" name="l00450"></a><span class="lineno">  450</span>       </div>
<div class="line"><a id="l00451" name="l00451"></a><span class="lineno">  451</span>   <span class="comment">// Get this cell&#39;s polygon</span></div>
<div class="line"><a id="l00452" name="l00452"></a><span class="lineno">  452</span>   <span class="keywordtype">int</span> nPoly = <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[nXCliff][nYCliff].nGetPolygonID();</div>
<div class="line"><a id="l00453" name="l00453"></a><span class="lineno">  453</span>   <span class="keywordflow">if</span> (nPoly == <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#a01aa8b423260b337ddff2016107b51a0">INT_NODATA</a>)</div>
<div class="line"><a id="l00454" name="l00454"></a><span class="lineno">  454</span>   {</div>
<div class="line"><a id="l00455" name="l00455"></a><span class="lineno">  455</span>      <span class="comment">// This cell isn&#39;t in a polygon</span></div>
<div class="line"><a id="l00456" name="l00456"></a><span class="lineno">  456</span>      <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a222962121613613a48f518e0c2110f21">LogStream</a> &lt;&lt; <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#ad67e8c5b30a0572f64ecfb5c062c2edc">m_ulIter</a> &lt;&lt; <span class="stringliteral">&quot; : in nDoCliffCollapse(), [&quot;</span> &lt;&lt; nXCliff &lt;&lt; <span class="stringliteral">&quot;][&quot;</span> &lt;&lt; nYCliff &lt;&lt; <span class="stringliteral">&quot;] = {&quot;</span> &lt;&lt; <a class="code hl_function" href="../../d1/d98/classCSimulation.html#ad79b925ac5f358c6f867b6e47dad74bd">dGridCentroidXToExtCRSX</a>(nXCliff) &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; <a class="code hl_function" href="../../d1/d98/classCSimulation.html#a7e2a4bd69ce79377fee86aa5598903f8">dGridCentroidYToExtCRSY</a>(nYCliff) &lt;&lt; <span class="stringliteral">&quot;} is not in a polygon&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a id="l00457" name="l00457"></a><span class="lineno">  457</span>      </div>
<div class="line"><a id="l00458" name="l00458"></a><span class="lineno">  458</span>      <span class="keywordflow">return</span> <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#a8e182d96bc7134148551c890343aef9b">RTN_ERR_CLIFF_NOT_IN_POLYGON</a>;</div>
<div class="line"><a id="l00459" name="l00459"></a><span class="lineno">  459</span>   }</div>
<div class="line"><a id="l00460" name="l00460"></a><span class="lineno">  460</span> </div>
<div class="line"><a id="l00461" name="l00461"></a><span class="lineno">  461</span>   <a class="code hl_class" href="../../df/d45/classCGeomCoastPolygon.html">CGeomCoastPolygon</a>* pPolygon = <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a25ada8139c82ca7beab3f279cff83184">m_VCoast</a>[nCoast].pGetPolygon(nPoly);</div>
<div class="line"><a id="l00462" name="l00462"></a><span class="lineno">  462</span>       </div>
<div class="line"><a id="l00463" name="l00463"></a><span class="lineno">  463</span>   <span class="comment">// OK, now set up the planview sequence talus deposition. First we deposit to create a Dean profile starting from the cliff collapse cell. Then we deposit along two profiles which start from the coast cells on either side of the cliff collapse cell, and then on two profiles starting on the next two &quot;outside&quot; coast cells, etc. However, we do have a &quot;preferred&quot; talus width</span></div>
<div class="line"><a id="l00464" name="l00464"></a><span class="lineno">  464</span>   <span class="keywordtype">int</span> nTalusWidth = <a class="code hl_function" href="../../d1/d98/classCSimulation.html#a88015ff9851069ccb4aa4bef2773fe22">nConvertMetresToNumCells</a>(<a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a010ac62ee6bbb82fd71f9b2c5e3f2172">m_dCliffDepositionPlanviewWidth</a>);</div>
<div class="line"><a id="l00465" name="l00465"></a><span class="lineno">  465</span>   </div>
<div class="line"><a id="l00466" name="l00466"></a><span class="lineno">  466</span>   <span class="comment">// The default talus collapse must be an odd number of cells in width i.e. centred on the cliff collapse cell (but only if we are not at the end of the coast)</span></div>
<div class="line"><a id="l00467" name="l00467"></a><span class="lineno">  467</span>   <span class="keywordflow">if</span> ((nTalusWidth % 2) == 0)</div>
<div class="line"><a id="l00468" name="l00468"></a><span class="lineno">  468</span>      nTalusWidth++;</div>
<div class="line"><a id="l00469" name="l00469"></a><span class="lineno">  469</span>   </div>
<div class="line"><a id="l00470" name="l00470"></a><span class="lineno">  470</span>   <span class="comment">// This holds the valid coast start points for each Dean profile</span></div>
<div class="line"><a id="l00471" name="l00471"></a><span class="lineno">  471</span>   vector&lt;int&gt; VnTalusProfileCoastStartPoint(nCoastSize);</div>
<div class="line"><a id="l00472" name="l00472"></a><span class="lineno">  472</span>   </div>
<div class="line"><a id="l00473" name="l00473"></a><span class="lineno">  473</span>   <span class="comment">// This is the coast start point for the first Dean profile</span></div>
<div class="line"><a id="l00474" name="l00474"></a><span class="lineno">  474</span>   VnTalusProfileCoastStartPoint[0] = nStartPoint;</div>
<div class="line"><a id="l00475" name="l00475"></a><span class="lineno">  475</span>   <span class="keywordtype">int</span> nn = 1;</div>
<div class="line"><a id="l00476" name="l00476"></a><span class="lineno">  476</span>   <span class="keywordtype">int</span> nSigned = 1;</div>
<div class="line"><a id="l00477" name="l00477"></a><span class="lineno">  477</span>   <span class="keywordtype">int</span> nCount = 1;</div>
<div class="line"><a id="l00478" name="l00478"></a><span class="lineno">  478</span> </div>
<div class="line"><a id="l00479" name="l00479"></a><span class="lineno">  479</span>   <span class="keywordflow">do</span></div>
<div class="line"><a id="l00480" name="l00480"></a><span class="lineno">  480</span>   {</div>
<div class="line"><a id="l00481" name="l00481"></a><span class="lineno">  481</span>      <span class="keywordtype">int</span> nTmpPoint;</div>
<div class="line"><a id="l00482" name="l00482"></a><span class="lineno">  482</span>      </div>
<div class="line"><a id="l00483" name="l00483"></a><span class="lineno">  483</span>      <span class="keywordflow">if</span> ((nCount % 2) != 0)</div>
<div class="line"><a id="l00484" name="l00484"></a><span class="lineno">  484</span>         nTmpPoint = nStartPoint + nSigned;</div>
<div class="line"><a id="l00485" name="l00485"></a><span class="lineno">  485</span>      <span class="keywordflow">else</span></div>
<div class="line"><a id="l00486" name="l00486"></a><span class="lineno">  486</span>      {</div>
<div class="line"><a id="l00487" name="l00487"></a><span class="lineno">  487</span>         nTmpPoint = nStartPoint - nSigned;</div>
<div class="line"><a id="l00488" name="l00488"></a><span class="lineno">  488</span>         nSigned++;</div>
<div class="line"><a id="l00489" name="l00489"></a><span class="lineno">  489</span>      }</div>
<div class="line"><a id="l00490" name="l00490"></a><span class="lineno">  490</span>      </div>
<div class="line"><a id="l00491" name="l00491"></a><span class="lineno">  491</span>      <span class="comment">// Is this start point valid?</span></div>
<div class="line"><a id="l00492" name="l00492"></a><span class="lineno">  492</span>      <span class="keywordflow">if</span> ((nTmpPoint &lt; 0) || (nTmpPoint &gt; (nCoastSize - 1)))</div>
<div class="line"><a id="l00493" name="l00493"></a><span class="lineno">  493</span>      {</div>
<div class="line"><a id="l00494" name="l00494"></a><span class="lineno">  494</span>         <span class="comment">// No, it is outside the grid, so find another </span></div>
<div class="line"><a id="l00495" name="l00495"></a><span class="lineno">  495</span>         nCount++;         </div>
<div class="line"><a id="l00496" name="l00496"></a><span class="lineno">  496</span>         <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l00497" name="l00497"></a><span class="lineno">  497</span>      }</div>
<div class="line"><a id="l00498" name="l00498"></a><span class="lineno">  498</span>      <span class="keywordflow">else</span></div>
<div class="line"><a id="l00499" name="l00499"></a><span class="lineno">  499</span>      {</div>
<div class="line"><a id="l00500" name="l00500"></a><span class="lineno">  500</span>         <span class="comment">// It is valid</span></div>
<div class="line"><a id="l00501" name="l00501"></a><span class="lineno">  501</span>         VnTalusProfileCoastStartPoint[nn] = nTmpPoint;</div>
<div class="line"><a id="l00502" name="l00502"></a><span class="lineno">  502</span>         nn++;</div>
<div class="line"><a id="l00503" name="l00503"></a><span class="lineno">  503</span>         nCount++;</div>
<div class="line"><a id="l00504" name="l00504"></a><span class="lineno">  504</span>      }      </div>
<div class="line"><a id="l00505" name="l00505"></a><span class="lineno">  505</span>   }</div>
<div class="line"><a id="l00506" name="l00506"></a><span class="lineno">  506</span>   <span class="keywordflow">while</span> (nn &lt; <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(VnTalusProfileCoastStartPoint.size()));</div>
<div class="line"><a id="l00507" name="l00507"></a><span class="lineno">  507</span> </div>
<div class="line"><a id="l00508" name="l00508"></a><span class="lineno">  508</span>   <span class="keywordtype">bool</span> bHitFirstCoastPoint = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00509" name="l00509"></a><span class="lineno">  509</span>   <span class="keywordtype">bool</span> bHitLastCoastPoint = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00510" name="l00510"></a><span class="lineno">  510</span> </div>
<div class="line"><a id="l00511" name="l00511"></a><span class="lineno">  511</span>   <span class="keywordtype">double</span> dTotSandToDepositAllProfiles = dSandFromCollapse;          <span class="comment">// Note that this can increase, if we get erosion because Dean profile is lower than profile</span></div>
<div class="line"><a id="l00512" name="l00512"></a><span class="lineno">  512</span>   <span class="keywordtype">double</span> dTotCoarseToDepositAllProfiles = dCoarseFromCollapse;      <span class="comment">// Note that this can increase, if we get erosion because Dean profile is lower than profile</span></div>
<div class="line"><a id="l00513" name="l00513"></a><span class="lineno">  513</span>   <span class="keywordtype">double</span> dTotSandDepositedAllProfiles = 0;</div>
<div class="line"><a id="l00514" name="l00514"></a><span class="lineno">  514</span>   <span class="keywordtype">double</span> dTotCoarseDepositedAllProfiles = 0;</div>
<div class="line"><a id="l00515" name="l00515"></a><span class="lineno">  515</span>      </div>
<div class="line"><a id="l00516" name="l00516"></a><span class="lineno">  516</span>   <span class="comment">// Process each deposition profile</span></div>
<div class="line"><a id="l00517" name="l00517"></a><span class="lineno">  517</span>   <span class="keywordtype">int</span> nStartPointSize = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(VnTalusProfileCoastStartPoint.size());</div>
<div class="line"><a id="l00518" name="l00518"></a><span class="lineno">  518</span>   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> nAcross = 0; nAcross &lt; nStartPointSize; nAcross++)</div>
<div class="line"><a id="l00519" name="l00519"></a><span class="lineno">  519</span>   {</div>
<div class="line"><a id="l00520" name="l00520"></a><span class="lineno">  520</span>      <span class="keywordtype">bool</span> bDoSandDepositionOnThisProfile = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00521" name="l00521"></a><span class="lineno">  521</span>      <span class="keywordtype">bool</span> bSandDepositionCompletedOnThisProfile = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00522" name="l00522"></a><span class="lineno">  522</span>      <span class="keywordtype">bool</span> bDoCoarseDepositionOnThisProfile = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00523" name="l00523"></a><span class="lineno">  523</span>      <span class="keywordtype">bool</span> bCoarseDepositionCompletedOnThisProfile = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00524" name="l00524"></a><span class="lineno">  524</span> </div>
<div class="line"><a id="l00525" name="l00525"></a><span class="lineno">  525</span>      <span class="keywordtype">int</span> nRemaining = <a class="code hl_function" href="../../d6/d2a/cme_8h.html#a7e895b460cef877dec4d12ead0c74f15">tMax</a>(1, nTalusWidth - nAcross);</div>
<div class="line"><a id="l00526" name="l00526"></a><span class="lineno">  526</span> </div>
<div class="line"><a id="l00527" name="l00527"></a><span class="lineno">  527</span>      <span class="comment">// This is the minimum planview length of the Dean profile (the initial length will be increased later if we can&#39;t deposit sufficient talus)</span></div>
<div class="line"><a id="l00528" name="l00528"></a><span class="lineno">  528</span>      <span class="keywordtype">int</span> nTalusProfileLen = <a class="code hl_function" href="../../d1/d98/classCSimulation.html#a88015ff9851069ccb4aa4bef2773fe22">nConvertMetresToNumCells</a>(<a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a3d53726bf8b2b2118c8b69c6707b304b">m_dCliffTalusMinDepositionLength</a>);</div>
<div class="line"><a id="l00529" name="l00529"></a><span class="lineno">  529</span>   </div>
<div class="line"><a id="l00530" name="l00530"></a><span class="lineno">  530</span>      <span class="comment">// Calculate the target amount to be deposited on each talus profile, assuming the &quot;preferred&quot; talus width</span></div>
<div class="line"><a id="l00531" name="l00531"></a><span class="lineno">  531</span>      <span class="keywordtype">double</span> dTargetSandToDepositOnThisProfile = (dTotSandToDepositAllProfiles - dTotSandDepositedAllProfiles) / nRemaining;</div>
<div class="line"><a id="l00532" name="l00532"></a><span class="lineno">  532</span>      <span class="keywordtype">double</span> dTargetCoarseToDepositOnThisProfile = (dTotCoarseToDepositAllProfiles - dTotCoarseDepositedAllProfiles) / nRemaining;</div>
<div class="line"><a id="l00533" name="l00533"></a><span class="lineno">  533</span> </div>
<div class="line"><a id="l00534" name="l00534"></a><span class="lineno">  534</span>      <span class="comment">// Use this to make sure that, if we have both sand and coarse to deposit, we don&#39;t drop all the sand on a cell and then be unable to deposit any coarse</span></div>
<div class="line"><a id="l00535" name="l00535"></a><span class="lineno">  535</span>      <span class="keywordtype">double</span> dSandProp = 0.5;</div>
<div class="line"><a id="l00536" name="l00536"></a><span class="lineno">  536</span>      <span class="keywordtype">double</span> dCoarseProp = 1 - dSandProp;</div>
<div class="line"><a id="l00537" name="l00537"></a><span class="lineno">  537</span>      <span class="keywordflow">if</span> (dTargetSandToDepositOnThisProfile + dTargetCoarseToDepositOnThisProfile &gt; 0)</div>
<div class="line"><a id="l00538" name="l00538"></a><span class="lineno">  538</span>      {</div>
<div class="line"><a id="l00539" name="l00539"></a><span class="lineno">  539</span>         dSandProp = dTargetSandToDepositOnThisProfile / (dTargetSandToDepositOnThisProfile + dTargetCoarseToDepositOnThisProfile);</div>
<div class="line"><a id="l00540" name="l00540"></a><span class="lineno">  540</span>         dCoarseProp = 1 - dSandProp;</div>
<div class="line"><a id="l00541" name="l00541"></a><span class="lineno">  541</span>      }</div>
<div class="line"><a id="l00542" name="l00542"></a><span class="lineno">  542</span>      </div>
<div class="line"><a id="l00543" name="l00543"></a><span class="lineno">  543</span>      <span class="keywordtype">double</span> dSandDepositedOnThisProfile = 0;</div>
<div class="line"><a id="l00544" name="l00544"></a><span class="lineno">  544</span>      <span class="keywordtype">double</span> dCoarseDepositedOnThisProfile = 0;</div>
<div class="line"><a id="l00545" name="l00545"></a><span class="lineno">  545</span> </div>
<div class="line"><a id="l00546" name="l00546"></a><span class="lineno">  546</span>      <span class="keywordflow">if</span> (dTotSandToDepositAllProfiles &gt; 0)</div>
<div class="line"><a id="l00547" name="l00547"></a><span class="lineno">  547</span>      {</div>
<div class="line"><a id="l00548" name="l00548"></a><span class="lineno">  548</span>         bDoSandDepositionOnThisProfile = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00549" name="l00549"></a><span class="lineno">  549</span>         </div>
<div class="line"><a id="l00550" name="l00550"></a><span class="lineno">  550</span>         <span class="keywordflow">if</span> (<a class="code hl_function" href="../../d6/d2a/cme_8h.html#a61afa8560a3b39c80657661a1d8f76ab">bFPIsEqual</a>(dTotSandToDepositAllProfiles - dTotSandDepositedAllProfiles, 0.0, <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#a7b4b1553585db781ce65707e31294bea">MASS_BALANCE_TOLERANCE</a>))</div>
<div class="line"><a id="l00551" name="l00551"></a><span class="lineno">  551</span>            bSandDepositionCompletedOnThisProfile = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00552" name="l00552"></a><span class="lineno">  552</span>      }</div>
<div class="line"><a id="l00553" name="l00553"></a><span class="lineno">  553</span>      <span class="keywordflow">else</span></div>
<div class="line"><a id="l00554" name="l00554"></a><span class="lineno">  554</span>         bSandDepositionCompletedOnThisProfile = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00555" name="l00555"></a><span class="lineno">  555</span>         </div>
<div class="line"><a id="l00556" name="l00556"></a><span class="lineno">  556</span>      <span class="keywordflow">if</span> (dTotCoarseToDepositAllProfiles &gt; 0)</div>
<div class="line"><a id="l00557" name="l00557"></a><span class="lineno">  557</span>      {</div>
<div class="line"><a id="l00558" name="l00558"></a><span class="lineno">  558</span>         bDoCoarseDepositionOnThisProfile = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00559" name="l00559"></a><span class="lineno">  559</span>         </div>
<div class="line"><a id="l00560" name="l00560"></a><span class="lineno">  560</span>         <span class="keywordflow">if</span> (<a class="code hl_function" href="../../d6/d2a/cme_8h.html#a61afa8560a3b39c80657661a1d8f76ab">bFPIsEqual</a>(dTotCoarseToDepositAllProfiles - dTotCoarseDepositedAllProfiles, 0.0, <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#a7b4b1553585db781ce65707e31294bea">MASS_BALANCE_TOLERANCE</a>))</div>
<div class="line"><a id="l00561" name="l00561"></a><span class="lineno">  561</span>            bCoarseDepositionCompletedOnThisProfile = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00562" name="l00562"></a><span class="lineno">  562</span>      }</div>
<div class="line"><a id="l00563" name="l00563"></a><span class="lineno">  563</span>      <span class="keywordflow">else</span></div>
<div class="line"><a id="l00564" name="l00564"></a><span class="lineno">  564</span>         bCoarseDepositionCompletedOnThisProfile = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00565" name="l00565"></a><span class="lineno">  565</span> </div>
<div class="line"><a id="l00566" name="l00566"></a><span class="lineno">  566</span>      <span class="keywordflow">if</span> (bSandDepositionCompletedOnThisProfile &amp;&amp; bCoarseDepositionCompletedOnThisProfile)</div>
<div class="line"><a id="l00567" name="l00567"></a><span class="lineno">  567</span>      {</div>
<div class="line"><a id="l00568" name="l00568"></a><span class="lineno">  568</span>         <span class="comment">// LogStream &lt;&lt; m_ulIter &lt;&lt; &quot;: break 2 for cliff collapse at [&quot; &lt;&lt; nXCliff &lt;&lt; &quot;][&quot; &lt;&lt; nYCliff &lt;&lt; &quot;] nStartPoint = &quot; &lt;&lt; nStartPoint &lt;&lt; &quot; nAcross = &quot; &lt;&lt; nAcross &lt;&lt; endl &lt;&lt; &quot;\tdTargetSandToDepositOnThisProfile = &quot; &lt;&lt; dTargetSandToDepositOnThisProfile &lt;&lt; &quot; dSandDepositedOnThisProfile = &quot; &lt;&lt; dSandDepositedOnThisProfile &lt;&lt; &quot; dTotSandToDepositAllProfiles = &quot; &lt;&lt; dTotSandToDepositAllProfiles &lt;&lt; &quot; dTotSandDepositedAllProfiles = &quot; &lt;&lt; dTotSandDepositedAllProfiles &lt;&lt; endl &lt;&lt; &quot;\tdTargetCoarseToDepositOnThisProfile = &quot; &lt;&lt; dTargetCoarseToDepositOnThisProfile &lt;&lt; &quot; dCoarseDepositedOnThisProfile = &quot; &lt;&lt; dCoarseDepositedOnThisProfile &lt;&lt; &quot; dTotCoarseToDepositAllProfiles = &quot; &lt;&lt;  dTotCoarseToDepositAllProfiles &lt;&lt; &quot; dTotCoarseDepositedAllProfiles = &quot; &lt;&lt; dTotCoarseDepositedAllProfiles &lt;&lt; endl;</span></div>
<div class="line"><a id="l00569" name="l00569"></a><span class="lineno">  569</span>         </div>
<div class="line"><a id="l00570" name="l00570"></a><span class="lineno">  570</span>         <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00571" name="l00571"></a><span class="lineno">  571</span>      }</div>
<div class="line"><a id="l00572" name="l00572"></a><span class="lineno">  572</span>         </div>
<div class="line"><a id="l00573" name="l00573"></a><span class="lineno">  573</span>      <span class="comment">// Get the start point of this cliff collapse deposition profile</span></div>
<div class="line"><a id="l00574" name="l00574"></a><span class="lineno">  574</span>      <span class="keywordtype">int</span> nThisPoint = VnTalusProfileCoastStartPoint[nAcross];</div>
<div class="line"><a id="l00575" name="l00575"></a><span class="lineno">  575</span>      </div>
<div class="line"><a id="l00576" name="l00576"></a><span class="lineno">  576</span>      <span class="comment">// Are we at the start or end of the coast?</span></div>
<div class="line"><a id="l00577" name="l00577"></a><span class="lineno">  577</span>      <span class="keywordflow">if</span> (nThisPoint == 0)</div>
<div class="line"><a id="l00578" name="l00578"></a><span class="lineno">  578</span>         bHitFirstCoastPoint = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00579" name="l00579"></a><span class="lineno">  579</span>      </div>
<div class="line"><a id="l00580" name="l00580"></a><span class="lineno">  580</span>      <span class="keywordflow">if</span> (nThisPoint == nCoastSize-1)</div>
<div class="line"><a id="l00581" name="l00581"></a><span class="lineno">  581</span>         bHitLastCoastPoint = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00582" name="l00582"></a><span class="lineno">  582</span> </div>
<div class="line"><a id="l00583" name="l00583"></a><span class="lineno">  583</span>      <a class="code hl_class" href="../../d5/d4e/classCGeom2DPoint.html">CGeom2DPoint</a> PtStart;</div>
<div class="line"><a id="l00584" name="l00584"></a><span class="lineno">  584</span>      <a class="code hl_class" href="../../d5/d4e/classCGeom2DPoint.html">CGeom2DPoint</a> PtEnd;</div>
<div class="line"><a id="l00585" name="l00585"></a><span class="lineno">  585</span> </div>
<div class="line"><a id="l00586" name="l00586"></a><span class="lineno">  586</span>      <span class="comment">// Make the start of the deposition profile the cliff cell that is marked as coast (not the cell under the smoothed vector coast, they may well be different)</span></div>
<div class="line"><a id="l00587" name="l00587"></a><span class="lineno">  587</span>      PtStart.<a class="code hl_function" href="../../d5/d4e/classCGeom2DPoint.html#af5dfdef4b78c0703800049b064483278">SetX</a>(<a class="code hl_function" href="../../d1/d98/classCSimulation.html#ad79b925ac5f358c6f867b6e47dad74bd">dGridCentroidXToExtCRSX</a>(<a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a25ada8139c82ca7beab3f279cff83184">m_VCoast</a>[nCoast].pPtiGetCellMarkedAsCoastline(nThisPoint)-&gt;nGetX()));</div>
<div class="line"><a id="l00588" name="l00588"></a><span class="lineno">  588</span>      PtStart.<a class="code hl_function" href="../../d5/d4e/classCGeom2DPoint.html#a1dff4e8adee61e6fe5c5062d6ba88f01">SetY</a>(<a class="code hl_function" href="../../d1/d98/classCSimulation.html#a7e2a4bd69ce79377fee86aa5598903f8">dGridCentroidYToExtCRSY</a>(<a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a25ada8139c82ca7beab3f279cff83184">m_VCoast</a>[nCoast].pPtiGetCellMarkedAsCoastline(nThisPoint)-&gt;nGetY()));</div>
<div class="line"><a id="l00589" name="l00589"></a><span class="lineno">  589</span>      </div>
<div class="line"><a id="l00590" name="l00590"></a><span class="lineno">  590</span>      <span class="comment">// Set the initial fraction of cliff height, this will be increased (max is one) if we can&#39;t deposit sufficient talus</span></div>
<div class="line"><a id="l00591" name="l00591"></a><span class="lineno">  591</span>      <span class="keywordtype">double</span> dCliffHeightFrac = <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a9c151ce3de623725c152505491fa4424">m_dMinCliffTalusHeightFrac</a>;</div>
<div class="line"><a id="l00592" name="l00592"></a><span class="lineno">  592</span>      </div>
<div class="line"><a id="l00593" name="l00593"></a><span class="lineno">  593</span>      <span class="keywordtype">bool</span> bJustDepositWhatWeCan = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00594" name="l00594"></a><span class="lineno">  594</span> </div>
<div class="line"><a id="l00595" name="l00595"></a><span class="lineno">  595</span>      <span class="comment">// The initial seaward offset, in cells. This will be increased if we can&#39;t deposit sufficient talus</span></div>
<div class="line"><a id="l00596" name="l00596"></a><span class="lineno">  596</span>      <span class="keywordtype">int</span> nSeawardOffset = 0;</div>
<div class="line"><a id="l00597" name="l00597"></a><span class="lineno">  597</span> </div>
<div class="line"><a id="l00598" name="l00598"></a><span class="lineno">  598</span>      <span class="comment">// Process this profile</span></div>
<div class="line"><a id="l00599" name="l00599"></a><span class="lineno">  599</span>      <span class="keywordflow">do</span></div>
<div class="line"><a id="l00600" name="l00600"></a><span class="lineno">  600</span>      {</div>
<div class="line"><a id="l00601" name="l00601"></a><span class="lineno">  601</span>         <span class="keywordflow">if</span> (bJustDepositWhatWeCan || (bSandDepositionCompletedOnThisProfile &amp;&amp; bCoarseDepositionCompletedOnThisProfile))</div>
<div class="line"><a id="l00602" name="l00602"></a><span class="lineno">  602</span>         {</div>
<div class="line"><a id="l00603" name="l00603"></a><span class="lineno">  603</span>            <span class="comment">// LogStream &lt;&lt; m_ulIter &lt;&lt; &quot;: break 3 for cliff collapse at [&quot; &lt;&lt; nXCliff &lt;&lt; &quot;][&quot; &lt;&lt; nYCliff &lt;&lt; &quot;] nStartPoint = &quot; &lt;&lt; nStartPoint &lt;&lt; &quot; nThisPoint = &quot; &lt;&lt; nThisPoint &lt;&lt; endl &lt;&lt; &quot;\tnSeawardOffset = &quot; &lt;&lt; nSeawardOffset &lt;&lt; &quot; dCliffHeightFrac = &quot; &lt;&lt; dCliffHeightFrac &lt;&lt; &quot; nAcross = &quot; &lt;&lt; nAcross &lt;&lt; endl &lt;&lt; &quot;\tbJustDepositWhatWeCan = &quot; &lt;&lt; bJustDepositWhatWeCan &lt;&lt; &quot;\tdTargetSandToDepositOnThisProfile = &quot; &lt;&lt; dTargetSandToDepositOnThisProfile &lt;&lt; &quot; dSandDepositedOnThisProfile = &quot; &lt;&lt; dSandDepositedOnThisProfile &lt;&lt; &quot; dTotSandToDepositAllProfiles = &quot; &lt;&lt; dTotSandToDepositAllProfiles &lt;&lt; &quot; dTotSandDepositedAllProfiles = &quot; &lt;&lt; dTotSandDepositedAllProfiles &lt;&lt; endl &lt;&lt; &quot;\tdTargetCoarseToDepositOnThisProfile = &quot; &lt;&lt; dTargetCoarseToDepositOnThisProfile &lt;&lt; &quot; dCoarseDepositedOnThisProfile = &quot; &lt;&lt; dCoarseDepositedOnThisProfile &lt;&lt; &quot; dTotCoarseToDepositAllProfiles = &quot; &lt;&lt;  dTotCoarseToDepositAllProfiles &lt;&lt; &quot; dTotCoarseDepositedAllProfiles = &quot; &lt;&lt; dTotCoarseDepositedAllProfiles &lt;&lt; endl;</span></div>
<div class="line"><a id="l00604" name="l00604"></a><span class="lineno">  604</span>            </div>
<div class="line"><a id="l00605" name="l00605"></a><span class="lineno">  605</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00606" name="l00606"></a><span class="lineno">  606</span>         }</div>
<div class="line"><a id="l00607" name="l00607"></a><span class="lineno">  607</span> </div>
<div class="line"><a id="l00608" name="l00608"></a><span class="lineno">  608</span>         <span class="comment">// Need to deposit more on this profile: increase the seaward offset each time round the loop</span></div>
<div class="line"><a id="l00609" name="l00609"></a><span class="lineno">  609</span>         nSeawardOffset++;</div>
<div class="line"><a id="l00610" name="l00610"></a><span class="lineno">  610</span>         </div>
<div class="line"><a id="l00611" name="l00611"></a><span class="lineno">  611</span>         <span class="comment">// Has the seaward offset reached the arbitrary limit?</span></div>
<div class="line"><a id="l00612" name="l00612"></a><span class="lineno">  612</span>         <span class="keywordflow">if</span> (nSeawardOffset &gt;= <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#a345c00500ce26313ccfe7c13845306bf">MAX_SEAWARD_OFFSET_FOR_CLIFF_TALUS</a>)</div>
<div class="line"><a id="l00613" name="l00613"></a><span class="lineno">  613</span>         {</div>
<div class="line"><a id="l00614" name="l00614"></a><span class="lineno">  614</span>            <span class="comment">// It has, so if cliff height is not at the maximum, then try again with a larger fraction of cliff height</span></div>
<div class="line"><a id="l00615" name="l00615"></a><span class="lineno">  615</span>            <span class="keywordflow">if</span> (dCliffHeightFrac &lt; 1)</div>
<div class="line"><a id="l00616" name="l00616"></a><span class="lineno">  616</span>            {</div>
<div class="line"><a id="l00617" name="l00617"></a><span class="lineno">  617</span>               dCliffHeightFrac += <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#a80df4d9236509b6c0a0adb67ed93478a">CLIFF_COLLAPSE_HEIGHT_INCREMENT</a>;</div>
<div class="line"><a id="l00618" name="l00618"></a><span class="lineno">  618</span> </div>
<div class="line"><a id="l00619" name="l00619"></a><span class="lineno">  619</span>               <span class="comment">// Reset seaward offset</span></div>
<div class="line"><a id="l00620" name="l00620"></a><span class="lineno">  620</span>               nSeawardOffset = 1;</div>
<div class="line"><a id="l00621" name="l00621"></a><span class="lineno">  621</span>            }</div>
<div class="line"><a id="l00622" name="l00622"></a><span class="lineno">  622</span>            <span class="keywordflow">else</span></div>
<div class="line"><a id="l00623" name="l00623"></a><span class="lineno">  623</span>            {</div>
<div class="line"><a id="l00624" name="l00624"></a><span class="lineno">  624</span>               <span class="comment">// Cliff height has reached the limit, is the talus length also at its arbitrary limit?</span></div>
<div class="line"><a id="l00625" name="l00625"></a><span class="lineno">  625</span>               <span class="keywordflow">if</span> (nTalusProfileLen &gt;= <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#a8272a52e71f5a7b38fdf4fcdc1887fb7">MAX_CLIFF_TALUS_LENGTH</a>)</div>
<div class="line"><a id="l00626" name="l00626"></a><span class="lineno">  626</span>               {</div>
<div class="line"><a id="l00627" name="l00627"></a><span class="lineno">  627</span>                  <span class="comment">// The talus length is also at this limit, so there is nothing more we can increase on this profile. Just deposit what we can and move on to the next profile</span></div>
<div class="line"><a id="l00628" name="l00628"></a><span class="lineno">  628</span>                  bJustDepositWhatWeCan = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00629" name="l00629"></a><span class="lineno">  629</span>               }</div>
<div class="line"><a id="l00630" name="l00630"></a><span class="lineno">  630</span>               <span class="keywordflow">else</span></div>
<div class="line"><a id="l00631" name="l00631"></a><span class="lineno">  631</span>               {</div>
<div class="line"><a id="l00632" name="l00632"></a><span class="lineno">  632</span>                  <span class="comment">// The talus length is not at its limit, so try again with an increased talus length</span></div>
<div class="line"><a id="l00633" name="l00633"></a><span class="lineno">  633</span>                  nTalusProfileLen += <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#a9b341d045bbf90c51fc0528eb453fa2c">CLIFF_COLLAPSE_LENGTH_INCREMENT</a>;</div>
<div class="line"><a id="l00634" name="l00634"></a><span class="lineno">  634</span> </div>
<div class="line"><a id="l00635" name="l00635"></a><span class="lineno">  635</span>                  <span class="comment">// Reset seaward offset</span></div>
<div class="line"><a id="l00636" name="l00636"></a><span class="lineno">  636</span>                  nSeawardOffset = 1;</div>
<div class="line"><a id="l00637" name="l00637"></a><span class="lineno">  637</span> </div>
<div class="line"><a id="l00638" name="l00638"></a><span class="lineno">  638</span>                  <span class="comment">// Set cliff height to exactly one</span></div>
<div class="line"><a id="l00639" name="l00639"></a><span class="lineno">  639</span>                  dCliffHeightFrac = 1;</div>
<div class="line"><a id="l00640" name="l00640"></a><span class="lineno">  640</span>               }</div>
<div class="line"><a id="l00641" name="l00641"></a><span class="lineno">  641</span>            }</div>
<div class="line"><a id="l00642" name="l00642"></a><span class="lineno">  642</span>         }</div>
<div class="line"><a id="l00643" name="l00643"></a><span class="lineno">  643</span> </div>
<div class="line"><a id="l00644" name="l00644"></a><span class="lineno">  644</span>         <span class="keywordflow">if</span> (bHitFirstCoastPoint &amp;&amp; bHitLastCoastPoint)</div>
<div class="line"><a id="l00645" name="l00645"></a><span class="lineno">  645</span>         {</div>
<div class="line"><a id="l00646" name="l00646"></a><span class="lineno">  646</span>            <span class="comment">// Uh-oh, we&#39;ve reached both ends of the coast (!) and we can&#39;t increase anything any more</span></div>
<div class="line"><a id="l00647" name="l00647"></a><span class="lineno">  647</span>            <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a222962121613613a48f518e0c2110f21">LogStream</a> &lt;&lt; <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#ad67e8c5b30a0572f64ecfb5c062c2edc">m_ulIter</a> &lt;&lt; <span class="stringliteral">&quot;: unable to deposit sufficient unconsolidated talus from cliff collapse at [&quot;</span> &lt;&lt; nXCliff &lt;&lt; <span class="stringliteral">&quot;][&quot;</span> &lt;&lt; nYCliff &lt;&lt; <span class="stringliteral">&quot;] nStartPoint = &quot;</span> &lt;&lt; nStartPoint &lt;&lt; <span class="stringliteral">&quot; nThisPoint = &quot;</span> &lt;&lt; nThisPoint &lt;&lt; endl &lt;&lt; <span class="stringliteral">&quot;\tnSeawardOffset = &quot;</span> &lt;&lt; nSeawardOffset &lt;&lt; <span class="stringliteral">&quot; dCliffHeightFrac = &quot;</span> &lt;&lt; dCliffHeightFrac &lt;&lt; <span class="stringliteral">&quot; nAcross = &quot;</span> &lt;&lt; nAcross &lt;&lt; endl &lt;&lt; <span class="stringliteral">&quot;\tdTargetSandToDepositOnThisProfile = &quot;</span> &lt;&lt; dTargetSandToDepositOnThisProfile &lt;&lt; <span class="stringliteral">&quot; dSandDepositedOnThisProfile = &quot;</span> &lt;&lt; dSandDepositedOnThisProfile &lt;&lt; <span class="stringliteral">&quot; dTotSandToDepositAllProfiles = &quot;</span> &lt;&lt; dTotSandToDepositAllProfiles &lt;&lt; <span class="stringliteral">&quot; dTotSandDepositedAllProfiles = &quot;</span> &lt;&lt; dTotSandDepositedAllProfiles &lt;&lt; endl &lt;&lt; <span class="stringliteral">&quot;\tdTargetCoarseToDepositOnThisProfile = &quot;</span> &lt;&lt; dTargetCoarseToDepositOnThisProfile &lt;&lt; <span class="stringliteral">&quot; dCoarseDepositedOnThisProfile = &quot;</span> &lt;&lt; dCoarseDepositedOnThisProfile &lt;&lt; <span class="stringliteral">&quot; dTotCoarseToDepositAllProfiles = &quot;</span> &lt;&lt;  dTotCoarseToDepositAllProfiles &lt;&lt; <span class="stringliteral">&quot; dTotCoarseDepositedAllProfiles = &quot;</span> &lt;&lt; dTotCoarseDepositedAllProfiles &lt;&lt; endl;</div>
<div class="line"><a id="l00648" name="l00648"></a><span class="lineno">  648</span>            </div>
<div class="line"><a id="l00649" name="l00649"></a><span class="lineno">  649</span>            <span class="keywordflow">return</span> <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#ac35a5105cdbbb00d8c809eee7c72a0f8">RTN_ERR_CLIFFDEPOSIT</a>;</div>
<div class="line"><a id="l00650" name="l00650"></a><span class="lineno">  650</span>         }</div>
<div class="line"><a id="l00651" name="l00651"></a><span class="lineno">  651</span> </div>
<div class="line"><a id="l00652" name="l00652"></a><span class="lineno">  652</span>         <span class="comment">// Now construct a deposition collapse profile from the start point, it is one cell longer than the specified length because it includes the cliff point in the profile. Calculate its length in external CRS units, the way it is done here is approximate but probably OK</span></div>
<div class="line"><a id="l00653" name="l00653"></a><span class="lineno">  653</span>         <span class="keywordtype">double</span> dThisProfileLength = (nTalusProfileLen + nSeawardOffset + 1) * <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#ae0de69c3d3acd6d52dc2ec2f456c0eb5">m_dCellSide</a>;</div>
<div class="line"><a id="l00654" name="l00654"></a><span class="lineno">  654</span> </div>
<div class="line"><a id="l00655" name="l00655"></a><span class="lineno">  655</span>         <span class="comment">// Get the end point of this coastline-normal line</span></div>
<div class="line"><a id="l00656" name="l00656"></a><span class="lineno">  656</span>         <a class="code hl_class" href="../../d6/d0d/classCGeom2DIPoint.html">CGeom2DIPoint</a> PtiEnd;            <span class="comment">// In grid CRS</span></div>
<div class="line"><a id="l00657" name="l00657"></a><span class="lineno">  657</span>         <span class="keywordtype">int</span> nRtn = <a class="code hl_function" href="../../d1/d98/classCSimulation.html#a9a8f66d4a55299b92d4b1cea9e1d095e">nGetCoastNormalEndPoint</a>(nCoast, nThisPoint, nCoastSize, &amp;PtStart, dThisProfileLength, &amp;PtEnd, &amp;PtiEnd, <span class="keyword">false</span>);</div>
<div class="line"><a id="l00658" name="l00658"></a><span class="lineno">  658</span> </div>
<div class="line"><a id="l00659" name="l00659"></a><span class="lineno">  659</span>         <span class="comment">// Safety check</span></div>
<div class="line"><a id="l00660" name="l00660"></a><span class="lineno">  660</span>         <span class="keywordflow">if</span> (nRtn == <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#ace82416ca7fb524bd4da49c3d402b082">RTN_ERR_NO_SOLUTION_FOR_ENDPOINT</a>)</div>
<div class="line"><a id="l00661" name="l00661"></a><span class="lineno">  661</span>         {</div>
<div class="line"><a id="l00662" name="l00662"></a><span class="lineno">  662</span>            <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a222962121613613a48f518e0c2110f21">LogStream</a> &lt;&lt; <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#ad67e8c5b30a0572f64ecfb5c062c2edc">m_ulIter</a> &lt;&lt; <span class="stringliteral">&quot;: unable to deposit sufficient unconsolidated talus from cliff collapse, could not find a solution for the end point of the Dean profile&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a id="l00663" name="l00663"></a><span class="lineno">  663</span>            </div>
<div class="line"><a id="l00664" name="l00664"></a><span class="lineno">  664</span>            <span class="keywordflow">return</span> nRtn;</div>
<div class="line"><a id="l00665" name="l00665"></a><span class="lineno">  665</span>         }</div>
<div class="line"><a id="l00666" name="l00666"></a><span class="lineno">  666</span> </div>
<div class="line"><a id="l00667" name="l00667"></a><span class="lineno">  667</span>         <span class="comment">// Safety check</span></div>
<div class="line"><a id="l00668" name="l00668"></a><span class="lineno">  668</span>         <span class="keywordflow">if</span> (PtStart == PtEnd)</div>
<div class="line"><a id="l00669" name="l00669"></a><span class="lineno">  669</span>         {</div>
<div class="line"><a id="l00670" name="l00670"></a><span class="lineno">  670</span>            <span class="comment">// This would give a zero-length profile, and a zero-divide error during rasterization. So just move on to the next profile</span></div>
<div class="line"><a id="l00671" name="l00671"></a><span class="lineno">  671</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00672" name="l00672"></a><span class="lineno">  672</span>         }</div>
<div class="line"><a id="l00673" name="l00673"></a><span class="lineno">  673</span>         </div>
<div class="line"><a id="l00674" name="l00674"></a><span class="lineno">  674</span>         <span class="comment">// OK, both the start and end points of this deposition profile are within the grid</span></div>
<div class="line"><a id="l00675" name="l00675"></a><span class="lineno">  675</span>         <span class="comment">//         LogStream &lt;&lt; m_ulIter &lt;&lt; &quot;: nWidthDistSigned = &quot; &lt;&lt; nWidthDistSigned &lt;&lt; &quot; cliff collapse profile from &quot; &lt;&lt; PtStart.dGetX() &lt;&lt; &quot;, &quot; &lt;&lt; PtStart.dGetY() &lt;&lt; &quot; to &quot; &lt;&lt; PtEnd.dGetX() &lt;&lt; &quot;, &quot; &lt;&lt; PtEnd.dGetY() &lt;&lt; &quot; with length (inc. cliff point) = &quot; &lt;&lt; dThisProfileLength &lt;&lt; endl;</span></div>
<div class="line"><a id="l00676" name="l00676"></a><span class="lineno">  676</span> </div>
<div class="line"><a id="l00677" name="l00677"></a><span class="lineno">  677</span>         vector&lt;CGeom2DPoint&gt; VTmpProfile;</div>
<div class="line"><a id="l00678" name="l00678"></a><span class="lineno">  678</span>         VTmpProfile.push_back(PtStart);</div>
<div class="line"><a id="l00679" name="l00679"></a><span class="lineno">  679</span>         VTmpProfile.push_back(PtEnd);</div>
<div class="line"><a id="l00680" name="l00680"></a><span class="lineno">  680</span>         vector&lt;CGeom2DIPoint&gt; VCellsUnderProfile;</div>
<div class="line"><a id="l00681" name="l00681"></a><span class="lineno">  681</span> </div>
<div class="line"><a id="l00682" name="l00682"></a><span class="lineno">  682</span>         <span class="comment">// Now get the raster cells under this profile</span></div>
<div class="line"><a id="l00683" name="l00683"></a><span class="lineno">  683</span>         <a class="code hl_function" href="../../d1/d98/classCSimulation.html#a185287a9d4c6dafaef17e0938c018c3e">RasterizeCliffCollapseProfile</a>(&amp;VTmpProfile, &amp;VCellsUnderProfile);</div>
<div class="line"><a id="l00684" name="l00684"></a><span class="lineno">  684</span> </div>
<div class="line"><a id="l00685" name="l00685"></a><span class="lineno">  685</span>         <span class="keywordtype">int</span> nRasterProfileLength = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(VCellsUnderProfile.size());</div>
<div class="line"><a id="l00686" name="l00686"></a><span class="lineno">  686</span> </div>
<div class="line"><a id="l00687" name="l00687"></a><span class="lineno">  687</span>         <span class="comment">// Check now, for the case where the profile is very short</span></div>
<div class="line"><a id="l00688" name="l00688"></a><span class="lineno">  688</span>         <span class="keywordflow">if</span> (nRasterProfileLength - nSeawardOffset &lt; 3)</div>
<div class="line"><a id="l00689" name="l00689"></a><span class="lineno">  689</span>         {</div>
<div class="line"><a id="l00690" name="l00690"></a><span class="lineno">  690</span>            <span class="comment">// Can&#39;t do anything with this very short profile, since (nRasterProfileLength - nSeawardOffset - 2) later will give zero or -ve dInc. So just move on to the next profile</span></div>
<div class="line"><a id="l00691" name="l00691"></a><span class="lineno">  691</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00692" name="l00692"></a><span class="lineno">  692</span>         }</div>
<div class="line"><a id="l00693" name="l00693"></a><span class="lineno">  693</span>         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (nRasterProfileLength - nSeawardOffset == 3)</div>
<div class="line"><a id="l00694" name="l00694"></a><span class="lineno">  694</span>         {</div>
<div class="line"><a id="l00695" name="l00695"></a><span class="lineno">  695</span>            <span class="comment">// Can&#39;t increase offset any more, or get zero divide with (nRasterProfileLength - nSeawardOffset - 2) later. So just deposit what we can and then move on to the next profile</span></div>
<div class="line"><a id="l00696" name="l00696"></a><span class="lineno">  696</span>            bJustDepositWhatWeCan = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00697" name="l00697"></a><span class="lineno">  697</span>         }</div>
<div class="line"><a id="l00698" name="l00698"></a><span class="lineno">  698</span> </div>
<div class="line"><a id="l00699" name="l00699"></a><span class="lineno">  699</span>         vector&lt;double&gt; dVProfileNow(nRasterProfileLength, 0);</div>
<div class="line"><a id="l00700" name="l00700"></a><span class="lineno">  700</span>         vector&lt;bool&gt; bVProfileValid(nRasterProfileLength, <span class="keyword">true</span>);</div>
<div class="line"><a id="l00701" name="l00701"></a><span class="lineno">  701</span> </div>
<div class="line"><a id="l00702" name="l00702"></a><span class="lineno">  702</span>         <span class="comment">// LogStream &lt;&lt; m_ulIter &lt;&lt; &quot;: for cliff collapse at [&quot; &lt;&lt; nXCliff &lt;&lt; &quot;][&quot; &lt;&lt; nYCliff &lt;&lt; &quot;] nStartPoint = &quot; &lt;&lt; nStartPoint &lt;&lt; &quot; nAcross = &quot; &lt;&lt; nAcross &lt;&lt; endl &lt;&lt; &quot;\tnRasterProfileLength = &quot; &lt;&lt; nRasterProfileLength &lt;&lt; &quot; nSeawardOffset = &quot; &lt;&lt; nSeawardOffset &lt;&lt; &quot; nRasterProfileLength - nSeawardOffset - 2 = &quot; &lt;&lt; nRasterProfileLength - nSeawardOffset - 2 &lt;&lt; endl;</span></div>
<div class="line"><a id="l00703" name="l00703"></a><span class="lineno">  703</span> </div>
<div class="line"><a id="l00704" name="l00704"></a><span class="lineno">  704</span>         <span class="comment">// Calculate the existing elevation for all points along the deposition profile</span></div>
<div class="line"><a id="l00705" name="l00705"></a><span class="lineno">  705</span>         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n = 0; n &lt; nRasterProfileLength; n++)</div>
<div class="line"><a id="l00706" name="l00706"></a><span class="lineno">  706</span>         {</div>
<div class="line"><a id="l00707" name="l00707"></a><span class="lineno">  707</span>            <span class="keywordtype">int</span> nX = VCellsUnderProfile[n].nGetX();</div>
<div class="line"><a id="l00708" name="l00708"></a><span class="lineno">  708</span>            <span class="keywordtype">int</span> nY = VCellsUnderProfile[n].nGetY();</div>
<div class="line"><a id="l00709" name="l00709"></a><span class="lineno">  709</span> </div>
<div class="line"><a id="l00710" name="l00710"></a><span class="lineno">  710</span>            dVProfileNow[n] = <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[nX][nY].dGetSedimentTopElev();</div>
<div class="line"><a id="l00711" name="l00711"></a><span class="lineno">  711</span> </div>
<div class="line"><a id="l00712" name="l00712"></a><span class="lineno">  712</span>            <span class="comment">// Don&#39;t allow cliff collapse talus onto intervention cells TODO 078 Is this realistic? Should it change with different types on intervention?</span></div>
<div class="line"><a id="l00713" name="l00713"></a><span class="lineno">  713</span>            <span class="keywordflow">if</span> (<a class="code hl_function" href="../../d1/d98/classCSimulation.html#ae293573ac53f0a8d536037d0edffd25f">bIsInterventionCell</a>(nX, nY))</div>
<div class="line"><a id="l00714" name="l00714"></a><span class="lineno">  714</span>               bVProfileValid[n] = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00715" name="l00715"></a><span class="lineno">  715</span>         }</div>
<div class="line"><a id="l00716" name="l00716"></a><span class="lineno">  716</span> </div>
<div class="line"><a id="l00717" name="l00717"></a><span class="lineno">  717</span>         <span class="comment">// Now calculate the elevation of the talus top at the shoreline</span></div>
<div class="line"><a id="l00718" name="l00718"></a><span class="lineno">  718</span>         <span class="keywordtype">double</span> dCliffHeight = dPreCollapseCliffElev - dPostCollapseCliffElev;</div>
<div class="line"><a id="l00719" name="l00719"></a><span class="lineno">  719</span>         <span class="keywordtype">double</span> dTalusTopElev = dPostCollapseCliffElev + (dCliffHeight * dCliffHeightFrac);</div>
<div class="line"><a id="l00720" name="l00720"></a><span class="lineno">  720</span> </div>
<div class="line"><a id="l00721" name="l00721"></a><span class="lineno">  721</span>         <span class="comment">//         LogStream &lt;&lt; &quot;Elevations: cliff top = &quot; &lt;&lt; dPreCollapseCliffElev &lt;&lt; &quot; cliff base = &quot; &lt;&lt; dPostCollapseCliffElev &lt;&lt; &quot; talus top = &quot; &lt;&lt; dTalusTopElev &lt;&lt; endl;</span></div>
<div class="line"><a id="l00722" name="l00722"></a><span class="lineno">  722</span> </div>
<div class="line"><a id="l00723" name="l00723"></a><span class="lineno">  723</span>         <span class="comment">//          if (dPreCollapseCliffElev &lt; dPostCollapseCliffElev)</span></div>
<div class="line"><a id="l00724" name="l00724"></a><span class="lineno">  724</span>         <span class="comment">//             LogStream &lt;&lt; &quot;*** ERROR, cliff top is lower than cliff base&quot; &lt;&lt; endl;</span></div>
<div class="line"><a id="l00725" name="l00725"></a><span class="lineno">  725</span> </div>
<div class="line"><a id="l00726" name="l00726"></a><span class="lineno">  726</span>         <span class="comment">// Next calculate the talus slope length in external CRS units, this is approximate but probably OK</span></div>
<div class="line"><a id="l00727" name="l00727"></a><span class="lineno">  727</span>         <span class="keywordtype">double</span> dTalusSlopeLength = dThisProfileLength - ((nSeawardOffset - 1) * <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#ae0de69c3d3acd6d52dc2ec2f456c0eb5">m_dCellSide</a>);</div>
<div class="line"><a id="l00728" name="l00728"></a><span class="lineno">  728</span> </div>
<div class="line"><a id="l00729" name="l00729"></a><span class="lineno">  729</span>         <span class="comment">// If user has not supplied a value for m_dCliffDepositionA, then solve for dA so that the elevations at end of the existing profile, and at the end of the Dean equilibrium profile, are the same</span></div>
<div class="line"><a id="l00730" name="l00730"></a><span class="lineno">  730</span>         <span class="keywordtype">double</span> dA = 0;</div>
<div class="line"><a id="l00731" name="l00731"></a><span class="lineno">  731</span>         <span class="keywordflow">if</span> (<a class="code hl_function" href="../../d6/d2a/cme_8h.html#a61afa8560a3b39c80657661a1d8f76ab">bFPIsEqual</a>(<a class="code hl_variable" href="../../d1/d98/classCSimulation.html#aa35a5d1dce719b48d71f4ca4e008290b">m_dCliffDepositionA</a>, 0.0, <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#a08b1623863ee3bd4300a8892de323722">TOLERANCE</a>))</div>
<div class="line"><a id="l00732" name="l00732"></a><span class="lineno">  732</span>            dA = <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#aa35a5d1dce719b48d71f4ca4e008290b">m_dCliffDepositionA</a>;</div>
<div class="line"><a id="l00733" name="l00733"></a><span class="lineno">  733</span>         <span class="keywordflow">else</span></div>
<div class="line"><a id="l00734" name="l00734"></a><span class="lineno">  734</span>            dA = (dTalusTopElev - dVProfileNow[nRasterProfileLength - 1]) / pow(dTalusSlopeLength, <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#ac5c14eafd96860d3f562e9c7f23a4104">DEAN_POWER</a>);</div>
<div class="line"><a id="l00735" name="l00735"></a><span class="lineno">  735</span> </div>
<div class="line"><a id="l00736" name="l00736"></a><span class="lineno">  736</span>         <span class="comment">// assert((nRasterProfileLength - nSeawardOffset - 2) &gt; 0);</span></div>
<div class="line"><a id="l00737" name="l00737"></a><span class="lineno">  737</span>         <span class="keywordtype">double</span> dInc = dTalusSlopeLength / (nRasterProfileLength - nSeawardOffset - 2);</div>
<div class="line"><a id="l00738" name="l00738"></a><span class="lineno">  738</span>         vector&lt;double&gt; dVDeanProfile(nRasterProfileLength);</div>
<div class="line"><a id="l00739" name="l00739"></a><span class="lineno">  739</span> </div>
<div class="line"><a id="l00740" name="l00740"></a><span class="lineno">  740</span>         <span class="comment">// Calculate the Dean equilibrium profile of the talus h(y) = A * y^(2/3) where h(y) is the distance below the talus-top elevation (the highest point in the Dean profile) at a distance y from the cliff (the landward start of the profile)</span></div>
<div class="line"><a id="l00741" name="l00741"></a><span class="lineno">  741</span>         <a class="code hl_function" href="../../d1/d98/classCSimulation.html#aee4cd1d27e2a0710a45b4d814e95078d">CalcDeanProfile</a>(&amp;dVDeanProfile, dInc, dTalusTopElev, dA, <span class="keyword">true</span>, nSeawardOffset, dTalusTopElev);</div>
<div class="line"><a id="l00742" name="l00742"></a><span class="lineno">  742</span> </div>
<div class="line"><a id="l00743" name="l00743"></a><span class="lineno">  743</span>         <span class="comment">// Get the total difference in elevation between the two profiles (Dean profile - present profile). Since we want the Dean profile to be higher than the present profile, a good result is a +ve number</span></div>
<div class="line"><a id="l00744" name="l00744"></a><span class="lineno">  744</span>         <span class="keywordtype">double</span> dTotElevDiff = <a class="code hl_function" href="../../d1/d98/classCSimulation.html#a5c6043e2c01c4f9d1cb9b4ca5f940bd7">dSubtractProfiles</a>(&amp;dVDeanProfile, &amp;dVProfileNow, &amp;bVProfileValid);</div>
<div class="line"><a id="l00745" name="l00745"></a><span class="lineno">  745</span> </div>
<div class="line"><a id="l00746" name="l00746"></a><span class="lineno">  746</span>         <span class="comment">//          // DEBUG CODE -----------------------------------------------------</span></div>
<div class="line"><a id="l00747" name="l00747"></a><span class="lineno">  747</span>         <span class="comment">//          LogStream &lt;&lt; endl;</span></div>
<div class="line"><a id="l00748" name="l00748"></a><span class="lineno">  748</span>         <span class="comment">//          LogStream &lt;&lt; &quot;dTalusSlopeLength = &quot; &lt;&lt; dTalusSlopeLength &lt;&lt; &quot; dA = &quot; &lt;&lt; dA &lt;&lt; endl;</span></div>
<div class="line"><a id="l00749" name="l00749"></a><span class="lineno">  749</span>         <span class="comment">//          LogStream &lt;&lt; &quot;dDistFromTalusStart - dInc = &quot; &lt;&lt; dDistFromTalusStart - dInc &lt;&lt; &quot; dThisProfileLength - nSeawardOffset - 2 = &quot; &lt;&lt; dThisProfileLength - nSeawardOffset - 2 &lt;&lt; endl;</span></div>
<div class="line"><a id="l00750" name="l00750"></a><span class="lineno">  750</span>         <span class="comment">//          LogStream &lt;&lt; &quot;Profile now (inc. cliff cell) = &quot;;</span></div>
<div class="line"><a id="l00751" name="l00751"></a><span class="lineno">  751</span>         <span class="comment">//          for (int n = 0; n &lt; nRasterProfileLength; n++)</span></div>
<div class="line"><a id="l00752" name="l00752"></a><span class="lineno">  752</span>         <span class="comment">//          {</span></div>
<div class="line"><a id="l00753" name="l00753"></a><span class="lineno">  753</span>         <span class="comment">//             int</span></div>
<div class="line"><a id="l00754" name="l00754"></a><span class="lineno">  754</span>         <span class="comment">//                nX = VCellsUnderProfile[n].nGetX(),</span></div>
<div class="line"><a id="l00755" name="l00755"></a><span class="lineno">  755</span>         <span class="comment">//                nY = VCellsUnderProfile[n].nGetY();</span></div>
<div class="line"><a id="l00756" name="l00756"></a><span class="lineno">  756</span>         <span class="comment">//             dVProfileNow[n] = m_pRasterGrid-&gt;m_Cell[nX][nY].dGetSedimentTopElev();</span></div>
<div class="line"><a id="l00757" name="l00757"></a><span class="lineno">  757</span>         <span class="comment">//             LogStream &lt;&lt; dVProfileNow[n] &lt;&lt; &quot; &quot;;</span></div>
<div class="line"><a id="l00758" name="l00758"></a><span class="lineno">  758</span>         <span class="comment">//          }</span></div>
<div class="line"><a id="l00759" name="l00759"></a><span class="lineno">  759</span>         <span class="comment">//          LogStream &lt;&lt; endl;</span></div>
<div class="line"><a id="l00760" name="l00760"></a><span class="lineno">  760</span>         <span class="comment">//          LogStream &lt;&lt; &quot;Dean equilibrium profile (inc. cliff cell) = &quot;;</span></div>
<div class="line"><a id="l00761" name="l00761"></a><span class="lineno">  761</span>         <span class="comment">//          for (int n = 0; n &lt; nRasterProfileLength; n++)</span></div>
<div class="line"><a id="l00762" name="l00762"></a><span class="lineno">  762</span>         <span class="comment">//          {</span></div>
<div class="line"><a id="l00763" name="l00763"></a><span class="lineno">  763</span>         <span class="comment">//             LogStream &lt;&lt; dVDeanProfile[n] &lt;&lt; &quot; &quot;;</span></div>
<div class="line"><a id="l00764" name="l00764"></a><span class="lineno">  764</span>         <span class="comment">//          }</span></div>
<div class="line"><a id="l00765" name="l00765"></a><span class="lineno">  765</span>         <span class="comment">//          LogStream &lt;&lt; endl;</span></div>
<div class="line"><a id="l00766" name="l00766"></a><span class="lineno">  766</span>         <span class="comment">//          LogStream &lt;&lt; &quot;Difference (inc. cliff cell) = &quot;;</span></div>
<div class="line"><a id="l00767" name="l00767"></a><span class="lineno">  767</span>         <span class="comment">//          for (int n = 0; n &lt; nRasterProfileLength; n++)</span></div>
<div class="line"><a id="l00768" name="l00768"></a><span class="lineno">  768</span>         <span class="comment">//          {</span></div>
<div class="line"><a id="l00769" name="l00769"></a><span class="lineno">  769</span>         <span class="comment">//             LogStream &lt;&lt; dVDeanProfile[n] - dVProfileNow[n] &lt;&lt; &quot; &quot;;</span></div>
<div class="line"><a id="l00770" name="l00770"></a><span class="lineno">  770</span>         <span class="comment">//          }</span></div>
<div class="line"><a id="l00771" name="l00771"></a><span class="lineno">  771</span>         <span class="comment">//          LogStream &lt;&lt; endl;</span></div>
<div class="line"><a id="l00772" name="l00772"></a><span class="lineno">  772</span>         <span class="comment">//          // DEBUG CODE -----------------------------------------------------</span></div>
<div class="line"><a id="l00773" name="l00773"></a><span class="lineno">  773</span> </div>
<div class="line"><a id="l00774" name="l00774"></a><span class="lineno">  774</span>         <span class="comment">// If we are not in a &quot;just deposit what we can&quot; situation, then for this planview profile, does the Dean equilibrium profile allow us to deposit all the talus sediment which we need to get rid of?</span></div>
<div class="line"><a id="l00775" name="l00775"></a><span class="lineno">  775</span>         <span class="keywordflow">if</span> (! bJustDepositWhatWeCan &amp;&amp; (dTotElevDiff &lt; (dTargetSandToDepositOnThisProfile + dTargetCoarseToDepositOnThisProfile)))</div>
<div class="line"><a id="l00776" name="l00776"></a><span class="lineno">  776</span>         {</div>
<div class="line"><a id="l00777" name="l00777"></a><span class="lineno">  777</span>            <span class="comment">// No it doesn&#39;t, so try again with a larger seaward offset and/or a longer Dean profile length</span></div>
<div class="line"><a id="l00778" name="l00778"></a><span class="lineno">  778</span>            <span class="comment">// LogStream &lt;&lt; m_ulIter &lt;&lt; &quot;: bJustDepositWhatWeCan = &quot; &lt;&lt; bJustDepositWhatWeCan &lt;&lt; &quot; nSeawardOffset = &quot; &lt;&lt; nSeawardOffset &lt;&lt; &quot; dTotElevDiff = &quot; &lt;&lt; dTotElevDiff &lt;&lt; endl;</span></div>
<div class="line"><a id="l00779" name="l00779"></a><span class="lineno">  779</span>            </div>
<div class="line"><a id="l00780" name="l00780"></a><span class="lineno">  780</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l00781" name="l00781"></a><span class="lineno">  781</span>         }</div>
<div class="line"><a id="l00782" name="l00782"></a><span class="lineno">  782</span>         </div>
<div class="line"><a id="l00783" name="l00783"></a><span class="lineno">  783</span>         <span class="comment">// OK, now process all cells in this profile, including the first one (which is where the cliff collapse occurred)</span></div>
<div class="line"><a id="l00784" name="l00784"></a><span class="lineno">  784</span>         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n = 0; n &lt; nRasterProfileLength; n++)</div>
<div class="line"><a id="l00785" name="l00785"></a><span class="lineno">  785</span>         {</div>
<div class="line"><a id="l00786" name="l00786"></a><span class="lineno">  786</span>            <span class="comment">// Are we depositing sand talus sediment on this profile?</span></div>
<div class="line"><a id="l00787" name="l00787"></a><span class="lineno">  787</span>            <span class="keywordflow">if</span> (bDoSandDepositionOnThisProfile)</div>
<div class="line"><a id="l00788" name="l00788"></a><span class="lineno">  788</span>            {</div>
<div class="line"><a id="l00789" name="l00789"></a><span class="lineno">  789</span>               <span class="keywordflow">if</span> (<a class="code hl_function" href="../../d6/d2a/cme_8h.html#a61afa8560a3b39c80657661a1d8f76ab">bFPIsEqual</a>(dTargetSandToDepositOnThisProfile - dSandDepositedOnThisProfile, 0.0, <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#a7b4b1553585db781ce65707e31294bea">MASS_BALANCE_TOLERANCE</a>))</div>
<div class="line"><a id="l00790" name="l00790"></a><span class="lineno">  790</span>                  bSandDepositionCompletedOnThisProfile = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00791" name="l00791"></a><span class="lineno">  791</span>               <span class="keywordflow">else</span></div>
<div class="line"><a id="l00792" name="l00792"></a><span class="lineno">  792</span>                  bSandDepositionCompletedOnThisProfile = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00793" name="l00793"></a><span class="lineno">  793</span>            }</div>
<div class="line"><a id="l00794" name="l00794"></a><span class="lineno">  794</span> </div>
<div class="line"><a id="l00795" name="l00795"></a><span class="lineno">  795</span>            <span class="comment">// Are we depositing coarse talus sediment on this profile?</span></div>
<div class="line"><a id="l00796" name="l00796"></a><span class="lineno">  796</span>            <span class="keywordflow">if</span> (bDoCoarseDepositionOnThisProfile)</div>
<div class="line"><a id="l00797" name="l00797"></a><span class="lineno">  797</span>            {</div>
<div class="line"><a id="l00798" name="l00798"></a><span class="lineno">  798</span>               <span class="keywordflow">if</span> (<a class="code hl_function" href="../../d6/d2a/cme_8h.html#a61afa8560a3b39c80657661a1d8f76ab">bFPIsEqual</a>(dTargetCoarseToDepositOnThisProfile - dCoarseDepositedOnThisProfile, 0.0, <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#a7b4b1553585db781ce65707e31294bea">MASS_BALANCE_TOLERANCE</a>))</div>
<div class="line"><a id="l00799" name="l00799"></a><span class="lineno">  799</span>                  bCoarseDepositionCompletedOnThisProfile = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00800" name="l00800"></a><span class="lineno">  800</span>               <span class="keywordflow">else</span></div>
<div class="line"><a id="l00801" name="l00801"></a><span class="lineno">  801</span>                  bCoarseDepositionCompletedOnThisProfile = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00802" name="l00802"></a><span class="lineno">  802</span>            }</div>
<div class="line"><a id="l00803" name="l00803"></a><span class="lineno">  803</span> </div>
<div class="line"><a id="l00804" name="l00804"></a><span class="lineno">  804</span>            <span class="comment">// If we have deposited enough, then break out of the loop</span></div>
<div class="line"><a id="l00805" name="l00805"></a><span class="lineno">  805</span>            <span class="keywordflow">if</span> (bSandDepositionCompletedOnThisProfile &amp;&amp; bCoarseDepositionCompletedOnThisProfile)</div>
<div class="line"><a id="l00806" name="l00806"></a><span class="lineno">  806</span>            {</div>
<div class="line"><a id="l00807" name="l00807"></a><span class="lineno">  807</span>               <span class="comment">// LogStream &lt;&lt; m_ulIter &lt;&lt; &quot;: break 1 for cliff collapse at [&quot; &lt;&lt; nXCliff &lt;&lt; &quot;][&quot; &lt;&lt; nYCliff &lt;&lt; &quot;] nStartPoint = &quot; &lt;&lt; nStartPoint &lt;&lt; &quot; nThisPoint = &quot; &lt;&lt; nThisPoint &lt;&lt; endl &lt;&lt; &quot;\tbJustDepositWhatWeCan = &quot; &lt;&lt; bJustDepositWhatWeCan &lt;&lt; &quot; nSeawardOffset = &quot; &lt;&lt; nSeawardOffset &lt;&lt; &quot; dCliffHeightFrac = &quot; &lt;&lt; dCliffHeightFrac &lt;&lt; &quot; nAcross = &quot; &lt;&lt; nAcross &lt;&lt; endl &lt;&lt; &quot;\tdTargetSandToDepositOnThisProfile = &quot; &lt;&lt; dTargetSandToDepositOnThisProfile &lt;&lt; &quot; dSandDepositedOnThisProfile = &quot; &lt;&lt; dSandDepositedOnThisProfile &lt;&lt; &quot; dTotSandToDepositAllProfiles = &quot; &lt;&lt; dTotSandToDepositAllProfiles &lt;&lt; &quot; dTotSandDepositedAllProfiles = &quot; &lt;&lt; dTotSandDepositedAllProfiles &lt;&lt; endl &lt;&lt; &quot;\tdTargetCoarseToDepositOnThisProfile = &quot; &lt;&lt; dTargetCoarseToDepositOnThisProfile &lt;&lt; &quot; dCoarseDepositedOnThisProfile = &quot; &lt;&lt; dCoarseDepositedOnThisProfile &lt;&lt; &quot; dTotCoarseToDepositAllProfiles = &quot; &lt;&lt;  dTotCoarseToDepositAllProfiles &lt;&lt; &quot; dTotCoarseDepositedAllProfiles = &quot; &lt;&lt; dTotCoarseDepositedAllProfiles &lt;&lt; endl;</span></div>
<div class="line"><a id="l00808" name="l00808"></a><span class="lineno">  808</span>               </div>
<div class="line"><a id="l00809" name="l00809"></a><span class="lineno">  809</span>               <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00810" name="l00810"></a><span class="lineno">  810</span>            }</div>
<div class="line"><a id="l00811" name="l00811"></a><span class="lineno">  811</span> </div>
<div class="line"><a id="l00812" name="l00812"></a><span class="lineno">  812</span>            <span class="comment">// Nope, we still have some talus left to deposit</span></div>
<div class="line"><a id="l00813" name="l00813"></a><span class="lineno">  813</span>            <span class="keywordtype">int</span> nX = VCellsUnderProfile[n].nGetX();</div>
<div class="line"><a id="l00814" name="l00814"></a><span class="lineno">  814</span>            <span class="keywordtype">int</span> nY = VCellsUnderProfile[n].nGetY();</div>
<div class="line"><a id="l00815" name="l00815"></a><span class="lineno">  815</span> </div>
<div class="line"><a id="l00816" name="l00816"></a><span class="lineno">  816</span>            <span class="comment">// Don&#39;t allow cliff collapse talus onto intervention cells TODO 078 Is this realistic? Should it change with different types on intervention?</span></div>
<div class="line"><a id="l00817" name="l00817"></a><span class="lineno">  817</span>            <span class="keywordflow">if</span> (<a class="code hl_function" href="../../d1/d98/classCSimulation.html#ae293573ac53f0a8d536037d0edffd25f">bIsInterventionCell</a>(nX, nY))</div>
<div class="line"><a id="l00818" name="l00818"></a><span class="lineno">  818</span>               <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l00819" name="l00819"></a><span class="lineno">  819</span> </div>
<div class="line"><a id="l00820" name="l00820"></a><span class="lineno">  820</span>            <span class="keywordtype">int</span> nTopLayer = <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[nX][nY].nGetTopNonZeroLayerAboveBasement();</div>
<div class="line"><a id="l00821" name="l00821"></a><span class="lineno">  821</span> </div>
<div class="line"><a id="l00822" name="l00822"></a><span class="lineno">  822</span>            <span class="comment">// Safety check</span></div>
<div class="line"><a id="l00823" name="l00823"></a><span class="lineno">  823</span>            <span class="keywordflow">if</span> (nTopLayer == <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#a01aa8b423260b337ddff2016107b51a0">INT_NODATA</a>)</div>
<div class="line"><a id="l00824" name="l00824"></a><span class="lineno">  824</span>               <span class="keywordflow">return</span> <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#a0af2b64c1c33dbf4d223944b0bf234e6">RTN_ERR_NO_TOP_LAYER</a>;</div>
<div class="line"><a id="l00825" name="l00825"></a><span class="lineno">  825</span> </div>
<div class="line"><a id="l00826" name="l00826"></a><span class="lineno">  826</span>            <span class="keywordflow">if</span> (nTopLayer == <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#a01522c1e8423c6586193dd5ca0c76171">NO_NONZERO_THICKNESS_LAYERS</a>)</div>
<div class="line"><a id="l00827" name="l00827"></a><span class="lineno">  827</span>            {</div>
<div class="line"><a id="l00828" name="l00828"></a><span class="lineno">  828</span>               <span class="comment">// TODO 021 Improve this</span></div>
<div class="line"><a id="l00829" name="l00829"></a><span class="lineno">  829</span>               cerr &lt;&lt; <span class="stringliteral">&quot;All layers have zero thickness&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a id="l00830" name="l00830"></a><span class="lineno">  830</span>               <span class="keywordflow">return</span> <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#ac35a5105cdbbb00d8c809eee7c72a0f8">RTN_ERR_CLIFFDEPOSIT</a>;</div>
<div class="line"><a id="l00831" name="l00831"></a><span class="lineno">  831</span>            }</div>
<div class="line"><a id="l00832" name="l00832"></a><span class="lineno">  832</span> </div>
<div class="line"><a id="l00833" name="l00833"></a><span class="lineno">  833</span>            <span class="comment">// Only do deposition on this cell if its elevation is below the Dean elevation</span></div>
<div class="line"><a id="l00834" name="l00834"></a><span class="lineno">  834</span>            <span class="keywordflow">if</span> (dVDeanProfile[n] &gt; dVProfileNow[n])</div>
<div class="line"><a id="l00835" name="l00835"></a><span class="lineno">  835</span>            {</div>
<div class="line"><a id="l00836" name="l00836"></a><span class="lineno">  836</span>               <span class="comment">// At this point along the profile, the Dean profile is higher than the present profile. So we can deposit some sediment on this cell</span></div>
<div class="line"><a id="l00837" name="l00837"></a><span class="lineno">  837</span>               <span class="keywordtype">double</span> dSandToDeposit = 0;</div>
<div class="line"><a id="l00838" name="l00838"></a><span class="lineno">  838</span>               <span class="keywordflow">if</span> (bDoSandDepositionOnThisProfile)</div>
<div class="line"><a id="l00839" name="l00839"></a><span class="lineno">  839</span>               {</div>
<div class="line"><a id="l00840" name="l00840"></a><span class="lineno">  840</span>                  dSandToDeposit = (dVDeanProfile[n] - dVProfileNow[n]) * dSandProp;</div>
<div class="line"><a id="l00841" name="l00841"></a><span class="lineno">  841</span>                  dSandToDeposit = <a class="code hl_function" href="../../d6/d2a/cme_8h.html#a068017859403c0629d89f8d348f6c224">tMin</a>(dSandToDeposit, (dTargetSandToDepositOnThisProfile - dSandDepositedOnThisProfile), (dTotSandToDepositAllProfiles - dTotSandDepositedAllProfiles));</div>
<div class="line"><a id="l00842" name="l00842"></a><span class="lineno">  842</span> </div>
<div class="line"><a id="l00843" name="l00843"></a><span class="lineno">  843</span>                  <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[nX][nY].pGetLayerAboveBasement(nTopLayer)-&gt;pGetUnconsolidatedSediment()-&gt;AddSandDepth(dSandToDeposit);</div>
<div class="line"><a id="l00844" name="l00844"></a><span class="lineno">  844</span> </div>
<div class="line"><a id="l00845" name="l00845"></a><span class="lineno">  845</span>                  <span class="comment">// Set the changed-this-timestep switch</span></div>
<div class="line"><a id="l00846" name="l00846"></a><span class="lineno">  846</span>                  <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#aa6ebdb3d36ad3cea05ec1446f20cacb8">m_bUnconsChangedThisIter</a>[nTopLayer] = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00847" name="l00847"></a><span class="lineno">  847</span>                  </div>
<div class="line"><a id="l00848" name="l00848"></a><span class="lineno">  848</span>                  dSandDepositedOnThisProfile += dSandToDeposit;</div>
<div class="line"><a id="l00849" name="l00849"></a><span class="lineno">  849</span>                  dTotSandDepositedAllProfiles += dSandToDeposit;</div>
<div class="line"><a id="l00850" name="l00850"></a><span class="lineno">  850</span>               }</div>
<div class="line"><a id="l00851" name="l00851"></a><span class="lineno">  851</span> </div>
<div class="line"><a id="l00852" name="l00852"></a><span class="lineno">  852</span>               <span class="keywordtype">double</span> dCoarseToDeposit = 0;</div>
<div class="line"><a id="l00853" name="l00853"></a><span class="lineno">  853</span>               <span class="keywordflow">if</span> (bDoCoarseDepositionOnThisProfile)</div>
<div class="line"><a id="l00854" name="l00854"></a><span class="lineno">  854</span>               {</div>
<div class="line"><a id="l00855" name="l00855"></a><span class="lineno">  855</span>                  dCoarseToDeposit = (dVDeanProfile[n] - dVProfileNow[n]) * dCoarseProp;</div>
<div class="line"><a id="l00856" name="l00856"></a><span class="lineno">  856</span>                  dCoarseToDeposit = <a class="code hl_function" href="../../d6/d2a/cme_8h.html#a068017859403c0629d89f8d348f6c224">tMin</a>(dCoarseToDeposit, (dTargetCoarseToDepositOnThisProfile - dCoarseDepositedOnThisProfile), (dTotCoarseToDepositAllProfiles - dTotCoarseDepositedAllProfiles));</div>
<div class="line"><a id="l00857" name="l00857"></a><span class="lineno">  857</span> </div>
<div class="line"><a id="l00858" name="l00858"></a><span class="lineno">  858</span>                  <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[nX][nY].pGetLayerAboveBasement(nTopLayer)-&gt;pGetUnconsolidatedSediment()-&gt;AddCoarseDepth(dCoarseToDeposit);</div>
<div class="line"><a id="l00859" name="l00859"></a><span class="lineno">  859</span> </div>
<div class="line"><a id="l00860" name="l00860"></a><span class="lineno">  860</span>                  <span class="comment">// Set the changed-this-timestep switch</span></div>
<div class="line"><a id="l00861" name="l00861"></a><span class="lineno">  861</span>                  <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#aa6ebdb3d36ad3cea05ec1446f20cacb8">m_bUnconsChangedThisIter</a>[nTopLayer] = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00862" name="l00862"></a><span class="lineno">  862</span> </div>
<div class="line"><a id="l00863" name="l00863"></a><span class="lineno">  863</span>                  dCoarseDepositedOnThisProfile += dCoarseToDeposit;</div>
<div class="line"><a id="l00864" name="l00864"></a><span class="lineno">  864</span>                  dTotCoarseDepositedAllProfiles += dCoarseToDeposit;</div>
<div class="line"><a id="l00865" name="l00865"></a><span class="lineno">  865</span>               }</div>
<div class="line"><a id="l00866" name="l00866"></a><span class="lineno">  866</span> </div>
<div class="line"><a id="l00867" name="l00867"></a><span class="lineno">  867</span>               <span class="comment">// Now update the cell&#39;s layer elevations</span></div>
<div class="line"><a id="l00868" name="l00868"></a><span class="lineno">  868</span>               <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[nX][nY].CalcAllLayerElevsAndD50();</div>
<div class="line"><a id="l00869" name="l00869"></a><span class="lineno">  869</span> </div>
<div class="line"><a id="l00870" name="l00870"></a><span class="lineno">  870</span>               <span class="comment">// Update the cell&#39;s sea depth</span></div>
<div class="line"><a id="l00871" name="l00871"></a><span class="lineno">  871</span>               <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[nX][nY].SetSeaDepth();</div>
<div class="line"><a id="l00872" name="l00872"></a><span class="lineno">  872</span> </div>
<div class="line"><a id="l00873" name="l00873"></a><span class="lineno">  873</span>               <span class="comment">// Update the cell&#39;s talus deposition, and total talus deposition, values</span></div>
<div class="line"><a id="l00874" name="l00874"></a><span class="lineno">  874</span>               <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[nX][nY].AddSandTalusDeposition(dSandToDeposit);</div>
<div class="line"><a id="l00875" name="l00875"></a><span class="lineno">  875</span>               <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[nX][nY].AddCoarseTalusDeposition(dCoarseToDeposit);</div>
<div class="line"><a id="l00876" name="l00876"></a><span class="lineno">  876</span> </div>
<div class="line"><a id="l00877" name="l00877"></a><span class="lineno">  877</span>               <span class="comment">// And set the landform category</span></div>
<div class="line"><a id="l00878" name="l00878"></a><span class="lineno">  878</span>               <a class="code hl_class" href="../../dc/d4a/classCRWCellLandform.html">CRWCellLandform</a>* pLandform = <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[nX][nY].pGetLandform();</div>
<div class="line"><a id="l00879" name="l00879"></a><span class="lineno">  879</span>               <span class="keywordtype">int</span> nCat = pLandform-&gt;<a class="code hl_function" href="../../dc/d4a/classCRWCellLandform.html#a5350a7ac48d1eef3a78bef9bcf041b45">nGetLFCategory</a>();</div>
<div class="line"><a id="l00880" name="l00880"></a><span class="lineno">  880</span> </div>
<div class="line"><a id="l00881" name="l00881"></a><span class="lineno">  881</span>               <span class="keywordflow">if</span> ((nCat != <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#a2113878b63a7dc5971c9500654865d55">LF_CAT_SEDIMENT_INPUT</a>) &amp;&amp; (nCat != <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#a2c56dd72d6afc9eb107a42a919bef8b0">LF_CAT_SEDIMENT_INPUT_SUBMERGED</a>) &amp;&amp; (nCat != <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#ac79118ee70069f5e1a7e50430aef4597">LF_CAT_SEDIMENT_INPUT_NOT_SUBMERGED</a>))</div>
<div class="line"><a id="l00882" name="l00882"></a><span class="lineno">  882</span>                  pLandform-&gt;<a class="code hl_function" href="../../dc/d4a/classCRWCellLandform.html#af53d3fe69c297cfb0b41d03e55ed6467">SetLFSubCategory</a>(<a class="code hl_variable" href="../../d6/d2a/cme_8h.html#a8a73c1e3b62bdc03aeb0be69f0fa018b">LF_SUBCAT_DRIFT_TALUS</a>);</div>
<div class="line"><a id="l00883" name="l00883"></a><span class="lineno">  883</span>            }</div>
<div class="line"><a id="l00884" name="l00884"></a><span class="lineno">  884</span> </div>
<div class="line"><a id="l00885" name="l00885"></a><span class="lineno">  885</span>            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dVDeanProfile[n] &lt; dVProfileNow[n])</div>
<div class="line"><a id="l00886" name="l00886"></a><span class="lineno">  886</span>            {</div>
<div class="line"><a id="l00887" name="l00887"></a><span class="lineno">  887</span>               <span class="comment">// Here, the Dean profile is lower than the existing profile, so we must remove some sediment from this cell  TODO 075 What if bedrock sticks above Dean profile?</span></div>
<div class="line"><a id="l00888" name="l00888"></a><span class="lineno">  888</span>               <span class="keywordtype">double</span> dThisLowering = dVProfileNow[n] - dVDeanProfile[n];</div>
<div class="line"><a id="l00889" name="l00889"></a><span class="lineno">  889</span> </div>
<div class="line"><a id="l00890" name="l00890"></a><span class="lineno">  890</span>               <span class="comment">// Find out how much sediment we have available on this cell</span></div>
<div class="line"><a id="l00891" name="l00891"></a><span class="lineno">  891</span>               <span class="keywordtype">double</span> dExistingAvailableFine = <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[nX][nY].pGetLayerAboveBasement(nTopLayer)-&gt;pGetUnconsolidatedSediment()-&gt;dGetFineDepth();</div>
<div class="line"><a id="l00892" name="l00892"></a><span class="lineno">  892</span>               <span class="keywordtype">double</span> dExistingAvailableSand = <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[nX][nY].pGetLayerAboveBasement(nTopLayer)-&gt;pGetUnconsolidatedSediment()-&gt;dGetSandDepth();</div>
<div class="line"><a id="l00893" name="l00893"></a><span class="lineno">  893</span>               <span class="keywordtype">double</span> dExistingAvailableCoarse = <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[nX][nY].pGetLayerAboveBasement(nTopLayer)-&gt;pGetUnconsolidatedSediment()-&gt;dGetCoarseDepth();</div>
<div class="line"><a id="l00894" name="l00894"></a><span class="lineno">  894</span> </div>
<div class="line"><a id="l00895" name="l00895"></a><span class="lineno">  895</span>               <span class="comment">// Now partition the total lowering for this cell between the three size fractions: do this by relative erodibility</span></div>
<div class="line"><a id="l00896" name="l00896"></a><span class="lineno">  896</span>               <span class="keywordtype">int</span> nFineWeight = (dExistingAvailableFine &gt; 0 ? 1 : 0);</div>
<div class="line"><a id="l00897" name="l00897"></a><span class="lineno">  897</span>               <span class="keywordtype">int</span> nSandWeight = (dExistingAvailableSand &gt; 0 ? 1 : 0);</div>
<div class="line"><a id="l00898" name="l00898"></a><span class="lineno">  898</span>               <span class="keywordtype">int</span> nCoarseWeight = (dExistingAvailableCoarse &gt; 0 ? 1 : 0);</div>
<div class="line"><a id="l00899" name="l00899"></a><span class="lineno">  899</span> </div>
<div class="line"><a id="l00900" name="l00900"></a><span class="lineno">  900</span>               <span class="keywordtype">double</span> dTotErodibility = (nFineWeight * <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a2fc00e8bedd7b2f6f2d7d6fedf54821d">m_dFineErodibilityNormalized</a>) + (nSandWeight * <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a73cad40fa795d80bb48bb360df2c47e9">m_dSandErodibilityNormalized</a>) + (nCoarseWeight * <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a41d2967d84cbcf1799123f3d51aac287">m_dCoarseErodibilityNormalized</a>);</div>
<div class="line"><a id="l00901" name="l00901"></a><span class="lineno">  901</span> </div>
<div class="line"><a id="l00902" name="l00902"></a><span class="lineno">  902</span>               <span class="keywordflow">if</span> (nFineWeight)</div>
<div class="line"><a id="l00903" name="l00903"></a><span class="lineno">  903</span>               {</div>
<div class="line"><a id="l00904" name="l00904"></a><span class="lineno">  904</span>                  <span class="comment">// Erode some fine-sized sediment</span></div>
<div class="line"><a id="l00905" name="l00905"></a><span class="lineno">  905</span>                  <span class="keywordtype">double</span> dFineLowering = (<a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a2fc00e8bedd7b2f6f2d7d6fedf54821d">m_dFineErodibilityNormalized</a> * dThisLowering) / dTotErodibility;</div>
<div class="line"><a id="l00906" name="l00906"></a><span class="lineno">  906</span> </div>
<div class="line"><a id="l00907" name="l00907"></a><span class="lineno">  907</span>                  <span class="comment">// Make sure we don&#39;t get -ve amounts left on the cell</span></div>
<div class="line"><a id="l00908" name="l00908"></a><span class="lineno">  908</span>                  <span class="keywordtype">double</span> dFine = <a class="code hl_function" href="../../d6/d2a/cme_8h.html#a068017859403c0629d89f8d348f6c224">tMin</a>(dExistingAvailableFine, dFineLowering);</div>
<div class="line"><a id="l00909" name="l00909"></a><span class="lineno">  909</span>                  <span class="keywordtype">double</span> dRemaining = dExistingAvailableFine - dFine;</div>
<div class="line"><a id="l00910" name="l00910"></a><span class="lineno">  910</span> </div>
<div class="line"><a id="l00911" name="l00911"></a><span class="lineno">  911</span>                  <span class="comment">// Set the value for this layer</span></div>
<div class="line"><a id="l00912" name="l00912"></a><span class="lineno">  912</span>                  <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[nX][nY].pGetLayerAboveBasement(nTopLayer)-&gt;pGetUnconsolidatedSediment()-&gt;SetFineDepth(dRemaining);</div>
<div class="line"><a id="l00913" name="l00913"></a><span class="lineno">  913</span> </div>
<div class="line"><a id="l00914" name="l00914"></a><span class="lineno">  914</span>                  <span class="comment">// And set the changed-this-timestep switch</span></div>
<div class="line"><a id="l00915" name="l00915"></a><span class="lineno">  915</span>                  <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#aa6ebdb3d36ad3cea05ec1446f20cacb8">m_bUnconsChangedThisIter</a>[nTopLayer] = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00916" name="l00916"></a><span class="lineno">  916</span> </div>
<div class="line"><a id="l00917" name="l00917"></a><span class="lineno">  917</span>                  <span class="comment">// And increment the per-timestep total for fine sediment eroded during cliff collapse deposition (note that this gets added in to the suspended load elsewhere, so no need to do it here)</span></div>
<div class="line"><a id="l00918" name="l00918"></a><span class="lineno">  918</span>                  <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a30f847968bc8dfb175fcf571ce93296f">m_dThisIterCliffCollapseFineErodedDuringDeposition</a> += dFine;</div>
<div class="line"><a id="l00919" name="l00919"></a><span class="lineno">  919</span> </div>
<div class="line"><a id="l00920" name="l00920"></a><span class="lineno">  920</span>                  <span class="comment">// LogStream &lt;&lt; m_ulIter &lt;&lt; &quot;: FINE erosion during cliff collapse talus deposition = &quot; &lt;&lt; dFine * m_dCellArea &lt;&lt; endl;</span></div>
<div class="line"><a id="l00921" name="l00921"></a><span class="lineno">  921</span> </div>
<div class="line"><a id="l00922" name="l00922"></a><span class="lineno">  922</span>                  <span class="comment">// Also add to the suspended load</span></div>
<div class="line"><a id="l00923" name="l00923"></a><span class="lineno">  923</span>                  <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a9ff982b02c96da7af9df717158907d43">m_dThisIterFineSedimentToSuspension</a> += dFine;</div>
<div class="line"><a id="l00924" name="l00924"></a><span class="lineno">  924</span>               }</div>
<div class="line"><a id="l00925" name="l00925"></a><span class="lineno">  925</span> </div>
<div class="line"><a id="l00926" name="l00926"></a><span class="lineno">  926</span>               <span class="keywordflow">if</span> (nSandWeight)</div>
<div class="line"><a id="l00927" name="l00927"></a><span class="lineno">  927</span>               {</div>
<div class="line"><a id="l00928" name="l00928"></a><span class="lineno">  928</span>                  <span class="comment">// Erode some sand-sized sediment</span></div>
<div class="line"><a id="l00929" name="l00929"></a><span class="lineno">  929</span>                  <span class="keywordtype">double</span> dSandLowering = (<a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a73cad40fa795d80bb48bb360df2c47e9">m_dSandErodibilityNormalized</a> * dThisLowering) / dTotErodibility;</div>
<div class="line"><a id="l00930" name="l00930"></a><span class="lineno">  930</span> </div>
<div class="line"><a id="l00931" name="l00931"></a><span class="lineno">  931</span>                  <span class="comment">// Make sure we don&#39;t get -ve amounts left on the source cell</span></div>
<div class="line"><a id="l00932" name="l00932"></a><span class="lineno">  932</span>                  <span class="keywordtype">double</span> dSandToErode = <a class="code hl_function" href="../../d6/d2a/cme_8h.html#a068017859403c0629d89f8d348f6c224">tMin</a>(dExistingAvailableSand, dSandLowering);</div>
<div class="line"><a id="l00933" name="l00933"></a><span class="lineno">  933</span>                  <span class="keywordtype">double</span> dRemaining = dExistingAvailableSand - dSandToErode;</div>
<div class="line"><a id="l00934" name="l00934"></a><span class="lineno">  934</span> </div>
<div class="line"><a id="l00935" name="l00935"></a><span class="lineno">  935</span>                  <span class="comment">// Set the value for this layer</span></div>
<div class="line"><a id="l00936" name="l00936"></a><span class="lineno">  936</span>                  <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[nX][nY].pGetLayerAboveBasement(nTopLayer)-&gt;pGetUnconsolidatedSediment()-&gt;SetSandDepth(dRemaining);</div>
<div class="line"><a id="l00937" name="l00937"></a><span class="lineno">  937</span> </div>
<div class="line"><a id="l00938" name="l00938"></a><span class="lineno">  938</span>                  <span class="comment">// Set the changed-this-timestep switch</span></div>
<div class="line"><a id="l00939" name="l00939"></a><span class="lineno">  939</span>                  <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#aa6ebdb3d36ad3cea05ec1446f20cacb8">m_bUnconsChangedThisIter</a>[nTopLayer] = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00940" name="l00940"></a><span class="lineno">  940</span> </div>
<div class="line"><a id="l00941" name="l00941"></a><span class="lineno">  941</span>                  <span class="comment">// And increment the per-timestep total for sand sediment eroded during cliff collapse deposition</span></div>
<div class="line"><a id="l00942" name="l00942"></a><span class="lineno">  942</span>                  <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#aa260ec96182ba4bd9881622f3568b7bd">m_dThisIterCliffCollapseSandErodedDuringDeposition</a> += dSandToErode;</div>
<div class="line"><a id="l00943" name="l00943"></a><span class="lineno">  943</span> </div>
<div class="line"><a id="l00944" name="l00944"></a><span class="lineno">  944</span>                  <span class="comment">// Increase the all-profiles and this-profile sand deposition targets</span></div>
<div class="line"><a id="l00945" name="l00945"></a><span class="lineno">  945</span>                  dTargetSandToDepositOnThisProfile += dSandToErode;</div>
<div class="line"><a id="l00946" name="l00946"></a><span class="lineno">  946</span>                  dTotSandToDepositAllProfiles += dSandToErode;</div>
<div class="line"><a id="l00947" name="l00947"></a><span class="lineno">  947</span> </div>
<div class="line"><a id="l00948" name="l00948"></a><span class="lineno">  948</span>                  <span class="comment">// LogStream &lt;&lt; m_ulIter &lt;&lt; &quot;: SAND erosion during cliff collapse talus deposition = &quot; &lt;&lt; dSandToErode * m_dCellArea &lt;&lt; endl;</span></div>
<div class="line"><a id="l00949" name="l00949"></a><span class="lineno">  949</span> </div>
<div class="line"><a id="l00950" name="l00950"></a><span class="lineno">  950</span>                  <span class="comment">// Store the depth of sand sediment eroded during Dean profile deposition of sand cliff collapse talus</span></div>
<div class="line"><a id="l00951" name="l00951"></a><span class="lineno">  951</span>                  pPolygon-&gt;<a class="code hl_function" href="../../df/d45/classCGeomCoastPolygon.html#a603f68f67e5c7e649f455ef96eafbe44">AddCliffCollapseSandErodedDeanProfile</a>(dSandToErode);</div>
<div class="line"><a id="l00952" name="l00952"></a><span class="lineno">  952</span>               }</div>
<div class="line"><a id="l00953" name="l00953"></a><span class="lineno">  953</span> </div>
<div class="line"><a id="l00954" name="l00954"></a><span class="lineno">  954</span>               <span class="keywordflow">if</span> (nCoarseWeight)</div>
<div class="line"><a id="l00955" name="l00955"></a><span class="lineno">  955</span>               {</div>
<div class="line"><a id="l00956" name="l00956"></a><span class="lineno">  956</span>                  <span class="comment">// Erode some coarse-sized sediment</span></div>
<div class="line"><a id="l00957" name="l00957"></a><span class="lineno">  957</span>                  <span class="keywordtype">double</span> dCoarseLowering = (<a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a41d2967d84cbcf1799123f3d51aac287">m_dCoarseErodibilityNormalized</a> * dThisLowering) / dTotErodibility;</div>
<div class="line"><a id="l00958" name="l00958"></a><span class="lineno">  958</span> </div>
<div class="line"><a id="l00959" name="l00959"></a><span class="lineno">  959</span>                  <span class="comment">// Make sure we don&#39;t get -ve amounts left on the source cell</span></div>
<div class="line"><a id="l00960" name="l00960"></a><span class="lineno">  960</span>                  <span class="keywordtype">double</span> dCoarseToErode = <a class="code hl_function" href="../../d6/d2a/cme_8h.html#a068017859403c0629d89f8d348f6c224">tMin</a>(dExistingAvailableCoarse, dCoarseLowering);</div>
<div class="line"><a id="l00961" name="l00961"></a><span class="lineno">  961</span>                  <span class="keywordtype">double</span> dRemaining = dExistingAvailableCoarse - dCoarseToErode;</div>
<div class="line"><a id="l00962" name="l00962"></a><span class="lineno">  962</span> </div>
<div class="line"><a id="l00963" name="l00963"></a><span class="lineno">  963</span>                  <span class="comment">// Set the value for this layer</span></div>
<div class="line"><a id="l00964" name="l00964"></a><span class="lineno">  964</span>                  <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[nX][nY].pGetLayerAboveBasement(nTopLayer)-&gt;pGetUnconsolidatedSediment()-&gt;SetCoarseDepth(dRemaining);</div>
<div class="line"><a id="l00965" name="l00965"></a><span class="lineno">  965</span> </div>
<div class="line"><a id="l00966" name="l00966"></a><span class="lineno">  966</span>                  <span class="comment">// Set the changed-this-timestep switch</span></div>
<div class="line"><a id="l00967" name="l00967"></a><span class="lineno">  967</span>                  <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#aa6ebdb3d36ad3cea05ec1446f20cacb8">m_bUnconsChangedThisIter</a>[nTopLayer] = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00968" name="l00968"></a><span class="lineno">  968</span> </div>
<div class="line"><a id="l00969" name="l00969"></a><span class="lineno">  969</span>                  <span class="comment">// And increment the per-timestep total for coarse sediment eroded during cliff collapse deposition</span></div>
<div class="line"><a id="l00970" name="l00970"></a><span class="lineno">  970</span>                  <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#ae67aea0bf8c81af2287aabbfd7d3daa5">m_dThisIterCliffCollapseCoarseErodedDuringDeposition</a> += dCoarseToErode;</div>
<div class="line"><a id="l00971" name="l00971"></a><span class="lineno">  971</span> </div>
<div class="line"><a id="l00972" name="l00972"></a><span class="lineno">  972</span>                  <span class="comment">// Increase the all-profiles and this-profile coarse deposition targets</span></div>
<div class="line"><a id="l00973" name="l00973"></a><span class="lineno">  973</span>                  dTargetCoarseToDepositOnThisProfile += dCoarseToErode;</div>
<div class="line"><a id="l00974" name="l00974"></a><span class="lineno">  974</span>                  dTotCoarseToDepositAllProfiles += dCoarseToErode;</div>
<div class="line"><a id="l00975" name="l00975"></a><span class="lineno">  975</span> </div>
<div class="line"><a id="l00976" name="l00976"></a><span class="lineno">  976</span>                  <span class="comment">// LogStream &lt;&lt; m_ulIter &lt;&lt; &quot;: COARSE erosion during cliff collapse talus deposition = &quot; &lt;&lt; dCoarseToErode * m_dCellArea &lt;&lt; endl;</span></div>
<div class="line"><a id="l00977" name="l00977"></a><span class="lineno">  977</span> </div>
<div class="line"><a id="l00978" name="l00978"></a><span class="lineno">  978</span>                  <span class="comment">// Store the depth of coarse sediment eroded during Dean profile deposition of coarse cliff collapse talus</span></div>
<div class="line"><a id="l00979" name="l00979"></a><span class="lineno">  979</span>                  pPolygon-&gt;<a class="code hl_function" href="../../df/d45/classCGeomCoastPolygon.html#a84699900d390382a991017e2cf88aee9">AddCliffCollapseCoarseErodedDeanProfile</a>(dCoarseToErode);</div>
<div class="line"><a id="l00980" name="l00980"></a><span class="lineno">  980</span>               }</div>
<div class="line"><a id="l00981" name="l00981"></a><span class="lineno">  981</span> </div>
<div class="line"><a id="l00982" name="l00982"></a><span class="lineno">  982</span>               <span class="comment">// for this cell, recalculate the elevation of every layer</span></div>
<div class="line"><a id="l00983" name="l00983"></a><span class="lineno">  983</span>               <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[nX][nY].CalcAllLayerElevsAndD50();</div>
<div class="line"><a id="l00984" name="l00984"></a><span class="lineno">  984</span> </div>
<div class="line"><a id="l00985" name="l00985"></a><span class="lineno">  985</span>               <span class="comment">// And update the cell&#39;s sea depth</span></div>
<div class="line"><a id="l00986" name="l00986"></a><span class="lineno">  986</span>               <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[nX][nY].SetSeaDepth();</div>
<div class="line"><a id="l00987" name="l00987"></a><span class="lineno">  987</span>            }</div>
<div class="line"><a id="l00988" name="l00988"></a><span class="lineno">  988</span>         }     <span class="comment">// All cells in this profile </span></div>
<div class="line"><a id="l00989" name="l00989"></a><span class="lineno">  989</span> </div>
<div class="line"><a id="l00990" name="l00990"></a><span class="lineno">  990</span>         <span class="comment">// OK we have either processed all cells in this profile, or we have deposited enough talus sediment on this profile</span></div>
<div class="line"><a id="l00991" name="l00991"></a><span class="lineno">  991</span>         <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00992" name="l00992"></a><span class="lineno">  992</span>      } </div>
<div class="line"><a id="l00993" name="l00993"></a><span class="lineno">  993</span>      <span class="keywordflow">while</span> (<span class="keyword">true</span>);      <span class="comment">// The seaward offset etc. loop</span></div>
<div class="line"><a id="l00994" name="l00994"></a><span class="lineno">  994</span>      </div>
<div class="line"><a id="l00995" name="l00995"></a><span class="lineno">  995</span>      <span class="comment">// LogStream &lt;&lt; m_ulIter &lt;&lt; &quot;: left seaward offset loop for cliff collapse at [&quot; &lt;&lt; nXCliff &lt;&lt; &quot;][&quot; &lt;&lt; nYCliff &lt;&lt; &quot;] nStartPoint = &quot; &lt;&lt; nStartPoint &lt;&lt; &quot; nThisPoint = &quot; &lt;&lt; nThisPoint &lt;&lt; endl &lt;&lt; &quot;\tnSeawardOffset = &quot; &lt;&lt; nSeawardOffset &lt;&lt; &quot; dCliffHeightFrac = &quot; &lt;&lt; dCliffHeightFrac &lt;&lt; &quot; nAcross = &quot; &lt;&lt; nAcross &lt;&lt; &quot; bJustDepositWhatWeCan = &quot; &lt;&lt; bJustDepositWhatWeCan &lt;&lt; endl &lt;&lt; &quot;\tdTargetSandToDepositOnThisProfile = &quot; &lt;&lt; dTargetSandToDepositOnThisProfile &lt;&lt; &quot; dSandDepositedOnThisProfile = &quot; &lt;&lt; dSandDepositedOnThisProfile &lt;&lt; &quot; dTotSandToDepositAllProfiles = &quot; &lt;&lt; dTotSandToDepositAllProfiles &lt;&lt; &quot; dTotSandDepositedAllProfiles = &quot; &lt;&lt; dTotSandDepositedAllProfiles &lt;&lt; endl &lt;&lt; &quot;\tdTargetCoarseToDepositOnThisProfile = &quot; &lt;&lt; dTargetCoarseToDepositOnThisProfile &lt;&lt; &quot; dCoarseDepositedOnThisProfile = &quot; &lt;&lt; dCoarseDepositedOnThisProfile &lt;&lt; &quot; dTotCoarseToDepositAllProfiles = &quot; &lt;&lt;  dTotCoarseToDepositAllProfiles &lt;&lt; &quot; dTotCoarseDepositedAllProfiles = &quot; &lt;&lt; dTotCoarseDepositedAllProfiles &lt;&lt; endl;</span></div>
<div class="line"><a id="l00996" name="l00996"></a><span class="lineno">  996</span>      </div>
<div class="line"><a id="l00997" name="l00997"></a><span class="lineno">  997</span>      <span class="comment">// Have we deposited enough for this cliff collapse?</span></div>
<div class="line"><a id="l00998" name="l00998"></a><span class="lineno">  998</span>      <span class="keywordflow">if</span> (bDoSandDepositionOnThisProfile)</div>
<div class="line"><a id="l00999" name="l00999"></a><span class="lineno">  999</span>      {</div>
<div class="line"><a id="l01000" name="l01000"></a><span class="lineno"> 1000</span>         <span class="keywordflow">if</span> (<a class="code hl_function" href="../../d6/d2a/cme_8h.html#a61afa8560a3b39c80657661a1d8f76ab">bFPIsEqual</a>(dTotSandToDepositAllProfiles - dTotSandDepositedAllProfiles, 0.0, <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#a7b4b1553585db781ce65707e31294bea">MASS_BALANCE_TOLERANCE</a>))</div>
<div class="line"><a id="l01001" name="l01001"></a><span class="lineno"> 1001</span>            bSandDepositionCompletedOnThisProfile = <span class="keyword">true</span>;</div>
<div class="line"><a id="l01002" name="l01002"></a><span class="lineno"> 1002</span>      }</div>
<div class="line"><a id="l01003" name="l01003"></a><span class="lineno"> 1003</span>      </div>
<div class="line"><a id="l01004" name="l01004"></a><span class="lineno"> 1004</span>      <span class="keywordflow">if</span> (bDoCoarseDepositionOnThisProfile)</div>
<div class="line"><a id="l01005" name="l01005"></a><span class="lineno"> 1005</span>      {</div>
<div class="line"><a id="l01006" name="l01006"></a><span class="lineno"> 1006</span>         <span class="keywordflow">if</span> (<a class="code hl_function" href="../../d6/d2a/cme_8h.html#a61afa8560a3b39c80657661a1d8f76ab">bFPIsEqual</a>(dTotCoarseToDepositAllProfiles - dTotCoarseDepositedAllProfiles, 0.0, <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#a7b4b1553585db781ce65707e31294bea">MASS_BALANCE_TOLERANCE</a>))</div>
<div class="line"><a id="l01007" name="l01007"></a><span class="lineno"> 1007</span>            bCoarseDepositionCompletedOnThisProfile = <span class="keyword">true</span>;</div>
<div class="line"><a id="l01008" name="l01008"></a><span class="lineno"> 1008</span>      }</div>
<div class="line"><a id="l01009" name="l01009"></a><span class="lineno"> 1009</span>      </div>
<div class="line"><a id="l01010" name="l01010"></a><span class="lineno"> 1010</span>      <span class="keywordflow">if</span> (bSandDepositionCompletedOnThisProfile &amp;&amp; bCoarseDepositionCompletedOnThisProfile)</div>
<div class="line"><a id="l01011" name="l01011"></a><span class="lineno"> 1011</span>      {</div>
<div class="line"><a id="l01012" name="l01012"></a><span class="lineno"> 1012</span>         <span class="comment">// LogStream &lt;&lt; m_ulIter &lt;&lt; &quot;: bSandDepositionCompletedOnThisProfile &amp;&amp; bCoarseDepositionCompletedOnThisProfile for cliff collapse at [&quot; &lt;&lt; nXCliff &lt;&lt; &quot;][&quot; &lt;&lt; nYCliff &lt;&lt; &quot;] nStartPoint = &quot; &lt;&lt; nStartPoint &lt;&lt; &quot; nThisPoint = &quot; &lt;&lt; nThisPoint &lt;&lt; endl &lt;&lt; &quot;\tnbJustDepositWhatWeCan = &quot; &lt;&lt; bJustDepositWhatWeCan &lt;&lt; &quot; SeawardOffset = &quot; &lt;&lt; nSeawardOffset &lt;&lt; &quot; dCliffHeightFrac = &quot; &lt;&lt; dCliffHeightFrac &lt;&lt; &quot; nAcross = &quot; &lt;&lt; nAcross &lt;&lt; endl &lt;&lt; &quot;\tdTargetSandToDepositOnThisProfile = &quot; &lt;&lt; dTargetSandToDepositOnThisProfile &lt;&lt; &quot; dSandDepositedOnThisProfile = &quot; &lt;&lt; dSandDepositedOnThisProfile &lt;&lt; &quot; dTotSandToDepositAllProfiles = &quot; &lt;&lt; dTotSandToDepositAllProfiles &lt;&lt; &quot; dTotSandDepositedAllProfiles = &quot; &lt;&lt; dTotSandDepositedAllProfiles &lt;&lt; endl &lt;&lt; &quot;\tdTargetCoarseToDepositOnThisProfile = &quot; &lt;&lt; dTargetCoarseToDepositOnThisProfile &lt;&lt; &quot; dCoarseDepositedOnThisProfile = &quot; &lt;&lt; dCoarseDepositedOnThisProfile &lt;&lt; &quot; dTotCoarseToDepositAllProfiles = &quot; &lt;&lt;  dTotCoarseToDepositAllProfiles &lt;&lt; &quot; dTotCoarseDepositedAllProfiles = &quot; &lt;&lt; dTotCoarseDepositedAllProfiles &lt;&lt; endl;</span></div>
<div class="line"><a id="l01013" name="l01013"></a><span class="lineno"> 1013</span>      }      </div>
<div class="line"><a id="l01014" name="l01014"></a><span class="lineno"> 1014</span>   }     <span class="comment">// Process each deposition profile</span></div>
<div class="line"><a id="l01015" name="l01015"></a><span class="lineno"> 1015</span> </div>
<div class="line"><a id="l01016" name="l01016"></a><span class="lineno"> 1016</span>   <span class="comment">// Safety check for sand sediment</span></div>
<div class="line"><a id="l01017" name="l01017"></a><span class="lineno"> 1017</span>   <span class="keywordflow">if</span> (! <a class="code hl_function" href="../../d6/d2a/cme_8h.html#a61afa8560a3b39c80657661a1d8f76ab">bFPIsEqual</a>((dTotSandToDepositAllProfiles - dTotSandDepositedAllProfiles), 0.0, <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#a7b4b1553585db781ce65707e31294bea">MASS_BALANCE_TOLERANCE</a>))</div>
<div class="line"><a id="l01018" name="l01018"></a><span class="lineno"> 1018</span>      <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a222962121613613a48f518e0c2110f21">LogStream</a> &lt;&lt; <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#a292fc90846543ca4814daa9f759feb05">ERR</a> &lt;&lt; <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#ad67e8c5b30a0572f64ecfb5c062c2edc">m_ulIter</a> &lt;&lt; <span class="stringliteral">&quot;: non-zero dTotSandToDepositAllProfiles = &quot;</span> &lt;&lt; dTotSandToDepositAllProfiles &lt;&lt; endl;</div>
<div class="line"><a id="l01019" name="l01019"></a><span class="lineno"> 1019</span> </div>
<div class="line"><a id="l01020" name="l01020"></a><span class="lineno"> 1020</span>   <span class="comment">// Ditto for coarse sediment</span></div>
<div class="line"><a id="l01021" name="l01021"></a><span class="lineno"> 1021</span>   <span class="keywordflow">if</span> (! <a class="code hl_function" href="../../d6/d2a/cme_8h.html#a61afa8560a3b39c80657661a1d8f76ab">bFPIsEqual</a>((dTotCoarseToDepositAllProfiles - dTotCoarseDepositedAllProfiles), 0.0, <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#a7b4b1553585db781ce65707e31294bea">MASS_BALANCE_TOLERANCE</a>))</div>
<div class="line"><a id="l01022" name="l01022"></a><span class="lineno"> 1022</span>      <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a222962121613613a48f518e0c2110f21">LogStream</a> &lt;&lt; <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#a292fc90846543ca4814daa9f759feb05">ERR</a> &lt;&lt; <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#ad67e8c5b30a0572f64ecfb5c062c2edc">m_ulIter</a> &lt;&lt; <span class="stringliteral">&quot;: non-zero dTotCoarseToDepositAllProfiles = &quot;</span> &lt;&lt; dTotCoarseToDepositAllProfiles &lt;&lt; endl;</div>
<div class="line"><a id="l01023" name="l01023"></a><span class="lineno"> 1023</span> </div>
<div class="line"><a id="l01024" name="l01024"></a><span class="lineno"> 1024</span>   <span class="comment">// Store the total depths of cliff collapse deposition for this polygon</span></div>
<div class="line"><a id="l01025" name="l01025"></a><span class="lineno"> 1025</span>   pPolygon-&gt;<a class="code hl_function" href="../../df/d45/classCGeomCoastPolygon.html#a40a001b722ed87718c1d1c000ff452cd">AddCliffCollapseUnconsSandDeposition</a>(dTotSandDepositedAllProfiles);</div>
<div class="line"><a id="l01026" name="l01026"></a><span class="lineno"> 1026</span>   pPolygon-&gt;<a class="code hl_function" href="../../df/d45/classCGeomCoastPolygon.html#a07e9ea4d7d48c310476893d6f45a9dec">AddCliffCollapseUnconsCoarseDeposition</a>(dTotCoarseDepositedAllProfiles);</div>
<div class="line"><a id="l01027" name="l01027"></a><span class="lineno"> 1027</span>   </div>
<div class="line"><a id="l01028" name="l01028"></a><span class="lineno"> 1028</span>   <span class="comment">// Increment this-timestep totals for cliff collapse deposition</span></div>
<div class="line"><a id="l01029" name="l01029"></a><span class="lineno"> 1029</span>   <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a90adbbfff9b8ce4f40ce6010657b375b">m_dThisIterUnconsSandCliffDeposition</a> += dTotSandDepositedAllProfiles;</div>
<div class="line"><a id="l01030" name="l01030"></a><span class="lineno"> 1030</span>   <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a89aac08d3cfa2f5f5793b3ca6400e868">m_dThisIterUnconsCoarseCliffDeposition</a> += dTotCoarseDepositedAllProfiles;</div>
<div class="line"><a id="l01031" name="l01031"></a><span class="lineno"> 1031</span> </div>
<div class="line"><a id="l01032" name="l01032"></a><span class="lineno"> 1032</span>   <span class="comment">// LogStream &lt;&lt; endl;</span></div>
<div class="line"><a id="l01033" name="l01033"></a><span class="lineno"> 1033</span>   <span class="comment">// LogStream &lt;&lt; &quot;\tdTotSandToDepositAllProfiles = &quot; &lt;&lt; dTotSandToDepositAllProfiles &lt;&lt; &quot; dTotSandDepositedAllProfiles = &quot; &lt;&lt; dTotSandDepositedAllProfiles &lt;&lt; endl;</span></div>
<div class="line"><a id="l01034" name="l01034"></a><span class="lineno"> 1034</span>   <span class="comment">// LogStream &lt;&lt; &quot;\tdTotCoarseToDepositAllProfiles = &quot; &lt;&lt; dTotCoarseToDepositAllProfiles &lt;&lt; &quot; dTotCoarseDepositedAllProfiles = &quot; &lt;&lt; dTotCoarseDepositedAllProfiles &lt;&lt; endl;</span></div>
<div class="line"><a id="l01035" name="l01035"></a><span class="lineno"> 1035</span>   <span class="comment">// LogStream &lt;&lt; endl &lt;&lt; &quot;****************************************&quot; &lt;&lt; endl &lt;&lt; endl;</span></div>
<div class="line"><a id="l01036" name="l01036"></a><span class="lineno"> 1036</span> </div>
<div class="line"><a id="l01037" name="l01037"></a><span class="lineno"> 1037</span>   <span class="keywordflow">return</span> <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#aa768cb14b5c6123ee95e6e4ebd9fe331">RTN_OK</a>;</div>
<div class="line"><a id="l01038" name="l01038"></a><span class="lineno"> 1038</span>}</div>
</div>
<div class="line"><a id="l01039" name="l01039"></a><span class="lineno"> 1039</span> </div>
<div class="line"><a id="l01040" name="l01040"></a><span class="lineno"> 1040</span><span class="comment">//===============================================================================================================================</span></div>
<div class="line"><a id="l01042" name="l01042"></a><span class="lineno"> 1042</span><span class="comment">//===============================================================================================================================</span></div>
<div class="foldopen" id="foldopen01043" data-start="{" data-end="}">
<div class="line"><a id="l01043" name="l01043"></a><span class="lineno"><a class="line" href="../../d1/d98/classCSimulation.html#a185287a9d4c6dafaef17e0938c018c3e"> 1043</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="../../d1/d98/classCSimulation.html#a185287a9d4c6dafaef17e0938c018c3e">CSimulation::RasterizeCliffCollapseProfile</a>(vector&lt;CGeom2DPoint&gt; <span class="keyword">const</span>* pVPointsIn, vector&lt;CGeom2DIPoint&gt;* pVIPointsOut)<span class="keyword"> const</span></div>
<div class="line"><a id="l01044" name="l01044"></a><span class="lineno"> 1044</span><span class="keyword"></span>{</div>
<div class="line"><a id="l01045" name="l01045"></a><span class="lineno"> 1045</span>   pVIPointsOut-&gt;clear();</div>
<div class="line"><a id="l01046" name="l01046"></a><span class="lineno"> 1046</span> </div>
<div class="line"><a id="l01047" name="l01047"></a><span class="lineno"> 1047</span>   <span class="comment">// The start point of the normal is the centroid of a coastline cell. Convert from the external CRS to grid CRS</span></div>
<div class="line"><a id="l01048" name="l01048"></a><span class="lineno"> 1048</span>   <span class="keywordtype">double</span> dXStart = <a class="code hl_function" href="../../d1/d98/classCSimulation.html#a9fbe52d4e0f26ad432f12b7154c599e4">dExtCRSXToGridX</a>(pVPointsIn-&gt;at(0).dGetX());</div>
<div class="line"><a id="l01049" name="l01049"></a><span class="lineno"> 1049</span>   <span class="keywordtype">double</span> dYStart = <a class="code hl_function" href="../../d1/d98/classCSimulation.html#ac2e7e204d9e9b527d0a4c941f2e525ad">dExtCRSYToGridY</a>(pVPointsIn-&gt;at(0).dGetY());</div>
<div class="line"><a id="l01050" name="l01050"></a><span class="lineno"> 1050</span> </div>
<div class="line"><a id="l01051" name="l01051"></a><span class="lineno"> 1051</span>   <span class="comment">// The end point of the normal, again convert from the external CRS to grid CRS. Note too that it could be off the grid</span></div>
<div class="line"><a id="l01052" name="l01052"></a><span class="lineno"> 1052</span>   <span class="keywordtype">double</span> dXEnd = <a class="code hl_function" href="../../d1/d98/classCSimulation.html#a9fbe52d4e0f26ad432f12b7154c599e4">dExtCRSXToGridX</a>(pVPointsIn-&gt;at(1).dGetX());</div>
<div class="line"><a id="l01053" name="l01053"></a><span class="lineno"> 1053</span>   <span class="keywordtype">double</span> dYEnd = <a class="code hl_function" href="../../d1/d98/classCSimulation.html#ac2e7e204d9e9b527d0a4c941f2e525ad">dExtCRSYToGridY</a>(pVPointsIn-&gt;at(1).dGetY());</div>
<div class="line"><a id="l01054" name="l01054"></a><span class="lineno"> 1054</span> </div>
<div class="line"><a id="l01055" name="l01055"></a><span class="lineno"> 1055</span>   <span class="comment">// Interpolate between cells by a simple DDA line algorithm, see http://en.wikipedia.org/wiki/Digital_differential_analyzer_(graphics_algorithm) Note that Bresenham&#39;s algorithm gave occasional gaps</span></div>
<div class="line"><a id="l01056" name="l01056"></a><span class="lineno"> 1056</span>   <span class="keywordtype">double</span> dXInc = dXEnd - dXStart;</div>
<div class="line"><a id="l01057" name="l01057"></a><span class="lineno"> 1057</span>   <span class="keywordtype">double</span> dYInc = dYEnd - dYStart;</div>
<div class="line"><a id="l01058" name="l01058"></a><span class="lineno"> 1058</span>   <span class="keywordtype">double</span> dLength = <a class="code hl_function" href="../../d6/d2a/cme_8h.html#a7e895b460cef877dec4d12ead0c74f15">tMax</a>(<a class="code hl_function" href="../../d6/d2a/cme_8h.html#ae3b6dc50cfc97050529faa5e0bd66136">tAbs</a>(dXInc), <a class="code hl_function" href="../../d6/d2a/cme_8h.html#ae3b6dc50cfc97050529faa5e0bd66136">tAbs</a>(dYInc));</div>
<div class="line"><a id="l01059" name="l01059"></a><span class="lineno"> 1059</span> </div>
<div class="line"><a id="l01060" name="l01060"></a><span class="lineno"> 1060</span>   dXInc /= dLength;</div>
<div class="line"><a id="l01061" name="l01061"></a><span class="lineno"> 1061</span>   dYInc /= dLength;</div>
<div class="line"><a id="l01062" name="l01062"></a><span class="lineno"> 1062</span> </div>
<div class="line"><a id="l01063" name="l01063"></a><span class="lineno"> 1063</span>   <span class="keywordtype">double</span> dX = dXStart;</div>
<div class="line"><a id="l01064" name="l01064"></a><span class="lineno"> 1064</span>   <span class="keywordtype">double</span> dY = dYStart;</div>
<div class="line"><a id="l01065" name="l01065"></a><span class="lineno"> 1065</span> </div>
<div class="line"><a id="l01066" name="l01066"></a><span class="lineno"> 1066</span>   <span class="comment">// Process each interpolated point</span></div>
<div class="line"><a id="l01067" name="l01067"></a><span class="lineno"> 1067</span>   <span class="keywordtype">int</span> nLength = <a class="code hl_function" href="../../d2/dfd/utils__global_8cpp.html#a20842d0a19d0ca952c91f3e1eb175fee">nRound</a>(dLength);</div>
<div class="line"><a id="l01068" name="l01068"></a><span class="lineno"> 1068</span>   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> m = 0; m &lt;= nLength; m++)</div>
<div class="line"><a id="l01069" name="l01069"></a><span class="lineno"> 1069</span>   {</div>
<div class="line"><a id="l01070" name="l01070"></a><span class="lineno"> 1070</span>      <span class="keywordtype">int</span> nX = <a class="code hl_function" href="../../d2/dfd/utils__global_8cpp.html#a20842d0a19d0ca952c91f3e1eb175fee">nRound</a>(dX);</div>
<div class="line"><a id="l01071" name="l01071"></a><span class="lineno"> 1071</span>      <span class="keywordtype">int</span> nY = <a class="code hl_function" href="../../d2/dfd/utils__global_8cpp.html#a20842d0a19d0ca952c91f3e1eb175fee">nRound</a>(dY);</div>
<div class="line"><a id="l01072" name="l01072"></a><span class="lineno"> 1072</span> </div>
<div class="line"><a id="l01073" name="l01073"></a><span class="lineno"> 1073</span>      <span class="comment">// Make sure the interpolated point is within the raster grid (can get this kind of problem due to rounding)</span></div>
<div class="line"><a id="l01074" name="l01074"></a><span class="lineno"> 1074</span>      <span class="keywordflow">if</span> (! <a class="code hl_function" href="../../d1/d98/classCSimulation.html#ac900a5701df97da22278fae928951f50">bIsWithinValidGrid</a>(nX, nY))</div>
<div class="line"><a id="l01075" name="l01075"></a><span class="lineno"> 1075</span>         <a class="code hl_function" href="../../d1/d98/classCSimulation.html#aa0eddb8270d03b9c1a0a6e96254ebfed">KeepWithinValidGrid</a>(<a class="code hl_function" href="../../d2/dfd/utils__global_8cpp.html#a20842d0a19d0ca952c91f3e1eb175fee">nRound</a>(dXStart), <a class="code hl_function" href="../../d2/dfd/utils__global_8cpp.html#a20842d0a19d0ca952c91f3e1eb175fee">nRound</a>(dYStart), nX, nY);</div>
<div class="line"><a id="l01076" name="l01076"></a><span class="lineno"> 1076</span> </div>
<div class="line"><a id="l01077" name="l01077"></a><span class="lineno"> 1077</span>      <span class="comment">// This point is fine, so append it to the output vector</span></div>
<div class="line"><a id="l01078" name="l01078"></a><span class="lineno"> 1078</span>      pVIPointsOut-&gt;push_back(<a class="code hl_class" href="../../d6/d0d/classCGeom2DIPoint.html">CGeom2DIPoint</a>(nX, nY)); <span class="comment">// In raster grid coordinates</span></div>
<div class="line"><a id="l01079" name="l01079"></a><span class="lineno"> 1079</span> </div>
<div class="line"><a id="l01080" name="l01080"></a><span class="lineno"> 1080</span>      <span class="comment">// And increment for next time</span></div>
<div class="line"><a id="l01081" name="l01081"></a><span class="lineno"> 1081</span>      dX += dXInc;</div>
<div class="line"><a id="l01082" name="l01082"></a><span class="lineno"> 1082</span>      dY += dYInc;</div>
<div class="line"><a id="l01083" name="l01083"></a><span class="lineno"> 1083</span>   }</div>
<div class="line"><a id="l01084" name="l01084"></a><span class="lineno"> 1084</span>}</div>
</div>
<div class="ttc" id="aclassCACoastLandform_html"><div class="ttname"><a href="../../d2/de0/classCACoastLandform.html">CACoastLandform</a></div><div class="ttdoc">Abstract class, used as a base class for landform objects on the coastline.</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d6c/coast__landform_8h_source.html#l00034">coast_landform.h:35</a></div></div>
<div class="ttc" id="aclassCACoastLandform_html_a6a0284350c5965932c7cc74156ceadec"><div class="ttname"><a href="../../d2/de0/classCACoastLandform.html#a6a0284350c5965932c7cc74156ceadec">CACoastLandform::nGetPointOnCoast</a></div><div class="ttdeci">int nGetPointOnCoast(void) const</div><div class="ttdoc">Get the point on the coast on which this coast landform sits.</div><div class="ttdef"><b>Definition</b> <a href="../../de/dc3/coast__landform_8cpp_source.html#l00049">coast_landform.cpp:49</a></div></div>
<div class="ttc" id="aclassCACoastLandform_html_ac161cb56a83d653b651aa08173a1f1ca"><div class="ttname"><a href="../../d2/de0/classCACoastLandform.html#ac161cb56a83d653b651aa08173a1f1ca">CACoastLandform::nGetLandFormCategory</a></div><div class="ttdeci">int nGetLandFormCategory(void) const</div><div class="ttdoc">Get the landform category.</div><div class="ttdef"><b>Definition</b> <a href="../../de/dc3/coast__landform_8cpp_source.html#l00060">coast_landform.cpp:60</a></div></div>
<div class="ttc" id="aclassCACoastLandform_html_ac850dc100a259660040b3b29c86a5057"><div class="ttname"><a href="../../d2/de0/classCACoastLandform.html#ac850dc100a259660040b3b29c86a5057">CACoastLandform::IncTotAccumWaveEnergy</a></div><div class="ttdeci">void IncTotAccumWaveEnergy(double const)</div><div class="ttdoc">Increment total accumulated wave energy.</div><div class="ttdef"><b>Definition</b> <a href="../../de/dc3/coast__landform_8cpp_source.html#l00077">coast_landform.cpp:77</a></div></div>
<div class="ttc" id="aclassCACoastLandform_html_afd4b936869e33c47d2a741ff6404abf3"><div class="ttname"><a href="../../d2/de0/classCACoastLandform.html#afd4b936869e33c47d2a741ff6404abf3">CACoastLandform::pPtiGetCellMarkedAsLF</a></div><div class="ttdeci">CGeom2DIPoint * pPtiGetCellMarkedAsLF(void) const</div><div class="ttdoc">Get the grid coordinates of the cell on which this coast landform sits.</div><div class="ttdef"><b>Definition</b> <a href="../../de/dc3/coast__landform_8cpp_source.html#l00066">coast_landform.cpp:66</a></div></div>
<div class="ttc" id="aclassCGeom2DIPoint_html"><div class="ttname"><a href="../../d6/d0d/classCGeom2DIPoint.html">CGeom2DIPoint</a></div><div class="ttdoc">Geometry class used to represent 2D point objects with integer coordinates.</div><div class="ttdef"><b>Definition</b> <a href="../../d2/d66/2di__point_8h_source.html#l00028">2di_point.h:29</a></div></div>
<div class="ttc" id="aclassCGeom2DIPoint_html_a4d9c20bcca90dcb9d519b664aba09cbd"><div class="ttname"><a href="../../d6/d0d/classCGeom2DIPoint.html#a4d9c20bcca90dcb9d519b664aba09cbd">CGeom2DIPoint::nGetY</a></div><div class="ttdeci">int nGetY(void) const</div><div class="ttdoc">Returns the CGeom2DIPoint object&#39;s integer Y coordinate.</div><div class="ttdef"><b>Definition</b> <a href="../../d8/dc5/2di__point_8cpp_source.html#l00048">2di_point.cpp:48</a></div></div>
<div class="ttc" id="aclassCGeom2DIPoint_html_af84c687b2d0be01ab41cbcc0565f4f3f"><div class="ttname"><a href="../../d6/d0d/classCGeom2DIPoint.html#af84c687b2d0be01ab41cbcc0565f4f3f">CGeom2DIPoint::nGetX</a></div><div class="ttdeci">int nGetX(void) const</div><div class="ttdoc">Returns the CGeom2DIPoint object&#39;s integer X coordinate.</div><div class="ttdef"><b>Definition</b> <a href="../../d8/dc5/2di__point_8cpp_source.html#l00042">2di_point.cpp:42</a></div></div>
<div class="ttc" id="aclassCGeom2DPoint_html"><div class="ttname"><a href="../../d5/d4e/classCGeom2DPoint.html">CGeom2DPoint</a></div><div class="ttdoc">Geometry class used to represent 2D point objects with floating-point coordinates.</div><div class="ttdef"><b>Definition</b> <a href="../../d0/dee/2d__point_8h_source.html#l00026">2d_point.h:27</a></div></div>
<div class="ttc" id="aclassCGeom2DPoint_html_a1dff4e8adee61e6fe5c5062d6ba88f01"><div class="ttname"><a href="../../d5/d4e/classCGeom2DPoint.html#a1dff4e8adee61e6fe5c5062d6ba88f01">CGeom2DPoint::SetY</a></div><div class="ttdeci">void SetY(double const)</div><div class="ttdoc">The double parameter sets a value for the CGeom2DIPoint object&#39;s Y coordinate.</div><div class="ttdef"><b>Definition</b> <a href="../../d2/d81/2d__point_8cpp_source.html#l00058">2d_point.cpp:58</a></div></div>
<div class="ttc" id="aclassCGeom2DPoint_html_af5dfdef4b78c0703800049b064483278"><div class="ttname"><a href="../../d5/d4e/classCGeom2DPoint.html#af5dfdef4b78c0703800049b064483278">CGeom2DPoint::SetX</a></div><div class="ttdeci">void SetX(double const)</div><div class="ttdoc">The double parameter sets a value for the CGeom2DIPoint object&#39;s X coordinate.</div><div class="ttdef"><b>Definition</b> <a href="../../d2/d81/2d__point_8cpp_source.html#l00052">2d_point.cpp:52</a></div></div>
<div class="ttc" id="aclassCGeomCoastPolygon_html"><div class="ttname"><a href="../../df/d45/classCGeomCoastPolygon.html">CGeomCoastPolygon</a></div><div class="ttdoc">Geometry class used for coast polygon objects.</div><div class="ttdef"><b>Definition</b> <a href="../../d6/db2/coast__polygon_8h_source.html#l00030">coast_polygon.h:31</a></div></div>
<div class="ttc" id="aclassCGeomCoastPolygon_html_a07e9ea4d7d48c310476893d6f45a9dec"><div class="ttname"><a href="../../df/d45/classCGeomCoastPolygon.html#a07e9ea4d7d48c310476893d6f45a9dec">CGeomCoastPolygon::AddCliffCollapseUnconsCoarseDeposition</a></div><div class="ttdeci">void AddCliffCollapseUnconsCoarseDeposition(double const)</div><div class="ttdoc">Add to the this-iteration total of unconsolidated coarse sediment deposited from cliff collapse on th...</div><div class="ttdef"><b>Definition</b> <a href="../../df/d30/coast__polygon_8cpp_source.html#l00572">coast_polygon.cpp:572</a></div></div>
<div class="ttc" id="aclassCGeomCoastPolygon_html_a0fd90dff4fa857f2012826e2fb1977c5"><div class="ttname"><a href="../../df/d45/classCGeomCoastPolygon.html#a0fd90dff4fa857f2012826e2fb1977c5">CGeomCoastPolygon::AddCliffCollapseToSuspensionFine</a></div><div class="ttdeci">void AddCliffCollapseToSuspensionFine(double const)</div><div class="ttdoc">Add to the this-iteration total of unconsolidated fine sediment from cliff collapse which goes to sus...</div><div class="ttdef"><b>Definition</b> <a href="../../df/d30/coast__polygon_8cpp_source.html#l00512">coast_polygon.cpp:512</a></div></div>
<div class="ttc" id="aclassCGeomCoastPolygon_html_a40a001b722ed87718c1d1c000ff452cd"><div class="ttname"><a href="../../df/d45/classCGeomCoastPolygon.html#a40a001b722ed87718c1d1c000ff452cd">CGeomCoastPolygon::AddCliffCollapseUnconsSandDeposition</a></div><div class="ttdeci">void AddCliffCollapseUnconsSandDeposition(double const)</div><div class="ttdoc">Add to the this-iteration total of unconsolidated sand sediment deposited from cliff collapse on this...</div><div class="ttdef"><b>Definition</b> <a href="../../df/d30/coast__polygon_8cpp_source.html#l00560">coast_polygon.cpp:560</a></div></div>
<div class="ttc" id="aclassCGeomCoastPolygon_html_a49edc7f56745b394ca3090eee2ec73b7"><div class="ttname"><a href="../../df/d45/classCGeomCoastPolygon.html#a49edc7f56745b394ca3090eee2ec73b7">CGeomCoastPolygon::AddCliffCollapseErosionCoarse</a></div><div class="ttdeci">void AddCliffCollapseErosionCoarse(double const)</div><div class="ttdoc">Add to the this-iteration total of unconsolidated coarse sediment from cliff collapse on this polygon...</div><div class="ttdef"><b>Definition</b> <a href="../../df/d30/coast__polygon_8cpp_source.html#l00548">coast_polygon.cpp:548</a></div></div>
<div class="ttc" id="aclassCGeomCoastPolygon_html_a603f68f67e5c7e649f455ef96eafbe44"><div class="ttname"><a href="../../df/d45/classCGeomCoastPolygon.html#a603f68f67e5c7e649f455ef96eafbe44">CGeomCoastPolygon::AddCliffCollapseSandErodedDeanProfile</a></div><div class="ttdeci">void AddCliffCollapseSandErodedDeanProfile(double const)</div><div class="ttdoc">Add to the this-iteration total of unconsolidated sand sediment eroded during deposition of cliff col...</div><div class="ttdef"><b>Definition</b> <a href="../../df/d30/coast__polygon_8cpp_source.html#l00584">coast_polygon.cpp:584</a></div></div>
<div class="ttc" id="aclassCGeomCoastPolygon_html_a7adb4ed4f436b869cd05f1b8c66e08de"><div class="ttname"><a href="../../df/d45/classCGeomCoastPolygon.html#a7adb4ed4f436b869cd05f1b8c66e08de">CGeomCoastPolygon::AddCliffCollapseErosionFine</a></div><div class="ttdeci">void AddCliffCollapseErosionFine(double const)</div><div class="ttdoc">Add to the this-iteration total of unconsolidated fine sediment eroded from cliff collapse on this po...</div><div class="ttdef"><b>Definition</b> <a href="../../df/d30/coast__polygon_8cpp_source.html#l00524">coast_polygon.cpp:524</a></div></div>
<div class="ttc" id="aclassCGeomCoastPolygon_html_a84699900d390382a991017e2cf88aee9"><div class="ttname"><a href="../../df/d45/classCGeomCoastPolygon.html#a84699900d390382a991017e2cf88aee9">CGeomCoastPolygon::AddCliffCollapseCoarseErodedDeanProfile</a></div><div class="ttdeci">void AddCliffCollapseCoarseErodedDeanProfile(double const)</div><div class="ttdoc">Add to the this-iteration total of unconsolidated coarse sediment eroded during deposition of cliff c...</div><div class="ttdef"><b>Definition</b> <a href="../../df/d30/coast__polygon_8cpp_source.html#l00596">coast_polygon.cpp:596</a></div></div>
<div class="ttc" id="aclassCGeomCoastPolygon_html_ace19eeda9ceb7f1d729cbfad37148237"><div class="ttname"><a href="../../df/d45/classCGeomCoastPolygon.html#ace19eeda9ceb7f1d729cbfad37148237">CGeomCoastPolygon::AddCliffCollapseErosionSand</a></div><div class="ttdeci">void AddCliffCollapseErosionSand(double const)</div><div class="ttdoc">Add to the this-iteration total of unconsolidated sand sediment from cliff collapse on this polygon,...</div><div class="ttdef"><b>Definition</b> <a href="../../df/d30/coast__polygon_8cpp_source.html#l00536">coast_polygon.cpp:536</a></div></div>
<div class="ttc" id="aclassCRWCellLandform_html"><div class="ttname"><a href="../../dc/d4a/classCRWCellLandform.html">CRWCellLandform</a></div><div class="ttdoc">Real-world class used to represent the landform of a cell.</div><div class="ttdef"><b>Definition</b> <a href="../../df/d51/cell__landform_8h_source.html#l00028">cell_landform.h:29</a></div></div>
<div class="ttc" id="aclassCRWCellLandform_html_a5350a7ac48d1eef3a78bef9bcf041b45"><div class="ttname"><a href="../../dc/d4a/classCRWCellLandform.html#a5350a7ac48d1eef3a78bef9bcf041b45">CRWCellLandform::nGetLFCategory</a></div><div class="ttdeci">int nGetLFCategory(void) const</div><div class="ttdoc">Get the landform category.</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d02/cell__landform_8cpp_source.html#l00049">cell_landform.cpp:49</a></div></div>
<div class="ttc" id="aclassCRWCellLandform_html_af53d3fe69c297cfb0b41d03e55ed6467"><div class="ttname"><a href="../../dc/d4a/classCRWCellLandform.html#af53d3fe69c297cfb0b41d03e55ed6467">CRWCellLandform::SetLFSubCategory</a></div><div class="ttdeci">void SetLFSubCategory(int const)</div><div class="ttdoc">Set the both the landform sub-category, and the landform category.</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d02/cell__landform_8cpp_source.html#l00055">cell_landform.cpp:55</a></div></div>
<div class="ttc" id="aclassCRWCliff_html"><div class="ttname"><a href="../../d9/d8b/classCRWCliff.html">CRWCliff</a></div><div class="ttdoc">Real-world class used to represent the &#39;cliff&#39; category of coastal landform object.</div><div class="ttdef"><b>Definition</b> <a href="../../db/df0/cliff_8h_source.html#l00032">cliff.h:33</a></div></div>
<div class="ttc" id="aclassCRWCliff_html_a230895c26a89fb53f0160d59e156137c"><div class="ttname"><a href="../../d9/d8b/classCRWCliff.html#a230895c26a89fb53f0160d59e156137c">CRWCliff::bReadyToCollapse</a></div><div class="ttdeci">bool bReadyToCollapse(double const) const</div><div class="ttdoc">Returns true if the horizontal depth of the erosional notch exceeds the critical notch overhang.</div><div class="ttdef"><b>Definition</b> <a href="../../d4/d3f/cliff_8cpp_source.html#l00100">cliff.cpp:100</a></div></div>
<div class="ttc" id="aclassCRWCliff_html_a6ded2d94f7a674e8a6d8315e5f301a6f"><div class="ttname"><a href="../../d9/d8b/classCRWCliff.html#a6ded2d94f7a674e8a6d8315e5f301a6f">CRWCliff::DeepenErosionalNotch</a></div><div class="ttdeci">void DeepenErosionalNotch(double const)</div><div class="ttdoc">Increases the XY-plane length (in external CRS units) of the erosional notch, measured inland from th...</div><div class="ttdef"><b>Definition</b> <a href="../../d4/d3f/cliff_8cpp_source.html#l00109">cliff.cpp:109</a></div></div>
<div class="ttc" id="aclassCRWCliff_html_a70151d708b933a25eb7836d63cea7f8b"><div class="ttname"><a href="../../d9/d8b/classCRWCliff.html#a70151d708b933a25eb7836d63cea7f8b">CRWCliff::dGetNotchBaseElev</a></div><div class="ttdeci">double dGetNotchBaseElev(void) const</div><div class="ttdoc">Returns the elevation of the base of the erosional notch.</div><div class="ttdef"><b>Definition</b> <a href="../../d4/d3f/cliff_8cpp_source.html#l00070">cliff.cpp:70</a></div></div>
<div class="ttc" id="aclassCRWCliff_html_a73acc82455562b794d027455c1b8c3d5"><div class="ttname"><a href="../../d9/d8b/classCRWCliff.html#a73acc82455562b794d027455c1b8c3d5">CRWCliff::SetNotchBaseElev</a></div><div class="ttdeci">void SetNotchBaseElev(double const)</div><div class="ttdoc">Sets the elevation of the base of the erosional notch.</div><div class="ttdef"><b>Definition</b> <a href="../../d4/d3f/cliff_8cpp_source.html#l00076">cliff.cpp:76</a></div></div>
<div class="ttc" id="aclassCRWCliff_html_ab7084345058193f7084d7fcaecb9ea1b"><div class="ttname"><a href="../../d9/d8b/classCRWCliff.html#ab7084345058193f7084d7fcaecb9ea1b">CRWCliff::SetCliffCollapsed</a></div><div class="ttdeci">void SetCliffCollapsed(void)</div><div class="ttdoc">Flags the cliff as having collapsed.</div><div class="ttdef"><b>Definition</b> <a href="../../d4/d3f/cliff_8cpp_source.html#l00064">cliff.cpp:64</a></div></div>
<div class="ttc" id="aclassCSimulation_html_a010ac62ee6bbb82fd71f9b2c5e3f2172"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#a010ac62ee6bbb82fd71f9b2c5e3f2172">CSimulation::m_dCliffDepositionPlanviewWidth</a></div><div class="ttdeci">double m_dCliffDepositionPlanviewWidth</div><div class="ttdoc">Planview width of cliff collapse talus (m)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d6a/simulation_8h_source.html#l00869">simulation.h:869</a></div></div>
<div class="ttc" id="aclassCSimulation_html_a0245d3cbdd603fbeced6ca1465eb3f16"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#a0245d3cbdd603fbeced6ca1465eb3f16">CSimulation::m_nLogFileDetail</a></div><div class="ttdeci">int m_nLogFileDetail</div><div class="ttdoc">The level of detail in the log file output. Can be LOG_FILE_LOW_DETAIL, LOG_FILE_MIDDLE_DETAIL,...</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d6a/simulation_8h_source.html#l00528">simulation.h:528</a></div></div>
<div class="ttc" id="aclassCSimulation_html_a0dae0444cb7c9f54e4109cfaa054f6fc"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#a0dae0444cb7c9f54e4109cfaa054f6fc">CSimulation::m_dNotchDepthAtCollapse</a></div><div class="ttdeci">double m_dNotchDepthAtCollapse</div><div class="ttdoc">Notch overhang (i.e. length of horizontal incision) to initiate collapse (m)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d6a/simulation_8h_source.html#l00860">simulation.h:860</a></div></div>
<div class="ttc" id="aclassCSimulation_html_a1312f0ac2c93a6cb2bc41c23eb01c293"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">CSimulation::m_pRasterGrid</a></div><div class="ttdeci">CGeomRasterGrid * m_pRasterGrid</div><div class="ttdoc">Pointer to the raster grid object.</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d6a/simulation_8h_source.html#l01476">simulation.h:1476</a></div></div>
<div class="ttc" id="aclassCSimulation_html_a185287a9d4c6dafaef17e0938c018c3e"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#a185287a9d4c6dafaef17e0938c018c3e">CSimulation::RasterizeCliffCollapseProfile</a></div><div class="ttdeci">void RasterizeCliffCollapseProfile(vector&lt; CGeom2DPoint &gt; const *, vector&lt; CGeom2DIPoint &gt; *) const</div><div class="ttdoc">Given the start and end points of a cliff-collapse normal profile, returns an output vector of cells ...</div><div class="ttdef"><b>Definition</b> <a href="#l01043">do_cliff_collapse.cpp:1043</a></div></div>
<div class="ttc" id="aclassCSimulation_html_a1af38849a4694be096d76c39c1281f09"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#a1af38849a4694be096d76c39c1281f09">CSimulation::nDoCliffCollapseDeposition</a></div><div class="ttdeci">int nDoCliffCollapseDeposition(int const, CRWCliff const *, double const, double const, double const, double const)</div><div class="ttdoc">Redistributes the sand-sized and coarse-sized sediment from a cliff collapse onto the foreshore,...</div><div class="ttdef"><b>Definition</b> <a href="#l00435">do_cliff_collapse.cpp:435</a></div></div>
<div class="ttc" id="aclassCSimulation_html_a222962121613613a48f518e0c2110f21"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#a222962121613613a48f518e0c2110f21">CSimulation::LogStream</a></div><div class="ttdeci">ofstream LogStream</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d6a/simulation_8h_source.html#l01766">simulation.h:1766</a></div></div>
<div class="ttc" id="aclassCSimulation_html_a25ada8139c82ca7beab3f279cff83184"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#a25ada8139c82ca7beab3f279cff83184">CSimulation::m_VCoast</a></div><div class="ttdeci">vector&lt; CRWCoast &gt; m_VCoast</div><div class="ttdoc">The coastline objects.</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d6a/simulation_8h_source.html#l01479">simulation.h:1479</a></div></div>
<div class="ttc" id="aclassCSimulation_html_a2fc00e8bedd7b2f6f2d7d6fedf54821d"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#a2fc00e8bedd7b2f6f2d7d6fedf54821d">CSimulation::m_dFineErodibilityNormalized</a></div><div class="ttdeci">double m_dFineErodibilityNormalized</div><div class="ttdoc">Relative erodibility of fine unconsolidated beach sediment, normalized.</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d6a/simulation_8h_source.html#l00749">simulation.h:749</a></div></div>
<div class="ttc" id="aclassCSimulation_html_a30f847968bc8dfb175fcf571ce93296f"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#a30f847968bc8dfb175fcf571ce93296f">CSimulation::m_dThisIterCliffCollapseFineErodedDuringDeposition</a></div><div class="ttdeci">double m_dThisIterCliffCollapseFineErodedDuringDeposition</div><div class="ttdoc">Total fine sediment eroded during Dean profile deposition of talus following cliff collapse (depth in...</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d6a/simulation_8h_source.html#l00827">simulation.h:827</a></div></div>
<div class="ttc" id="aclassCSimulation_html_a3d53726bf8b2b2118c8b69c6707b304b"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#a3d53726bf8b2b2118c8b69c6707b304b">CSimulation::m_dCliffTalusMinDepositionLength</a></div><div class="ttdeci">double m_dCliffTalusMinDepositionLength</div><div class="ttdoc">Planview length of cliff deposition talus (m)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d6a/simulation_8h_source.html#l00872">simulation.h:872</a></div></div>
<div class="ttc" id="aclassCSimulation_html_a41d2967d84cbcf1799123f3d51aac287"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#a41d2967d84cbcf1799123f3d51aac287">CSimulation::m_dCoarseErodibilityNormalized</a></div><div class="ttdeci">double m_dCoarseErodibilityNormalized</div><div class="ttdoc">Relative erodibility of coarse unconsolidated beach sediment, normalized.</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d6a/simulation_8h_source.html#l00755">simulation.h:755</a></div></div>
<div class="ttc" id="aclassCSimulation_html_a495b588ec7b6b6440675712123870303"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#a495b588ec7b6b6440675712123870303">CSimulation::m_dThisIterCliffCollapseErosionCoarseUncons</a></div><div class="ttdeci">double m_dThisIterCliffCollapseErosionCoarseUncons</div><div class="ttdoc">This-iteration total of coarse unconsolidated sediment produced by cliff collapse (m^3)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d6a/simulation_8h_source.html#l00884">simulation.h:884</a></div></div>
<div class="ttc" id="aclassCSimulation_html_a534390d32312d83a3564afd2f6fddc4e"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#a534390d32312d83a3564afd2f6fddc4e">CSimulation::m_dThisIterCliffCollapseErosionFineUncons</a></div><div class="ttdeci">double m_dThisIterCliffCollapseErosionFineUncons</div><div class="ttdoc">This-iteration total of fine unconsolidated sediment produced by cliff collapse (m^3)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d6a/simulation_8h_source.html#l00878">simulation.h:878</a></div></div>
<div class="ttc" id="aclassCSimulation_html_a5c6043e2c01c4f9d1cb9b4ca5f940bd7"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#a5c6043e2c01c4f9d1cb9b4ca5f940bd7">CSimulation::dSubtractProfiles</a></div><div class="ttdeci">static double dSubtractProfiles(vector&lt; double &gt; const *, vector&lt; double &gt; const *, vector&lt; bool &gt; const *)</div><div class="ttdoc">Calculate the total elevation difference between every point in two elevation profiles (first profile...</div><div class="ttdef"><b>Definition</b> <a href="../../de/d06/utils_8cpp_source.html#l02394">utils.cpp:2394</a></div></div>
<div class="ttc" id="aclassCSimulation_html_a67be223b916774e3eabb4bc5bf232eda"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#a67be223b916774e3eabb4bc5bf232eda">CSimulation::m_dNotchBaseBelowSWL</a></div><div class="ttdeci">double m_dNotchBaseBelowSWL</div><div class="ttdoc">Notch base below SWL (m)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d6a/simulation_8h_source.html#l00863">simulation.h:863</a></div></div>
<div class="ttc" id="aclassCSimulation_html_a73cad40fa795d80bb48bb360df2c47e9"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#a73cad40fa795d80bb48bb360df2c47e9">CSimulation::m_dSandErodibilityNormalized</a></div><div class="ttdeci">double m_dSandErodibilityNormalized</div><div class="ttdoc">Relative erodibility of sand unconsolidated beach sediment, normalized.</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d6a/simulation_8h_source.html#l00752">simulation.h:752</a></div></div>
<div class="ttc" id="aclassCSimulation_html_a7c3995b189dcff813dfbfcc7c285e205"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#a7c3995b189dcff813dfbfcc7c285e205">CSimulation::m_dCliffErosionResistance</a></div><div class="ttdeci">double m_dCliffErosionResistance</div><div class="ttdoc">Resistance of cliff to notch erosion.</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d6a/simulation_8h_source.html#l00857">simulation.h:857</a></div></div>
<div class="ttc" id="aclassCSimulation_html_a7e2a4bd69ce79377fee86aa5598903f8"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#a7e2a4bd69ce79377fee86aa5598903f8">CSimulation::dGridCentroidYToExtCRSY</a></div><div class="ttdeci">double dGridCentroidYToExtCRSY(int const) const</div><div class="ttdoc">Given the integer Y-axis ordinate of a cell in the raster grid CRS, returns the external CRS Y-axis o...</div><div class="ttdef"><b>Definition</b> <a href="../../db/df7/gis__utils_8cpp_source.html#l00071">gis_utils.cpp:71</a></div></div>
<div class="ttc" id="aclassCSimulation_html_a88015ff9851069ccb4aa4bef2773fe22"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#a88015ff9851069ccb4aa4bef2773fe22">CSimulation::nConvertMetresToNumCells</a></div><div class="ttdeci">int nConvertMetresToNumCells(double const) const</div><div class="ttdoc">Given a length in m, this returns the rounded equivalent number of cells.</div><div class="ttdef"><b>Definition</b> <a href="../../db/df7/gis__utils_8cpp_source.html#l01784">gis_utils.cpp:1784</a></div></div>
<div class="ttc" id="aclassCSimulation_html_a89aac08d3cfa2f5f5793b3ca6400e868"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#a89aac08d3cfa2f5f5793b3ca6400e868">CSimulation::m_dThisIterUnconsCoarseCliffDeposition</a></div><div class="ttdeci">double m_dThisIterUnconsCoarseCliffDeposition</div><div class="ttdoc">This-iteration total of coarse unconsolidated sediment deposited due to cliff collapse (m^3)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d6a/simulation_8h_source.html#l00899">simulation.h:899</a></div></div>
<div class="ttc" id="aclassCSimulation_html_a90adbbfff9b8ce4f40ce6010657b375b"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#a90adbbfff9b8ce4f40ce6010657b375b">CSimulation::m_dThisIterUnconsSandCliffDeposition</a></div><div class="ttdeci">double m_dThisIterUnconsSandCliffDeposition</div><div class="ttdoc">This-iteration total of sand unconsolidated sediment deposited due to cliff collapse (m^3)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d6a/simulation_8h_source.html#l00896">simulation.h:896</a></div></div>
<div class="ttc" id="aclassCSimulation_html_a9a8f66d4a55299b92d4b1cea9e1d095e"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#a9a8f66d4a55299b92d4b1cea9e1d095e">CSimulation::nGetCoastNormalEndPoint</a></div><div class="ttdeci">int nGetCoastNormalEndPoint(int const, int const, int const, CGeom2DPoint const *, double const, CGeom2DPoint *, CGeom2DIPoint *, bool const)</div><div class="ttdoc">Finds the end point of a coastline-normal line, given the start point on the vector coastline....</div><div class="ttdef"><b>Definition</b> <a href="../../da/db2/create__profiles_8cpp_source.html#l00689">create_profiles.cpp:689</a></div></div>
<div class="ttc" id="aclassCSimulation_html_a9c151ce3de623725c152505491fa4424"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#a9c151ce3de623725c152505491fa4424">CSimulation::m_dMinCliffTalusHeightFrac</a></div><div class="ttdeci">double m_dMinCliffTalusHeightFrac</div><div class="ttdoc">Minimum height of the landward end of cliff collapse talus, as a fraction of cliff elevation.</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d6a/simulation_8h_source.html#l00875">simulation.h:875</a></div></div>
<div class="ttc" id="aclassCSimulation_html_a9fbe52d4e0f26ad432f12b7154c599e4"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#a9fbe52d4e0f26ad432f12b7154c599e4">CSimulation::dExtCRSXToGridX</a></div><div class="ttdeci">double dExtCRSXToGridX(double const) const</div><div class="ttdoc">Transforms an X-axis ordinate in the external CRS to the equivalent X-axis ordinate in the raster gri...</div><div class="ttdef"><b>Definition</b> <a href="../../db/df7/gis__utils_8cpp_source.html#l00110">gis_utils.cpp:110</a></div></div>
<div class="ttc" id="aclassCSimulation_html_a9ff982b02c96da7af9df717158907d43"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#a9ff982b02c96da7af9df717158907d43">CSimulation::m_dThisIterFineSedimentToSuspension</a></div><div class="ttdeci">double m_dThisIterFineSedimentToSuspension</div><div class="ttdoc">Total fine unconsolidated sediment in suspension for this iteration (depth in m)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d6a/simulation_8h_source.html#l00812">simulation.h:812</a></div></div>
<div class="ttc" id="aclassCSimulation_html_a9ffa887989f66980ea60a8bea69b1e6e"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#a9ffa887989f66980ea60a8bea69b1e6e">CSimulation::nDoAllWaveEnergyToCoastLandforms</a></div><div class="ttdeci">int nDoAllWaveEnergyToCoastLandforms(void)</div><div class="ttdoc">Update accumulated wave energy in coastal landform objects.</div><div class="ttdef"><b>Definition</b> <a href="#l00041">do_cliff_collapse.cpp:41</a></div></div>
<div class="ttc" id="aclassCSimulation_html_aa0eddb8270d03b9c1a0a6e96254ebfed"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#aa0eddb8270d03b9c1a0a6e96254ebfed">CSimulation::KeepWithinValidGrid</a></div><div class="ttdeci">void KeepWithinValidGrid(int, int, int &amp;, int &amp;) const</div><div class="ttdoc">Given two points in the grid CRS (the points assumed not to be coincident), this routine modifies the...</div><div class="ttdef"><b>Definition</b> <a href="../../db/df7/gis__utils_8cpp_source.html#l00210">gis_utils.cpp:210</a></div></div>
<div class="ttc" id="aclassCSimulation_html_aa260ec96182ba4bd9881622f3568b7bd"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#aa260ec96182ba4bd9881622f3568b7bd">CSimulation::m_dThisIterCliffCollapseSandErodedDuringDeposition</a></div><div class="ttdeci">double m_dThisIterCliffCollapseSandErodedDuringDeposition</div><div class="ttdoc">Total sand sediment eroded during Dean profile deposition of talus following cliff collapse (depth in...</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d6a/simulation_8h_source.html#l00830">simulation.h:830</a></div></div>
<div class="ttc" id="aclassCSimulation_html_aa35a5d1dce719b48d71f4ca4e008290b"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#aa35a5d1dce719b48d71f4ca4e008290b">CSimulation::m_dCliffDepositionA</a></div><div class="ttdeci">double m_dCliffDepositionA</div><div class="ttdoc">Scale parameter A for cliff deposition (m^(1/3)), may be zero for auto-calculation.</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d6a/simulation_8h_source.html#l00866">simulation.h:866</a></div></div>
<div class="ttc" id="aclassCSimulation_html_aa49a03295b1c3da6f5be1cfbf6af02fc"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#aa49a03295b1c3da6f5be1cfbf6af02fc">CSimulation::nDoCliffCollapse</a></div><div class="ttdeci">int nDoCliffCollapse(int const, CRWCliff *, double &amp;, double &amp;, double &amp;, double &amp;, double &amp;)</div><div class="ttdoc">Simulates cliff collapse on a single cliff object, which happens when when a notch (incised into a co...</div><div class="ttdef"><b>Definition</b> <a href="#l00195">do_cliff_collapse.cpp:195</a></div></div>
<div class="ttc" id="aclassCSimulation_html_aa6ebdb3d36ad3cea05ec1446f20cacb8"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#aa6ebdb3d36ad3cea05ec1446f20cacb8">CSimulation::m_bUnconsChangedThisIter</a></div><div class="ttdeci">vector&lt; bool &gt; m_bUnconsChangedThisIter</div><div class="ttdoc">One element per layer: has the consolidated sediment of this layer been changed during this iteration...</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d6a/simulation_8h_source.html#l01308">simulation.h:1308</a></div></div>
<div class="ttc" id="aclassCSimulation_html_aad28423979cf34cb63c4e02e0260c4bb"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#aad28423979cf34cb63c4e02e0260c4bb">CSimulation::m_dThisIterCliffCollapseErosionFineCons</a></div><div class="ttdeci">double m_dThisIterCliffCollapseErosionFineCons</div><div class="ttdoc">This-iteration total of fine consolidated sediment produced by cliff collapse (m^3)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d6a/simulation_8h_source.html#l00887">simulation.h:887</a></div></div>
<div class="ttc" id="aclassCSimulation_html_ac26ef813bdee563625a9a7be573a3741"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#ac26ef813bdee563625a9a7be573a3741">CSimulation::m_dCellArea</a></div><div class="ttdeci">double m_dCellArea</div><div class="ttdoc">Area of a cell (in external CRS units)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d6a/simulation_8h_source.html#l00614">simulation.h:614</a></div></div>
<div class="ttc" id="aclassCSimulation_html_ac2e7e204d9e9b527d0a4c941f2e525ad"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#ac2e7e204d9e9b527d0a4c941f2e525ad">CSimulation::dExtCRSYToGridY</a></div><div class="ttdeci">double dExtCRSYToGridY(double const) const</div><div class="ttdoc">Transforms a Y-axis ordinate in the external CRS to the equivalent Y-axis ordinate in the raster grid...</div><div class="ttdef"><b>Definition</b> <a href="../../db/df7/gis__utils_8cpp_source.html#l00119">gis_utils.cpp:119</a></div></div>
<div class="ttc" id="aclassCSimulation_html_ac900a5701df97da22278fae928951f50"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#ac900a5701df97da22278fae928951f50">CSimulation::bIsWithinValidGrid</a></div><div class="ttdeci">bool bIsWithinValidGrid(int const, int const) const</div><div class="ttdoc">Checks whether the supplied point (an x-y pair, in the grid CRS) is within the raster grid,...</div><div class="ttdef"><b>Definition</b> <a href="../../db/df7/gis__utils_8cpp_source.html#l00170">gis_utils.cpp:170</a></div></div>
<div class="ttc" id="aclassCSimulation_html_acc2add764952e52de17425ae15c07219"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#acc2add764952e52de17425ae15c07219">CSimulation::m_dThisIterCliffCollapseErosionSandCons</a></div><div class="ttdeci">double m_dThisIterCliffCollapseErosionSandCons</div><div class="ttdoc">This-iteration total of sand consolidated sediment produced by cliff collapse (m^3)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d6a/simulation_8h_source.html#l00890">simulation.h:890</a></div></div>
<div class="ttc" id="aclassCSimulation_html_ad241bd6dbff1824ca6f8fb6280f4d960"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#ad241bd6dbff1824ca6f8fb6280f4d960">CSimulation::m_dThisIterCliffCollapseErosionSandUncons</a></div><div class="ttdeci">double m_dThisIterCliffCollapseErosionSandUncons</div><div class="ttdoc">This-iteration total of sand unconsolidated sediment produced by cliff collapse (m^3)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d6a/simulation_8h_source.html#l00881">simulation.h:881</a></div></div>
<div class="ttc" id="aclassCSimulation_html_ad67e8c5b30a0572f64ecfb5c062c2edc"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#ad67e8c5b30a0572f64ecfb5c062c2edc">CSimulation::m_ulIter</a></div><div class="ttdeci">unsigned long m_ulIter</div><div class="ttdoc">The number of the current iteration (time step)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d6a/simulation_8h_source.html#l00551">simulation.h:551</a></div></div>
<div class="ttc" id="aclassCSimulation_html_ad79b925ac5f358c6f867b6e47dad74bd"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#ad79b925ac5f358c6f867b6e47dad74bd">CSimulation::dGridCentroidXToExtCRSX</a></div><div class="ttdeci">double dGridCentroidXToExtCRSX(int const) const</div><div class="ttdoc">Given the integer X-axis ordinate of a cell in the raster grid CRS, returns the external CRS X-axis o...</div><div class="ttdef"><b>Definition</b> <a href="../../db/df7/gis__utils_8cpp_source.html#l00062">gis_utils.cpp:62</a></div></div>
<div class="ttc" id="aclassCSimulation_html_ae0de69c3d3acd6d52dc2ec2f456c0eb5"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#ae0de69c3d3acd6d52dc2ec2f456c0eb5">CSimulation::m_dCellSide</a></div><div class="ttdeci">double m_dCellSide</div><div class="ttdoc">Length of a cell side (in external CRS units)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d6a/simulation_8h_source.html#l00611">simulation.h:611</a></div></div>
<div class="ttc" id="aclassCSimulation_html_ae293573ac53f0a8d536037d0edffd25f"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#ae293573ac53f0a8d536037d0edffd25f">CSimulation::bIsInterventionCell</a></div><div class="ttdeci">bool bIsInterventionCell(int const, int const) const</div><div class="ttdoc">Returns true if the cell is an intervention.</div><div class="ttdef"><b>Definition</b> <a href="../../de/d06/utils_8cpp_source.html#l02736">utils.cpp:2736</a></div></div>
<div class="ttc" id="aclassCSimulation_html_ae67aea0bf8c81af2287aabbfd7d3daa5"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#ae67aea0bf8c81af2287aabbfd7d3daa5">CSimulation::m_dThisIterCliffCollapseCoarseErodedDuringDeposition</a></div><div class="ttdeci">double m_dThisIterCliffCollapseCoarseErodedDuringDeposition</div><div class="ttdoc">Total coarse sediment eroded during Dean profile deposition of talus following cliff collapse (depth ...</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d6a/simulation_8h_source.html#l00833">simulation.h:833</a></div></div>
<div class="ttc" id="aclassCSimulation_html_aec4061ede2955755db0a1d4e5a1bfc36"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#aec4061ede2955755db0a1d4e5a1bfc36">CSimulation::m_dThisIterCliffCollapseErosionCoarseCons</a></div><div class="ttdeci">double m_dThisIterCliffCollapseErosionCoarseCons</div><div class="ttdoc">This-iteration total of coarse consolidated sediment produced by cliff collapse (m^3)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d6a/simulation_8h_source.html#l00893">simulation.h:893</a></div></div>
<div class="ttc" id="aclassCSimulation_html_aee4cd1d27e2a0710a45b4d814e95078d"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#aee4cd1d27e2a0710a45b4d814e95078d">CSimulation::CalcDeanProfile</a></div><div class="ttdeci">static void CalcDeanProfile(vector&lt; double &gt; *, double const, double const, double const, bool const, int const, double const)</div><div class="ttdoc">Calculates a Dean equilibrium profile h(y) = A * y^(2/3) where h(y) is the distance below the highest...</div><div class="ttdef"><b>Definition</b> <a href="../../de/d06/utils_8cpp_source.html#l02356">utils.cpp:2356</a></div></div>
<div class="ttc" id="aclassCSimulation_html_aee72433983f1b26c0b734ee7b0d26014"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#aee72433983f1b26c0b734ee7b0d26014">CSimulation::m_bConsChangedThisIter</a></div><div class="ttdeci">vector&lt; bool &gt; m_bConsChangedThisIter</div><div class="ttdoc">One element per layer: has the consolidated sediment of this layer been changed during this iteration...</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d6a/simulation_8h_source.html#l01305">simulation.h:1305</a></div></div>
<div class="ttc" id="acliff_8h_html"><div class="ttname"><a href="../../db/df0/cliff_8h.html">cliff.h</a></div><div class="ttdoc">Contains CRWCliff definitions.</div></div>
<div class="ttc" id="acme_8h_html"><div class="ttname"><a href="../../d6/d2a/cme_8h.html">cme.h</a></div><div class="ttdoc">This file contains global definitions for CoastalME.</div></div>
<div class="ttc" id="acme_8h_html_a01522c1e8423c6586193dd5ca0c76171"><div class="ttname"><a href="../../d6/d2a/cme_8h.html#a01522c1e8423c6586193dd5ca0c76171">NO_NONZERO_THICKNESS_LAYERS</a></div><div class="ttdeci">int const NO_NONZERO_THICKNESS_LAYERS</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d2a/cme_8h_source.html#l00655">cme.h:655</a></div></div>
<div class="ttc" id="acme_8h_html_a01aa8b423260b337ddff2016107b51a0"><div class="ttname"><a href="../../d6/d2a/cme_8h.html#a01aa8b423260b337ddff2016107b51a0">INT_NODATA</a></div><div class="ttdeci">int const INT_NODATA</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d2a/cme_8h_source.html#l00365">cme.h:365</a></div></div>
<div class="ttc" id="acme_8h_html_a068017859403c0629d89f8d348f6c224"><div class="ttname"><a href="../../d6/d2a/cme_8h.html#a068017859403c0629d89f8d348f6c224">tMin</a></div><div class="ttdeci">T tMin(T a, T b)</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d2a/cme_8h_source.html#l01139">cme.h:1139</a></div></div>
<div class="ttc" id="acme_8h_html_a073ffbb4921531737dc0dee04bdcbe11"><div class="ttname"><a href="../../d6/d2a/cme_8h.html#a073ffbb4921531737dc0dee04bdcbe11">RTN_ERR_CLIFFNOTCH</a></div><div class="ttdeci">int const RTN_ERR_CLIFFNOTCH</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d2a/cme_8h_source.html#l00617">cme.h:617</a></div></div>
<div class="ttc" id="acme_8h_html_a08b1623863ee3bd4300a8892de323722"><div class="ttname"><a href="../../d6/d2a/cme_8h.html#a08b1623863ee3bd4300a8892de323722">TOLERANCE</a></div><div class="ttdeci">double const TOLERANCE</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d2a/cme_8h_source.html#l00701">cme.h:701</a></div></div>
<div class="ttc" id="acme_8h_html_a0af2b64c1c33dbf4d223944b0bf234e6"><div class="ttname"><a href="../../d6/d2a/cme_8h.html#a0af2b64c1c33dbf4d223944b0bf234e6">RTN_ERR_NO_TOP_LAYER</a></div><div class="ttdeci">int const RTN_ERR_NO_TOP_LAYER</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d2a/cme_8h_source.html#l00626">cme.h:626</a></div></div>
<div class="ttc" id="acme_8h_html_a1a0f3745fbc2e50a9f483893339c9f75"><div class="ttname"><a href="../../d6/d2a/cme_8h.html#a1a0f3745fbc2e50a9f483893339c9f75">ELEV_ABOVE_SEDIMENT_TOP</a></div><div class="ttdeci">int const ELEV_ABOVE_SEDIMENT_TOP</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d2a/cme_8h_source.html#l00654">cme.h:654</a></div></div>
<div class="ttc" id="acme_8h_html_a2113878b63a7dc5971c9500654865d55"><div class="ttname"><a href="../../d6/d2a/cme_8h.html#a2113878b63a7dc5971c9500654865d55">LF_CAT_SEDIMENT_INPUT</a></div><div class="ttdeci">int const LF_CAT_SEDIMENT_INPUT</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d2a/cme_8h_source.html#l00427">cme.h:427</a></div></div>
<div class="ttc" id="acme_8h_html_a292fc90846543ca4814daa9f759feb05"><div class="ttname"><a href="../../d6/d2a/cme_8h.html#a292fc90846543ca4814daa9f759feb05">ERR</a></div><div class="ttdeci">string const ERR</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d2a/cme_8h_source.html#l00778">cme.h:778</a></div></div>
<div class="ttc" id="acme_8h_html_a2c56dd72d6afc9eb107a42a919bef8b0"><div class="ttname"><a href="../../d6/d2a/cme_8h.html#a2c56dd72d6afc9eb107a42a919bef8b0">LF_CAT_SEDIMENT_INPUT_SUBMERGED</a></div><div class="ttdeci">int const LF_CAT_SEDIMENT_INPUT_SUBMERGED</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d2a/cme_8h_source.html#l00428">cme.h:428</a></div></div>
<div class="ttc" id="acme_8h_html_a345c00500ce26313ccfe7c13845306bf"><div class="ttname"><a href="../../d6/d2a/cme_8h.html#a345c00500ce26313ccfe7c13845306bf">MAX_SEAWARD_OFFSET_FOR_CLIFF_TALUS</a></div><div class="ttdeci">int const MAX_SEAWARD_OFFSET_FOR_CLIFF_TALUS</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d2a/cme_8h_source.html#l00370">cme.h:370</a></div></div>
<div class="ttc" id="acme_8h_html_a540d8a94fc09b0b14fd8ab657445b67a"><div class="ttname"><a href="../../d6/d2a/cme_8h.html#a540d8a94fc09b0b14fd8ab657445b67a">LOG_FILE_MIDDLE_DETAIL</a></div><div class="ttdeci">int const LOG_FILE_MIDDLE_DETAIL</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d2a/cme_8h_source.html#l00380">cme.h:380</a></div></div>
<div class="ttc" id="acme_8h_html_a61afa8560a3b39c80657661a1d8f76ab"><div class="ttname"><a href="../../d6/d2a/cme_8h.html#a61afa8560a3b39c80657661a1d8f76ab">bFPIsEqual</a></div><div class="ttdeci">bool bFPIsEqual(const T d1, const T d2, const T dEpsilon)</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d2a/cme_8h_source.html#l01179">cme.h:1179</a></div></div>
<div class="ttc" id="acme_8h_html_a7b4b1553585db781ce65707e31294bea"><div class="ttname"><a href="../../d6/d2a/cme_8h.html#a7b4b1553585db781ce65707e31294bea">MASS_BALANCE_TOLERANCE</a></div><div class="ttdeci">double const MASS_BALANCE_TOLERANCE</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d2a/cme_8h_source.html#l00703">cme.h:703</a></div></div>
<div class="ttc" id="acme_8h_html_a7e895b460cef877dec4d12ead0c74f15"><div class="ttname"><a href="../../d6/d2a/cme_8h.html#a7e895b460cef877dec4d12ead0c74f15">tMax</a></div><div class="ttdeci">T tMax(T a, T b)</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d2a/cme_8h_source.html#l01126">cme.h:1126</a></div></div>
<div class="ttc" id="acme_8h_html_a80df4d9236509b6c0a0adb67ed93478a"><div class="ttname"><a href="../../d6/d2a/cme_8h.html#a80df4d9236509b6c0a0adb67ed93478a">CLIFF_COLLAPSE_HEIGHT_INCREMENT</a></div><div class="ttdeci">double const CLIFF_COLLAPSE_HEIGHT_INCREMENT</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d2a/cme_8h_source.html#l00708">cme.h:708</a></div></div>
<div class="ttc" id="acme_8h_html_a8272a52e71f5a7b38fdf4fcdc1887fb7"><div class="ttname"><a href="../../d6/d2a/cme_8h.html#a8272a52e71f5a7b38fdf4fcdc1887fb7">MAX_CLIFF_TALUS_LENGTH</a></div><div class="ttdeci">int const MAX_CLIFF_TALUS_LENGTH</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d2a/cme_8h_source.html#l00366">cme.h:366</a></div></div>
<div class="ttc" id="acme_8h_html_a85da1142fa4655ec66f1e391444a6d9a"><div class="ttname"><a href="../../d6/d2a/cme_8h.html#a85da1142fa4655ec66f1e391444a6d9a">LOG_FILE_HIGH_DETAIL</a></div><div class="ttdeci">int const LOG_FILE_HIGH_DETAIL</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d2a/cme_8h_source.html#l00381">cme.h:381</a></div></div>
<div class="ttc" id="acme_8h_html_a8a73c1e3b62bdc03aeb0be69f0fa018b"><div class="ttname"><a href="../../d6/d2a/cme_8h.html#a8a73c1e3b62bdc03aeb0be69f0fa018b">LF_SUBCAT_DRIFT_TALUS</a></div><div class="ttdeci">int const LF_SUBCAT_DRIFT_TALUS</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d2a/cme_8h_source.html#l00442">cme.h:442</a></div></div>
<div class="ttc" id="acme_8h_html_a8e182d96bc7134148551c890343aef9b"><div class="ttname"><a href="../../d6/d2a/cme_8h.html#a8e182d96bc7134148551c890343aef9b">RTN_ERR_CLIFF_NOT_IN_POLYGON</a></div><div class="ttdeci">int const RTN_ERR_CLIFF_NOT_IN_POLYGON</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d2a/cme_8h_source.html#l00649">cme.h:649</a></div></div>
<div class="ttc" id="acme_8h_html_a957ca99e98618160534cafb0929f743d"><div class="ttname"><a href="../../d6/d2a/cme_8h.html#a957ca99e98618160534cafb0929f743d">WARN</a></div><div class="ttdeci">string const WARN</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d2a/cme_8h_source.html#l00779">cme.h:779</a></div></div>
<div class="ttc" id="acme_8h_html_a992c7916632c97c6c1fa25fd5a788282"><div class="ttname"><a href="../../d6/d2a/cme_8h.html#a992c7916632c97c6c1fa25fd5a788282">SEDIMENT_ELEV_TOLERANCE</a></div><div class="ttdeci">double const SEDIMENT_ELEV_TOLERANCE</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d2a/cme_8h_source.html#l00702">cme.h:702</a></div></div>
<div class="ttc" id="acme_8h_html_a9b341d045bbf90c51fc0528eb453fa2c"><div class="ttname"><a href="../../d6/d2a/cme_8h.html#a9b341d045bbf90c51fc0528eb453fa2c">CLIFF_COLLAPSE_LENGTH_INCREMENT</a></div><div class="ttdeci">int const CLIFF_COLLAPSE_LENGTH_INCREMENT</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d2a/cme_8h_source.html#l00675">cme.h:675</a></div></div>
<div class="ttc" id="acme_8h_html_aa58b13ad2e88aaa20449bfea242396a4"><div class="ttname"><a href="../../d6/d2a/cme_8h.html#aa58b13ad2e88aaa20449bfea242396a4">LOG_FILE_ALL</a></div><div class="ttdeci">int const LOG_FILE_ALL</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d2a/cme_8h_source.html#l00382">cme.h:382</a></div></div>
<div class="ttc" id="acme_8h_html_aa768cb14b5c6123ee95e6e4ebd9fe331"><div class="ttname"><a href="../../d6/d2a/cme_8h.html#aa768cb14b5c6123ee95e6e4ebd9fe331">RTN_OK</a></div><div class="ttdeci">int const RTN_OK</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d2a/cme_8h_source.html#l00580">cme.h:580</a></div></div>
<div class="ttc" id="acme_8h_html_ac003bdff958dca839f5d274f15786e07"><div class="ttname"><a href="../../d6/d2a/cme_8h.html#ac003bdff958dca839f5d274f15786e07">DBL_NODATA</a></div><div class="ttdeci">double const DBL_NODATA</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d2a/cme_8h_source.html#l00710">cme.h:710</a></div></div>
<div class="ttc" id="acme_8h_html_ac35a5105cdbbb00d8c809eee7c72a0f8"><div class="ttname"><a href="../../d6/d2a/cme_8h.html#ac35a5105cdbbb00d8c809eee7c72a0f8">RTN_ERR_CLIFFDEPOSIT</a></div><div class="ttdeci">int const RTN_ERR_CLIFFDEPOSIT</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d2a/cme_8h_source.html#l00618">cme.h:618</a></div></div>
<div class="ttc" id="acme_8h_html_ac5c14eafd96860d3f562e9c7f23a4104"><div class="ttname"><a href="../../d6/d2a/cme_8h.html#ac5c14eafd96860d3f562e9c7f23a4104">DEAN_POWER</a></div><div class="ttdeci">double const DEAN_POWER</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d2a/cme_8h_source.html#l00695">cme.h:695</a></div></div>
<div class="ttc" id="acme_8h_html_ac79118ee70069f5e1a7e50430aef4597"><div class="ttname"><a href="../../d6/d2a/cme_8h.html#ac79118ee70069f5e1a7e50430aef4597">LF_CAT_SEDIMENT_INPUT_NOT_SUBMERGED</a></div><div class="ttdeci">int const LF_CAT_SEDIMENT_INPUT_NOT_SUBMERGED</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d2a/cme_8h_source.html#l00429">cme.h:429</a></div></div>
<div class="ttc" id="acme_8h_html_ace82416ca7fb524bd4da49c3d402b082"><div class="ttname"><a href="../../d6/d2a/cme_8h.html#ace82416ca7fb524bd4da49c3d402b082">RTN_ERR_NO_SOLUTION_FOR_ENDPOINT</a></div><div class="ttdeci">int const RTN_ERR_NO_SOLUTION_FOR_ENDPOINT</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d2a/cme_8h_source.html#l00607">cme.h:607</a></div></div>
<div class="ttc" id="acme_8h_html_ad6be96d3be217d31a74c2412d7e6cbbb"><div class="ttname"><a href="../../d6/d2a/cme_8h.html#ad6be96d3be217d31a74c2412d7e6cbbb">LF_CAT_CLIFF</a></div><div class="ttdeci">int const LF_CAT_CLIFF</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d2a/cme_8h_source.html#l00432">cme.h:432</a></div></div>
<div class="ttc" id="acme_8h_html_ae3b6dc50cfc97050529faa5e0bd66136"><div class="ttname"><a href="../../d6/d2a/cme_8h.html#ae3b6dc50cfc97050529faa5e0bd66136">tAbs</a></div><div class="ttdeci">T tAbs(T a)</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d2a/cme_8h_source.html#l01151">cme.h:1151</a></div></div>
<div class="ttc" id="asimulation_8h_html"><div class="ttname"><a href="../../dd/d6a/simulation_8h.html">simulation.h</a></div><div class="ttdoc">Contains CSimulation definitions.</div></div>
<div class="ttc" id="autils__global_8cpp_html_a20842d0a19d0ca952c91f3e1eb175fee"><div class="ttname"><a href="../../d2/dfd/utils__global_8cpp.html#a20842d0a19d0ca952c91f3e1eb175fee">nRound</a></div><div class="ttdeci">int nRound(double const d)</div><div class="ttdoc">Version of the above that returns an int.</div><div class="ttdef"><b>Definition</b> <a href="../../d2/dfd/utils__global_8cpp_source.html#l00056">utils_global.cpp:56</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="../../d1/d93/do__cliff__collapse_8cpp.html">do_cliff_collapse.cpp</a></li>
    <li class="footer">Generated on Mon Mar 24 2025 14:36:31 for CoastalME (Coastal Modelling Environment) by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
</body>
</html>
