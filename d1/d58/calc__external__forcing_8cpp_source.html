<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>CoastalME (Coastal Modelling Environment): calc_external_forcing.cpp Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<script type="text/javascript" src="../../clipboard.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../cookie.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">CoastalME (Coastal Modelling Environment)
   </div>
   <div id="projectbrief">Simulates the long-term behaviour of complex coastlines</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(1); });
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('d1/d58/calc__external__forcing_8cpp_source.html','../../'); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">calc_external_forcing.cpp</div></div>
</div><!--header-->
<div class="contents">
<a href="../../d1/d58/calc__external__forcing_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno">    1</span></div>
<div class="line"><a id="l00010" name="l00010"></a><span class="lineno">   10</span> </div>
<div class="line"><a id="l00011" name="l00011"></a><span class="lineno">   11</span><span class="comment">/* ==============================================================================================================================</span></div>
<div class="line"><a id="l00012" name="l00012"></a><span class="lineno">   12</span><span class="comment">   This file is part of CoastalME, the Coastal Modelling Environment.</span></div>
<div class="line"><a id="l00013" name="l00013"></a><span class="lineno">   13</span><span class="comment"></span> </div>
<div class="line"><a id="l00014" name="l00014"></a><span class="lineno">   14</span><span class="comment">   CoastalME is free software; you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation; either version 3 of the License, or (at your option) any later version.</span></div>
<div class="line"><a id="l00015" name="l00015"></a><span class="lineno">   15</span><span class="comment"></span> </div>
<div class="line"><a id="l00016" name="l00016"></a><span class="lineno">   16</span><span class="comment">   This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.</span></div>
<div class="line"><a id="l00017" name="l00017"></a><span class="lineno">   17</span><span class="comment"></span> </div>
<div class="line"><a id="l00018" name="l00018"></a><span class="lineno">   18</span><span class="comment">   You should have received a copy of the GNU General Public License along with this program; if not, write to the Free Software Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.</span></div>
<div class="line"><a id="l00019" name="l00019"></a><span class="lineno">   19</span><span class="comment">==============================================================================================================================*/</span></div>
<div class="line"><a id="l00020" name="l00020"></a><span class="lineno">   20</span><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><a id="l00021" name="l00021"></a><span class="lineno">   21</span><span class="keyword">using </span>std::endl;</div>
<div class="line"><a id="l00022" name="l00022"></a><span class="lineno">   22</span> </div>
<div class="line"><a id="l00023" name="l00023"></a><span class="lineno">   23</span><span class="preprocessor">#include &quot;<a class="code" href="../../d6/d2a/cme_8h.html">cme.h</a>&quot;</span></div>
<div class="line"><a id="l00024" name="l00024"></a><span class="lineno">   24</span><span class="preprocessor">#include &quot;<a class="code" href="../../dd/d6a/simulation_8h.html">simulation.h</a>&quot;</span></div>
<div class="line"><a id="l00025" name="l00025"></a><span class="lineno">   25</span> </div>
<div class="line"><a id="l00026" name="l00026"></a><span class="lineno">   26</span><span class="comment">//===============================================================================================================================</span></div>
<div class="line"><a id="l00028" name="l00028"></a><span class="lineno">   28</span><span class="comment">//===============================================================================================================================</span></div>
<div class="foldopen" id="foldopen00029" data-start="{" data-end="}">
<div class="line"><a id="l00029" name="l00029"></a><span class="lineno"><a class="line" href="../../d1/d98/classCSimulation.html#a2e53c27590e5217827b7e96000b2e4af">   29</a></span><span class="keywordtype">int</span> <a class="code hl_function" href="../../d1/d98/classCSimulation.html#a2e53c27590e5217827b7e96000b2e4af">CSimulation::nCalcExternalForcing</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a id="l00030" name="l00030"></a><span class="lineno">   30</span>{</div>
<div class="line"><a id="l00031" name="l00031"></a><span class="lineno">   31</span>   <span class="comment">// Increment long-term SWL change (increment may be zero)</span></div>
<div class="line"><a id="l00032" name="l00032"></a><span class="lineno">   32</span>   <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a9d814ca72120a681f1fcbe21ff90cce9">m_dAccumulatedSeaLevelChange</a> += <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#aaa63b75c940b9bc39e5bbb0bf24db977">m_dDeltaSWLPerTimestep</a>;</div>
<div class="line"><a id="l00033" name="l00033"></a><span class="lineno">   33</span> </div>
<div class="line"><a id="l00034" name="l00034"></a><span class="lineno">   34</span>   <span class="comment">// Increment this-iteration mean SWL with long-term SWL change</span></div>
<div class="line"><a id="l00035" name="l00035"></a><span class="lineno">   35</span>   <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#af375727df124a4b1781d34976f1d90d3">m_dThisIterMeanSWL</a> = <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a58b6cf0c6be3c02086f0373a4dcd45cc">m_dInitialMeanSWL</a> + <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a9d814ca72120a681f1fcbe21ff90cce9">m_dAccumulatedSeaLevelChange</a>;</div>
<div class="line"><a id="l00036" name="l00036"></a><span class="lineno">   36</span> </div>
<div class="line"><a id="l00037" name="l00037"></a><span class="lineno">   37</span>   <span class="keywordtype">int</span> <span class="keyword">const</span> nSize = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a38c6f6701771a34a4a503fabbf50278b">m_VdTideData</a>.size());</div>
<div class="line"><a id="l00038" name="l00038"></a><span class="lineno">   38</span>   <span class="keywordflow">if</span> (nSize == 0)</div>
<div class="line"><a id="l00039" name="l00039"></a><span class="lineno">   39</span>   {</div>
<div class="line"><a id="l00040" name="l00040"></a><span class="lineno">   40</span>      <span class="comment">// No tide data</span></div>
<div class="line"><a id="l00041" name="l00041"></a><span class="lineno">   41</span>      <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a115ab27bae37ce2d0de57cbdaeaba852">m_dThisIterSWL</a> = <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#af375727df124a4b1781d34976f1d90d3">m_dThisIterMeanSWL</a>;</div>
<div class="line"><a id="l00042" name="l00042"></a><span class="lineno">   42</span>      <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#abc1c620b4f32fb7175f6cdf761b1df92">m_dThisIterMHWElev</a> = <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#af375727df124a4b1781d34976f1d90d3">m_dThisIterMeanSWL</a>;</div>
<div class="line"><a id="l00043" name="l00043"></a><span class="lineno">   43</span>   }</div>
<div class="line"><a id="l00044" name="l00044"></a><span class="lineno">   44</span>   <span class="keywordflow">else</span></div>
<div class="line"><a id="l00045" name="l00045"></a><span class="lineno">   45</span>   {</div>
<div class="line"><a id="l00046" name="l00046"></a><span class="lineno">   46</span>      <span class="comment">// We have tide data</span></div>
<div class="line"><a id="l00047" name="l00047"></a><span class="lineno">   47</span>      <span class="keyword">static</span> <span class="keywordtype">int</span> snTideDataCount = 0;</div>
<div class="line"><a id="l00048" name="l00048"></a><span class="lineno">   48</span> </div>
<div class="line"><a id="l00049" name="l00049"></a><span class="lineno">   49</span>      <span class="comment">// Wrap the tide data, i.e. start again with the first line of the tide data if we do not have enough</span></div>
<div class="line"><a id="l00050" name="l00050"></a><span class="lineno">   50</span>      <span class="keywordflow">if</span> (snTideDataCount &gt; nSize - 1)</div>
<div class="line"><a id="l00051" name="l00051"></a><span class="lineno">   51</span>         snTideDataCount = 0;</div>
<div class="line"><a id="l00052" name="l00052"></a><span class="lineno">   52</span> </div>
<div class="line"><a id="l00053" name="l00053"></a><span class="lineno">   53</span>      <span class="comment">// This-iteration SWL includes both tidal change and long-term SWL change</span></div>
<div class="line"><a id="l00054" name="l00054"></a><span class="lineno">   54</span>      <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a115ab27bae37ce2d0de57cbdaeaba852">m_dThisIterSWL</a> = <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#af375727df124a4b1781d34976f1d90d3">m_dThisIterMeanSWL</a> + <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a38c6f6701771a34a4a503fabbf50278b">m_VdTideData</a>[snTideDataCount];</div>
<div class="line"><a id="l00055" name="l00055"></a><span class="lineno">   55</span> </div>
<div class="line"><a id="l00056" name="l00056"></a><span class="lineno">   56</span>      <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d1/d98/classCSimulation.html#aebf28c80a84bcd6e3f295740fe6c21c9">m_bDoCliffCollapse</a>)</div>
<div class="line"><a id="l00057" name="l00057"></a><span class="lineno">   57</span>         <a class="code hl_function" href="../../d1/d98/classCSimulation.html#ac1b38807f9a54957dbd92bc457cd1097">CalcMHWElevation</a>(snTideDataCount);</div>
<div class="line"><a id="l00058" name="l00058"></a><span class="lineno">   58</span> </div>
<div class="line"><a id="l00059" name="l00059"></a><span class="lineno">   59</span>      snTideDataCount++;</div>
<div class="line"><a id="l00060" name="l00060"></a><span class="lineno">   60</span>   }</div>
<div class="line"><a id="l00061" name="l00061"></a><span class="lineno">   61</span> </div>
<div class="line"><a id="l00062" name="l00062"></a><span class="lineno">   62</span>   <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a222962121613613a48f518e0c2110f21">LogStream</a> &lt;&lt; <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#ad67e8c5b30a0572f64ecfb5c062c2edc">m_ulIter</a> &lt;&lt; <span class="stringliteral">&quot;: SWL = &quot;</span> &lt;&lt; <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a115ab27bae37ce2d0de57cbdaeaba852">m_dThisIterSWL</a> &lt;&lt; std::endl;</div>
<div class="line"><a id="l00063" name="l00063"></a><span class="lineno">   63</span> </div>
<div class="line"><a id="l00064" name="l00064"></a><span class="lineno">   64</span>   <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a949f4dda2c9d3e16aede065412052b2f">m_bHighestSWLSoFar</a> = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00065" name="l00065"></a><span class="lineno">   65</span>   <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a56ea62dd03993be4b96f9a8db1fc1f7b">m_bLowestSWLSoFar</a> = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00066" name="l00066"></a><span class="lineno">   66</span> </div>
<div class="line"><a id="l00067" name="l00067"></a><span class="lineno">   67</span>   <span class="comment">// Maybe update min and max still water levels so far during this simulation</span></div>
<div class="line"><a id="l00068" name="l00068"></a><span class="lineno">   68</span>   <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a115ab27bae37ce2d0de57cbdaeaba852">m_dThisIterSWL</a> &gt; <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a3d22bbdc97592cd9c86dd5187cbc388b">m_dMaxSWLSoFar</a>)</div>
<div class="line"><a id="l00069" name="l00069"></a><span class="lineno">   69</span>   {</div>
<div class="line"><a id="l00070" name="l00070"></a><span class="lineno">   70</span>      <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a949f4dda2c9d3e16aede065412052b2f">m_bHighestSWLSoFar</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00071" name="l00071"></a><span class="lineno">   71</span>      <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a3d22bbdc97592cd9c86dd5187cbc388b">m_dMaxSWLSoFar</a> = <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a115ab27bae37ce2d0de57cbdaeaba852">m_dThisIterSWL</a>;</div>
<div class="line"><a id="l00072" name="l00072"></a><span class="lineno">   72</span>   }</div>
<div class="line"><a id="l00073" name="l00073"></a><span class="lineno">   73</span> </div>
<div class="line"><a id="l00074" name="l00074"></a><span class="lineno">   74</span>   <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a115ab27bae37ce2d0de57cbdaeaba852">m_dThisIterSWL</a> &lt; <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a8708807d3f7edb4af1e1a94fb3b0b542">m_dMinSWLSoFar</a>)</div>
<div class="line"><a id="l00075" name="l00075"></a><span class="lineno">   75</span>   {</div>
<div class="line"><a id="l00076" name="l00076"></a><span class="lineno">   76</span>      <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a56ea62dd03993be4b96f9a8db1fc1f7b">m_bLowestSWLSoFar</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00077" name="l00077"></a><span class="lineno">   77</span>      <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a8708807d3f7edb4af1e1a94fb3b0b542">m_dMinSWLSoFar</a> = <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a115ab27bae37ce2d0de57cbdaeaba852">m_dThisIterSWL</a>;</div>
<div class="line"><a id="l00078" name="l00078"></a><span class="lineno">   78</span>   }</div>
<div class="line"><a id="l00079" name="l00079"></a><span class="lineno">   79</span> </div>
<div class="line"><a id="l00080" name="l00080"></a><span class="lineno">   80</span>   <span class="comment">// Update the wave height, orientation and period for this time step and start again with the first record if we do not have enough</span></div>
<div class="line"><a id="l00081" name="l00081"></a><span class="lineno">   81</span>   <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a6f9031bd5d455f968fa2daa790582fe0">m_bHaveWaveStationData</a>)</div>
<div class="line"><a id="l00082" name="l00082"></a><span class="lineno">   82</span>   {</div>
<div class="line"><a id="l00083" name="l00083"></a><span class="lineno">   83</span>      <span class="keyword">static</span> <span class="keywordtype">int</span> snWaveStationDataCount = 0;</div>
<div class="line"><a id="l00084" name="l00084"></a><span class="lineno">   84</span> </div>
<div class="line"><a id="l00085" name="l00085"></a><span class="lineno">   85</span>      <span class="keywordflow">if</span> (snWaveStationDataCount &gt; <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a879caef8def45279b1627b9c4cef4898">m_nDeepWaterWaveDataNumTimeSteps</a> - 1)</div>
<div class="line"><a id="l00086" name="l00086"></a><span class="lineno">   86</span>      {</div>
<div class="line"><a id="l00087" name="l00087"></a><span class="lineno">   87</span>         <span class="comment">// Wrap the tide data, i.e. start again with the first record if we do not have enough</span></div>
<div class="line"><a id="l00088" name="l00088"></a><span class="lineno">   88</span>         snWaveStationDataCount = 0;</div>
<div class="line"><a id="l00089" name="l00089"></a><span class="lineno">   89</span>      }</div>
<div class="line"><a id="l00090" name="l00090"></a><span class="lineno">   90</span> </div>
<div class="line"><a id="l00091" name="l00091"></a><span class="lineno">   91</span>      <span class="comment">// Do we have just a single wave station?</span></div>
<div class="line"><a id="l00092" name="l00092"></a><span class="lineno">   92</span>      <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a2963505fabb1d12ef0d3e9de2efd35dc">m_bSingleDeepWaterWaveValues</a>)</div>
<div class="line"><a id="l00093" name="l00093"></a><span class="lineno">   93</span>      {</div>
<div class="line"><a id="l00094" name="l00094"></a><span class="lineno">   94</span>         <span class="comment">// Yes, just a single wave station</span></div>
<div class="line"><a id="l00095" name="l00095"></a><span class="lineno">   95</span>         <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a045629fd82b44f7aa4544f95d4500831">m_dAllCellsDeepWaterWaveHeight</a> = <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#af282f481ab4de736eaa0353517f0e1ac">m_VdTSDeepWaterWaveStationHeight</a>[snWaveStationDataCount];</div>
<div class="line"><a id="l00096" name="l00096"></a><span class="lineno">   96</span>         <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a8483ca176ba8397ba19f763e8406bf21">m_dAllCellsDeepWaterWaveAngle</a> = <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#afa1325c85a1a561fc8dc9be0bafa783c">m_VdTSDeepWaterWaveStationAngle</a>[snWaveStationDataCount];</div>
<div class="line"><a id="l00097" name="l00097"></a><span class="lineno">   97</span>         <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#ae63521034d80f14484277a9c1d76d004">m_dAllCellsDeepWaterWavePeriod</a> = <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a092a4d81476caa113aabf917b97ee7bc">m_VdTSDeepWaterWaveStationPeriod</a>[snWaveStationDataCount];</div>
<div class="line"><a id="l00098" name="l00098"></a><span class="lineno">   98</span>      }</div>
<div class="line"><a id="l00099" name="l00099"></a><span class="lineno">   99</span>      <span class="keywordflow">else</span></div>
<div class="line"><a id="l00100" name="l00100"></a><span class="lineno">  100</span>      {</div>
<div class="line"><a id="l00101" name="l00101"></a><span class="lineno">  101</span>         <span class="comment">// More than one wave station, so update this time step&#39;s deep water wave values for use in the nInterpolateAllDeepWaterWaveValues() routine. Note that the order on the vector is determined by the points ID i.e. to ensure that stations match with time series</span></div>
<div class="line"><a id="l00102" name="l00102"></a><span class="lineno">  102</span>         <span class="keywordtype">int</span> <span class="keyword">const</span> nNumberDeepWaterWaveStations = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a90b4069add3cc1669ed9450a0c9f7183">m_VnDeepWaterWaveStationID</a>.size());</div>
<div class="line"><a id="l00103" name="l00103"></a><span class="lineno">  103</span>         <span class="keywordtype">int</span> <span class="keyword">const</span> nTot = nNumberDeepWaterWaveStations * snWaveStationDataCount;</div>
<div class="line"><a id="l00104" name="l00104"></a><span class="lineno">  104</span> </div>
<div class="line"><a id="l00105" name="l00105"></a><span class="lineno">  105</span>         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; nNumberDeepWaterWaveStations; j++)</div>
<div class="line"><a id="l00106" name="l00106"></a><span class="lineno">  106</span>         {</div>
<div class="line"><a id="l00107" name="l00107"></a><span class="lineno">  107</span>            <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a5e3c5680aac8973f28c0ed1add48abc2">m_VdThisIterDeepWaterWaveStationHeight</a>[j] = <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#af282f481ab4de736eaa0353517f0e1ac">m_VdTSDeepWaterWaveStationHeight</a>[(<a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a90b4069add3cc1669ed9450a0c9f7183">m_VnDeepWaterWaveStationID</a>[j] - 1) + nTot];</div>
<div class="line"><a id="l00108" name="l00108"></a><span class="lineno">  108</span>            <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#ae055656af8a3af277b6eaa84cd11dd11">m_VdThisIterDeepWaterWaveStationAngle</a>[j] = <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#afa1325c85a1a561fc8dc9be0bafa783c">m_VdTSDeepWaterWaveStationAngle</a>[(<a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a90b4069add3cc1669ed9450a0c9f7183">m_VnDeepWaterWaveStationID</a>[j] - 1) + nTot];</div>
<div class="line"><a id="l00109" name="l00109"></a><span class="lineno">  109</span>            <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a7e010e95181519915b0dab1f9d9838ea">m_VdThisIterDeepWaterWaveStationPeriod</a>[j] = <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a092a4d81476caa113aabf917b97ee7bc">m_VdTSDeepWaterWaveStationPeriod</a>[(<a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a90b4069add3cc1669ed9450a0c9f7183">m_VnDeepWaterWaveStationID</a>[j] - 1) + nTot];</div>
<div class="line"><a id="l00110" name="l00110"></a><span class="lineno">  110</span>         }</div>
<div class="line"><a id="l00111" name="l00111"></a><span class="lineno">  111</span>      }</div>
<div class="line"><a id="l00112" name="l00112"></a><span class="lineno">  112</span> </div>
<div class="line"><a id="l00113" name="l00113"></a><span class="lineno">  113</span>      snWaveStationDataCount++;</div>
<div class="line"><a id="l00114" name="l00114"></a><span class="lineno">  114</span>   }</div>
<div class="line"><a id="l00115" name="l00115"></a><span class="lineno">  115</span> </div>
<div class="line"><a id="l00116" name="l00116"></a><span class="lineno">  116</span>   <span class="keywordflow">return</span> <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#aa768cb14b5c6123ee95e6e4ebd9fe331">RTN_OK</a>;</div>
<div class="line"><a id="l00117" name="l00117"></a><span class="lineno">  117</span>}</div>
</div>
<div class="ttc" id="aclassCSimulation_html_a045629fd82b44f7aa4544f95d4500831"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#a045629fd82b44f7aa4544f95d4500831">CSimulation::m_dAllCellsDeepWaterWaveHeight</a></div><div class="ttdeci">double m_dAllCellsDeepWaterWaveHeight</div><div class="ttdoc">Deep water wave height (m) for all sea cells.</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d6a/simulation_8h_source.html#l00760">simulation.h:760</a></div></div>
<div class="ttc" id="aclassCSimulation_html_a092a4d81476caa113aabf917b97ee7bc"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#a092a4d81476caa113aabf917b97ee7bc">CSimulation::m_VdTSDeepWaterWaveStationPeriod</a></div><div class="ttdeci">vector&lt; double &gt; m_VdTSDeepWaterWaveStationPeriod</div><div class="ttdoc">Time series of wave period at deep water wave station.</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d6a/simulation_8h_source.html#l01439">simulation.h:1439</a></div></div>
<div class="ttc" id="aclassCSimulation_html_a115ab27bae37ce2d0de57cbdaeaba852"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#a115ab27bae37ce2d0de57cbdaeaba852">CSimulation::m_dThisIterSWL</a></div><div class="ttdeci">double m_dThisIterSWL</div><div class="ttdoc">The still water level for this timestep (this includes tidal changes and any long-term SWL change)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d6a/simulation_8h_source.html#l00718">simulation.h:718</a></div></div>
<div class="ttc" id="aclassCSimulation_html_a222962121613613a48f518e0c2110f21"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#a222962121613613a48f518e0c2110f21">CSimulation::LogStream</a></div><div class="ttdeci">ofstream LogStream</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d6a/simulation_8h_source.html#l01873">simulation.h:1873</a></div></div>
<div class="ttc" id="aclassCSimulation_html_a2963505fabb1d12ef0d3e9de2efd35dc"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#a2963505fabb1d12ef0d3e9de2efd35dc">CSimulation::m_bSingleDeepWaterWaveValues</a></div><div class="ttdeci">bool m_bSingleDeepWaterWaveValues</div><div class="ttdoc">Do we have just a point source for (i.e. only a single measurement of) deep water wave values.</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d6a/simulation_8h_source.html#l00379">simulation.h:379</a></div></div>
<div class="ttc" id="aclassCSimulation_html_a2e53c27590e5217827b7e96000b2e4af"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#a2e53c27590e5217827b7e96000b2e4af">CSimulation::nCalcExternalForcing</a></div><div class="ttdeci">int nCalcExternalForcing(void)</div><div class="ttdoc">Calculate external forcings: change in still water level, tide level and deep water waves height,...</div><div class="ttdef"><b>Definition</b> <a href="#l00029">calc_external_forcing.cpp:29</a></div></div>
<div class="ttc" id="aclassCSimulation_html_a38c6f6701771a34a4a503fabbf50278b"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#a38c6f6701771a34a4a503fabbf50278b">CSimulation::m_VdTideData</a></div><div class="ttdeci">vector&lt; double &gt; m_VdTideData</div><div class="ttdoc">Tide data: one record per timestep, is the change (m) from still water level for that timestep.</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d6a/simulation_8h_source.html#l01415">simulation.h:1415</a></div></div>
<div class="ttc" id="aclassCSimulation_html_a3d22bbdc97592cd9c86dd5187cbc388b"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#a3d22bbdc97592cd9c86dd5187cbc388b">CSimulation::m_dMaxSWLSoFar</a></div><div class="ttdeci">double m_dMaxSWLSoFar</div><div class="ttdoc">Maximum still water level (m)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d6a/simulation_8h_source.html#l00730">simulation.h:730</a></div></div>
<div class="ttc" id="aclassCSimulation_html_a56ea62dd03993be4b96f9a8db1fc1f7b"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#a56ea62dd03993be4b96f9a8db1fc1f7b">CSimulation::m_bLowestSWLSoFar</a></div><div class="ttdeci">bool m_bLowestSWLSoFar</div><div class="ttdoc">Do we have the lowest SWL so far?</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d6a/simulation_8h_source.html#l00460">simulation.h:460</a></div></div>
<div class="ttc" id="aclassCSimulation_html_a58b6cf0c6be3c02086f0373a4dcd45cc"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#a58b6cf0c6be3c02086f0373a4dcd45cc">CSimulation::m_dInitialMeanSWL</a></div><div class="ttdeci">double m_dInitialMeanSWL</div><div class="ttdoc">The start-of-simulation still water level (m)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d6a/simulation_8h_source.html#l00709">simulation.h:709</a></div></div>
<div class="ttc" id="aclassCSimulation_html_a5e3c5680aac8973f28c0ed1add48abc2"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#a5e3c5680aac8973f28c0ed1add48abc2">CSimulation::m_VdThisIterDeepWaterWaveStationHeight</a></div><div class="ttdeci">vector&lt; double &gt; m_VdThisIterDeepWaterWaveStationHeight</div><div class="ttdoc">This-iteration wave height at deep water wave station.</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d6a/simulation_8h_source.html#l01424">simulation.h:1424</a></div></div>
<div class="ttc" id="aclassCSimulation_html_a6f9031bd5d455f968fa2daa790582fe0"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#a6f9031bd5d455f968fa2daa790582fe0">CSimulation::m_bHaveWaveStationData</a></div><div class="ttdeci">bool m_bHaveWaveStationData</div><div class="ttdoc">Do we have wave station data?</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d6a/simulation_8h_source.html#l00382">simulation.h:382</a></div></div>
<div class="ttc" id="aclassCSimulation_html_a7e010e95181519915b0dab1f9d9838ea"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#a7e010e95181519915b0dab1f9d9838ea">CSimulation::m_VdThisIterDeepWaterWaveStationPeriod</a></div><div class="ttdeci">vector&lt; double &gt; m_VdThisIterDeepWaterWaveStationPeriod</div><div class="ttdoc">This-iteration wave period at deep water wave station.</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d6a/simulation_8h_source.html#l01430">simulation.h:1430</a></div></div>
<div class="ttc" id="aclassCSimulation_html_a8483ca176ba8397ba19f763e8406bf21"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#a8483ca176ba8397ba19f763e8406bf21">CSimulation::m_dAllCellsDeepWaterWaveAngle</a></div><div class="ttdeci">double m_dAllCellsDeepWaterWaveAngle</div><div class="ttdoc">Deep water wave angle for all sea cells.</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d6a/simulation_8h_source.html#l00763">simulation.h:763</a></div></div>
<div class="ttc" id="aclassCSimulation_html_a8708807d3f7edb4af1e1a94fb3b0b542"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#a8708807d3f7edb4af1e1a94fb3b0b542">CSimulation::m_dMinSWLSoFar</a></div><div class="ttdeci">double m_dMinSWLSoFar</div><div class="ttdoc">Minimum still water level (m)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d6a/simulation_8h_source.html#l00727">simulation.h:727</a></div></div>
<div class="ttc" id="aclassCSimulation_html_a879caef8def45279b1627b9c4cef4898"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#a879caef8def45279b1627b9c4cef4898">CSimulation::m_nDeepWaterWaveDataNumTimeSteps</a></div><div class="ttdeci">int m_nDeepWaterWaveDataNumTimeSteps</div><div class="ttdoc">The duration of data for deep water waves, expressed as a number of timesteps.</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d6a/simulation_8h_source.html#l00577">simulation.h:577</a></div></div>
<div class="ttc" id="aclassCSimulation_html_a90b4069add3cc1669ed9450a0c9f7183"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#a90b4069add3cc1669ed9450a0c9f7183">CSimulation::m_VnDeepWaterWaveStationID</a></div><div class="ttdeci">vector&lt; int &gt; m_VnDeepWaterWaveStationID</div><div class="ttdoc">ID for deep water wave station, this corresponds with the ID in the wave time series file.</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d6a/simulation_8h_source.html#l01382">simulation.h:1382</a></div></div>
<div class="ttc" id="aclassCSimulation_html_a949f4dda2c9d3e16aede065412052b2f"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#a949f4dda2c9d3e16aede065412052b2f">CSimulation::m_bHighestSWLSoFar</a></div><div class="ttdeci">bool m_bHighestSWLSoFar</div><div class="ttdoc">Do we have the highest SWL so far?</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d6a/simulation_8h_source.html#l00457">simulation.h:457</a></div></div>
<div class="ttc" id="aclassCSimulation_html_a9d814ca72120a681f1fcbe21ff90cce9"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#a9d814ca72120a681f1fcbe21ff90cce9">CSimulation::m_dAccumulatedSeaLevelChange</a></div><div class="ttdeci">double m_dAccumulatedSeaLevelChange</div><div class="ttdoc">If long-term SWL changes, the total change (m) so far since the start of simulation.</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d6a/simulation_8h_source.html#l00724">simulation.h:724</a></div></div>
<div class="ttc" id="aclassCSimulation_html_aaa63b75c940b9bc39e5bbb0bf24db977"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#aaa63b75c940b9bc39e5bbb0bf24db977">CSimulation::m_dDeltaSWLPerTimestep</a></div><div class="ttdeci">double m_dDeltaSWLPerTimestep</div><div class="ttdoc">If long-term SWL changes, the increment per timestep.</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d6a/simulation_8h_source.html#l00715">simulation.h:715</a></div></div>
<div class="ttc" id="aclassCSimulation_html_abc1c620b4f32fb7175f6cdf761b1df92"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#abc1c620b4f32fb7175f6cdf761b1df92">CSimulation::m_dThisIterMHWElev</a></div><div class="ttdeci">double m_dThisIterMHWElev</div><div class="ttdoc">This iteration&#39;s Mean High Water (MHW) elevation, calculated using a moving time window....</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d6a/simulation_8h_source.html#l01039">simulation.h:1039</a></div></div>
<div class="ttc" id="aclassCSimulation_html_ac1b38807f9a54957dbd92bc457cd1097"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#ac1b38807f9a54957dbd92bc457cd1097">CSimulation::CalcMHWElevation</a></div><div class="ttdeci">void CalcMHWElevation(int const)</div><div class="ttdoc">Calculate Mean High Water (MHW) elevation for a given duration (in days). This is a tidal datum deter...</div><div class="ttdef"><b>Definition</b> <a href="../../de/d06/utils_8cpp_source.html#l03073">utils.cpp:3073</a></div></div>
<div class="ttc" id="aclassCSimulation_html_ad67e8c5b30a0572f64ecfb5c062c2edc"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#ad67e8c5b30a0572f64ecfb5c062c2edc">CSimulation::m_ulIter</a></div><div class="ttdeci">unsigned long m_ulIter</div><div class="ttdoc">The number of the current iteration (time step)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d6a/simulation_8h_source.html#l00601">simulation.h:601</a></div></div>
<div class="ttc" id="aclassCSimulation_html_ae055656af8a3af277b6eaa84cd11dd11"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#ae055656af8a3af277b6eaa84cd11dd11">CSimulation::m_VdThisIterDeepWaterWaveStationAngle</a></div><div class="ttdeci">vector&lt; double &gt; m_VdThisIterDeepWaterWaveStationAngle</div><div class="ttdoc">This-iteration wave orientation at deep water wave station.</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d6a/simulation_8h_source.html#l01427">simulation.h:1427</a></div></div>
<div class="ttc" id="aclassCSimulation_html_ae63521034d80f14484277a9c1d76d004"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#ae63521034d80f14484277a9c1d76d004">CSimulation::m_dAllCellsDeepWaterWavePeriod</a></div><div class="ttdeci">double m_dAllCellsDeepWaterWavePeriod</div><div class="ttdoc">Deep water wave period for all sea cells.</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d6a/simulation_8h_source.html#l00766">simulation.h:766</a></div></div>
<div class="ttc" id="aclassCSimulation_html_aebf28c80a84bcd6e3f295740fe6c21c9"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#aebf28c80a84bcd6e3f295740fe6c21c9">CSimulation::m_bDoCliffCollapse</a></div><div class="ttdeci">bool m_bDoCliffCollapse</div><div class="ttdoc">Simulate cliff collapse?</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d6a/simulation_8h_source.html#l00358">simulation.h:358</a></div></div>
<div class="ttc" id="aclassCSimulation_html_af282f481ab4de736eaa0353517f0e1ac"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#af282f481ab4de736eaa0353517f0e1ac">CSimulation::m_VdTSDeepWaterWaveStationHeight</a></div><div class="ttdeci">vector&lt; double &gt; m_VdTSDeepWaterWaveStationHeight</div><div class="ttdoc">Time series of wave heights at deep water wave station.</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d6a/simulation_8h_source.html#l01433">simulation.h:1433</a></div></div>
<div class="ttc" id="aclassCSimulation_html_af375727df124a4b1781d34976f1d90d3"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#af375727df124a4b1781d34976f1d90d3">CSimulation::m_dThisIterMeanSWL</a></div><div class="ttdeci">double m_dThisIterMeanSWL</div><div class="ttdoc">The mean still water level for this timestep (does not include tidal changes, but includes any long-t...</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d6a/simulation_8h_source.html#l00721">simulation.h:721</a></div></div>
<div class="ttc" id="aclassCSimulation_html_afa1325c85a1a561fc8dc9be0bafa783c"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#afa1325c85a1a561fc8dc9be0bafa783c">CSimulation::m_VdTSDeepWaterWaveStationAngle</a></div><div class="ttdeci">vector&lt; double &gt; m_VdTSDeepWaterWaveStationAngle</div><div class="ttdoc">Time series of wave orientation at deep water wave station.</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d6a/simulation_8h_source.html#l01436">simulation.h:1436</a></div></div>
<div class="ttc" id="acme_8h_html"><div class="ttname"><a href="../../d6/d2a/cme_8h.html">cme.h</a></div><div class="ttdoc">This file contains global definitions for CoastalME.</div></div>
<div class="ttc" id="acme_8h_html_aa768cb14b5c6123ee95e6e4ebd9fe331"><div class="ttname"><a href="../../d6/d2a/cme_8h.html#aa768cb14b5c6123ee95e6e4ebd9fe331">RTN_OK</a></div><div class="ttdeci">int const RTN_OK</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d2a/cme_8h_source.html#l00583">cme.h:583</a></div></div>
<div class="ttc" id="asimulation_8h_html"><div class="ttname"><a href="../../dd/d6a/simulation_8h.html">simulation.h</a></div><div class="ttdoc">Contains CSimulation definitions.</div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="../../d1/d58/calc__external__forcing_8cpp.html">calc_external_forcing.cpp</a></li>
    <li class="footer">Generated on Mon Nov 10 2025 15:48:19 for CoastalME (Coastal Modelling Environment) by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
</body>
</html>
