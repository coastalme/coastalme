<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>CoastalME (Coastal Modelling Environment): create_profiles.cpp Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<script type="text/javascript" src="../../clipboard.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../cookie.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">CoastalME (Coastal Modelling Environment)
   </div>
   <div id="projectbrief">Simulates the long-term behaviour of complex coastlines</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(1); });
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('da/db2/create__profiles_8cpp_source.html','../../'); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">create_profiles.cpp</div></div>
</div><!--header-->
<div class="contents">
<a href="../../da/db2/create__profiles_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno">    1</span></div>
<div class="line"><a id="l00012" name="l00012"></a><span class="lineno">   12</span> </div>
<div class="line"><a id="l00013" name="l00013"></a><span class="lineno">   13</span><span class="comment">/*==============================================================================================================================</span></div>
<div class="line"><a id="l00014" name="l00014"></a><span class="lineno">   14</span><span class="comment"></span> </div>
<div class="line"><a id="l00015" name="l00015"></a><span class="lineno">   15</span><span class="comment">This file is part of CoastalME, the Coastal Modelling Environment.</span></div>
<div class="line"><a id="l00016" name="l00016"></a><span class="lineno">   16</span><span class="comment"></span> </div>
<div class="line"><a id="l00017" name="l00017"></a><span class="lineno">   17</span><span class="comment">CoastalME is free software; you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation; either version 3 of the License, or (at your option) any later version.</span></div>
<div class="line"><a id="l00018" name="l00018"></a><span class="lineno">   18</span><span class="comment"></span> </div>
<div class="line"><a id="l00019" name="l00019"></a><span class="lineno">   19</span><span class="comment">This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.</span></div>
<div class="line"><a id="l00020" name="l00020"></a><span class="lineno">   20</span><span class="comment"></span> </div>
<div class="line"><a id="l00021" name="l00021"></a><span class="lineno">   21</span><span class="comment">You should have received a copy of the GNU General Public License along with this program; if not, write to the Free Software Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.</span></div>
<div class="line"><a id="l00022" name="l00022"></a><span class="lineno">   22</span><span class="comment"></span> </div>
<div class="line"><a id="l00023" name="l00023"></a><span class="lineno">   23</span><span class="comment">==============================================================================================================================*/</span></div>
<div class="line"><a id="l00024" name="l00024"></a><span class="lineno">   24</span><span class="preprocessor">#include &lt;assert.h&gt;</span></div>
<div class="line"><a id="l00025" name="l00025"></a><span class="lineno">   25</span> </div>
<div class="line"><a id="l00026" name="l00026"></a><span class="lineno">   26</span><span class="preprocessor">#include &lt;cmath&gt;</span></div>
<div class="line"><a id="l00027" name="l00027"></a><span class="lineno">   27</span><span class="preprocessor">#include &lt;cfloat&gt;</span></div>
<div class="line"><a id="l00028" name="l00028"></a><span class="lineno">   28</span> </div>
<div class="line"><a id="l00029" name="l00029"></a><span class="lineno">   29</span><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><a id="l00030" name="l00030"></a><span class="lineno">   30</span><span class="keyword">using </span>std::cerr;</div>
<div class="line"><a id="l00031" name="l00031"></a><span class="lineno">   31</span><span class="keyword">using </span>std::cout;</div>
<div class="line"><a id="l00032" name="l00032"></a><span class="lineno">   32</span><span class="keyword">using </span>std::endl;</div>
<div class="line"><a id="l00033" name="l00033"></a><span class="lineno">   33</span><span class="keyword">using </span>std::ios;</div>
<div class="line"><a id="l00034" name="l00034"></a><span class="lineno">   34</span> </div>
<div class="line"><a id="l00035" name="l00035"></a><span class="lineno">   35</span><span class="preprocessor">#include &lt;iomanip&gt;</span></div>
<div class="line"><a id="l00036" name="l00036"></a><span class="lineno">   36</span><span class="keyword">using </span>std::setiosflags;</div>
<div class="line"><a id="l00037" name="l00037"></a><span class="lineno">   37</span><span class="keyword">using </span>std::setprecision;</div>
<div class="line"><a id="l00038" name="l00038"></a><span class="lineno">   38</span> </div>
<div class="line"><a id="l00039" name="l00039"></a><span class="lineno">   39</span><span class="preprocessor">#include &lt;algorithm&gt;</span></div>
<div class="line"><a id="l00040" name="l00040"></a><span class="lineno">   40</span><span class="keyword">using </span>std::find;</div>
<div class="line"><a id="l00041" name="l00041"></a><span class="lineno">   41</span><span class="keyword">using </span>std::sort;</div>
<div class="line"><a id="l00042" name="l00042"></a><span class="lineno">   42</span> </div>
<div class="line"><a id="l00043" name="l00043"></a><span class="lineno">   43</span><span class="preprocessor">#include &lt;utility&gt;</span></div>
<div class="line"><a id="l00044" name="l00044"></a><span class="lineno">   44</span><span class="keyword">using </span>std::make_pair;</div>
<div class="line"><a id="l00045" name="l00045"></a><span class="lineno">   45</span><span class="keyword">using </span>std::pair;</div>
<div class="line"><a id="l00046" name="l00046"></a><span class="lineno">   46</span> </div>
<div class="line"><a id="l00047" name="l00047"></a><span class="lineno">   47</span><span class="preprocessor">#include &lt;random&gt;</span></div>
<div class="line"><a id="l00048" name="l00048"></a><span class="lineno">   48</span><span class="keyword">using </span>std::normal_distribution;</div>
<div class="line"><a id="l00049" name="l00049"></a><span class="lineno">   49</span> </div>
<div class="line"><a id="l00050" name="l00050"></a><span class="lineno">   50</span><span class="preprocessor">#include &quot;<a class="code" href="../../d6/d2a/cme_8h.html">cme.h</a>&quot;</span></div>
<div class="line"><a id="l00051" name="l00051"></a><span class="lineno">   51</span><span class="preprocessor">#include &quot;<a class="code" href="../../dd/d6a/simulation_8h.html">simulation.h</a>&quot;</span></div>
<div class="line"><a id="l00052" name="l00052"></a><span class="lineno">   52</span><span class="preprocessor">#include &quot;<a class="code" href="../../de/d65/coast_8h.html">coast.h</a>&quot;</span></div>
<div class="line"><a id="l00053" name="l00053"></a><span class="lineno">   53</span> </div>
<div class="line"><a id="l00054" name="l00054"></a><span class="lineno">   54</span><span class="comment">//===============================================================================================================================</span></div>
<div class="line"><a id="l00056" name="l00056"></a><span class="lineno">   56</span><span class="comment">//===============================================================================================================================</span></div>
<div class="foldopen" id="foldopen00057" data-start="{" data-end="}">
<div class="line"><a id="l00057" name="l00057"></a><span class="lineno"><a class="line" href="../../da/db2/create__profiles_8cpp.html#ae04a8509dc0ab747823a37fe3bb91f26">   57</a></span><span class="keywordtype">bool</span> <a class="code hl_function" href="../../da/db2/create__profiles_8cpp.html#ae04a8509dc0ab747823a37fe3bb91f26">bCurvaturePairCompareDescending</a>(<span class="keyword">const</span> pair&lt;int, double&gt;&amp; prLeft, <span class="keyword">const</span> pair&lt;int, double&gt;&amp; prRight)</div>
<div class="line"><a id="l00058" name="l00058"></a><span class="lineno">   58</span>{</div>
<div class="line"><a id="l00059" name="l00059"></a><span class="lineno">   59</span>   <span class="comment">// Sort in descending order (i.e. most concave first)</span></div>
<div class="line"><a id="l00060" name="l00060"></a><span class="lineno">   60</span>   <span class="keywordflow">return</span> prLeft.second &gt; prRight.second;</div>
<div class="line"><a id="l00061" name="l00061"></a><span class="lineno">   61</span>}</div>
</div>
<div class="line"><a id="l00062" name="l00062"></a><span class="lineno">   62</span> </div>
<div class="line"><a id="l00063" name="l00063"></a><span class="lineno">   63</span><span class="comment">//===============================================================================================================================</span></div>
<div class="line"><a id="l00065" name="l00065"></a><span class="lineno">   65</span><span class="comment">//===============================================================================================================================</span></div>
<div class="foldopen" id="foldopen00066" data-start="{" data-end="}">
<div class="line"><a id="l00066" name="l00066"></a><span class="lineno"><a class="line" href="../../d1/d98/classCSimulation.html#ab836aff6fe78298ad19c49b8c5d0ce12">   66</a></span><span class="keywordtype">int</span> <a class="code hl_function" href="../../d1/d98/classCSimulation.html#ab836aff6fe78298ad19c49b8c5d0ce12">CSimulation::nCreateAllProfiles</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a id="l00067" name="l00067"></a><span class="lineno">   67</span>{</div>
<div class="line"><a id="l00068" name="l00068"></a><span class="lineno">   68</span>   <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a0245d3cbdd603fbeced6ca1465eb3f16">m_nLogFileDetail</a> &gt;= <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#a540d8a94fc09b0b14fd8ab657445b67a">LOG_FILE_MIDDLE_DETAIL</a>)</div>
<div class="line"><a id="l00069" name="l00069"></a><span class="lineno">   69</span>      <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a222962121613613a48f518e0c2110f21">LogStream</a> &lt;&lt; <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#ad67e8c5b30a0572f64ecfb5c062c2edc">m_ulIter</a> &lt;&lt; <span class="stringliteral">&quot;: Creating profiles&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a id="l00070" name="l00070"></a><span class="lineno">   70</span> </div>
<div class="line"><a id="l00071" name="l00071"></a><span class="lineno">   71</span>   <span class="keywordtype">int</span> nProfileGlobalID = -1;</div>
<div class="line"><a id="l00072" name="l00072"></a><span class="lineno">   72</span> </div>
<div class="line"><a id="l00073" name="l00073"></a><span class="lineno">   73</span>   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nCoast = 0; nCoast &lt; <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a25ada8139c82ca7beab3f279cff83184">m_VCoast</a>.size(); nCoast++)</div>
<div class="line"><a id="l00074" name="l00074"></a><span class="lineno">   74</span>   {</div>
<div class="line"><a id="l00075" name="l00075"></a><span class="lineno">   75</span>      <span class="keywordtype">int</span> nProfile = 0;</div>
<div class="line"><a id="l00076" name="l00076"></a><span class="lineno">   76</span>      <span class="keywordtype">int</span> nCoastSize = <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a25ada8139c82ca7beab3f279cff83184">m_VCoast</a>[nCoast].nGetCoastlineSize();</div>
<div class="line"><a id="l00077" name="l00077"></a><span class="lineno">   77</span> </div>
<div class="line"><a id="l00078" name="l00078"></a><span class="lineno">   78</span>      <span class="comment">// Create a bool vector to mark coast points which have been searched</span></div>
<div class="line"><a id="l00079" name="l00079"></a><span class="lineno">   79</span>      vector&lt;bool&gt; bVCoastPointDone(nCoastSize, <span class="keyword">false</span>);</div>
<div class="line"><a id="l00080" name="l00080"></a><span class="lineno">   80</span> </div>
<div class="line"><a id="l00081" name="l00081"></a><span class="lineno">   81</span>      <span class="comment">// Now create a vector of pairs: the first value of the pair is the coastline point, the second is the coastline&#39;s curvature at that point</span></div>
<div class="line"><a id="l00082" name="l00082"></a><span class="lineno">   82</span>      vector&lt;pair&lt;int, double&gt;&gt; prVCurvature;</div>
<div class="line"><a id="l00083" name="l00083"></a><span class="lineno">   83</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> nCoastPoint = 0; nCoastPoint &lt; nCoastSize; nCoastPoint++)</div>
<div class="line"><a id="l00084" name="l00084"></a><span class="lineno">   84</span>      {</div>
<div class="line"><a id="l00085" name="l00085"></a><span class="lineno">   85</span>         <span class="keywordtype">double</span> dCurvature;</div>
<div class="line"><a id="l00086" name="l00086"></a><span class="lineno">   86</span>         <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a25ada8139c82ca7beab3f279cff83184">m_VCoast</a>[nCoast].pGetCoastLandform(nCoastPoint)-&gt;nGetLandFormCategory() != <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#afb9499d46447e0115ed3abc66ce28a7d">LF_CAT_INTERVENTION</a>)</div>
<div class="line"><a id="l00087" name="l00087"></a><span class="lineno">   87</span>         {</div>
<div class="line"><a id="l00088" name="l00088"></a><span class="lineno">   88</span>            <span class="comment">// Not an intervention coast point, so store the smoothed curvature</span></div>
<div class="line"><a id="l00089" name="l00089"></a><span class="lineno">   89</span>            dCurvature = <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a25ada8139c82ca7beab3f279cff83184">m_VCoast</a>[nCoast].dGetSmoothCurvature(nCoastPoint);</div>
<div class="line"><a id="l00090" name="l00090"></a><span class="lineno">   90</span>         }</div>
<div class="line"><a id="l00091" name="l00091"></a><span class="lineno">   91</span>         <span class="keywordflow">else</span></div>
<div class="line"><a id="l00092" name="l00092"></a><span class="lineno">   92</span>         {</div>
<div class="line"><a id="l00093" name="l00093"></a><span class="lineno">   93</span>            <span class="comment">// This is an intervention coast point, which is likely to have some sharp angles. So store the detailed curvature</span></div>
<div class="line"><a id="l00094" name="l00094"></a><span class="lineno">   94</span>            dCurvature = <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a25ada8139c82ca7beab3f279cff83184">m_VCoast</a>[nCoast].dGetDetailedCurvature(nCoastPoint);</div>
<div class="line"><a id="l00095" name="l00095"></a><span class="lineno">   95</span>         }</div>
<div class="line"><a id="l00096" name="l00096"></a><span class="lineno">   96</span>         prVCurvature.push_back(make_pair(nCoastPoint, dCurvature));</div>
<div class="line"><a id="l00097" name="l00097"></a><span class="lineno">   97</span>      }</div>
<div class="line"><a id="l00098" name="l00098"></a><span class="lineno">   98</span> </div>
<div class="line"><a id="l00099" name="l00099"></a><span class="lineno">   99</span>      <span class="comment">// Sort this pair vector in descending order, so that the most convex curvature points are first</span></div>
<div class="line"><a id="l00100" name="l00100"></a><span class="lineno">  100</span>      sort(prVCurvature.begin(), prVCurvature.end(), <a class="code hl_function" href="../../da/db2/create__profiles_8cpp.html#ae04a8509dc0ab747823a37fe3bb91f26">bCurvaturePairCompareDescending</a>);</div>
<div class="line"><a id="l00101" name="l00101"></a><span class="lineno">  101</span> </div>
<div class="line"><a id="l00102" name="l00102"></a><span class="lineno">  102</span>      <span class="comment">// // DEBUG CODE =======================================================================================================================</span></div>
<div class="line"><a id="l00103" name="l00103"></a><span class="lineno">  103</span>      <span class="comment">// for (int n = 0; n &lt; prVCurvature.size(); n++)</span></div>
<div class="line"><a id="l00104" name="l00104"></a><span class="lineno">  104</span>      <span class="comment">// {</span></div>
<div class="line"><a id="l00105" name="l00105"></a><span class="lineno">  105</span>      <span class="comment">//    LogStream &lt;&lt; prVCurvature[n].first &lt;&lt; &quot;\t&quot; &lt;&lt; prVCurvature[n].second &lt;&lt; endl;</span></div>
<div class="line"><a id="l00106" name="l00106"></a><span class="lineno">  106</span>      <span class="comment">// }</span></div>
<div class="line"><a id="l00107" name="l00107"></a><span class="lineno">  107</span>      <span class="comment">// LogStream &lt;&lt; endl &lt;&lt; endl;</span></div>
<div class="line"><a id="l00108" name="l00108"></a><span class="lineno">  108</span>      <span class="comment">// // DEBUG CODE =======================================================================================================================</span></div>
<div class="line"><a id="l00109" name="l00109"></a><span class="lineno">  109</span> </div>
<div class="line"><a id="l00110" name="l00110"></a><span class="lineno">  110</span>      <span class="comment">// And mark points at and near the start and end of the coastline so that they don&#39;t get searched (will be creating &#39;special&#39; start- and end-of-coast profiles at these end points later)</span></div>
<div class="line"><a id="l00111" name="l00111"></a><span class="lineno">  111</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n = 0; n &lt; <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a50e5297e7c9dd45da078e543c04151be">m_nCoastNormalSpacing</a>; n++)</div>
<div class="line"><a id="l00112" name="l00112"></a><span class="lineno">  112</span>      {</div>
<div class="line"><a id="l00113" name="l00113"></a><span class="lineno">  113</span>         <span class="keywordflow">if</span> (n &lt; nCoastSize)</div>
<div class="line"><a id="l00114" name="l00114"></a><span class="lineno">  114</span>            bVCoastPointDone[n] = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00115" name="l00115"></a><span class="lineno">  115</span> </div>
<div class="line"><a id="l00116" name="l00116"></a><span class="lineno">  116</span>         <span class="keywordtype">int</span> m = nCoastSize - n - 1;</div>
<div class="line"><a id="l00117" name="l00117"></a><span class="lineno">  117</span>         <span class="keywordflow">if</span> (m &gt;= 0)</div>
<div class="line"><a id="l00118" name="l00118"></a><span class="lineno">  118</span>            bVCoastPointDone[m] = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00119" name="l00119"></a><span class="lineno">  119</span>      }</div>
<div class="line"><a id="l00120" name="l00120"></a><span class="lineno">  120</span> </div>
<div class="line"><a id="l00121" name="l00121"></a><span class="lineno">  121</span>      <span class="comment">// Now locate the start points for all coastline-normal profiles (except the grid-edge ones), at points of maximum convexity. Then create the profiles</span></div>
<div class="line"><a id="l00122" name="l00122"></a><span class="lineno">  122</span>      <a class="code hl_function" href="../../d1/d98/classCSimulation.html#ad62124f880fbfa18774fc5fdd4de2dae">LocateAndCreateProfiles</a>(nCoast, nProfile, nProfileGlobalID, &amp;bVCoastPointDone, &amp;prVCurvature);</div>
<div class="line"><a id="l00123" name="l00123"></a><span class="lineno">  123</span> </div>
<div class="line"><a id="l00124" name="l00124"></a><span class="lineno">  124</span>      <span class="comment">// Did we fail to create any normal profiles? If so, quit</span></div>
<div class="line"><a id="l00125" name="l00125"></a><span class="lineno">  125</span>      <span class="keywordflow">if</span> (nProfile &lt; 0)</div>
<div class="line"><a id="l00126" name="l00126"></a><span class="lineno">  126</span>      {</div>
<div class="line"><a id="l00127" name="l00127"></a><span class="lineno">  127</span>         <span class="keywordtype">string</span> strErr = <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#a292fc90846543ca4814daa9f759feb05">ERR</a> + <span class="stringliteral">&quot;timestep &quot;</span> + <a class="code hl_function" href="../../d6/d2a/cme_8h.html#ac5528230f00386b7317458e308458f5e">strDblToStr</a>(<a class="code hl_variable" href="../../d1/d98/classCSimulation.html#ad67e8c5b30a0572f64ecfb5c062c2edc">m_ulIter</a>) + <span class="stringliteral">&quot;: could not create profiles for coastline &quot;</span> + <a class="code hl_function" href="../../d6/d2a/cme_8h.html#ac5528230f00386b7317458e308458f5e">strDblToStr</a>(nCoast);</div>
<div class="line"><a id="l00128" name="l00128"></a><span class="lineno">  128</span>         <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d1/d98/classCSimulation.html#ad67e8c5b30a0572f64ecfb5c062c2edc">m_ulIter</a> == 1)</div>
<div class="line"><a id="l00129" name="l00129"></a><span class="lineno">  129</span>            strErr += <span class="stringliteral">&quot;. Check the SWL&quot;</span>;</div>
<div class="line"><a id="l00130" name="l00130"></a><span class="lineno">  130</span>         strErr += <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l00131" name="l00131"></a><span class="lineno">  131</span> </div>
<div class="line"><a id="l00132" name="l00132"></a><span class="lineno">  132</span>         cerr &lt;&lt; strErr;</div>
<div class="line"><a id="l00133" name="l00133"></a><span class="lineno">  133</span>         <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a222962121613613a48f518e0c2110f21">LogStream</a> &lt;&lt; strErr;</div>
<div class="line"><a id="l00134" name="l00134"></a><span class="lineno">  134</span> </div>
<div class="line"><a id="l00135" name="l00135"></a><span class="lineno">  135</span>         <span class="keywordflow">return</span> <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#ab4869c0fb8ec425940f898430be5e46a">RTN_ERR_NO_PROFILES_1</a>;</div>
<div class="line"><a id="l00136" name="l00136"></a><span class="lineno">  136</span>      }</div>
<div class="line"><a id="l00137" name="l00137"></a><span class="lineno">  137</span> </div>
<div class="line"><a id="l00138" name="l00138"></a><span class="lineno">  138</span>      <span class="comment">// Locate and create a &#39;special&#39; profile at the grid edge, first at the beginning of the coastline. Then put this onto the raster grid</span></div>
<div class="line"><a id="l00139" name="l00139"></a><span class="lineno">  139</span>      <span class="keywordtype">int</span> nRet = <a class="code hl_function" href="../../d1/d98/classCSimulation.html#a45251d09c5a0822fd1ad9199016733d1">nLocateAndCreateGridEdgeProfile</a>(<span class="keyword">true</span>, nCoast, nProfile, nProfileGlobalID);</div>
<div class="line"><a id="l00140" name="l00140"></a><span class="lineno">  140</span>      <span class="keywordflow">if</span> (nRet != <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#aa768cb14b5c6123ee95e6e4ebd9fe331">RTN_OK</a>)</div>
<div class="line"><a id="l00141" name="l00141"></a><span class="lineno">  141</span>         <span class="keywordflow">return</span> nRet;</div>
<div class="line"><a id="l00142" name="l00142"></a><span class="lineno">  142</span> </div>
<div class="line"><a id="l00143" name="l00143"></a><span class="lineno">  143</span>      <span class="comment">// Locate a second &#39;special&#39; profile at the grid edge, this time at end of the coastline. Then put this onto the raster grid</span></div>
<div class="line"><a id="l00144" name="l00144"></a><span class="lineno">  144</span>      nRet = <a class="code hl_function" href="../../d1/d98/classCSimulation.html#a45251d09c5a0822fd1ad9199016733d1">nLocateAndCreateGridEdgeProfile</a>(<span class="keyword">false</span>, nCoast, ++nProfile, nProfileGlobalID);</div>
<div class="line"><a id="l00145" name="l00145"></a><span class="lineno">  145</span>      <span class="keywordflow">if</span> (nRet != <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#aa768cb14b5c6123ee95e6e4ebd9fe331">RTN_OK</a>)</div>
<div class="line"><a id="l00146" name="l00146"></a><span class="lineno">  146</span>         <span class="keywordflow">return</span> nRet;</div>
<div class="line"><a id="l00147" name="l00147"></a><span class="lineno">  147</span> </div>
<div class="line"><a id="l00148" name="l00148"></a><span class="lineno">  148</span>      <span class="comment">// Insert pointers to profiles at coastline points in the profile-all-coastpoint index</span></div>
<div class="line"><a id="l00149" name="l00149"></a><span class="lineno">  149</span>      <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a25ada8139c82ca7beab3f279cff83184">m_VCoast</a>[nCoast].InsertProfilesInProfileCoastPointIndex();</div>
<div class="line"><a id="l00150" name="l00150"></a><span class="lineno">  150</span> </div>
<div class="line"><a id="l00151" name="l00151"></a><span class="lineno">  151</span>      <span class="comment">// // DEBUG CODE ===================================================================================================</span></div>
<div class="line"><a id="l00152" name="l00152"></a><span class="lineno">  152</span>      <span class="comment">// LogStream &lt;&lt; endl &lt;&lt; &quot;===========================================================================================&quot; &lt;&lt; endl;</span></div>
<div class="line"><a id="l00153" name="l00153"></a><span class="lineno">  153</span>      <span class="comment">// LogStream &lt;&lt; &quot;PROFILES BEFORE ADDING BEFORE- AND AFTER-PROFILE NUMBERS&quot; &lt;&lt; endl;</span></div>
<div class="line"><a id="l00154" name="l00154"></a><span class="lineno">  154</span>      <span class="comment">// int nNumProfiles = m_VCoast[nCoast].nGetNumProfiles();</span></div>
<div class="line"><a id="l00155" name="l00155"></a><span class="lineno">  155</span>      <span class="comment">// for (int nn = 0; nn &lt; nNumProfiles; nn++)</span></div>
<div class="line"><a id="l00156" name="l00156"></a><span class="lineno">  156</span>      <span class="comment">// {</span></div>
<div class="line"><a id="l00157" name="l00157"></a><span class="lineno">  157</span>      <span class="comment">//    CGeomProfile* pProfile = m_VCoast[nCoast].pGetProfile(nn);</span></div>
<div class="line"><a id="l00158" name="l00158"></a><span class="lineno">  158</span>      <span class="comment">//</span></div>
<div class="line"><a id="l00159" name="l00159"></a><span class="lineno">  159</span>      <span class="comment">//    LogStream &lt;&lt; nn &lt;&lt; &quot; nCoastID = &quot; &lt;&lt; pProfile-&gt;nGetCoastID() &lt;&lt; &quot; nGlobalID = &quot; &lt;&lt; pProfile-&gt;nGetCoastID() &lt;&lt; &quot; nGetCoastPoint = &quot; &lt;&lt; pProfile-&gt;nGetCoastPoint() &lt;&lt; &quot; pGetUpCoastAdjacentProfile = &quot; &lt;&lt; pProfile-&gt;pGetUpCoastAdjacentProfile() &lt;&lt; &quot; pGetDownCoastAdjacentProfile = &quot; &lt;&lt; pProfile-&gt;pGetDownCoastAdjacentProfile() &lt;&lt; endl;</span></div>
<div class="line"><a id="l00160" name="l00160"></a><span class="lineno">  160</span>      <span class="comment">// }</span></div>
<div class="line"><a id="l00161" name="l00161"></a><span class="lineno">  161</span>      <span class="comment">// LogStream &lt;&lt; &quot;===================================================================================================&quot; &lt;&lt; endl &lt;&lt; endl;</span></div>
<div class="line"><a id="l00162" name="l00162"></a><span class="lineno">  162</span>      <span class="comment">// // DEBUG CODE ===================================================================================================</span></div>
<div class="line"><a id="l00163" name="l00163"></a><span class="lineno">  163</span> </div>
<div class="line"><a id="l00164" name="l00164"></a><span class="lineno">  164</span>      <span class="comment">// // DEBUG CODE ===================================================================================================</span></div>
<div class="line"><a id="l00165" name="l00165"></a><span class="lineno">  165</span>      <span class="comment">// int nProf = 0;</span></div>
<div class="line"><a id="l00166" name="l00166"></a><span class="lineno">  166</span>      <span class="comment">// for (int n = 0; n &lt; nCoastSize; n++)</span></div>
<div class="line"><a id="l00167" name="l00167"></a><span class="lineno">  167</span>      <span class="comment">// {</span></div>
<div class="line"><a id="l00168" name="l00168"></a><span class="lineno">  168</span>      <span class="comment">//    if (m_VCoast[nCoast].bIsProfileAtCoastPoint(n))</span></div>
<div class="line"><a id="l00169" name="l00169"></a><span class="lineno">  169</span>      <span class="comment">//    {</span></div>
<div class="line"><a id="l00170" name="l00170"></a><span class="lineno">  170</span>      <span class="comment">//       CGeomProfile* pProfile = m_VCoast[nCoast].pGetProfileAtCoastPoint(n);</span></div>
<div class="line"><a id="l00171" name="l00171"></a><span class="lineno">  171</span>      <span class="comment">//</span></div>
<div class="line"><a id="l00172" name="l00172"></a><span class="lineno">  172</span>      <span class="comment">//       LogStream &lt;&lt; &quot;profile &quot; &lt;&lt; pProfile-&gt;nGetCoastID() &lt;&lt; &quot; at coast point &quot; &lt;&lt; n &lt;&lt; &quot; adjacent up-coast profile = &quot; &lt;&lt; pProfile-&gt;pGetUpCoastAdjacentProfile() &lt;&lt; &quot; adjacent down-coast profile = &quot; &lt;&lt; pProfile-&gt;pGetDownCoastAdjacentProfile() &lt;&lt; endl;</span></div>
<div class="line"><a id="l00173" name="l00173"></a><span class="lineno">  173</span>      <span class="comment">//</span></div>
<div class="line"><a id="l00174" name="l00174"></a><span class="lineno">  174</span>      <span class="comment">//       nProf++;</span></div>
<div class="line"><a id="l00175" name="l00175"></a><span class="lineno">  175</span>      <span class="comment">//    }</span></div>
<div class="line"><a id="l00176" name="l00176"></a><span class="lineno">  176</span>      <span class="comment">// }</span></div>
<div class="line"><a id="l00177" name="l00177"></a><span class="lineno">  177</span>      <span class="comment">// LogStream &lt;&lt; endl;</span></div>
<div class="line"><a id="l00178" name="l00178"></a><span class="lineno">  178</span>      <span class="comment">// LogStream &lt;&lt; &quot;nProf = &quot; &lt;&lt; nProf &lt;&lt; endl;</span></div>
<div class="line"><a id="l00179" name="l00179"></a><span class="lineno">  179</span>      <span class="comment">// // DEBUG CODE ===================================================================================================</span></div>
<div class="line"><a id="l00180" name="l00180"></a><span class="lineno">  180</span> </div>
<div class="line"><a id="l00181" name="l00181"></a><span class="lineno">  181</span>      <span class="comment">// int nLastProfile;</span></div>
<div class="line"><a id="l00182" name="l00182"></a><span class="lineno">  182</span>      <span class="comment">// int nThisProfile;</span></div>
<div class="line"><a id="l00183" name="l00183"></a><span class="lineno">  183</span>      <a class="code hl_class" href="../../da/dae/classCGeomProfile.html">CGeomProfile</a>* pLastProfile;</div>
<div class="line"><a id="l00184" name="l00184"></a><span class="lineno">  184</span>      <a class="code hl_class" href="../../da/dae/classCGeomProfile.html">CGeomProfile</a>* pThisProfile;</div>
<div class="line"><a id="l00185" name="l00185"></a><span class="lineno">  185</span> </div>
<div class="line"><a id="l00186" name="l00186"></a><span class="lineno">  186</span>      <span class="comment">// Go along the coastline and give each profile the number of the adjacent up-coast profile and the adjacent down-coast profile</span></div>
<div class="line"><a id="l00187" name="l00187"></a><span class="lineno">  187</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> nCoastPoint = 0; nCoastPoint &lt; nCoastSize; nCoastPoint++)</div>
<div class="line"><a id="l00188" name="l00188"></a><span class="lineno">  188</span>      {</div>
<div class="line"><a id="l00189" name="l00189"></a><span class="lineno">  189</span>         <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a25ada8139c82ca7beab3f279cff83184">m_VCoast</a>[nCoast].bIsProfileAtCoastPoint(nCoastPoint))</div>
<div class="line"><a id="l00190" name="l00190"></a><span class="lineno">  190</span>         {</div>
<div class="line"><a id="l00191" name="l00191"></a><span class="lineno">  191</span>            pThisProfile = <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a25ada8139c82ca7beab3f279cff83184">m_VCoast</a>[nCoast].pGetProfileAtCoastPoint(nCoastPoint);</div>
<div class="line"><a id="l00192" name="l00192"></a><span class="lineno">  192</span>            <span class="comment">// nThisProfile = pThisProfile-&gt;nGetCoastID();</span></div>
<div class="line"><a id="l00193" name="l00193"></a><span class="lineno">  193</span> </div>
<div class="line"><a id="l00194" name="l00194"></a><span class="lineno">  194</span>            <span class="keywordflow">if</span> (nCoastPoint == 0)</div>
<div class="line"><a id="l00195" name="l00195"></a><span class="lineno">  195</span>            {</div>
<div class="line"><a id="l00196" name="l00196"></a><span class="lineno">  196</span>               pThisProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#a659efb6561fab81177a262e6e0d320f9">SetUpCoastAdjacentProfile</a>(NULL);</div>
<div class="line"><a id="l00197" name="l00197"></a><span class="lineno">  197</span> </div>
<div class="line"><a id="l00198" name="l00198"></a><span class="lineno">  198</span>               <span class="comment">// LogStream &lt;&lt; &quot;nCoastPoint = &quot; &lt;&lt; nCoastPoint &lt;&lt; &quot; ThisProfile = &quot; &lt;&lt; nThisProfile &lt;&lt; &quot; ThisProfile UpCoast = &quot; &lt;&lt; pThisProfile-&gt;pGetUpCoastAdjacentProfile() &lt;&lt; &quot; ThisProfile DownCoast = &quot; &lt;&lt; pThisProfile-&gt;pGetDownCoastAdjacentProfile() &lt;&lt; endl;</span></div>
<div class="line"><a id="l00199" name="l00199"></a><span class="lineno">  199</span> </div>
<div class="line"><a id="l00200" name="l00200"></a><span class="lineno">  200</span>               pLastProfile = pThisProfile;</div>
<div class="line"><a id="l00201" name="l00201"></a><span class="lineno">  201</span>               <span class="comment">// nLastProfile = nThisProfile;</span></div>
<div class="line"><a id="l00202" name="l00202"></a><span class="lineno">  202</span>               <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l00203" name="l00203"></a><span class="lineno">  203</span>            }</div>
<div class="line"><a id="l00204" name="l00204"></a><span class="lineno">  204</span> </div>
<div class="line"><a id="l00205" name="l00205"></a><span class="lineno">  205</span>            <span class="comment">// nLastProfile = pLastProfile-&gt;nGetCoastID();</span></div>
<div class="line"><a id="l00206" name="l00206"></a><span class="lineno">  206</span>            pLastProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#a95f2f276944ca8d48f6985a998d9efb6">SetDownCoastAdjacentProfile</a>(pThisProfile);</div>
<div class="line"><a id="l00207" name="l00207"></a><span class="lineno">  207</span>            pThisProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#a659efb6561fab81177a262e6e0d320f9">SetUpCoastAdjacentProfile</a>(pLastProfile);</div>
<div class="line"><a id="l00208" name="l00208"></a><span class="lineno">  208</span> </div>
<div class="line"><a id="l00209" name="l00209"></a><span class="lineno">  209</span>            <span class="keywordflow">if</span> (nCoastPoint == nCoastSize-1)</div>
<div class="line"><a id="l00210" name="l00210"></a><span class="lineno">  210</span>               pThisProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#a95f2f276944ca8d48f6985a998d9efb6">SetDownCoastAdjacentProfile</a>(NULL);</div>
<div class="line"><a id="l00211" name="l00211"></a><span class="lineno">  211</span> </div>
<div class="line"><a id="l00212" name="l00212"></a><span class="lineno">  212</span>            <span class="comment">// LogStream &lt;&lt; &quot;nCoastPoint = &quot; &lt;&lt; nCoastPoint &lt;&lt; &quot; LastProfile = &quot; &lt;&lt; nLastProfile &lt;&lt; &quot; LastProfile UpCoast = &quot; &lt;&lt; pLastProfile-&gt;pGetUpCoastAdjacentProfile() &lt;&lt; &quot; LastProfile DownCoast = &quot; &lt;&lt; pLastProfile-&gt;pGetDownCoastAdjacentProfile() &lt;&lt; &quot; ThisProfile = &quot; &lt;&lt; nThisProfile &lt;&lt; &quot; ThisProfile UpCoast = &quot; &lt;&lt; pThisProfile-&gt;pGetUpCoastAdjacentProfile() &lt;&lt; &quot; ThisProfile DownCoast = &quot; &lt;&lt; pThisProfile-&gt;pGetDownCoastAdjacentProfile() &lt;&lt; endl;</span></div>
<div class="line"><a id="l00213" name="l00213"></a><span class="lineno">  213</span> </div>
<div class="line"><a id="l00214" name="l00214"></a><span class="lineno">  214</span>            pLastProfile = pThisProfile;</div>
<div class="line"><a id="l00215" name="l00215"></a><span class="lineno">  215</span>            <span class="comment">// nLastProfile = nThisProfile;</span></div>
<div class="line"><a id="l00216" name="l00216"></a><span class="lineno">  216</span>         }</div>
<div class="line"><a id="l00217" name="l00217"></a><span class="lineno">  217</span>      }</div>
<div class="line"><a id="l00218" name="l00218"></a><span class="lineno">  218</span> </div>
<div class="line"><a id="l00219" name="l00219"></a><span class="lineno">  219</span>      <span class="comment">// And create an index to this coast&#39;s profiles in along-coastline sequence</span></div>
<div class="line"><a id="l00220" name="l00220"></a><span class="lineno">  220</span>      <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a25ada8139c82ca7beab3f279cff83184">m_VCoast</a>[nCoast].CreateProfileDownCoastIndex();</div>
<div class="line"><a id="l00221" name="l00221"></a><span class="lineno">  221</span> </div>
<div class="line"><a id="l00222" name="l00222"></a><span class="lineno">  222</span>      <span class="comment">// // DEBUG CODE =======================================================================================================================</span></div>
<div class="line"><a id="l00223" name="l00223"></a><span class="lineno">  223</span>      <span class="comment">// for (int n = 0; n &lt; m_VCoast[nCoast].nGetNumProfiles(); n++)</span></div>
<div class="line"><a id="l00224" name="l00224"></a><span class="lineno">  224</span>      <span class="comment">// {</span></div>
<div class="line"><a id="l00225" name="l00225"></a><span class="lineno">  225</span>      <span class="comment">//    CGeomProfile* pProfile = m_VCoast[nCoast].pGetProfileWithDownCoastSeq(n);</span></div>
<div class="line"><a id="l00226" name="l00226"></a><span class="lineno">  226</span>      <span class="comment">//    CGeomProfile* pUpCoastProfile = pProfile-&gt;pGetUpCoastAdjacentProfile();</span></div>
<div class="line"><a id="l00227" name="l00227"></a><span class="lineno">  227</span>      <span class="comment">//    CGeomProfile* pDownCoastProfile = pProfile-&gt;pGetDownCoastAdjacentProfile();</span></div>
<div class="line"><a id="l00228" name="l00228"></a><span class="lineno">  228</span>      <span class="comment">//    int nUpCoastProfile = INT_NODATA;</span></div>
<div class="line"><a id="l00229" name="l00229"></a><span class="lineno">  229</span>      <span class="comment">//    int nDownCoastProfile = INT_NODATA;</span></div>
<div class="line"><a id="l00230" name="l00230"></a><span class="lineno">  230</span>      <span class="comment">//    if (pUpCoastProfile != 0)</span></div>
<div class="line"><a id="l00231" name="l00231"></a><span class="lineno">  231</span>      <span class="comment">//       nUpCoastProfile = pUpCoastProfile-&gt;nGetCoastID();</span></div>
<div class="line"><a id="l00232" name="l00232"></a><span class="lineno">  232</span>      <span class="comment">//    if (pDownCoastProfile != 0)</span></div>
<div class="line"><a id="l00233" name="l00233"></a><span class="lineno">  233</span>      <span class="comment">//       nDownCoastProfile = pDownCoastProfile-&gt;nGetCoastID();</span></div>
<div class="line"><a id="l00234" name="l00234"></a><span class="lineno">  234</span>      <span class="comment">//    LogStream &lt;&lt; n &lt;&lt; &quot;\t nCoastID = &quot; &lt;&lt; pProfile-&gt;nGetCoastID() &lt;&lt; &quot;\tnGlobalID = &quot; &lt;&lt; pProfile-&gt;nGetGlobalID() &lt;&lt; &quot;\t up-coast profile = &quot; &lt;&lt; nUpCoastProfile &lt;&lt; &quot;\t down-coast profile = &quot; &lt;&lt; nDownCoastProfile &lt;&lt; endl;</span></div>
<div class="line"><a id="l00235" name="l00235"></a><span class="lineno">  235</span>      <span class="comment">// }</span></div>
<div class="line"><a id="l00236" name="l00236"></a><span class="lineno">  236</span>      <span class="comment">//    LogStream &lt;&lt; endl;</span></div>
<div class="line"><a id="l00237" name="l00237"></a><span class="lineno">  237</span>      <span class="comment">// // DEBUG CODE =======================================================================================================================</span></div>
<div class="line"><a id="l00238" name="l00238"></a><span class="lineno">  238</span> </div>
<div class="line"><a id="l00239" name="l00239"></a><span class="lineno">  239</span><span class="comment">//       // DEBUG CODE =======================================================================================================================</span></div>
<div class="line"><a id="l00240" name="l00240"></a><span class="lineno">  240</span><span class="comment">//       int nProf = 0;</span></div>
<div class="line"><a id="l00241" name="l00241"></a><span class="lineno">  241</span><span class="comment">//       for (int n = 0; n &lt; nCoastSize; n++)</span></div>
<div class="line"><a id="l00242" name="l00242"></a><span class="lineno">  242</span><span class="comment">//       {</span></div>
<div class="line"><a id="l00243" name="l00243"></a><span class="lineno">  243</span><span class="comment">//          // LogStream &lt;&lt; n &lt;&lt; &quot;\t&quot;;</span></div>
<div class="line"><a id="l00244" name="l00244"></a><span class="lineno">  244</span><span class="comment">//</span></div>
<div class="line"><a id="l00245" name="l00245"></a><span class="lineno">  245</span><span class="comment">// //          LogStream &lt;&lt; m_VCoast[nCoast].dGetDetailedCurvature(n) &lt;&lt; &quot;\t&quot;;</span></div>
<div class="line"><a id="l00246" name="l00246"></a><span class="lineno">  246</span><span class="comment">// //</span></div>
<div class="line"><a id="l00247" name="l00247"></a><span class="lineno">  247</span><span class="comment">// //          LogStream &lt;&lt; m_VCoast[nCoast].dGetSmoothCurvature(n) &lt;&lt; &quot;\t&quot;;</span></div>
<div class="line"><a id="l00248" name="l00248"></a><span class="lineno">  248</span><span class="comment">// //</span></div>
<div class="line"><a id="l00249" name="l00249"></a><span class="lineno">  249</span><span class="comment">// //          if (m_VCoast[nCoast].pGetCoastLandform(n)-&gt;nGetLandFormCategory() == LF_CAT_INTERVENTION)</span></div>
<div class="line"><a id="l00250" name="l00250"></a><span class="lineno">  250</span><span class="comment">// //             LogStream &lt;&lt; &quot;I\t&quot;;</span></div>
<div class="line"><a id="l00251" name="l00251"></a><span class="lineno">  251</span><span class="comment">//</span></div>
<div class="line"><a id="l00252" name="l00252"></a><span class="lineno">  252</span><span class="comment">//          if (m_VCoast[nCoast].bIsProfileAtCoastPoint(n))</span></div>
<div class="line"><a id="l00253" name="l00253"></a><span class="lineno">  253</span><span class="comment">//          {</span></div>
<div class="line"><a id="l00254" name="l00254"></a><span class="lineno">  254</span><span class="comment">//             CGeomProfile* pProfile = m_VCoast[nCoast].pGetProfileAtCoastPoint(n);</span></div>
<div class="line"><a id="l00255" name="l00255"></a><span class="lineno">  255</span><span class="comment">//</span></div>
<div class="line"><a id="l00256" name="l00256"></a><span class="lineno">  256</span><span class="comment">//             LogStream &lt;&lt; &quot;profile &quot; &lt;&lt; pProfile-&gt;nGetCoastID() &lt;&lt; &quot; at coast point &quot; &lt;&lt; n &lt;&lt; &quot; adjacent up-coast profile = &quot; &lt;&lt; pProfile-&gt;pGetUpCoastAdjacentProfile() &lt;&lt; &quot; adjacent down-coast profile = &quot; &lt;&lt; pProfile-&gt;pGetDownCoastAdjacentProfile() &lt;&lt; endl;</span></div>
<div class="line"><a id="l00257" name="l00257"></a><span class="lineno">  257</span><span class="comment">//</span></div>
<div class="line"><a id="l00258" name="l00258"></a><span class="lineno">  258</span><span class="comment">//             nProf++;</span></div>
<div class="line"><a id="l00259" name="l00259"></a><span class="lineno">  259</span><span class="comment">//          }</span></div>
<div class="line"><a id="l00260" name="l00260"></a><span class="lineno">  260</span><span class="comment">//       }</span></div>
<div class="line"><a id="l00261" name="l00261"></a><span class="lineno">  261</span><span class="comment">//       LogStream &lt;&lt; endl;</span></div>
<div class="line"><a id="l00262" name="l00262"></a><span class="lineno">  262</span><span class="comment">//       LogStream &lt;&lt; &quot;nProf = &quot; &lt;&lt; nProf &lt;&lt; endl;</span></div>
<div class="line"><a id="l00263" name="l00263"></a><span class="lineno">  263</span><span class="comment">//       // DEBUG CODE =======================================================================================================================</span></div>
<div class="line"><a id="l00264" name="l00264"></a><span class="lineno">  264</span> </div>
<div class="line"><a id="l00265" name="l00265"></a><span class="lineno">  265</span>      <span class="comment">// // DEBUG CODE =======================================================================================================================</span></div>
<div class="line"><a id="l00266" name="l00266"></a><span class="lineno">  266</span>      <span class="comment">// LogStream &lt;&lt; &quot;=====================&quot; &lt;&lt; endl;</span></div>
<div class="line"><a id="l00267" name="l00267"></a><span class="lineno">  267</span>      <span class="comment">// for (int n = 0; n &lt; m_VCoast[nCoast].nGetNumProfiles(); n++)</span></div>
<div class="line"><a id="l00268" name="l00268"></a><span class="lineno">  268</span>      <span class="comment">// {</span></div>
<div class="line"><a id="l00269" name="l00269"></a><span class="lineno">  269</span>      <span class="comment">//    CGeomProfile* pProfile = m_VCoast[nCoast].pGetProfileWithDownCoastSeq(n);</span></div>
<div class="line"><a id="l00270" name="l00270"></a><span class="lineno">  270</span>      <span class="comment">//    int nStartPoint = pProfile-&gt;nGetCoastPoint();</span></div>
<div class="line"><a id="l00271" name="l00271"></a><span class="lineno">  271</span>      <span class="comment">//</span></div>
<div class="line"><a id="l00272" name="l00272"></a><span class="lineno">  272</span>      <span class="comment">//    LogStream &lt;&lt; n &lt;&lt; &quot;\t nCoastID = &quot; &lt;&lt; pProfile-&gt;nGetCoastID() &lt;&lt; &quot;\tnGlobalID = &quot; &lt;&lt; pProfile-&gt;nGetGlobalID() &lt;&lt; &quot;\tnStartPoint = &quot; &lt;&lt; nStartPoint &lt;&lt; endl;</span></div>
<div class="line"><a id="l00273" name="l00273"></a><span class="lineno">  273</span>      <span class="comment">// }</span></div>
<div class="line"><a id="l00274" name="l00274"></a><span class="lineno">  274</span>      <span class="comment">//    LogStream &lt;&lt; endl;</span></div>
<div class="line"><a id="l00275" name="l00275"></a><span class="lineno">  275</span>      <span class="comment">// LogStream &lt;&lt; &quot;=====================&quot; &lt;&lt; endl;</span></div>
<div class="line"><a id="l00276" name="l00276"></a><span class="lineno">  276</span>      <span class="comment">// // DEBUG CODE =======================================================================================================================</span></div>
<div class="line"><a id="l00277" name="l00277"></a><span class="lineno">  277</span> </div>
<div class="line"><a id="l00278" name="l00278"></a><span class="lineno">  278</span>   }</div>
<div class="line"><a id="l00279" name="l00279"></a><span class="lineno">  279</span> </div>
<div class="line"><a id="l00280" name="l00280"></a><span class="lineno">  280</span>   <span class="keywordflow">return</span> <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#aa768cb14b5c6123ee95e6e4ebd9fe331">RTN_OK</a>;</div>
<div class="line"><a id="l00281" name="l00281"></a><span class="lineno">  281</span>}</div>
</div>
<div class="line"><a id="l00282" name="l00282"></a><span class="lineno">  282</span> </div>
<div class="line"><a id="l00283" name="l00283"></a><span class="lineno">  283</span><span class="comment">//===============================================================================================================================</span></div>
<div class="line"><a id="l00285" name="l00285"></a><span class="lineno">  285</span><span class="comment">//===============================================================================================================================</span></div>
<div class="foldopen" id="foldopen00286" data-start="{" data-end="}">
<div class="line"><a id="l00286" name="l00286"></a><span class="lineno"><a class="line" href="../../d1/d98/classCSimulation.html#ad62124f880fbfa18774fc5fdd4de2dae">  286</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="../../d1/d98/classCSimulation.html#ad62124f880fbfa18774fc5fdd4de2dae">CSimulation::LocateAndCreateProfiles</a>(<span class="keywordtype">int</span> <span class="keyword">const</span> nCoast, <span class="keywordtype">int</span>&amp; nProfile, <span class="keywordtype">int</span>&amp; nProfileGlobalID, vector&lt;bool&gt;* pbVCoastPointDone, vector&lt;pair&lt;int, double&gt;&gt; <span class="keyword">const</span>* prVCurvature)</div>
<div class="line"><a id="l00287" name="l00287"></a><span class="lineno">  287</span>{</div>
<div class="line"><a id="l00288" name="l00288"></a><span class="lineno">  288</span>   <span class="keywordtype">int</span> nCoastSize = <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a25ada8139c82ca7beab3f279cff83184">m_VCoast</a>[nCoast].nGetCoastlineSize();</div>
<div class="line"><a id="l00289" name="l00289"></a><span class="lineno">  289</span> </div>
<div class="line"><a id="l00290" name="l00290"></a><span class="lineno">  290</span>   <span class="comment">// Work along the vector of curvature pairs starting at the convex end</span></div>
<div class="line"><a id="l00291" name="l00291"></a><span class="lineno">  291</span>   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n = nCoastSize - 1; n &gt;= 0; n--)</div>
<div class="line"><a id="l00292" name="l00292"></a><span class="lineno">  292</span>   {</div>
<div class="line"><a id="l00293" name="l00293"></a><span class="lineno">  293</span>      <span class="comment">// Have we searched all the coastline points?</span></div>
<div class="line"><a id="l00294" name="l00294"></a><span class="lineno">  294</span>      <span class="keywordtype">int</span> nStillToSearch = 0;</div>
<div class="line"><a id="l00295" name="l00295"></a><span class="lineno">  295</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> m = 0; m &lt; nCoastSize; m++)</div>
<div class="line"><a id="l00296" name="l00296"></a><span class="lineno">  296</span>         <span class="keywordflow">if</span> (! pbVCoastPointDone-&gt;at(m))</div>
<div class="line"><a id="l00297" name="l00297"></a><span class="lineno">  297</span>            nStillToSearch++;</div>
<div class="line"><a id="l00298" name="l00298"></a><span class="lineno">  298</span> </div>
<div class="line"><a id="l00299" name="l00299"></a><span class="lineno">  299</span>      <span class="keywordflow">if</span> (nStillToSearch == 0)</div>
<div class="line"><a id="l00300" name="l00300"></a><span class="lineno">  300</span>         <span class="comment">// OK we are done here</span></div>
<div class="line"><a id="l00301" name="l00301"></a><span class="lineno">  301</span>         <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00302" name="l00302"></a><span class="lineno">  302</span> </div>
<div class="line"><a id="l00303" name="l00303"></a><span class="lineno">  303</span>      <span class="comment">// This convex point on the coastline is a potential location for a normal</span></div>
<div class="line"><a id="l00304" name="l00304"></a><span class="lineno">  304</span>      <span class="keywordtype">int</span> nNormalPoint = prVCurvature-&gt;at(n).first;</div>
<div class="line"><a id="l00305" name="l00305"></a><span class="lineno">  305</span> </div>
<div class="line"><a id="l00306" name="l00306"></a><span class="lineno">  306</span>      <span class="comment">// Ignore each end of the coastline</span></div>
<div class="line"><a id="l00307" name="l00307"></a><span class="lineno">  307</span>      <span class="keywordflow">if</span> ((nNormalPoint == 0) || (nNormalPoint == nCoastSize - 1))</div>
<div class="line"><a id="l00308" name="l00308"></a><span class="lineno">  308</span>         <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l00309" name="l00309"></a><span class="lineno">  309</span> </div>
<div class="line"><a id="l00310" name="l00310"></a><span class="lineno">  310</span>      <span class="comment">// TODO 089 When choosing locations for profiles, do coast first then interventions</span></div>
<div class="line"><a id="l00311" name="l00311"></a><span class="lineno">  311</span> </div>
<div class="line"><a id="l00312" name="l00312"></a><span class="lineno">  312</span>      <span class="keywordflow">if</span> (! pbVCoastPointDone-&gt;at(nNormalPoint))</div>
<div class="line"><a id="l00313" name="l00313"></a><span class="lineno">  313</span>      {</div>
<div class="line"><a id="l00314" name="l00314"></a><span class="lineno">  314</span>         <span class="comment">// We have not already searched this coast point. Is it an intervention coast point?</span></div>
<div class="line"><a id="l00315" name="l00315"></a><span class="lineno">  315</span>         <span class="keywordtype">bool</span> bIntervention = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00316" name="l00316"></a><span class="lineno">  316</span>         <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a25ada8139c82ca7beab3f279cff83184">m_VCoast</a>[nCoast].pGetCoastLandform(nNormalPoint)-&gt;nGetLandFormCategory() == <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#afb9499d46447e0115ed3abc66ce28a7d">LF_CAT_INTERVENTION</a>)</div>
<div class="line"><a id="l00317" name="l00317"></a><span class="lineno">  317</span>         {</div>
<div class="line"><a id="l00318" name="l00318"></a><span class="lineno">  318</span>            <span class="comment">// It is an intervention</span></div>
<div class="line"><a id="l00319" name="l00319"></a><span class="lineno">  319</span>            bIntervention = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00320" name="l00320"></a><span class="lineno">  320</span>         }</div>
<div class="line"><a id="l00321" name="l00321"></a><span class="lineno">  321</span> </div>
<div class="line"><a id="l00322" name="l00322"></a><span class="lineno">  322</span>         <a class="code hl_class" href="../../d6/d0d/classCGeom2DIPoint.html">CGeom2DIPoint</a> PtiThis = *<a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a25ada8139c82ca7beab3f279cff83184">m_VCoast</a>[nCoast].pPtiGetCellMarkedAsCoastline(nNormalPoint);</div>
<div class="line"><a id="l00323" name="l00323"></a><span class="lineno">  323</span> </div>
<div class="line"><a id="l00324" name="l00324"></a><span class="lineno">  324</span>         <span class="comment">// Create a profile here</span></div>
<div class="line"><a id="l00325" name="l00325"></a><span class="lineno">  325</span>         <span class="keywordtype">int</span> nRet = <a class="code hl_function" href="../../d1/d98/classCSimulation.html#acc448020e7a5073f9873c355645efeac">nCreateProfile</a>(nCoast, nCoastSize, nNormalPoint, nProfile, nProfileGlobalID, bIntervention, &amp;PtiThis);</div>
<div class="line"><a id="l00326" name="l00326"></a><span class="lineno">  326</span> </div>
<div class="line"><a id="l00327" name="l00327"></a><span class="lineno">  327</span>         <span class="comment">// // DEBUG CODE =================</span></div>
<div class="line"><a id="l00328" name="l00328"></a><span class="lineno">  328</span>         <span class="comment">// LogStream &lt;&lt; &quot;After nCreateProfile() ===========&quot; &lt;&lt; endl;</span></div>
<div class="line"><a id="l00329" name="l00329"></a><span class="lineno">  329</span>         <span class="comment">// CGeomProfile* pProfile = m_VCoast[nCoast].pGetProfile(nProfile);</span></div>
<div class="line"><a id="l00330" name="l00330"></a><span class="lineno">  330</span>         <span class="comment">// LogStream &lt;&lt; pProfile-&gt;nGetCoastID() &lt;&lt; &quot;\t&quot; &lt;&lt; pProfile-&gt;nGetGlobalID() &lt;&lt; &quot;\t&quot;;</span></div>
<div class="line"><a id="l00331" name="l00331"></a><span class="lineno">  331</span>         <span class="comment">//</span></div>
<div class="line"><a id="l00332" name="l00332"></a><span class="lineno">  332</span>         <span class="comment">// int nPointsInProfile = pProfile-&gt;nGetProfileSize();</span></div>
<div class="line"><a id="l00333" name="l00333"></a><span class="lineno">  333</span>         <span class="comment">//</span></div>
<div class="line"><a id="l00334" name="l00334"></a><span class="lineno">  334</span>         <span class="comment">// for (int nPoint = 0; nPoint &lt; nPointsInProfile; nPoint++)</span></div>
<div class="line"><a id="l00335" name="l00335"></a><span class="lineno">  335</span>         <span class="comment">// {</span></div>
<div class="line"><a id="l00336" name="l00336"></a><span class="lineno">  336</span>         <span class="comment">//    CGeom2DPoint Pt = *pProfile-&gt;pPtGetPointInProfile(nPoint);</span></div>
<div class="line"><a id="l00337" name="l00337"></a><span class="lineno">  337</span>         <span class="comment">//    LogStream &lt;&lt; &quot; {&quot; &lt;&lt; Pt.dGetX() &lt;&lt; &quot;, &quot; &lt;&lt; Pt.dGetY() &lt;&lt; &quot;}&quot;;</span></div>
<div class="line"><a id="l00338" name="l00338"></a><span class="lineno">  338</span>         <span class="comment">// }</span></div>
<div class="line"><a id="l00339" name="l00339"></a><span class="lineno">  339</span>         <span class="comment">// LogStream &lt;&lt; endl &lt;&lt; &quot;===========&quot; &lt;&lt; endl;</span></div>
<div class="line"><a id="l00340" name="l00340"></a><span class="lineno">  340</span>         <span class="comment">// // DEBUG CODE =================</span></div>
<div class="line"><a id="l00341" name="l00341"></a><span class="lineno">  341</span> </div>
<div class="line"><a id="l00342" name="l00342"></a><span class="lineno">  342</span>         <span class="comment">// Mark this coast point as searched</span></div>
<div class="line"><a id="l00343" name="l00343"></a><span class="lineno">  343</span>         pbVCoastPointDone-&gt;at(nNormalPoint) = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00344" name="l00344"></a><span class="lineno">  344</span> </div>
<div class="line"><a id="l00345" name="l00345"></a><span class="lineno">  345</span>         <span class="keywordflow">if</span> (nRet != <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#aa768cb14b5c6123ee95e6e4ebd9fe331">RTN_OK</a>)</div>
<div class="line"><a id="l00346" name="l00346"></a><span class="lineno">  346</span>         {</div>
<div class="line"><a id="l00347" name="l00347"></a><span class="lineno">  347</span>            <span class="comment">// This potential profile is no good (has hit coast, or hit dry land, etc.) so forget about it</span></div>
<div class="line"><a id="l00348" name="l00348"></a><span class="lineno">  348</span>            <span class="comment">// LogStream &lt;&lt; &quot;Profile is no good&quot; &lt;&lt; endl;</span></div>
<div class="line"><a id="l00349" name="l00349"></a><span class="lineno">  349</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l00350" name="l00350"></a><span class="lineno">  350</span>         }</div>
<div class="line"><a id="l00351" name="l00351"></a><span class="lineno">  351</span> </div>
<div class="line"><a id="l00352" name="l00352"></a><span class="lineno">  352</span>         <span class="comment">// // DEBUG CODE ===================================================================================================</span></div>
<div class="line"><a id="l00353" name="l00353"></a><span class="lineno">  353</span>         <span class="comment">// LogStream &lt;&lt; endl &lt;&lt; &quot;===========================================================================================&quot; &lt;&lt; endl;</span></div>
<div class="line"><a id="l00354" name="l00354"></a><span class="lineno">  354</span>         <span class="comment">// LogStream &lt;&lt; &quot;PROFILES JUST AFTER CREATION&quot; &lt;&lt; endl;</span></div>
<div class="line"><a id="l00355" name="l00355"></a><span class="lineno">  355</span>         <span class="comment">// int nNumProfiles = m_VCoast[nCoast].nGetNumProfiles();</span></div>
<div class="line"><a id="l00356" name="l00356"></a><span class="lineno">  356</span>         <span class="comment">// for (int nn = 0; nn &lt; nNumProfiles; nn++)</span></div>
<div class="line"><a id="l00357" name="l00357"></a><span class="lineno">  357</span>         <span class="comment">// {</span></div>
<div class="line"><a id="l00358" name="l00358"></a><span class="lineno">  358</span>         <span class="comment">//    CGeomProfile* pProfile = m_VCoast[nCoast].pGetProfile(nn);</span></div>
<div class="line"><a id="l00359" name="l00359"></a><span class="lineno">  359</span>         <span class="comment">//</span></div>
<div class="line"><a id="l00360" name="l00360"></a><span class="lineno">  360</span>         <span class="comment">//    LogStream &lt;&lt; nn &lt;&lt; &quot; nCoastID = &quot; &lt;&lt; pProfile-&gt;nGetCoastID() &lt;&lt; &quot; nGlobalID = &quot; &lt;&lt; pProfile-&gt;nGetCoastID() &lt;&lt; &quot; nGetCoastPoint = &quot; &lt;&lt; pProfile-&gt;nGetCoastPoint() &lt;&lt; &quot; pGetUpCoastAdjacentProfile = &quot; &lt;&lt; pProfile-&gt;pGetUpCoastAdjacentProfile() &lt;&lt; &quot; pGetDownCoastAdjacentProfile = &quot; &lt;&lt; pProfile-&gt;pGetDownCoastAdjacentProfile() &lt;&lt; endl;</span></div>
<div class="line"><a id="l00361" name="l00361"></a><span class="lineno">  361</span>         <span class="comment">// }</span></div>
<div class="line"><a id="l00362" name="l00362"></a><span class="lineno">  362</span>         <span class="comment">// LogStream &lt;&lt; &quot;===================================================================================================&quot; &lt;&lt; endl &lt;&lt; endl;</span></div>
<div class="line"><a id="l00363" name="l00363"></a><span class="lineno">  363</span>         <span class="comment">// // DEBUG CODE ===================================================================================================</span></div>
<div class="line"><a id="l00364" name="l00364"></a><span class="lineno">  364</span>         <span class="comment">//</span></div>
<div class="line"><a id="l00365" name="l00365"></a><span class="lineno">  365</span>         <span class="comment">// // DEBUG CODE ===================================================================================================</span></div>
<div class="line"><a id="l00366" name="l00366"></a><span class="lineno">  366</span>         <span class="comment">// LogStream &lt;&lt; &quot;++++++++++++++++++++++&quot; &lt;&lt; endl;</span></div>
<div class="line"><a id="l00367" name="l00367"></a><span class="lineno">  367</span>         <span class="comment">// LogStream &lt;&lt; endl &lt;&lt; &quot;Just created profile &quot; &lt;&lt; nProfile &lt;&lt; endl;</span></div>
<div class="line"><a id="l00368" name="l00368"></a><span class="lineno">  368</span>         <span class="comment">// int nProf = 0;</span></div>
<div class="line"><a id="l00369" name="l00369"></a><span class="lineno">  369</span>         <span class="comment">// for (int nnn = 0; nnn &lt; nCoastSize; nnn++)</span></div>
<div class="line"><a id="l00370" name="l00370"></a><span class="lineno">  370</span>         <span class="comment">// {</span></div>
<div class="line"><a id="l00371" name="l00371"></a><span class="lineno">  371</span>         <span class="comment">//    if (m_VCoast[nCoast].bIsProfileAtCoastPoint(nnn))</span></div>
<div class="line"><a id="l00372" name="l00372"></a><span class="lineno">  372</span>         <span class="comment">//    {</span></div>
<div class="line"><a id="l00373" name="l00373"></a><span class="lineno">  373</span>         <span class="comment">//       CGeomProfile* pProfile = m_VCoast[nCoast].pGetProfileAtCoastPoint(nnn);</span></div>
<div class="line"><a id="l00374" name="l00374"></a><span class="lineno">  374</span>         <span class="comment">//</span></div>
<div class="line"><a id="l00375" name="l00375"></a><span class="lineno">  375</span>         <span class="comment">//       LogStream &lt;&lt; &quot;profile &quot; &lt;&lt; pProfile-&gt;nGetCoastID() &lt;&lt; &quot; at coast point &quot; &lt;&lt; nnn &lt;&lt; &quot; adjacent up-coast profile = &quot; &lt;&lt; pProfile-&gt;pGetUpCoastAdjacentProfile() &lt;&lt; &quot; adjacent down-coast profile = &quot; &lt;&lt; pProfile-&gt;pGetDownCoastAdjacentProfile() &lt;&lt; endl;</span></div>
<div class="line"><a id="l00376" name="l00376"></a><span class="lineno">  376</span>         <span class="comment">//</span></div>
<div class="line"><a id="l00377" name="l00377"></a><span class="lineno">  377</span>         <span class="comment">//       nProf++;</span></div>
<div class="line"><a id="l00378" name="l00378"></a><span class="lineno">  378</span>         <span class="comment">//    }</span></div>
<div class="line"><a id="l00379" name="l00379"></a><span class="lineno">  379</span>         <span class="comment">// }</span></div>
<div class="line"><a id="l00380" name="l00380"></a><span class="lineno">  380</span>         <span class="comment">// LogStream &lt;&lt; endl;</span></div>
<div class="line"><a id="l00381" name="l00381"></a><span class="lineno">  381</span>         <span class="comment">// LogStream &lt;&lt; &quot;nProf = &quot; &lt;&lt; nProf &lt;&lt; endl;</span></div>
<div class="line"><a id="l00382" name="l00382"></a><span class="lineno">  382</span>         <span class="comment">// LogStream &lt;&lt; &quot;++++++++++++++++++++++&quot; &lt;&lt; endl;</span></div>
<div class="line"><a id="l00383" name="l00383"></a><span class="lineno">  383</span>         <span class="comment">// // DEBUG CODE ===================================================================================================</span></div>
<div class="line"><a id="l00384" name="l00384"></a><span class="lineno">  384</span> </div>
<div class="line"><a id="l00385" name="l00385"></a><span class="lineno">  385</span>         <span class="comment">// CGeom2DPoint PtThis = *m_VCoast[nCoast].pPtGetCoastlinePointExtCRS(nNormalPoint);</span></div>
<div class="line"><a id="l00386" name="l00386"></a><span class="lineno">  386</span>         <span class="comment">// if (m_nLogFileDetail &gt;= LOG_FILE_ALL)</span></div>
<div class="line"><a id="l00387" name="l00387"></a><span class="lineno">  387</span>         <span class="comment">//    LogStream &lt;&lt; m_ulIter &lt;&lt; &quot;: Coast &quot; &lt;&lt; nCoast &lt;&lt; &quot; profile &quot; &lt;&lt; nProfile &lt;&lt; &quot; created at coast point &quot; &lt;&lt; nNormalPoint &lt;&lt; &quot; [&quot; &lt;&lt; PtiThis.nGetX() &lt;&lt; &quot;][&quot; &lt;&lt; PtiThis.nGetY() &lt;&lt; &quot;] = {&quot; &lt;&lt; PtThis.dGetX() &lt;&lt; &quot;, &quot; &lt;&lt; PtThis.dGetY() &lt;&lt; &quot;} (smoothed curvature = &quot; &lt;&lt; m_VCoast[nCoast].dGetSmoothCurvature(nNormalPoint) &lt;&lt; &quot;, detailed curvature = &quot; &lt;&lt; m_VCoast[nCoast].dGetDetailedCurvature(nNormalPoint) &lt;&lt; &quot;)&quot; &lt;&lt; endl;</span></div>
<div class="line"><a id="l00388" name="l00388"></a><span class="lineno">  388</span> </div>
<div class="line"><a id="l00389" name="l00389"></a><span class="lineno">  389</span>         <span class="comment">// // DEBUG CODE =================================================================================</span></div>
<div class="line"><a id="l00390" name="l00390"></a><span class="lineno">  390</span>         <span class="comment">// if (m_pRasterGrid-&gt;m_Cell[PtiThis.nGetX()][PtiThis.nGetY()].bIsCoastline())</span></div>
<div class="line"><a id="l00391" name="l00391"></a><span class="lineno">  391</span>         <span class="comment">//    LogStream &lt;&lt; m_ulIter &lt;&lt; &quot;: cell[&quot; &lt;&lt; PtiThis.nGetX() &lt;&lt; &quot;][&quot; &lt;&lt; PtiThis.nGetY() &lt;&lt; &quot;] IS coastline&quot; &lt;&lt; endl;</span></div>
<div class="line"><a id="l00392" name="l00392"></a><span class="lineno">  392</span>         <span class="comment">// else</span></div>
<div class="line"><a id="l00393" name="l00393"></a><span class="lineno">  393</span>         <span class="comment">//    LogStream &lt;&lt; m_ulIter &lt;&lt; &quot;: ******* cell[&quot; &lt;&lt; PtiThis.nGetX() &lt;&lt; &quot;][&quot; &lt;&lt; PtiThis.nGetY() &lt;&lt; &quot;] IS NOT coastline&quot; &lt;&lt; endl;</span></div>
<div class="line"><a id="l00394" name="l00394"></a><span class="lineno">  394</span>         <span class="comment">// // DEBUG CODE =================================================================================</span></div>
<div class="line"><a id="l00395" name="l00395"></a><span class="lineno">  395</span> </div>
<div class="line"><a id="l00396" name="l00396"></a><span class="lineno">  396</span>         <span class="comment">// This profile is fine</span></div>
<div class="line"><a id="l00397" name="l00397"></a><span class="lineno">  397</span>         nProfile++;</div>
<div class="line"><a id="l00398" name="l00398"></a><span class="lineno">  398</span> </div>
<div class="line"><a id="l00399" name="l00399"></a><span class="lineno">  399</span>         <span class="comment">// We need to mark points on either side of this profile so that we don&#39;t get profiles which are too close together. However best-placed profiles on narrow intervention structures may need to be quite closes</span></div>
<div class="line"><a id="l00400" name="l00400"></a><span class="lineno">  400</span>         <span class="keywordtype">double</span> dNumToMark = <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a50e5297e7c9dd45da078e543c04151be">m_nCoastNormalSpacing</a>;</div>
<div class="line"><a id="l00401" name="l00401"></a><span class="lineno">  401</span>         <span class="keywordflow">if</span> (bIntervention)</div>
<div class="line"><a id="l00402" name="l00402"></a><span class="lineno">  402</span>            dNumToMark = <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a6d38a32401702ff85a6bb65c884db477">m_nCoastNormalInterventionSpacing</a>;</div>
<div class="line"><a id="l00403" name="l00403"></a><span class="lineno">  403</span> </div>
<div class="line"><a id="l00404" name="l00404"></a><span class="lineno">  404</span>         <span class="comment">// If we have a random factor for profile spacing, then modify the profile spacing</span></div>
<div class="line"><a id="l00405" name="l00405"></a><span class="lineno">  405</span>         <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d1/d98/classCSimulation.html#ac325da71378069a11991ee97e4cefb79">m_dCoastNormalRandSpacingFactor</a> &gt; 0)</div>
<div class="line"><a id="l00406" name="l00406"></a><span class="lineno">  406</span>         {</div>
<div class="line"><a id="l00407" name="l00407"></a><span class="lineno">  407</span>            <span class="comment">// Draw a sample from the unit normal distribution using random number generator 0</span></div>
<div class="line"><a id="l00408" name="l00408"></a><span class="lineno">  408</span>            <span class="keywordtype">double</span> dRand = <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a39b5fdbebb3ad6db9ca36ed73f7c47d6">m_dGetFromUnitNormalDist</a>(<a class="code hl_variable" href="../../d1/d98/classCSimulation.html#aab026ce32dae1272a2633b41dd9217d5">m_Rand</a>[0]);</div>
<div class="line"><a id="l00409" name="l00409"></a><span class="lineno">  409</span> </div>
<div class="line"><a id="l00410" name="l00410"></a><span class="lineno">  410</span>            <span class="keywordtype">double</span> dTmp = dRand * <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#ac325da71378069a11991ee97e4cefb79">m_dCoastNormalRandSpacingFactor</a> * dNumToMark;</div>
<div class="line"><a id="l00411" name="l00411"></a><span class="lineno">  411</span>            dNumToMark += dTmp;</div>
<div class="line"><a id="l00412" name="l00412"></a><span class="lineno">  412</span> </div>
<div class="line"><a id="l00413" name="l00413"></a><span class="lineno">  413</span>            <span class="comment">// Make sure number to mark is not too small or too big TODO 011</span></div>
<div class="line"><a id="l00414" name="l00414"></a><span class="lineno">  414</span>            <span class="keywordflow">if</span> (bIntervention)</div>
<div class="line"><a id="l00415" name="l00415"></a><span class="lineno">  415</span>            {</div>
<div class="line"><a id="l00416" name="l00416"></a><span class="lineno">  416</span>               dNumToMark = <a class="code hl_function" href="../../d6/d2a/cme_8h.html#a068017859403c0629d89f8d348f6c224">tMin</a>(dNumToMark, <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a6d38a32401702ff85a6bb65c884db477">m_nCoastNormalInterventionSpacing</a> * 0.5);</div>
<div class="line"><a id="l00417" name="l00417"></a><span class="lineno">  417</span>               dNumToMark = <a class="code hl_function" href="../../d6/d2a/cme_8h.html#a7e895b460cef877dec4d12ead0c74f15">tMax</a>(dNumToMark, <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a6d38a32401702ff85a6bb65c884db477">m_nCoastNormalInterventionSpacing</a> * 1.5);</div>
<div class="line"><a id="l00418" name="l00418"></a><span class="lineno">  418</span>            }</div>
<div class="line"><a id="l00419" name="l00419"></a><span class="lineno">  419</span>            <span class="keywordflow">else</span></div>
<div class="line"><a id="l00420" name="l00420"></a><span class="lineno">  420</span>            {</div>
<div class="line"><a id="l00421" name="l00421"></a><span class="lineno">  421</span>               dNumToMark = <a class="code hl_function" href="../../d6/d2a/cme_8h.html#a068017859403c0629d89f8d348f6c224">tMin</a>(dNumToMark, <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a50e5297e7c9dd45da078e543c04151be">m_nCoastNormalSpacing</a> * 0.5);</div>
<div class="line"><a id="l00422" name="l00422"></a><span class="lineno">  422</span>               dNumToMark = <a class="code hl_function" href="../../d6/d2a/cme_8h.html#a7e895b460cef877dec4d12ead0c74f15">tMax</a>(dNumToMark, <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a50e5297e7c9dd45da078e543c04151be">m_nCoastNormalSpacing</a> * 1.5);</div>
<div class="line"><a id="l00423" name="l00423"></a><span class="lineno">  423</span>            }</div>
<div class="line"><a id="l00424" name="l00424"></a><span class="lineno">  424</span> </div>
<div class="line"><a id="l00425" name="l00425"></a><span class="lineno">  425</span>            <span class="comment">// TODO 014 Assume that the above is the profile spacing on straight bits of coast. Try gradually increasing the profile spacing with increasing concavity, and decreasing the profile spacing with increasing convexity. Could use a Michaelis-Menten S-curve relationship for this i.e.</span></div>
<div class="line"><a id="l00426" name="l00426"></a><span class="lineno">  426</span><span class="comment">//          double fReN = pow(NowCell[nX][nY].dGetReynolds(m_dNu), m_dDepN);</span></div>
<div class="line"><a id="l00427" name="l00427"></a><span class="lineno">  427</span><span class="comment">//          double fC1 = m_dC1Laminar - ((m_dC1Diff * fReN) / (fReN + m_dReMidN));</span></div>
<div class="line"><a id="l00428" name="l00428"></a><span class="lineno">  428</span>         }</div>
<div class="line"><a id="l00429" name="l00429"></a><span class="lineno">  429</span> </div>
<div class="line"><a id="l00430" name="l00430"></a><span class="lineno">  430</span>         <span class="comment">// Mark points on either side of the profile</span></div>
<div class="line"><a id="l00431" name="l00431"></a><span class="lineno">  431</span>         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> m = 1; m &lt; dNumToMark; m++)</div>
<div class="line"><a id="l00432" name="l00432"></a><span class="lineno">  432</span>         {</div>
<div class="line"><a id="l00433" name="l00433"></a><span class="lineno">  433</span>            <span class="keywordtype">int</span> nTmpPoint = nNormalPoint + m;</div>
<div class="line"><a id="l00434" name="l00434"></a><span class="lineno">  434</span>            <span class="keywordflow">if</span> (nTmpPoint &lt; nCoastSize)</div>
<div class="line"><a id="l00435" name="l00435"></a><span class="lineno">  435</span>               pbVCoastPointDone-&gt;at(nTmpPoint) = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00436" name="l00436"></a><span class="lineno">  436</span> </div>
<div class="line"><a id="l00437" name="l00437"></a><span class="lineno">  437</span>            nTmpPoint = nNormalPoint - m;</div>
<div class="line"><a id="l00438" name="l00438"></a><span class="lineno">  438</span>            <span class="keywordflow">if</span> (nTmpPoint &gt;= 0)</div>
<div class="line"><a id="l00439" name="l00439"></a><span class="lineno">  439</span>               pbVCoastPointDone-&gt;at(nTmpPoint) = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00440" name="l00440"></a><span class="lineno">  440</span>         }</div>
<div class="line"><a id="l00441" name="l00441"></a><span class="lineno">  441</span>      }</div>
<div class="line"><a id="l00442" name="l00442"></a><span class="lineno">  442</span>   }</div>
<div class="line"><a id="l00443" name="l00443"></a><span class="lineno">  443</span>}</div>
</div>
<div class="line"><a id="l00444" name="l00444"></a><span class="lineno">  444</span> </div>
<div class="line"><a id="l00445" name="l00445"></a><span class="lineno">  445</span><span class="comment">//===============================================================================================================================</span></div>
<div class="line"><a id="l00447" name="l00447"></a><span class="lineno">  447</span><span class="comment">//===============================================================================================================================</span></div>
<div class="foldopen" id="foldopen00448" data-start="{" data-end="}">
<div class="line"><a id="l00448" name="l00448"></a><span class="lineno"><a class="line" href="../../d1/d98/classCSimulation.html#acc448020e7a5073f9873c355645efeac">  448</a></span><span class="keywordtype">int</span> <a class="code hl_function" href="../../d1/d98/classCSimulation.html#acc448020e7a5073f9873c355645efeac">CSimulation::nCreateProfile</a>(<span class="keywordtype">int</span> <span class="keyword">const</span> nCoast, <span class="keywordtype">int</span> <span class="keyword">const</span> nCoastSize, <span class="keywordtype">int</span> <span class="keyword">const</span> nProfileStartPoint, <span class="keywordtype">int</span> <span class="keyword">const</span> nProfile, <span class="keywordtype">int</span>&amp; pnProfileGlobalID, <span class="keywordtype">bool</span> <span class="keyword">const</span> bIntervention, <a class="code hl_class" href="../../d6/d0d/classCGeom2DIPoint.html">CGeom2DIPoint</a> <span class="keyword">const</span>* pPtiStart)</div>
<div class="line"><a id="l00449" name="l00449"></a><span class="lineno">  449</span>{</div>
<div class="line"><a id="l00450" name="l00450"></a><span class="lineno">  450</span>   <span class="comment">// OK, we have flagged the start point of this new coastline-normal profile, so create it. Make the start of the profile the centroid of the actual cell that is marked as coast (not the cell under the smoothed vector coast, they may well be different)</span></div>
<div class="line"><a id="l00451" name="l00451"></a><span class="lineno">  451</span>   <a class="code hl_class" href="../../d5/d4e/classCGeom2DPoint.html">CGeom2DPoint</a> PtStart;         <span class="comment">// In external CRS</span></div>
<div class="line"><a id="l00452" name="l00452"></a><span class="lineno">  452</span>   PtStart.<a class="code hl_function" href="../../d5/d4e/classCGeom2DPoint.html#af5dfdef4b78c0703800049b064483278">SetX</a>(<a class="code hl_function" href="../../d1/d98/classCSimulation.html#ad79b925ac5f358c6f867b6e47dad74bd">dGridCentroidXToExtCRSX</a>(pPtiStart-&gt;<a class="code hl_function" href="../../d6/d0d/classCGeom2DIPoint.html#af84c687b2d0be01ab41cbcc0565f4f3f">nGetX</a>()));</div>
<div class="line"><a id="l00453" name="l00453"></a><span class="lineno">  453</span>   PtStart.<a class="code hl_function" href="../../d5/d4e/classCGeom2DPoint.html#a1dff4e8adee61e6fe5c5062d6ba88f01">SetY</a>(<a class="code hl_function" href="../../d1/d98/classCSimulation.html#a7e2a4bd69ce79377fee86aa5598903f8">dGridCentroidYToExtCRSY</a>(pPtiStart-&gt;<a class="code hl_function" href="../../d6/d0d/classCGeom2DIPoint.html#a4d9c20bcca90dcb9d519b664aba09cbd">nGetY</a>()));</div>
<div class="line"><a id="l00454" name="l00454"></a><span class="lineno">  454</span> </div>
<div class="line"><a id="l00455" name="l00455"></a><span class="lineno">  455</span>   <a class="code hl_class" href="../../d5/d4e/classCGeom2DPoint.html">CGeom2DPoint</a> PtEnd;           <span class="comment">// In external CRS</span></div>
<div class="line"><a id="l00456" name="l00456"></a><span class="lineno">  456</span>   <a class="code hl_class" href="../../d6/d0d/classCGeom2DIPoint.html">CGeom2DIPoint</a> PtiEnd;         <span class="comment">// In grid CRS</span></div>
<div class="line"><a id="l00457" name="l00457"></a><span class="lineno">  457</span>   <span class="keywordtype">int</span> nRet = <a class="code hl_function" href="../../d1/d98/classCSimulation.html#a9a8f66d4a55299b92d4b1cea9e1d095e">nGetCoastNormalEndPoint</a>(nCoast, nProfileStartPoint, nCoastSize, &amp;PtStart, <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a25f96376f123bba1ac65b1a8588b3c24">m_dCoastNormalLength</a>, &amp;PtEnd, &amp;PtiEnd, bIntervention);</div>
<div class="line"><a id="l00458" name="l00458"></a><span class="lineno">  458</span>   <span class="keywordflow">if</span> (nRet == <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#ace82416ca7fb524bd4da49c3d402b082">RTN_ERR_NO_SOLUTION_FOR_ENDPOINT</a>)</div>
<div class="line"><a id="l00459" name="l00459"></a><span class="lineno">  459</span>   {</div>
<div class="line"><a id="l00460" name="l00460"></a><span class="lineno">  460</span>      <span class="comment">// Could not solve end-point equation, so forget about this profile</span></div>
<div class="line"><a id="l00461" name="l00461"></a><span class="lineno">  461</span>      <span class="keywordflow">return</span> nRet;      </div>
<div class="line"><a id="l00462" name="l00462"></a><span class="lineno">  462</span>   }</div>
<div class="line"><a id="l00463" name="l00463"></a><span class="lineno">  463</span> </div>
<div class="line"><a id="l00464" name="l00464"></a><span class="lineno">  464</span>   <span class="keywordtype">int</span> nXEnd = PtiEnd.<a class="code hl_function" href="../../d6/d0d/classCGeom2DIPoint.html#af84c687b2d0be01ab41cbcc0565f4f3f">nGetX</a>();</div>
<div class="line"><a id="l00465" name="l00465"></a><span class="lineno">  465</span>   <span class="keywordtype">int</span> nYEnd = PtiEnd.<a class="code hl_function" href="../../d6/d0d/classCGeom2DIPoint.html#a4d9c20bcca90dcb9d519b664aba09cbd">nGetY</a>();</div>
<div class="line"><a id="l00466" name="l00466"></a><span class="lineno">  466</span> </div>
<div class="line"><a id="l00467" name="l00467"></a><span class="lineno">  467</span>   <span class="comment">// Safety check: is the end point in the contiguous sea?</span></div>
<div class="line"><a id="l00468" name="l00468"></a><span class="lineno">  468</span>   <span class="keywordflow">if</span> (! <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[nXEnd][nYEnd].bIsInContiguousSea())</div>
<div class="line"><a id="l00469" name="l00469"></a><span class="lineno">  469</span>   {</div>
<div class="line"><a id="l00470" name="l00470"></a><span class="lineno">  470</span>      <span class="comment">// if (m_nLogFileDetail &gt;= LOG_FILE_ALL)</span></div>
<div class="line"><a id="l00471" name="l00471"></a><span class="lineno">  471</span>      <span class="comment">//    LogStream &lt;&lt; m_ulIter &lt;&lt; &quot;: coast &quot; &lt;&lt; nCoast &lt;&lt; &quot;, possible profile with start point &quot; &lt;&lt; nProfileStartPoint &lt;&lt; &quot; has inland end point at [&quot; &lt;&lt; nXEnd &lt;&lt; &quot;][&quot; &lt;&lt; nYEnd &lt;&lt; &quot;] = {&quot; &lt;&lt; dGridCentroidXToExtCRSX(nXEnd) &lt;&lt; &quot;, &quot; &lt;&lt; dGridCentroidYToExtCRSY(nYEnd) &lt;&lt; &quot;}, ignoring&quot; &lt;&lt; endl;</span></div>
<div class="line"><a id="l00472" name="l00472"></a><span class="lineno">  472</span> </div>
<div class="line"><a id="l00473" name="l00473"></a><span class="lineno">  473</span>      <span class="keywordflow">return</span> <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#a9e2e05614e11bb2eeecad6383fbe17bd">RTN_ERR_PROFILE_ENDPOINT_IS_INLAND</a>;</div>
<div class="line"><a id="l00474" name="l00474"></a><span class="lineno">  474</span>   }</div>
<div class="line"><a id="l00475" name="l00475"></a><span class="lineno">  475</span> </div>
<div class="line"><a id="l00476" name="l00476"></a><span class="lineno">  476</span>   <span class="comment">// Safety check: is the water depth at the end point less than the depth of closure?</span></div>
<div class="line"><a id="l00477" name="l00477"></a><span class="lineno">  477</span>   <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[nXEnd][nYEnd].dGetSeaDepth() &lt; <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#aecac3135005148dc01ee8ba3871b7fbf">m_dDepthOfClosure</a>)</div>
<div class="line"><a id="l00478" name="l00478"></a><span class="lineno">  478</span>   {</div>
<div class="line"><a id="l00479" name="l00479"></a><span class="lineno">  479</span>      <span class="comment">// if (m_nLogFileDetail &gt;= LOG_FILE_ALL)</span></div>
<div class="line"><a id="l00480" name="l00480"></a><span class="lineno">  480</span>      <span class="comment">//    LogStream &lt;&lt; m_ulIter &lt;&lt; &quot;: coast &quot; &lt;&lt; nCoast &lt;&lt; &quot;, possible profile with start point &quot; &lt;&lt; nProfileStartPoint &lt;&lt; &quot; is too short for depth of closure &quot; &lt;&lt; m_dDepthOfClosure &lt;&lt; &quot; at end point [&quot; &lt;&lt; nXEnd &lt;&lt; &quot;][&quot; &lt;&lt; nYEnd &lt;&lt; &quot;] = {&quot; &lt;&lt; dGridCentroidXToExtCRSX(nXEnd) &lt;&lt; &quot;, &quot; &lt;&lt; dGridCentroidYToExtCRSY(nYEnd) &lt;&lt; &quot;}, ignoring&quot; &lt;&lt; endl;</span></div>
<div class="line"><a id="l00481" name="l00481"></a><span class="lineno">  481</span> </div>
<div class="line"><a id="l00482" name="l00482"></a><span class="lineno">  482</span>      <span class="keywordflow">return</span> <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#a826c2bcca39c6c900b6d87757b2ab393">RTN_ERR_PROFILE_END_INSUFFICIENT_DEPTH</a>;</div>
<div class="line"><a id="l00483" name="l00483"></a><span class="lineno">  483</span>   }</div>
<div class="line"><a id="l00484" name="l00484"></a><span class="lineno">  484</span> </div>
<div class="line"><a id="l00485" name="l00485"></a><span class="lineno">  485</span>   <span class="comment">// No problems, so create the new profile</span></div>
<div class="line"><a id="l00486" name="l00486"></a><span class="lineno">  486</span>   <a class="code hl_class" href="../../da/dae/classCGeomProfile.html">CGeomProfile</a>* pProfile = <span class="keyword">new</span> <a class="code hl_class" href="../../da/dae/classCGeomProfile.html">CGeomProfile</a>(nCoast, nProfileStartPoint, nProfile, ++pnProfileGlobalID, pPtiStart, &amp;PtiEnd, bIntervention);</div>
<div class="line"><a id="l00487" name="l00487"></a><span class="lineno">  487</span> </div>
<div class="line"><a id="l00488" name="l00488"></a><span class="lineno">  488</span>   <span class="comment">// And create the profile&#39;s coastline-normal vector. Only two points (start and end points, both external CRS) are stored</span></div>
<div class="line"><a id="l00489" name="l00489"></a><span class="lineno">  489</span>   vector&lt;CGeom2DPoint&gt; VNormal;</div>
<div class="line"><a id="l00490" name="l00490"></a><span class="lineno">  490</span>   VNormal.push_back(PtStart);</div>
<div class="line"><a id="l00491" name="l00491"></a><span class="lineno">  491</span>   VNormal.push_back(PtEnd);</div>
<div class="line"><a id="l00492" name="l00492"></a><span class="lineno">  492</span> </div>
<div class="line"><a id="l00493" name="l00493"></a><span class="lineno">  493</span>   <span class="comment">// Set the start and end points (external CRS) of the profile</span></div>
<div class="line"><a id="l00494" name="l00494"></a><span class="lineno">  494</span>   pProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#ad6723e65baa685812bd966e5e2aad547">SetPointsInProfile</a>(&amp;VNormal);</div>
<div class="line"><a id="l00495" name="l00495"></a><span class="lineno">  495</span> </div>
<div class="line"><a id="l00496" name="l00496"></a><span class="lineno">  496</span>   <span class="comment">// Create the profile&#39;s CGeomMultiLine then set nProfile as the only co-incident profile of the only line segment</span></div>
<div class="line"><a id="l00497" name="l00497"></a><span class="lineno">  497</span>   pProfile-&gt;<a class="code hl_function" href="../../d0/d89/classCGeomMultiLine.html#a3f99a9c2ac66b75c432941ec88fc8538">AppendLineSegment</a>();</div>
<div class="line"><a id="l00498" name="l00498"></a><span class="lineno">  498</span>   pProfile-&gt;<a class="code hl_function" href="../../d0/d89/classCGeomMultiLine.html#a679d5893191ff6dc5ab6b9acd1f5c770">AppendCoincidentProfileToLineSegments</a>(make_pair(nProfile, 0));</div>
<div class="line"><a id="l00499" name="l00499"></a><span class="lineno">  499</span> </div>
<div class="line"><a id="l00500" name="l00500"></a><span class="lineno">  500</span>   <span class="comment">// Save the profile, note that several fields in the profile are still blank</span></div>
<div class="line"><a id="l00501" name="l00501"></a><span class="lineno">  501</span>   <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a25ada8139c82ca7beab3f279cff83184">m_VCoast</a>[nCoast].AppendProfile(pProfile);</div>
<div class="line"><a id="l00502" name="l00502"></a><span class="lineno">  502</span> </div>
<div class="line"><a id="l00503" name="l00503"></a><span class="lineno">  503</span>   <span class="comment">// // DEBUG CODE =================</span></div>
<div class="line"><a id="l00504" name="l00504"></a><span class="lineno">  504</span>   <span class="comment">// LogStream &lt;&lt; &quot;in nCreateProfile() ===========&quot; &lt;&lt; endl;</span></div>
<div class="line"><a id="l00505" name="l00505"></a><span class="lineno">  505</span>   <span class="comment">// // CGeomProfile* pProfile = m_VCoast[nCoast].pGetProfile(nProfile);</span></div>
<div class="line"><a id="l00506" name="l00506"></a><span class="lineno">  506</span>   <span class="comment">// LogStream &lt;&lt; pProfile-&gt;nGetCoastID() &lt;&lt; &quot;\t&quot; &lt;&lt; pProfile-&gt;nGetGlobalID() &lt;&lt; &quot;\t&quot;;</span></div>
<div class="line"><a id="l00507" name="l00507"></a><span class="lineno">  507</span>   <span class="comment">//</span></div>
<div class="line"><a id="l00508" name="l00508"></a><span class="lineno">  508</span>   <span class="comment">// int nPointsInProfile = pProfile-&gt;nGetProfileSize();</span></div>
<div class="line"><a id="l00509" name="l00509"></a><span class="lineno">  509</span>   <span class="comment">//</span></div>
<div class="line"><a id="l00510" name="l00510"></a><span class="lineno">  510</span>   <span class="comment">// for (int nPoint = 0; nPoint &lt; nPointsInProfile; nPoint++)</span></div>
<div class="line"><a id="l00511" name="l00511"></a><span class="lineno">  511</span>   <span class="comment">// {</span></div>
<div class="line"><a id="l00512" name="l00512"></a><span class="lineno">  512</span>   <span class="comment">//    CGeom2DPoint Pt = *pProfile-&gt;pPtGetPointInProfile(nPoint);</span></div>
<div class="line"><a id="l00513" name="l00513"></a><span class="lineno">  513</span>   <span class="comment">//    LogStream &lt;&lt; &quot; {&quot; &lt;&lt; Pt.dGetX() &lt;&lt; &quot;, &quot; &lt;&lt; Pt.dGetY() &lt;&lt; &quot;}&quot;;</span></div>
<div class="line"><a id="l00514" name="l00514"></a><span class="lineno">  514</span>   <span class="comment">// }</span></div>
<div class="line"><a id="l00515" name="l00515"></a><span class="lineno">  515</span>   <span class="comment">// LogStream &lt;&lt; endl &lt;&lt; &quot;===========&quot; &lt;&lt; endl;</span></div>
<div class="line"><a id="l00516" name="l00516"></a><span class="lineno">  516</span>   <span class="comment">// // DEBUG CODE =================</span></div>
<div class="line"><a id="l00517" name="l00517"></a><span class="lineno">  517</span> </div>
<div class="line"><a id="l00518" name="l00518"></a><span class="lineno">  518</span>   <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a222962121613613a48f518e0c2110f21">LogStream</a> &lt;&lt; <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#ad67e8c5b30a0572f64ecfb5c062c2edc">m_ulIter</a> &lt;&lt; <span class="stringliteral">&quot;: coast &quot;</span> &lt;&lt; nCoast &lt;&lt; <span class="stringliteral">&quot; profile &quot;</span> &lt;&lt; nProfile &lt;&lt; <span class="stringliteral">&quot; (nCoastID = &quot;</span> &lt;&lt; pProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#aacd98f9837c3c7cf7414764b73275fba">nGetCoastID</a>() &lt;&lt; <span class="stringliteral">&quot; nGlobalID = &quot;</span> &lt;&lt; pProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#aa089dda45ee56fe997e3e08a9ab2a305">nGetGlobalID</a>() &lt;&lt; <span class="stringliteral">&quot;) created at coast point &quot;</span> &lt;&lt; nProfileStartPoint &lt;&lt; <span class="stringliteral">&quot; from [&quot;</span> &lt;&lt; pPtiStart-&gt;<a class="code hl_function" href="../../d6/d0d/classCGeom2DIPoint.html#af84c687b2d0be01ab41cbcc0565f4f3f">nGetX</a>() &lt;&lt; <span class="stringliteral">&quot;][&quot;</span> &lt;&lt; pPtiStart-&gt;<a class="code hl_function" href="../../d6/d0d/classCGeom2DIPoint.html#a4d9c20bcca90dcb9d519b664aba09cbd">nGetY</a>() &lt;&lt; <span class="stringliteral">&quot;] = {&quot;</span> &lt;&lt; PtStart.<a class="code hl_function" href="../../d5/d4e/classCGeom2DPoint.html#a250f937d03cfdf6e0244b74ad2bf96a4">dGetX</a>() &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; PtStart.<a class="code hl_function" href="../../d5/d4e/classCGeom2DPoint.html#a216921dc2c592d9468e6430fee7c7719">dGetY</a>() &lt;&lt; <span class="stringliteral">&quot;} to [&quot;</span> &lt;&lt; PtiEnd.<a class="code hl_function" href="../../d6/d0d/classCGeom2DIPoint.html#af84c687b2d0be01ab41cbcc0565f4f3f">nGetX</a>() &lt;&lt; <span class="stringliteral">&quot;][&quot;</span> &lt;&lt; PtiEnd.<a class="code hl_function" href="../../d6/d0d/classCGeom2DIPoint.html#a4d9c20bcca90dcb9d519b664aba09cbd">nGetY</a>() &lt;&lt; <span class="stringliteral">&quot;] = {&quot;</span> &lt;&lt; PtEnd.<a class="code hl_function" href="../../d5/d4e/classCGeom2DPoint.html#a250f937d03cfdf6e0244b74ad2bf96a4">dGetX</a>() &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; PtEnd.<a class="code hl_function" href="../../d5/d4e/classCGeom2DPoint.html#a216921dc2c592d9468e6430fee7c7719">dGetY</a>() &lt;&lt; <span class="stringliteral">&quot;}&quot;</span> &lt;&lt; (pProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#a9fc2d8b0adabc8dfa5b7f8b8400d6252">bIsIntervention</a>() ? <span class="stringliteral">&quot;, from intervention&quot;</span> : <span class="stringliteral">&quot;&quot;</span>) &lt;&lt; endl;</div>
<div class="line"><a id="l00519" name="l00519"></a><span class="lineno">  519</span> </div>
<div class="line"><a id="l00520" name="l00520"></a><span class="lineno">  520</span>   <span class="keywordflow">return</span> <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#aa768cb14b5c6123ee95e6e4ebd9fe331">RTN_OK</a>;</div>
<div class="line"><a id="l00521" name="l00521"></a><span class="lineno">  521</span>}</div>
</div>
<div class="line"><a id="l00522" name="l00522"></a><span class="lineno">  522</span> </div>
<div class="line"><a id="l00523" name="l00523"></a><span class="lineno">  523</span><span class="comment">//===============================================================================================================================</span></div>
<div class="line"><a id="l00525" name="l00525"></a><span class="lineno">  525</span><span class="comment">//===============================================================================================================================</span></div>
<div class="foldopen" id="foldopen00526" data-start="{" data-end="}">
<div class="line"><a id="l00526" name="l00526"></a><span class="lineno"><a class="line" href="../../d1/d98/classCSimulation.html#a45251d09c5a0822fd1ad9199016733d1">  526</a></span><span class="keywordtype">int</span> <a class="code hl_function" href="../../d1/d98/classCSimulation.html#a45251d09c5a0822fd1ad9199016733d1">CSimulation::nLocateAndCreateGridEdgeProfile</a>(<span class="keywordtype">bool</span> <span class="keyword">const</span> bCoastStart, <span class="keywordtype">int</span> <span class="keyword">const</span> nCoast, <span class="keywordtype">int</span> &amp;nProfile, <span class="keywordtype">int</span>&amp; nProfileGlobalID)</div>
<div class="line"><a id="l00527" name="l00527"></a><span class="lineno">  527</span>{</div>
<div class="line"><a id="l00528" name="l00528"></a><span class="lineno">  528</span>   <span class="keywordtype">int</span> nCoastSize = <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a25ada8139c82ca7beab3f279cff83184">m_VCoast</a>[nCoast].nGetCoastlineSize();</div>
<div class="line"><a id="l00529" name="l00529"></a><span class="lineno">  529</span>   <span class="keywordtype">int</span> nHandedness = <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a25ada8139c82ca7beab3f279cff83184">m_VCoast</a>[nCoast].nGetSeaHandedness();</div>
<div class="line"><a id="l00530" name="l00530"></a><span class="lineno">  530</span>   <span class="keywordtype">int</span> nProfileLen = <a class="code hl_function" href="../../d2/dfd/utils__global_8cpp.html#a20842d0a19d0ca952c91f3e1eb175fee">nRound</a>(<a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a25f96376f123bba1ac65b1a8588b3c24">m_dCoastNormalLength</a> / <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#ae0de69c3d3acd6d52dc2ec2f456c0eb5">m_dCellSide</a>);                          <span class="comment">// Profile length in grid CRS</span></div>
<div class="line"><a id="l00531" name="l00531"></a><span class="lineno">  531</span>   <span class="keywordtype">int</span> nProfileStartEdge;</div>
<div class="line"><a id="l00532" name="l00532"></a><span class="lineno">  532</span> </div>
<div class="line"><a id="l00533" name="l00533"></a><span class="lineno">  533</span>   <a class="code hl_class" href="../../d6/d0d/classCGeom2DIPoint.html">CGeom2DIPoint</a> PtiProfileStart;                                                         <span class="comment">// In grid CRS</span></div>
<div class="line"><a id="l00534" name="l00534"></a><span class="lineno">  534</span>   vector&lt;CGeom2DIPoint&gt; VPtiNormalPoints;                                                <span class="comment">// In grid CRS</span></div>
<div class="line"><a id="l00535" name="l00535"></a><span class="lineno">  535</span> </div>
<div class="line"><a id="l00536" name="l00536"></a><span class="lineno">  536</span>   <span class="keywordflow">if</span> (bCoastStart)</div>
<div class="line"><a id="l00537" name="l00537"></a><span class="lineno">  537</span>   {</div>
<div class="line"><a id="l00538" name="l00538"></a><span class="lineno">  538</span>      <span class="comment">// At start of coast</span></div>
<div class="line"><a id="l00539" name="l00539"></a><span class="lineno">  539</span>      PtiProfileStart = *<a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a25ada8139c82ca7beab3f279cff83184">m_VCoast</a>[nCoast].pPtiGetCellMarkedAsCoastline(0);                <span class="comment">// Grid CRS</span></div>
<div class="line"><a id="l00540" name="l00540"></a><span class="lineno">  540</span>      nProfileStartEdge = <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a25ada8139c82ca7beab3f279cff83184">m_VCoast</a>[nCoast].nGetStartEdge();</div>
<div class="line"><a id="l00541" name="l00541"></a><span class="lineno">  541</span>   }</div>
<div class="line"><a id="l00542" name="l00542"></a><span class="lineno">  542</span>   <span class="keywordflow">else</span></div>
<div class="line"><a id="l00543" name="l00543"></a><span class="lineno">  543</span>   {</div>
<div class="line"><a id="l00544" name="l00544"></a><span class="lineno">  544</span>      <span class="comment">// At end of coast</span></div>
<div class="line"><a id="l00545" name="l00545"></a><span class="lineno">  545</span>      PtiProfileStart = *<a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a25ada8139c82ca7beab3f279cff83184">m_VCoast</a>[nCoast].pPtiGetCellMarkedAsCoastline(nCoastSize - 1);   <span class="comment">// Grid CRS</span></div>
<div class="line"><a id="l00546" name="l00546"></a><span class="lineno">  546</span>      nProfileStartEdge = <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a25ada8139c82ca7beab3f279cff83184">m_VCoast</a>[nCoast].nGetEndEdge();</div>
<div class="line"><a id="l00547" name="l00547"></a><span class="lineno">  547</span>   }</div>
<div class="line"><a id="l00548" name="l00548"></a><span class="lineno">  548</span> </div>
<div class="line"><a id="l00549" name="l00549"></a><span class="lineno">  549</span>   VPtiNormalPoints.push_back(PtiProfileStart);</div>
<div class="line"><a id="l00550" name="l00550"></a><span class="lineno">  550</span> </div>
<div class="line"><a id="l00551" name="l00551"></a><span class="lineno">  551</span>   <span class="comment">// Find the start cell in the list of edge cells</span></div>
<div class="line"><a id="l00552" name="l00552"></a><span class="lineno">  552</span>   <span class="keyword">auto</span> it = find(<a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a92e9b30175422af3683e614128c1e4ad">m_VEdgeCell</a>.begin(), <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a92e9b30175422af3683e614128c1e4ad">m_VEdgeCell</a>.end(), PtiProfileStart);</div>
<div class="line"><a id="l00553" name="l00553"></a><span class="lineno">  553</span>   <span class="keywordflow">if</span> (it == <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a92e9b30175422af3683e614128c1e4ad">m_VEdgeCell</a>.end())</div>
<div class="line"><a id="l00554" name="l00554"></a><span class="lineno">  554</span>   {</div>
<div class="line"><a id="l00555" name="l00555"></a><span class="lineno">  555</span>      <span class="comment">// Not found. This can happen because of rounding problems, i.e. the cell which was stored as the first cell of the raster coastline</span></div>
<div class="line"><a id="l00556" name="l00556"></a><span class="lineno">  556</span>      <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a0245d3cbdd603fbeced6ca1465eb3f16">m_nLogFileDetail</a> &gt;= <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#a540d8a94fc09b0b14fd8ab657445b67a">LOG_FILE_MIDDLE_DETAIL</a>)</div>
<div class="line"><a id="l00557" name="l00557"></a><span class="lineno">  557</span>         <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a222962121613613a48f518e0c2110f21">LogStream</a> &lt;&lt; <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#ad67e8c5b30a0572f64ecfb5c062c2edc">m_ulIter</a> &lt;&lt; <span class="stringliteral">&quot;: &quot;</span> &lt;&lt; <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#a292fc90846543ca4814daa9f759feb05">ERR</a> &lt;&lt; <span class="stringliteral">&quot; when constructing start-of-coast profile, [&quot;</span> &lt;&lt; PtiProfileStart.<a class="code hl_function" href="../../d6/d0d/classCGeom2DIPoint.html#af84c687b2d0be01ab41cbcc0565f4f3f">nGetX</a>() &lt;&lt; <span class="stringliteral">&quot;][&quot;</span> &lt;&lt; PtiProfileStart.<a class="code hl_function" href="../../d6/d0d/classCGeom2DIPoint.html#a4d9c20bcca90dcb9d519b664aba09cbd">nGetY</a>() &lt;&lt; <span class="stringliteral">&quot;] = {&quot;</span> &lt;&lt; <a class="code hl_function" href="../../d1/d98/classCSimulation.html#ad79b925ac5f358c6f867b6e47dad74bd">dGridCentroidXToExtCRSX</a>(PtiProfileStart.<a class="code hl_function" href="../../d6/d0d/classCGeom2DIPoint.html#af84c687b2d0be01ab41cbcc0565f4f3f">nGetX</a>()) &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; <a class="code hl_function" href="../../d1/d98/classCSimulation.html#a7e2a4bd69ce79377fee86aa5598903f8">dGridCentroidYToExtCRSY</a>(PtiProfileStart.<a class="code hl_function" href="../../d6/d0d/classCGeom2DIPoint.html#a4d9c20bcca90dcb9d519b664aba09cbd">nGetY</a>()) &lt;&lt; <span class="stringliteral">&quot;} not found in list of edge cells&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a id="l00558" name="l00558"></a><span class="lineno">  558</span> </div>
<div class="line"><a id="l00559" name="l00559"></a><span class="lineno">  559</span>      <span class="keywordflow">return</span> <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#a1fcc0be2e2596fdd6617288a184a0493">RTN_ERR_COAST_CANT_FIND_EDGE_CELL</a>;</div>
<div class="line"><a id="l00560" name="l00560"></a><span class="lineno">  560</span>   }</div>
<div class="line"><a id="l00561" name="l00561"></a><span class="lineno">  561</span> </div>
<div class="line"><a id="l00562" name="l00562"></a><span class="lineno">  562</span>   <span class="comment">// Found</span></div>
<div class="line"><a id="l00563" name="l00563"></a><span class="lineno">  563</span>   <span class="keywordtype">int</span> nPos = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(it - <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a92e9b30175422af3683e614128c1e4ad">m_VEdgeCell</a>.begin());</div>
<div class="line"><a id="l00564" name="l00564"></a><span class="lineno">  564</span> </div>
<div class="line"><a id="l00565" name="l00565"></a><span class="lineno">  565</span>   <span class="comment">// Now construct the edge profile, searching for edge cells</span></div>
<div class="line"><a id="l00566" name="l00566"></a><span class="lineno">  566</span>   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n = 0; n &lt; nProfileLen; n++)</div>
<div class="line"><a id="l00567" name="l00567"></a><span class="lineno">  567</span>   {</div>
<div class="line"><a id="l00568" name="l00568"></a><span class="lineno">  568</span>      <span class="keywordflow">if</span> (bCoastStart)</div>
<div class="line"><a id="l00569" name="l00569"></a><span class="lineno">  569</span>      {</div>
<div class="line"><a id="l00570" name="l00570"></a><span class="lineno">  570</span>         <span class="comment">// At start of coast</span></div>
<div class="line"><a id="l00571" name="l00571"></a><span class="lineno">  571</span>         <span class="keywordflow">if</span> (nHandedness == <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#afdd3411d0fa60c62522af14ea2a90570">LEFT_HANDED</a>)</div>
<div class="line"><a id="l00572" name="l00572"></a><span class="lineno">  572</span>         {</div>
<div class="line"><a id="l00573" name="l00573"></a><span class="lineno">  573</span>            <span class="comment">// The list of edge cells is in clockwise sequence, go in this direction</span></div>
<div class="line"><a id="l00574" name="l00574"></a><span class="lineno">  574</span>            nPos++;</div>
<div class="line"><a id="l00575" name="l00575"></a><span class="lineno">  575</span> </div>
<div class="line"><a id="l00576" name="l00576"></a><span class="lineno">  576</span>            <span class="keywordflow">if</span> (nPos &gt;= <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a92e9b30175422af3683e614128c1e4ad">m_VEdgeCell</a>.size()))</div>
<div class="line"><a id="l00577" name="l00577"></a><span class="lineno">  577</span>            {</div>
<div class="line"><a id="l00578" name="l00578"></a><span class="lineno">  578</span>               <span class="comment">// We&#39;ve reached the end of the list of edge cells before the profile is long enough. OK, we can live with this</span></div>
<div class="line"><a id="l00579" name="l00579"></a><span class="lineno">  579</span>               <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00580" name="l00580"></a><span class="lineno">  580</span>            }</div>
<div class="line"><a id="l00581" name="l00581"></a><span class="lineno">  581</span>         }</div>
<div class="line"><a id="l00582" name="l00582"></a><span class="lineno">  582</span>         <span class="keywordflow">else</span> <span class="comment">// Right-handed</span></div>
<div class="line"><a id="l00583" name="l00583"></a><span class="lineno">  583</span>         {</div>
<div class="line"><a id="l00584" name="l00584"></a><span class="lineno">  584</span>            <span class="comment">// The list of edge cells is in clockwise sequence, go in the opposite direction</span></div>
<div class="line"><a id="l00585" name="l00585"></a><span class="lineno">  585</span>            nPos--;</div>
<div class="line"><a id="l00586" name="l00586"></a><span class="lineno">  586</span> </div>
<div class="line"><a id="l00587" name="l00587"></a><span class="lineno">  587</span>            <span class="keywordflow">if</span> (nPos &lt; 0)</div>
<div class="line"><a id="l00588" name="l00588"></a><span class="lineno">  588</span>            {</div>
<div class="line"><a id="l00589" name="l00589"></a><span class="lineno">  589</span>               <span class="comment">// We&#39;ve reached the beginning of the list of edge cells before the profile is long enough. OK, we can live with this</span></div>
<div class="line"><a id="l00590" name="l00590"></a><span class="lineno">  590</span>               <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00591" name="l00591"></a><span class="lineno">  591</span>            }</div>
<div class="line"><a id="l00592" name="l00592"></a><span class="lineno">  592</span>         }</div>
<div class="line"><a id="l00593" name="l00593"></a><span class="lineno">  593</span>      }</div>
<div class="line"><a id="l00594" name="l00594"></a><span class="lineno">  594</span>      <span class="keywordflow">else</span></div>
<div class="line"><a id="l00595" name="l00595"></a><span class="lineno">  595</span>      {</div>
<div class="line"><a id="l00596" name="l00596"></a><span class="lineno">  596</span>         <span class="comment">// At end of coast</span></div>
<div class="line"><a id="l00597" name="l00597"></a><span class="lineno">  597</span>         <span class="keywordflow">if</span> (nHandedness == <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#afdd3411d0fa60c62522af14ea2a90570">LEFT_HANDED</a>)</div>
<div class="line"><a id="l00598" name="l00598"></a><span class="lineno">  598</span>         {</div>
<div class="line"><a id="l00599" name="l00599"></a><span class="lineno">  599</span>            <span class="comment">// The list of edge cells is in clockwise sequence, go in the opposite direction</span></div>
<div class="line"><a id="l00600" name="l00600"></a><span class="lineno">  600</span>            nPos--;</div>
<div class="line"><a id="l00601" name="l00601"></a><span class="lineno">  601</span> </div>
<div class="line"><a id="l00602" name="l00602"></a><span class="lineno">  602</span>            <span class="keywordflow">if</span> (nPos &lt; 0)</div>
<div class="line"><a id="l00603" name="l00603"></a><span class="lineno">  603</span>            {</div>
<div class="line"><a id="l00604" name="l00604"></a><span class="lineno">  604</span>               <span class="comment">// We&#39;ve reached the beginning of the list of edge cells before the profile is long enough. OK, we can live with this</span></div>
<div class="line"><a id="l00605" name="l00605"></a><span class="lineno">  605</span>               <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00606" name="l00606"></a><span class="lineno">  606</span>            }</div>
<div class="line"><a id="l00607" name="l00607"></a><span class="lineno">  607</span>         }</div>
<div class="line"><a id="l00608" name="l00608"></a><span class="lineno">  608</span>         <span class="keywordflow">else</span> <span class="comment">// Right-handed</span></div>
<div class="line"><a id="l00609" name="l00609"></a><span class="lineno">  609</span>         {</div>
<div class="line"><a id="l00610" name="l00610"></a><span class="lineno">  610</span>            <span class="comment">// The list of edge cells is in clockwise sequence, go in this direction</span></div>
<div class="line"><a id="l00611" name="l00611"></a><span class="lineno">  611</span>            nPos++;</div>
<div class="line"><a id="l00612" name="l00612"></a><span class="lineno">  612</span> </div>
<div class="line"><a id="l00613" name="l00613"></a><span class="lineno">  613</span>            <span class="keywordflow">if</span> (nPos &gt;= <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a92e9b30175422af3683e614128c1e4ad">m_VEdgeCell</a>.size()))</div>
<div class="line"><a id="l00614" name="l00614"></a><span class="lineno">  614</span>            {</div>
<div class="line"><a id="l00615" name="l00615"></a><span class="lineno">  615</span>               <span class="comment">// We&#39;ve reached the end of the list of edge cells before the profile is long enough. OK, we can live with this</span></div>
<div class="line"><a id="l00616" name="l00616"></a><span class="lineno">  616</span>               <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00617" name="l00617"></a><span class="lineno">  617</span>            }</div>
<div class="line"><a id="l00618" name="l00618"></a><span class="lineno">  618</span>         }</div>
<div class="line"><a id="l00619" name="l00619"></a><span class="lineno">  619</span>      }</div>
<div class="line"><a id="l00620" name="l00620"></a><span class="lineno">  620</span> </div>
<div class="line"><a id="l00621" name="l00621"></a><span class="lineno">  621</span>      <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d1/d98/classCSimulation.html#afd26dea91f56fe78fa7c9740c81156d9">m_VEdgeCellEdge</a>[nPos] != nProfileStartEdge)</div>
<div class="line"><a id="l00622" name="l00622"></a><span class="lineno">  622</span>      {</div>
<div class="line"><a id="l00623" name="l00623"></a><span class="lineno">  623</span>         <span class="comment">// We&#39;ve reached the end of a grid side before the profile is long enough. OK, we can live with this</span></div>
<div class="line"><a id="l00624" name="l00624"></a><span class="lineno">  624</span>         <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00625" name="l00625"></a><span class="lineno">  625</span>      }</div>
<div class="line"><a id="l00626" name="l00626"></a><span class="lineno">  626</span> </div>
<div class="line"><a id="l00627" name="l00627"></a><span class="lineno">  627</span>      <span class="comment">// Append this grid-edge cell, making sure that there is no gap between this and the previously-appended cell (if there is, will get problems with flood fill)</span></div>
<div class="line"><a id="l00628" name="l00628"></a><span class="lineno">  628</span>      <a class="code hl_function" href="../../d1/d98/classCSimulation.html#ad63ccb95ae85ca79a6f511f3777a6fda">AppendEnsureNoGap</a>(&amp;VPtiNormalPoints, &amp;<a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a92e9b30175422af3683e614128c1e4ad">m_VEdgeCell</a>[nPos]);</div>
<div class="line"><a id="l00629" name="l00629"></a><span class="lineno">  629</span>   }</div>
<div class="line"><a id="l00630" name="l00630"></a><span class="lineno">  630</span> </div>
<div class="line"><a id="l00631" name="l00631"></a><span class="lineno">  631</span>   <span class="keywordtype">int</span> nProfileStartPoint;</div>
<div class="line"><a id="l00632" name="l00632"></a><span class="lineno">  632</span>   <a class="code hl_class" href="../../da/dae/classCGeomProfile.html">CGeomProfile</a>* pProfile;</div>
<div class="line"><a id="l00633" name="l00633"></a><span class="lineno">  633</span>   <a class="code hl_class" href="../../d6/d0d/classCGeom2DIPoint.html">CGeom2DIPoint</a> PtiDummy(<a class="code hl_variable" href="../../d6/d2a/cme_8h.html#a01aa8b423260b337ddff2016107b51a0">INT_NODATA</a>, <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#a01aa8b423260b337ddff2016107b51a0">INT_NODATA</a>);</div>
<div class="line"><a id="l00634" name="l00634"></a><span class="lineno">  634</span>   <span class="keywordflow">if</span> (bCoastStart)</div>
<div class="line"><a id="l00635" name="l00635"></a><span class="lineno">  635</span>   {</div>
<div class="line"><a id="l00636" name="l00636"></a><span class="lineno">  636</span>      nProfileStartPoint = 0;</div>
<div class="line"><a id="l00637" name="l00637"></a><span class="lineno">  637</span> </div>
<div class="line"><a id="l00638" name="l00638"></a><span class="lineno">  638</span>      <span class="comment">// Create the new start-of-coast profile</span></div>
<div class="line"><a id="l00639" name="l00639"></a><span class="lineno">  639</span>      pProfile = <span class="keyword">new</span> <a class="code hl_class" href="../../da/dae/classCGeomProfile.html">CGeomProfile</a>(nCoast, nProfileStartPoint, nProfile, ++nProfileGlobalID, &amp;PtiProfileStart, &amp;PtiDummy, <span class="keyword">false</span>);</div>
<div class="line"><a id="l00640" name="l00640"></a><span class="lineno">  640</span> </div>
<div class="line"><a id="l00641" name="l00641"></a><span class="lineno">  641</span>      <span class="comment">// Mark this as a start-of-coast profile</span></div>
<div class="line"><a id="l00642" name="l00642"></a><span class="lineno">  642</span>      pProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#a5bb5e15188369a41d0ae784e6a9ed044">SetStartOfCoast</a>(<span class="keyword">true</span>);</div>
<div class="line"><a id="l00643" name="l00643"></a><span class="lineno">  643</span>   }</div>
<div class="line"><a id="l00644" name="l00644"></a><span class="lineno">  644</span>   <span class="keywordflow">else</span></div>
<div class="line"><a id="l00645" name="l00645"></a><span class="lineno">  645</span>   {</div>
<div class="line"><a id="l00646" name="l00646"></a><span class="lineno">  646</span>      nProfileStartPoint = nCoastSize-1;</div>
<div class="line"><a id="l00647" name="l00647"></a><span class="lineno">  647</span> </div>
<div class="line"><a id="l00648" name="l00648"></a><span class="lineno">  648</span>      <span class="comment">// Create the new end-of-coast profile</span></div>
<div class="line"><a id="l00649" name="l00649"></a><span class="lineno">  649</span>      pProfile = <span class="keyword">new</span> <a class="code hl_class" href="../../da/dae/classCGeomProfile.html">CGeomProfile</a>(nCoast, nProfileStartPoint, nProfile, ++nProfileGlobalID, &amp;PtiProfileStart, &amp;PtiDummy, <span class="keyword">false</span>);</div>
<div class="line"><a id="l00650" name="l00650"></a><span class="lineno">  650</span> </div>
<div class="line"><a id="l00651" name="l00651"></a><span class="lineno">  651</span>      <span class="comment">// Mark this as an end-of-coast profile</span></div>
<div class="line"><a id="l00652" name="l00652"></a><span class="lineno">  652</span>      pProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#a11548359d3db93535befcaf518468f64">SetEndOfCoast</a>(<span class="keyword">true</span>);</div>
<div class="line"><a id="l00653" name="l00653"></a><span class="lineno">  653</span>   }</div>
<div class="line"><a id="l00654" name="l00654"></a><span class="lineno">  654</span> </div>
<div class="line"><a id="l00655" name="l00655"></a><span class="lineno">  655</span>   <span class="comment">// Create the list of cells &#39;under&#39; this grid-edge profile. Note that more than two cells are stored</span></div>
<div class="line"><a id="l00656" name="l00656"></a><span class="lineno">  656</span>   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n = 0; n &lt; VPtiNormalPoints.size(); n++)</div>
<div class="line"><a id="l00657" name="l00657"></a><span class="lineno">  657</span>   {</div>
<div class="line"><a id="l00658" name="l00658"></a><span class="lineno">  658</span>      <span class="keywordtype">int</span> nX = VPtiNormalPoints[n].nGetX();</div>
<div class="line"><a id="l00659" name="l00659"></a><span class="lineno">  659</span>      <span class="keywordtype">int</span> nY = VPtiNormalPoints[n].nGetY();</div>
<div class="line"><a id="l00660" name="l00660"></a><span class="lineno">  660</span> </div>
<div class="line"><a id="l00661" name="l00661"></a><span class="lineno">  661</span>      <span class="comment">// Mark each cell in the raster grid</span></div>
<div class="line"><a id="l00662" name="l00662"></a><span class="lineno">  662</span>      <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[nX][nY].SetProfileID(nProfile);</div>
<div class="line"><a id="l00663" name="l00663"></a><span class="lineno">  663</span> </div>
<div class="line"><a id="l00664" name="l00664"></a><span class="lineno">  664</span>      <span class="comment">// Store the raster grid coordinates in the profile object</span></div>
<div class="line"><a id="l00665" name="l00665"></a><span class="lineno">  665</span>      pProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#aafb35166293c29d0492621850d5d06d4">AppendCellInProfile</a>(nX, nY);</div>
<div class="line"><a id="l00666" name="l00666"></a><span class="lineno">  666</span> </div>
<div class="line"><a id="l00667" name="l00667"></a><span class="lineno">  667</span>      <a class="code hl_class" href="../../d5/d4e/classCGeom2DPoint.html">CGeom2DPoint</a> Pt(<a class="code hl_function" href="../../d1/d98/classCSimulation.html#ad79b925ac5f358c6f867b6e47dad74bd">dGridCentroidXToExtCRSX</a>(nX), <a class="code hl_function" href="../../d1/d98/classCSimulation.html#a7e2a4bd69ce79377fee86aa5598903f8">dGridCentroidYToExtCRSY</a>(nY)); <span class="comment">// In external CRS</span></div>
<div class="line"><a id="l00668" name="l00668"></a><span class="lineno">  668</span> </div>
<div class="line"><a id="l00669" name="l00669"></a><span class="lineno">  669</span>      <span class="comment">// Store the external coordinates in the profile object. Note that for this &#39;special&#39; profile, the coordinates of the cells and the coordinates of points on the profile itself are identical, this is not the case for ordinary profiles</span></div>
<div class="line"><a id="l00670" name="l00670"></a><span class="lineno">  670</span>      pProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#a6152817d6ec950e1474313ca9824da46">AppendCellInProfileExtCRS</a>(&amp;Pt);</div>
<div class="line"><a id="l00671" name="l00671"></a><span class="lineno">  671</span> </div>
<div class="line"><a id="l00672" name="l00672"></a><span class="lineno">  672</span>      <span class="keywordflow">if</span> ((n == 0) || (n == VPtiNormalPoints.size()-1))</div>
<div class="line"><a id="l00673" name="l00673"></a><span class="lineno">  673</span>      {</div>
<div class="line"><a id="l00674" name="l00674"></a><span class="lineno">  674</span>         <span class="comment">// Store just the first and last points in this &#39;special&#39; profile&#39;s coastline-normal vector</span></div>
<div class="line"><a id="l00675" name="l00675"></a><span class="lineno">  675</span>         pProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#a19aac71e045a17e2c6d98f020f2319fa">AppendPointInProfile</a>(&amp;Pt);</div>
<div class="line"><a id="l00676" name="l00676"></a><span class="lineno">  676</span>      }</div>
<div class="line"><a id="l00677" name="l00677"></a><span class="lineno">  677</span>   }</div>
<div class="line"><a id="l00678" name="l00678"></a><span class="lineno">  678</span> </div>
<div class="line"><a id="l00679" name="l00679"></a><span class="lineno">  679</span>   <span class="keywordtype">int</span> nEndX = VPtiNormalPoints.back().nGetX();</div>
<div class="line"><a id="l00680" name="l00680"></a><span class="lineno">  680</span>   <span class="keywordtype">int</span> nEndY = VPtiNormalPoints.back().nGetY();</div>
<div class="line"><a id="l00681" name="l00681"></a><span class="lineno">  681</span>   <a class="code hl_class" href="../../d6/d0d/classCGeom2DIPoint.html">CGeom2DIPoint</a> PtiEnd(nEndX, nEndY);</div>
<div class="line"><a id="l00682" name="l00682"></a><span class="lineno">  682</span>   pProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#acfba38cf7f54b2889544b4c0cb63e6d5">SetEndPoint</a>(&amp;PtiEnd);</div>
<div class="line"><a id="l00683" name="l00683"></a><span class="lineno">  683</span> </div>
<div class="line"><a id="l00684" name="l00684"></a><span class="lineno">  684</span>   <span class="comment">// Get the deep water wave height and orientation values at the end of the profile</span></div>
<div class="line"><a id="l00685" name="l00685"></a><span class="lineno">  685</span>   <span class="keywordtype">double</span> dDeepWaterWaveHeight = <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[nEndX][nEndY].dGetCellDeepWaterWaveHeight();</div>
<div class="line"><a id="l00686" name="l00686"></a><span class="lineno">  686</span>   <span class="keywordtype">double</span> dDeepWaterWaveAngle = <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[nEndX][nEndY].dGetCellDeepWaterWaveAngle();</div>
<div class="line"><a id="l00687" name="l00687"></a><span class="lineno">  687</span>   <span class="keywordtype">double</span> dDeepWaterWavePeriod = <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[nEndX][nEndY].dGetCellDeepWaterWavePeriod();</div>
<div class="line"><a id="l00688" name="l00688"></a><span class="lineno">  688</span> </div>
<div class="line"><a id="l00689" name="l00689"></a><span class="lineno">  689</span>   <span class="comment">// And store them in this profile</span></div>
<div class="line"><a id="l00690" name="l00690"></a><span class="lineno">  690</span>   pProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#a8e440a77b79c7e47db4b825ae2d47593">SetProfileDeepWaterWaveHeight</a>(dDeepWaterWaveHeight);</div>
<div class="line"><a id="l00691" name="l00691"></a><span class="lineno">  691</span>   pProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#af7caa9a58827f7ab1511e1acfda10bbb">SetProfileDeepWaterWaveAngle</a>(dDeepWaterWaveAngle);</div>
<div class="line"><a id="l00692" name="l00692"></a><span class="lineno">  692</span>   pProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#a35cb69932b881c6323e749a250bcb3c6">SetProfileDeepWaterWavePeriod</a>(dDeepWaterWavePeriod);</div>
<div class="line"><a id="l00693" name="l00693"></a><span class="lineno">  693</span> </div>
<div class="line"><a id="l00694" name="l00694"></a><span class="lineno">  694</span>   <span class="comment">// Create the profile&#39;s CGeomMultiLine then set nProfile as the only co-incident profile of the only line segment</span></div>
<div class="line"><a id="l00695" name="l00695"></a><span class="lineno">  695</span>   pProfile-&gt;<a class="code hl_function" href="../../d0/d89/classCGeomMultiLine.html#a3f99a9c2ac66b75c432941ec88fc8538">AppendLineSegment</a>();</div>
<div class="line"><a id="l00696" name="l00696"></a><span class="lineno">  696</span>   pProfile-&gt;<a class="code hl_function" href="../../d0/d89/classCGeomMultiLine.html#a679d5893191ff6dc5ab6b9acd1f5c770">AppendCoincidentProfileToLineSegments</a>(make_pair(nProfile, 0));</div>
<div class="line"><a id="l00697" name="l00697"></a><span class="lineno">  697</span> </div>
<div class="line"><a id="l00698" name="l00698"></a><span class="lineno">  698</span>   <span class="comment">// Store the profile</span></div>
<div class="line"><a id="l00699" name="l00699"></a><span class="lineno">  699</span>   <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a25ada8139c82ca7beab3f279cff83184">m_VCoast</a>[nCoast].AppendProfile(pProfile);</div>
<div class="line"><a id="l00700" name="l00700"></a><span class="lineno">  700</span>   <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a25ada8139c82ca7beab3f279cff83184">m_VCoast</a>[nCoast].SetProfileAtCoastPoint(nProfileStartPoint, pProfile);</div>
<div class="line"><a id="l00701" name="l00701"></a><span class="lineno">  701</span> </div>
<div class="line"><a id="l00702" name="l00702"></a><span class="lineno">  702</span>   <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a0245d3cbdd603fbeced6ca1465eb3f16">m_nLogFileDetail</a> &gt;= <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#aa58b13ad2e88aaa20449bfea242396a4">LOG_FILE_ALL</a>)</div>
<div class="line"><a id="l00703" name="l00703"></a><span class="lineno">  703</span>      <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a222962121613613a48f518e0c2110f21">LogStream</a> &lt;&lt; <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#ad67e8c5b30a0572f64ecfb5c062c2edc">m_ulIter</a> &lt;&lt; <span class="stringliteral">&quot;: coast &quot;</span> &lt;&lt; nCoast &lt;&lt; <span class="stringliteral">&quot; profile &quot;</span> &lt;&lt; nProfile &lt;&lt; <span class="stringliteral">&quot; created at coast &quot;</span> &lt;&lt; (bCoastStart ? <span class="stringliteral">&quot;start&quot;</span> : <span class="stringliteral">&quot;end&quot;</span>) &lt;&lt; <span class="stringliteral">&quot; point &quot;</span> &lt;&lt; (bCoastStart ? 0 : nCoastSize - 1) &lt;&lt; <span class="stringliteral">&quot;, from [&quot;</span> &lt;&lt; PtiProfileStart.<a class="code hl_function" href="../../d6/d0d/classCGeom2DIPoint.html#af84c687b2d0be01ab41cbcc0565f4f3f">nGetX</a>() &lt;&lt; <span class="stringliteral">&quot;][&quot;</span> &lt;&lt; PtiProfileStart.<a class="code hl_function" href="../../d6/d0d/classCGeom2DIPoint.html#a4d9c20bcca90dcb9d519b664aba09cbd">nGetY</a>() &lt;&lt; <span class="stringliteral">&quot;] = {&quot;</span> &lt;&lt; <a class="code hl_function" href="../../d1/d98/classCSimulation.html#ad79b925ac5f358c6f867b6e47dad74bd">dGridCentroidXToExtCRSX</a>(PtiProfileStart.<a class="code hl_function" href="../../d6/d0d/classCGeom2DIPoint.html#af84c687b2d0be01ab41cbcc0565f4f3f">nGetX</a>()) &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; <a class="code hl_function" href="../../d1/d98/classCSimulation.html#a7e2a4bd69ce79377fee86aa5598903f8">dGridCentroidYToExtCRSY</a>(PtiProfileStart.<a class="code hl_function" href="../../d6/d0d/classCGeom2DIPoint.html#a4d9c20bcca90dcb9d519b664aba09cbd">nGetY</a>()) &lt;&lt; <span class="stringliteral">&quot;} to [&quot;</span> &lt;&lt; VPtiNormalPoints.back().nGetX() &lt;&lt; <span class="stringliteral">&quot;][&quot;</span> &lt;&lt; VPtiNormalPoints.back().nGetY() &lt;&lt; <span class="stringliteral">&quot;] = {&quot;</span> &lt;&lt; <a class="code hl_function" href="../../d1/d98/classCSimulation.html#ad79b925ac5f358c6f867b6e47dad74bd">dGridCentroidXToExtCRSX</a>(VPtiNormalPoints.back().nGetX()) &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; <a class="code hl_function" href="../../d1/d98/classCSimulation.html#a7e2a4bd69ce79377fee86aa5598903f8">dGridCentroidYToExtCRSY</a>(VPtiNormalPoints.back().nGetY()) &lt;&lt; <span class="stringliteral">&quot;}&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a id="l00704" name="l00704"></a><span class="lineno">  704</span> </div>
<div class="line"><a id="l00705" name="l00705"></a><span class="lineno">  705</span>   <span class="keywordflow">return</span> <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#aa768cb14b5c6123ee95e6e4ebd9fe331">RTN_OK</a>;</div>
<div class="line"><a id="l00706" name="l00706"></a><span class="lineno">  706</span>}</div>
</div>
<div class="line"><a id="l00707" name="l00707"></a><span class="lineno">  707</span> </div>
<div class="line"><a id="l00708" name="l00708"></a><span class="lineno">  708</span><span class="comment">//===============================================================================================================================</span></div>
<div class="line"><a id="l00710" name="l00710"></a><span class="lineno">  710</span><span class="comment">//===============================================================================================================================</span></div>
<div class="foldopen" id="foldopen00711" data-start="{" data-end="}">
<div class="line"><a id="l00711" name="l00711"></a><span class="lineno"><a class="line" href="../../d1/d98/classCSimulation.html#a9a8f66d4a55299b92d4b1cea9e1d095e">  711</a></span><span class="keywordtype">int</span> <a class="code hl_function" href="../../d1/d98/classCSimulation.html#a9a8f66d4a55299b92d4b1cea9e1d095e">CSimulation::nGetCoastNormalEndPoint</a>(<span class="keywordtype">int</span> <span class="keyword">const</span> nCoast, <span class="keywordtype">int</span> <span class="keyword">const</span> nStartCoastPoint, <span class="keywordtype">int</span> <span class="keyword">const</span> nCoastSize, <a class="code hl_class" href="../../d5/d4e/classCGeom2DPoint.html">CGeom2DPoint</a> <span class="keyword">const</span>* pPtStart, <span class="keywordtype">double</span> <span class="keyword">const</span> dLineLength, <a class="code hl_class" href="../../d5/d4e/classCGeom2DPoint.html">CGeom2DPoint</a>* pPtEnd, <a class="code hl_class" href="../../d6/d0d/classCGeom2DIPoint.html">CGeom2DIPoint</a>* pPtiEnd, <span class="keywordtype">bool</span> <span class="keyword">const</span> bIntervention)</div>
<div class="line"><a id="l00712" name="l00712"></a><span class="lineno">  712</span>{</div>
<div class="line"><a id="l00713" name="l00713"></a><span class="lineno">  713</span>   <span class="keywordtype">int</span> <span class="keyword">const</span> AVGSIZE = 21;    <span class="comment">// TODO 011 This should be a user input</span></div>
<div class="line"><a id="l00714" name="l00714"></a><span class="lineno">  714</span> </div>
<div class="line"><a id="l00715" name="l00715"></a><span class="lineno">  715</span>   <a class="code hl_class" href="../../d5/d4e/classCGeom2DPoint.html">CGeom2DPoint</a> PtBefore;</div>
<div class="line"><a id="l00716" name="l00716"></a><span class="lineno">  716</span>   <a class="code hl_class" href="../../d5/d4e/classCGeom2DPoint.html">CGeom2DPoint</a> PtAfter;</div>
<div class="line"><a id="l00717" name="l00717"></a><span class="lineno">  717</span> </div>
<div class="line"><a id="l00718" name="l00718"></a><span class="lineno">  718</span>   <span class="keywordflow">if</span> (bIntervention)</div>
<div class="line"><a id="l00719" name="l00719"></a><span class="lineno">  719</span>   {</div>
<div class="line"><a id="l00720" name="l00720"></a><span class="lineno">  720</span>      <span class="comment">// This is an intervention profile, so just use one point on either side (coordinates in external CRS). Note this this assumes that this intervention profile is not at the start or end of the coastline</span></div>
<div class="line"><a id="l00721" name="l00721"></a><span class="lineno">  721</span>      PtBefore = *<a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a25ada8139c82ca7beab3f279cff83184">m_VCoast</a>[nCoast].pPtGetCoastlinePointExtCRS(nStartCoastPoint-1);</div>
<div class="line"><a id="l00722" name="l00722"></a><span class="lineno">  722</span>      PtAfter = *<a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a25ada8139c82ca7beab3f279cff83184">m_VCoast</a>[nCoast].pPtGetCoastlinePointExtCRS(nStartCoastPoint+1);</div>
<div class="line"><a id="l00723" name="l00723"></a><span class="lineno">  723</span>   }</div>
<div class="line"><a id="l00724" name="l00724"></a><span class="lineno">  724</span>   <span class="keywordflow">else</span></div>
<div class="line"><a id="l00725" name="l00725"></a><span class="lineno">  725</span>   {</div>
<div class="line"><a id="l00726" name="l00726"></a><span class="lineno">  726</span>      <span class="comment">// This is not an intervention, so put a maximum of AVGSIZE points before the start point into a vector</span></div>
<div class="line"><a id="l00727" name="l00727"></a><span class="lineno">  727</span>      vector&lt;CGeom2DPoint&gt; PtBeforeToAverage;</div>
<div class="line"><a id="l00728" name="l00728"></a><span class="lineno">  728</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n = 1; n &lt;= AVGSIZE; n++)</div>
<div class="line"><a id="l00729" name="l00729"></a><span class="lineno">  729</span>      {</div>
<div class="line"><a id="l00730" name="l00730"></a><span class="lineno">  730</span>         <span class="keywordtype">int</span> nPoint = nStartCoastPoint - n;</div>
<div class="line"><a id="l00731" name="l00731"></a><span class="lineno">  731</span>         <span class="keywordflow">if</span> (nPoint &lt; 0)</div>
<div class="line"><a id="l00732" name="l00732"></a><span class="lineno">  732</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00733" name="l00733"></a><span class="lineno">  733</span> </div>
<div class="line"><a id="l00734" name="l00734"></a><span class="lineno">  734</span>         PtBeforeToAverage.push_back(*<a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a25ada8139c82ca7beab3f279cff83184">m_VCoast</a>[nCoast].pPtGetCoastlinePointExtCRS(nPoint));</div>
<div class="line"><a id="l00735" name="l00735"></a><span class="lineno">  735</span>      }</div>
<div class="line"><a id="l00736" name="l00736"></a><span class="lineno">  736</span> </div>
<div class="line"><a id="l00737" name="l00737"></a><span class="lineno">  737</span>      <span class="comment">// Put a maximum of AVGSIZE points after the start point into a vector</span></div>
<div class="line"><a id="l00738" name="l00738"></a><span class="lineno">  738</span>      vector&lt;CGeom2DPoint&gt; PtAfterToAverage;</div>
<div class="line"><a id="l00739" name="l00739"></a><span class="lineno">  739</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n = 1; n &lt;= AVGSIZE; n++)</div>
<div class="line"><a id="l00740" name="l00740"></a><span class="lineno">  740</span>      {</div>
<div class="line"><a id="l00741" name="l00741"></a><span class="lineno">  741</span>         <span class="keywordtype">int</span> nPoint = nStartCoastPoint + n;</div>
<div class="line"><a id="l00742" name="l00742"></a><span class="lineno">  742</span>         <span class="keywordflow">if</span> (nPoint &gt; nCoastSize-1)</div>
<div class="line"><a id="l00743" name="l00743"></a><span class="lineno">  743</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00744" name="l00744"></a><span class="lineno">  744</span> </div>
<div class="line"><a id="l00745" name="l00745"></a><span class="lineno">  745</span>         PtAfterToAverage.push_back(*<a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a25ada8139c82ca7beab3f279cff83184">m_VCoast</a>[nCoast].pPtGetCoastlinePointExtCRS(nPoint));</div>
<div class="line"><a id="l00746" name="l00746"></a><span class="lineno">  746</span>      }</div>
<div class="line"><a id="l00747" name="l00747"></a><span class="lineno">  747</span> </div>
<div class="line"><a id="l00748" name="l00748"></a><span class="lineno">  748</span>      <span class="comment">// Now average each of these vectors of points: results are in PtBefore and PtAfter (coordinates in external CRS)</span></div>
<div class="line"><a id="l00749" name="l00749"></a><span class="lineno">  749</span>      PtBefore = <a class="code hl_function" href="../../d1/d98/classCSimulation.html#a41d2806566f688547f97c0d573bb1611">PtAverage</a>(&amp;PtBeforeToAverage);</div>
<div class="line"><a id="l00750" name="l00750"></a><span class="lineno">  750</span>      PtAfter = <a class="code hl_function" href="../../d1/d98/classCSimulation.html#a41d2806566f688547f97c0d573bb1611">PtAverage</a>(&amp;PtAfterToAverage);</div>
<div class="line"><a id="l00751" name="l00751"></a><span class="lineno">  751</span>   }</div>
<div class="line"><a id="l00752" name="l00752"></a><span class="lineno">  752</span> </div>
<div class="line"><a id="l00753" name="l00753"></a><span class="lineno">  753</span>   <span class="comment">// Get the y = a * x + b equation of the straight line linking the coastline points before and after &#39;this&#39; coastline point. For this linking line, slope a = (y2 - y1) / (x2 - x1)</span></div>
<div class="line"><a id="l00754" name="l00754"></a><span class="lineno">  754</span>   <span class="keywordtype">double</span> dYDiff = PtAfter.<a class="code hl_function" href="../../d5/d4e/classCGeom2DPoint.html#a216921dc2c592d9468e6430fee7c7719">dGetY</a>() - PtBefore.<a class="code hl_function" href="../../d5/d4e/classCGeom2DPoint.html#a216921dc2c592d9468e6430fee7c7719">dGetY</a>();</div>
<div class="line"><a id="l00755" name="l00755"></a><span class="lineno">  755</span>   <span class="keywordtype">double</span> dXDiff = PtAfter.<a class="code hl_function" href="../../d5/d4e/classCGeom2DPoint.html#a250f937d03cfdf6e0244b74ad2bf96a4">dGetX</a>() - PtBefore.<a class="code hl_function" href="../../d5/d4e/classCGeom2DPoint.html#a250f937d03cfdf6e0244b74ad2bf96a4">dGetX</a>();</div>
<div class="line"><a id="l00756" name="l00756"></a><span class="lineno">  756</span> </div>
<div class="line"><a id="l00757" name="l00757"></a><span class="lineno">  757</span>   <span class="keywordtype">double</span> dXEnd1 = 0, dXEnd2 = 0, dYEnd1 = 0, dYEnd2 = 0;</div>
<div class="line"><a id="l00758" name="l00758"></a><span class="lineno">  758</span> </div>
<div class="line"><a id="l00759" name="l00759"></a><span class="lineno">  759</span>   <span class="keywordflow">if</span> (<a class="code hl_function" href="../../d6/d2a/cme_8h.html#a61afa8560a3b39c80657661a1d8f76ab">bFPIsEqual</a>(dYDiff, 0.0, <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#a08b1623863ee3bd4300a8892de323722">TOLERANCE</a>))</div>
<div class="line"><a id="l00760" name="l00760"></a><span class="lineno">  760</span>   {</div>
<div class="line"><a id="l00761" name="l00761"></a><span class="lineno">  761</span>      <span class="comment">// The linking line runs W-E or E-W, so a straight line at right angles to this runs N-S or S-N. Calculate the two possible end points for this coastline-normal profile</span></div>
<div class="line"><a id="l00762" name="l00762"></a><span class="lineno">  762</span>      dXEnd1 = dXEnd2 = pPtStart-&gt;<a class="code hl_function" href="../../d5/d4e/classCGeom2DPoint.html#a250f937d03cfdf6e0244b74ad2bf96a4">dGetX</a>();</div>
<div class="line"><a id="l00763" name="l00763"></a><span class="lineno">  763</span>      dYEnd1 = pPtStart-&gt;<a class="code hl_function" href="../../d5/d4e/classCGeom2DPoint.html#a216921dc2c592d9468e6430fee7c7719">dGetY</a>() + dLineLength;</div>
<div class="line"><a id="l00764" name="l00764"></a><span class="lineno">  764</span>      dYEnd2 = pPtStart-&gt;<a class="code hl_function" href="../../d5/d4e/classCGeom2DPoint.html#a216921dc2c592d9468e6430fee7c7719">dGetY</a>() - dLineLength;</div>
<div class="line"><a id="l00765" name="l00765"></a><span class="lineno">  765</span>   }</div>
<div class="line"><a id="l00766" name="l00766"></a><span class="lineno">  766</span>   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_function" href="../../d6/d2a/cme_8h.html#a61afa8560a3b39c80657661a1d8f76ab">bFPIsEqual</a>(dXDiff, 0.0, <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#a08b1623863ee3bd4300a8892de323722">TOLERANCE</a>))</div>
<div class="line"><a id="l00767" name="l00767"></a><span class="lineno">  767</span>   {</div>
<div class="line"><a id="l00768" name="l00768"></a><span class="lineno">  768</span>      <span class="comment">// The linking line runs N-S or S-N, so a straight line at right angles to this runs W-E or E-W. Calculate the two possible end points for this coastline-normal profile</span></div>
<div class="line"><a id="l00769" name="l00769"></a><span class="lineno">  769</span>      dYEnd1 = dYEnd2 = pPtStart-&gt;<a class="code hl_function" href="../../d5/d4e/classCGeom2DPoint.html#a216921dc2c592d9468e6430fee7c7719">dGetY</a>();</div>
<div class="line"><a id="l00770" name="l00770"></a><span class="lineno">  770</span>      dXEnd1 = pPtStart-&gt;<a class="code hl_function" href="../../d5/d4e/classCGeom2DPoint.html#a250f937d03cfdf6e0244b74ad2bf96a4">dGetX</a>() + dLineLength;</div>
<div class="line"><a id="l00771" name="l00771"></a><span class="lineno">  771</span>      dXEnd2 = pPtStart-&gt;<a class="code hl_function" href="../../d5/d4e/classCGeom2DPoint.html#a250f937d03cfdf6e0244b74ad2bf96a4">dGetX</a>() - dLineLength;</div>
<div class="line"><a id="l00772" name="l00772"></a><span class="lineno">  772</span>   }</div>
<div class="line"><a id="l00773" name="l00773"></a><span class="lineno">  773</span>   <span class="keywordflow">else</span></div>
<div class="line"><a id="l00774" name="l00774"></a><span class="lineno">  774</span>   {</div>
<div class="line"><a id="l00775" name="l00775"></a><span class="lineno">  775</span>      <span class="comment">// The linking line runs neither W-E nor N-S so we have to work a bit harder to find the end-point of the coastline-normal profile</span></div>
<div class="line"><a id="l00776" name="l00776"></a><span class="lineno">  776</span>      <span class="keywordtype">double</span> dA = dYDiff / dXDiff;</div>
<div class="line"><a id="l00777" name="l00777"></a><span class="lineno">  777</span> </div>
<div class="line"><a id="l00778" name="l00778"></a><span class="lineno">  778</span>      <span class="comment">// Now calculate the equation of the straight line which is perpendicular to this linking line</span></div>
<div class="line"><a id="l00779" name="l00779"></a><span class="lineno">  779</span>      <span class="keywordtype">double</span> dAPerp = -1 / dA;</div>
<div class="line"><a id="l00780" name="l00780"></a><span class="lineno">  780</span>      <span class="keywordtype">double</span> dBPerp = pPtStart-&gt;<a class="code hl_function" href="../../d5/d4e/classCGeom2DPoint.html#a216921dc2c592d9468e6430fee7c7719">dGetY</a>() - (dAPerp * pPtStart-&gt;<a class="code hl_function" href="../../d5/d4e/classCGeom2DPoint.html#a250f937d03cfdf6e0244b74ad2bf96a4">dGetX</a>());</div>
<div class="line"><a id="l00781" name="l00781"></a><span class="lineno">  781</span> </div>
<div class="line"><a id="l00782" name="l00782"></a><span class="lineno">  782</span>      <span class="comment">// Calculate the end point of the profile: first do some substitution then rearrange as a quadratic equation i.e. in the form Ax^2 + Bx + C = 0 (see http://math.stackexchange.com/questions/228841/how-do-i-calculate-the-intersections-of-a-straight-line-and-a-circle)</span></div>
<div class="line"><a id="l00783" name="l00783"></a><span class="lineno">  783</span>      <span class="keywordtype">double</span> dQuadA = 1 + (dAPerp * dAPerp);</div>
<div class="line"><a id="l00784" name="l00784"></a><span class="lineno">  784</span>      <span class="keywordtype">double</span> dQuadB = 2 * ((dBPerp * dAPerp) - (dAPerp * pPtStart-&gt;<a class="code hl_function" href="../../d5/d4e/classCGeom2DPoint.html#a216921dc2c592d9468e6430fee7c7719">dGetY</a>()) - pPtStart-&gt;<a class="code hl_function" href="../../d5/d4e/classCGeom2DPoint.html#a250f937d03cfdf6e0244b74ad2bf96a4">dGetX</a>());</div>
<div class="line"><a id="l00785" name="l00785"></a><span class="lineno">  785</span>      <span class="keywordtype">double</span> dQuadC = ((pPtStart-&gt;<a class="code hl_function" href="../../d5/d4e/classCGeom2DPoint.html#a250f937d03cfdf6e0244b74ad2bf96a4">dGetX</a>() * pPtStart-&gt;<a class="code hl_function" href="../../d5/d4e/classCGeom2DPoint.html#a250f937d03cfdf6e0244b74ad2bf96a4">dGetX</a>()) + (pPtStart-&gt;<a class="code hl_function" href="../../d5/d4e/classCGeom2DPoint.html#a216921dc2c592d9468e6430fee7c7719">dGetY</a>() * pPtStart-&gt;<a class="code hl_function" href="../../d5/d4e/classCGeom2DPoint.html#a216921dc2c592d9468e6430fee7c7719">dGetY</a>()) + (dBPerp * dBPerp) - (2 * pPtStart-&gt;<a class="code hl_function" href="../../d5/d4e/classCGeom2DPoint.html#a216921dc2c592d9468e6430fee7c7719">dGetY</a>() * dBPerp) - (dLineLength * dLineLength));</div>
<div class="line"><a id="l00786" name="l00786"></a><span class="lineno">  786</span> </div>
<div class="line"><a id="l00787" name="l00787"></a><span class="lineno">  787</span>      <span class="comment">// Solve for x and y using the quadratic formula x = (−B ± sqrt(B^2 − 4AC)) / 2A</span></div>
<div class="line"><a id="l00788" name="l00788"></a><span class="lineno">  788</span>      <span class="keywordtype">double</span> dDiscriminant = (dQuadB * dQuadB) - (4 * dQuadA * dQuadC);</div>
<div class="line"><a id="l00789" name="l00789"></a><span class="lineno">  789</span>      <span class="keywordflow">if</span> (dDiscriminant &lt; 0)</div>
<div class="line"><a id="l00790" name="l00790"></a><span class="lineno">  790</span>      {</div>
<div class="line"><a id="l00791" name="l00791"></a><span class="lineno">  791</span>         <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a222962121613613a48f518e0c2110f21">LogStream</a> &lt;&lt; <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#a292fc90846543ca4814daa9f759feb05">ERR</a> &lt;&lt; <span class="stringliteral">&quot;timestep &quot;</span> &lt;&lt; <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#ad67e8c5b30a0572f64ecfb5c062c2edc">m_ulIter</a> &lt;&lt; <span class="stringliteral">&quot;: discriminant &lt; 0 when finding profile end point on coastline &quot;</span> &lt;&lt; nCoast &lt;&lt; <span class="stringliteral">&quot;, from coastline point &quot;</span> &lt;&lt; nStartCoastPoint &lt;&lt; <span class="stringliteral">&quot;), ignored&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a id="l00792" name="l00792"></a><span class="lineno">  792</span>         <span class="keywordflow">return</span> <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#ace82416ca7fb524bd4da49c3d402b082">RTN_ERR_NO_SOLUTION_FOR_ENDPOINT</a>;</div>
<div class="line"><a id="l00793" name="l00793"></a><span class="lineno">  793</span>      }</div>
<div class="line"><a id="l00794" name="l00794"></a><span class="lineno">  794</span> </div>
<div class="line"><a id="l00795" name="l00795"></a><span class="lineno">  795</span>      dXEnd1 = (-dQuadB + sqrt(dDiscriminant)) / (2 * dQuadA);</div>
<div class="line"><a id="l00796" name="l00796"></a><span class="lineno">  796</span>      dYEnd1 = (dAPerp * dXEnd1) + dBPerp;</div>
<div class="line"><a id="l00797" name="l00797"></a><span class="lineno">  797</span>      dXEnd2 = (-dQuadB - sqrt(dDiscriminant)) / (2 * dQuadA);</div>
<div class="line"><a id="l00798" name="l00798"></a><span class="lineno">  798</span>      dYEnd2 = (dAPerp * dXEnd2) + dBPerp;</div>
<div class="line"><a id="l00799" name="l00799"></a><span class="lineno">  799</span>   }</div>
<div class="line"><a id="l00800" name="l00800"></a><span class="lineno">  800</span> </div>
<div class="line"><a id="l00801" name="l00801"></a><span class="lineno">  801</span>   <span class="comment">// We have two possible solutions, so decide which of the two endpoints to use then create the profile end-point (coordinates in external CRS)</span></div>
<div class="line"><a id="l00802" name="l00802"></a><span class="lineno">  802</span>   <span class="keywordtype">int</span> nSeaHand = <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a25ada8139c82ca7beab3f279cff83184">m_VCoast</a>[nCoast].nGetSeaHandedness(); <span class="comment">// Assumes handedness is either 0 or 1 (i.e. not -1)</span></div>
<div class="line"><a id="l00803" name="l00803"></a><span class="lineno">  803</span>   *pPtEnd = <a class="code hl_function" href="../../d1/d98/classCSimulation.html#a3319d10c724017519510082073494022">PtChooseEndPoint</a>(nSeaHand, &amp;PtBefore, &amp;PtAfter, dXEnd1, dYEnd1, dXEnd2, dYEnd2);</div>
<div class="line"><a id="l00804" name="l00804"></a><span class="lineno">  804</span> </div>
<div class="line"><a id="l00805" name="l00805"></a><span class="lineno">  805</span>   <span class="comment">// Check that pPtiEnd is not off the grid. Note that pPtiEnd is not necessarily a cell centroid</span></div>
<div class="line"><a id="l00806" name="l00806"></a><span class="lineno">  806</span>   pPtiEnd-&gt;<a class="code hl_function" href="../../d6/d0d/classCGeom2DIPoint.html#a5ffded2cbbf18f6f3e6595824476b727">SetXY</a>(<a class="code hl_function" href="../../d2/dfd/utils__global_8cpp.html#a20842d0a19d0ca952c91f3e1eb175fee">nRound</a>(<a class="code hl_function" href="../../d1/d98/classCSimulation.html#a9fbe52d4e0f26ad432f12b7154c599e4">dExtCRSXToGridX</a>(pPtEnd-&gt;<a class="code hl_function" href="../../d5/d4e/classCGeom2DPoint.html#a250f937d03cfdf6e0244b74ad2bf96a4">dGetX</a>())), <a class="code hl_function" href="../../d2/dfd/utils__global_8cpp.html#a20842d0a19d0ca952c91f3e1eb175fee">nRound</a>(<a class="code hl_function" href="../../d1/d98/classCSimulation.html#ac2e7e204d9e9b527d0a4c941f2e525ad">dExtCRSYToGridY</a>(pPtEnd-&gt;<a class="code hl_function" href="../../d5/d4e/classCGeom2DPoint.html#a216921dc2c592d9468e6430fee7c7719">dGetY</a>())));</div>
<div class="line"><a id="l00807" name="l00807"></a><span class="lineno">  807</span>   <span class="keywordflow">if</span> (! <a class="code hl_function" href="../../d1/d98/classCSimulation.html#ac900a5701df97da22278fae928951f50">bIsWithinValidGrid</a>(pPtiEnd))</div>
<div class="line"><a id="l00808" name="l00808"></a><span class="lineno">  808</span>   {</div>
<div class="line"><a id="l00809" name="l00809"></a><span class="lineno">  809</span>      <span class="comment">// LogStream &lt;&lt; m_ulIter &lt;&lt; &quot;: profile endpoint is outside grid [&quot; &lt;&lt; pPtiEnd-&gt;nGetX() &lt;&lt; &quot;][&quot; &lt;&lt; pPtiEnd-&gt;nGetY() &lt;&lt; &quot;] = {&quot; &lt;&lt; pPtEnd-&gt;dGetX() &lt;&lt; &quot;, &quot; &lt;&lt; pPtEnd-&gt;dGetY() &lt;&lt; &quot;}. The profile starts at coastline point &quot; &lt;&lt; nStartCoastPoint &lt;&lt; &quot; = {&quot; &lt;&lt; pPtStart-&gt;dGetX() &lt;&lt; &quot;, &quot; &lt;&lt; pPtStart-&gt;dGetY() &lt;&lt; &quot;}&quot; &lt;&lt; endl;</span></div>
<div class="line"><a id="l00810" name="l00810"></a><span class="lineno">  810</span> </div>
<div class="line"><a id="l00811" name="l00811"></a><span class="lineno">  811</span>      <span class="comment">// The end point is off the grid, so constrain it to be within the valid grid</span></div>
<div class="line"><a id="l00812" name="l00812"></a><span class="lineno">  812</span>      <a class="code hl_class" href="../../d6/d0d/classCGeom2DIPoint.html">CGeom2DIPoint</a> PtiStart(<a class="code hl_function" href="../../d2/dfd/utils__global_8cpp.html#a20842d0a19d0ca952c91f3e1eb175fee">nRound</a>(<a class="code hl_function" href="../../d1/d98/classCSimulation.html#a9fbe52d4e0f26ad432f12b7154c599e4">dExtCRSXToGridX</a>(pPtStart-&gt;<a class="code hl_function" href="../../d5/d4e/classCGeom2DPoint.html#a250f937d03cfdf6e0244b74ad2bf96a4">dGetX</a>())), <a class="code hl_function" href="../../d2/dfd/utils__global_8cpp.html#a20842d0a19d0ca952c91f3e1eb175fee">nRound</a>(<a class="code hl_function" href="../../d1/d98/classCSimulation.html#ac2e7e204d9e9b527d0a4c941f2e525ad">dExtCRSYToGridY</a>(pPtStart-&gt;<a class="code hl_function" href="../../d5/d4e/classCGeom2DPoint.html#a216921dc2c592d9468e6430fee7c7719">dGetY</a>())));</div>
<div class="line"><a id="l00813" name="l00813"></a><span class="lineno">  813</span>      <a class="code hl_function" href="../../d1/d98/classCSimulation.html#aa0eddb8270d03b9c1a0a6e96254ebfed">KeepWithinValidGrid</a>(&amp;PtiStart, pPtiEnd);</div>
<div class="line"><a id="l00814" name="l00814"></a><span class="lineno">  814</span> </div>
<div class="line"><a id="l00815" name="l00815"></a><span class="lineno">  815</span>      pPtEnd-&gt;<a class="code hl_function" href="../../d5/d4e/classCGeom2DPoint.html#af5dfdef4b78c0703800049b064483278">SetX</a>(<a class="code hl_function" href="../../d1/d98/classCSimulation.html#ad79b925ac5f358c6f867b6e47dad74bd">dGridCentroidXToExtCRSX</a>(pPtiEnd-&gt;<a class="code hl_function" href="../../d6/d0d/classCGeom2DIPoint.html#af84c687b2d0be01ab41cbcc0565f4f3f">nGetX</a>()));</div>
<div class="line"><a id="l00816" name="l00816"></a><span class="lineno">  816</span>      pPtEnd-&gt;<a class="code hl_function" href="../../d5/d4e/classCGeom2DPoint.html#a1dff4e8adee61e6fe5c5062d6ba88f01">SetY</a>(<a class="code hl_function" href="../../d1/d98/classCSimulation.html#a7e2a4bd69ce79377fee86aa5598903f8">dGridCentroidYToExtCRSY</a>(pPtiEnd-&gt;<a class="code hl_function" href="../../d6/d0d/classCGeom2DIPoint.html#a4d9c20bcca90dcb9d519b664aba09cbd">nGetY</a>()));</div>
<div class="line"><a id="l00817" name="l00817"></a><span class="lineno">  817</span> </div>
<div class="line"><a id="l00818" name="l00818"></a><span class="lineno">  818</span>      <span class="comment">// LogStream &lt;&lt; m_ulIter &lt;&lt; &quot;: profile endpoint is now within the grid [&quot; &lt;&lt; pPtiEnd-&gt;nGetX() &lt;&lt; &quot;][&quot; &lt;&lt; pPtiEnd-&gt;nGetY() &lt;&lt; &quot;] = {&quot; &lt;&lt; pPtEnd-&gt;dGetX() &lt;&lt; &quot;, &quot; &lt;&lt; pPtEnd-&gt;dGetY() &lt;&lt; &quot;}. The profile starts at coastline point &quot; &lt;&lt; nStartCoastPoint &lt;&lt; &quot; = {&quot; &lt;&lt; pPtStart-&gt;dGetX() &lt;&lt; &quot;, &quot; &lt;&lt; pPtStart-&gt;dGetY() &lt;&lt; &quot;}&quot; &lt;&lt; endl;</span></div>
<div class="line"><a id="l00819" name="l00819"></a><span class="lineno">  819</span>      </div>
<div class="line"><a id="l00820" name="l00820"></a><span class="lineno">  820</span>      <span class="comment">// return RTN_ERR_PROFILE_ENDPOINT_AT_GRID_EDGE;</span></div>
<div class="line"><a id="l00821" name="l00821"></a><span class="lineno">  821</span>   }</div>
<div class="line"><a id="l00822" name="l00822"></a><span class="lineno">  822</span> </div>
<div class="line"><a id="l00823" name="l00823"></a><span class="lineno">  823</span>   <span class="keywordflow">return</span> <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#aa768cb14b5c6123ee95e6e4ebd9fe331">RTN_OK</a>;</div>
<div class="line"><a id="l00824" name="l00824"></a><span class="lineno">  824</span>}</div>
</div>
<div class="line"><a id="l00825" name="l00825"></a><span class="lineno">  825</span> </div>
<div class="line"><a id="l00826" name="l00826"></a><span class="lineno">  826</span><span class="comment">//===============================================================================================================================</span></div>
<div class="line"><a id="l00828" name="l00828"></a><span class="lineno">  828</span><span class="comment">//===============================================================================================================================</span></div>
<div class="foldopen" id="foldopen00829" data-start="{" data-end="}">
<div class="line"><a id="l00829" name="l00829"></a><span class="lineno"><a class="line" href="../../d1/d98/classCSimulation.html#a3319d10c724017519510082073494022">  829</a></span><a class="code hl_class" href="../../d5/d4e/classCGeom2DPoint.html">CGeom2DPoint</a> <a class="code hl_function" href="../../d1/d98/classCSimulation.html#a3319d10c724017519510082073494022">CSimulation::PtChooseEndPoint</a>(<span class="keywordtype">int</span> <span class="keyword">const</span> nHand, <a class="code hl_class" href="../../d5/d4e/classCGeom2DPoint.html">CGeom2DPoint</a> <span class="keyword">const</span> *PtBefore, <a class="code hl_class" href="../../d5/d4e/classCGeom2DPoint.html">CGeom2DPoint</a> <span class="keyword">const</span> *PtAfter, <span class="keywordtype">double</span> <span class="keyword">const</span> dXEnd1, <span class="keywordtype">double</span> <span class="keyword">const</span> dYEnd1, <span class="keywordtype">double</span> <span class="keyword">const</span> dXEnd2, <span class="keywordtype">double</span> <span class="keyword">const</span> dYEnd2)</div>
<div class="line"><a id="l00830" name="l00830"></a><span class="lineno">  830</span>{</div>
<div class="line"><a id="l00831" name="l00831"></a><span class="lineno">  831</span>   <a class="code hl_class" href="../../d5/d4e/classCGeom2DPoint.html">CGeom2DPoint</a> PtChosen;</div>
<div class="line"><a id="l00832" name="l00832"></a><span class="lineno">  832</span> </div>
<div class="line"><a id="l00833" name="l00833"></a><span class="lineno">  833</span>   <span class="comment">// All coordinates here are in the external CRS, so the origin of the grid is the bottom left</span></div>
<div class="line"><a id="l00834" name="l00834"></a><span class="lineno">  834</span>   <span class="keywordflow">if</span> (nHand == <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#ade186989e07cd54874887cd10d4a8465">RIGHT_HANDED</a>)</div>
<div class="line"><a id="l00835" name="l00835"></a><span class="lineno">  835</span>   {</div>
<div class="line"><a id="l00836" name="l00836"></a><span class="lineno">  836</span>      <span class="comment">// The sea is to the right of the linking line. So which way is the linking line oriented? First check the N-S component</span></div>
<div class="line"><a id="l00837" name="l00837"></a><span class="lineno">  837</span>      <span class="keywordflow">if</span> (PtAfter-&gt;<a class="code hl_function" href="../../d5/d4e/classCGeom2DPoint.html#a216921dc2c592d9468e6430fee7c7719">dGetY</a>() &gt; PtBefore-&gt;<a class="code hl_function" href="../../d5/d4e/classCGeom2DPoint.html#a216921dc2c592d9468e6430fee7c7719">dGetY</a>())</div>
<div class="line"><a id="l00838" name="l00838"></a><span class="lineno">  838</span>      {</div>
<div class="line"><a id="l00839" name="l00839"></a><span class="lineno">  839</span>         <span class="comment">// We are going S to N and the sea is to the right: the normal endpoint is to the E. We want the larger of the two x values</span></div>
<div class="line"><a id="l00840" name="l00840"></a><span class="lineno">  840</span>         <span class="keywordflow">if</span> (dXEnd1 &gt; dXEnd2)</div>
<div class="line"><a id="l00841" name="l00841"></a><span class="lineno">  841</span>         {</div>
<div class="line"><a id="l00842" name="l00842"></a><span class="lineno">  842</span>            PtChosen.<a class="code hl_function" href="../../d5/d4e/classCGeom2DPoint.html#af5dfdef4b78c0703800049b064483278">SetX</a>(dXEnd1);</div>
<div class="line"><a id="l00843" name="l00843"></a><span class="lineno">  843</span>            PtChosen.<a class="code hl_function" href="../../d5/d4e/classCGeom2DPoint.html#a1dff4e8adee61e6fe5c5062d6ba88f01">SetY</a>(dYEnd1);</div>
<div class="line"><a id="l00844" name="l00844"></a><span class="lineno">  844</span>         }</div>
<div class="line"><a id="l00845" name="l00845"></a><span class="lineno">  845</span>         <span class="keywordflow">else</span></div>
<div class="line"><a id="l00846" name="l00846"></a><span class="lineno">  846</span>         {</div>
<div class="line"><a id="l00847" name="l00847"></a><span class="lineno">  847</span>            PtChosen.<a class="code hl_function" href="../../d5/d4e/classCGeom2DPoint.html#af5dfdef4b78c0703800049b064483278">SetX</a>(dXEnd2);</div>
<div class="line"><a id="l00848" name="l00848"></a><span class="lineno">  848</span>            PtChosen.<a class="code hl_function" href="../../d5/d4e/classCGeom2DPoint.html#a1dff4e8adee61e6fe5c5062d6ba88f01">SetY</a>(dYEnd2);</div>
<div class="line"><a id="l00849" name="l00849"></a><span class="lineno">  849</span>         }</div>
<div class="line"><a id="l00850" name="l00850"></a><span class="lineno">  850</span>      }</div>
<div class="line"><a id="l00851" name="l00851"></a><span class="lineno">  851</span>      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (PtAfter-&gt;<a class="code hl_function" href="../../d5/d4e/classCGeom2DPoint.html#a216921dc2c592d9468e6430fee7c7719">dGetY</a>() &lt; PtBefore-&gt;<a class="code hl_function" href="../../d5/d4e/classCGeom2DPoint.html#a216921dc2c592d9468e6430fee7c7719">dGetY</a>())</div>
<div class="line"><a id="l00852" name="l00852"></a><span class="lineno">  852</span>      {</div>
<div class="line"><a id="l00853" name="l00853"></a><span class="lineno">  853</span>         <span class="comment">// We are going N to S and the sea is to the right: the normal endpoint is to the W. We want the smaller of the two x values</span></div>
<div class="line"><a id="l00854" name="l00854"></a><span class="lineno">  854</span>         <span class="keywordflow">if</span> (dXEnd1 &lt; dXEnd2)</div>
<div class="line"><a id="l00855" name="l00855"></a><span class="lineno">  855</span>         {</div>
<div class="line"><a id="l00856" name="l00856"></a><span class="lineno">  856</span>            PtChosen.<a class="code hl_function" href="../../d5/d4e/classCGeom2DPoint.html#af5dfdef4b78c0703800049b064483278">SetX</a>(dXEnd1);</div>
<div class="line"><a id="l00857" name="l00857"></a><span class="lineno">  857</span>            PtChosen.<a class="code hl_function" href="../../d5/d4e/classCGeom2DPoint.html#a1dff4e8adee61e6fe5c5062d6ba88f01">SetY</a>(dYEnd1);</div>
<div class="line"><a id="l00858" name="l00858"></a><span class="lineno">  858</span>         }</div>
<div class="line"><a id="l00859" name="l00859"></a><span class="lineno">  859</span>         <span class="keywordflow">else</span></div>
<div class="line"><a id="l00860" name="l00860"></a><span class="lineno">  860</span>         {</div>
<div class="line"><a id="l00861" name="l00861"></a><span class="lineno">  861</span>            PtChosen.<a class="code hl_function" href="../../d5/d4e/classCGeom2DPoint.html#af5dfdef4b78c0703800049b064483278">SetX</a>(dXEnd2);</div>
<div class="line"><a id="l00862" name="l00862"></a><span class="lineno">  862</span>            PtChosen.<a class="code hl_function" href="../../d5/d4e/classCGeom2DPoint.html#a1dff4e8adee61e6fe5c5062d6ba88f01">SetY</a>(dYEnd2);</div>
<div class="line"><a id="l00863" name="l00863"></a><span class="lineno">  863</span>         }</div>
<div class="line"><a id="l00864" name="l00864"></a><span class="lineno">  864</span>      }</div>
<div class="line"><a id="l00865" name="l00865"></a><span class="lineno">  865</span>      <span class="keywordflow">else</span></div>
<div class="line"><a id="l00866" name="l00866"></a><span class="lineno">  866</span>      {</div>
<div class="line"><a id="l00867" name="l00867"></a><span class="lineno">  867</span>         <span class="comment">// No N-S component i.e. the linking line is exactly W-E. So check the W-E component</span></div>
<div class="line"><a id="l00868" name="l00868"></a><span class="lineno">  868</span>         <span class="keywordflow">if</span> (PtAfter-&gt;<a class="code hl_function" href="../../d5/d4e/classCGeom2DPoint.html#a250f937d03cfdf6e0244b74ad2bf96a4">dGetX</a>() &gt; PtBefore-&gt;<a class="code hl_function" href="../../d5/d4e/classCGeom2DPoint.html#a250f937d03cfdf6e0244b74ad2bf96a4">dGetX</a>())</div>
<div class="line"><a id="l00869" name="l00869"></a><span class="lineno">  869</span>         {</div>
<div class="line"><a id="l00870" name="l00870"></a><span class="lineno">  870</span>            <span class="comment">// We are going W to E and the sea is to the right: the normal endpoint is to the s. We want the smaller of the two y values</span></div>
<div class="line"><a id="l00871" name="l00871"></a><span class="lineno">  871</span>            <span class="keywordflow">if</span> (dYEnd1 &lt; dYEnd2)</div>
<div class="line"><a id="l00872" name="l00872"></a><span class="lineno">  872</span>            {</div>
<div class="line"><a id="l00873" name="l00873"></a><span class="lineno">  873</span>               PtChosen.<a class="code hl_function" href="../../d5/d4e/classCGeom2DPoint.html#af5dfdef4b78c0703800049b064483278">SetX</a>(dXEnd1);</div>
<div class="line"><a id="l00874" name="l00874"></a><span class="lineno">  874</span>               PtChosen.<a class="code hl_function" href="../../d5/d4e/classCGeom2DPoint.html#a1dff4e8adee61e6fe5c5062d6ba88f01">SetY</a>(dYEnd1);</div>
<div class="line"><a id="l00875" name="l00875"></a><span class="lineno">  875</span>            }</div>
<div class="line"><a id="l00876" name="l00876"></a><span class="lineno">  876</span>            <span class="keywordflow">else</span></div>
<div class="line"><a id="l00877" name="l00877"></a><span class="lineno">  877</span>            {</div>
<div class="line"><a id="l00878" name="l00878"></a><span class="lineno">  878</span>               PtChosen.<a class="code hl_function" href="../../d5/d4e/classCGeom2DPoint.html#af5dfdef4b78c0703800049b064483278">SetX</a>(dXEnd2);</div>
<div class="line"><a id="l00879" name="l00879"></a><span class="lineno">  879</span>               PtChosen.<a class="code hl_function" href="../../d5/d4e/classCGeom2DPoint.html#a1dff4e8adee61e6fe5c5062d6ba88f01">SetY</a>(dYEnd2);</div>
<div class="line"><a id="l00880" name="l00880"></a><span class="lineno">  880</span>            }</div>
<div class="line"><a id="l00881" name="l00881"></a><span class="lineno">  881</span>         }</div>
<div class="line"><a id="l00882" name="l00882"></a><span class="lineno">  882</span>         <span class="keywordflow">else</span> <span class="comment">// Do not check for (PtAfter-&gt;dGetX() == PtBefore-&gt;dGetX()), since this would mean the two points are co-incident</span></div>
<div class="line"><a id="l00883" name="l00883"></a><span class="lineno">  883</span>         {</div>
<div class="line"><a id="l00884" name="l00884"></a><span class="lineno">  884</span>            <span class="comment">// We are going E to W and the sea is to the right: the normal endpoint is to the N. We want the larger of the two y values</span></div>
<div class="line"><a id="l00885" name="l00885"></a><span class="lineno">  885</span>            <span class="keywordflow">if</span> (dYEnd1 &gt; dYEnd2)</div>
<div class="line"><a id="l00886" name="l00886"></a><span class="lineno">  886</span>            {</div>
<div class="line"><a id="l00887" name="l00887"></a><span class="lineno">  887</span>               PtChosen.<a class="code hl_function" href="../../d5/d4e/classCGeom2DPoint.html#af5dfdef4b78c0703800049b064483278">SetX</a>(dXEnd1);</div>
<div class="line"><a id="l00888" name="l00888"></a><span class="lineno">  888</span>               PtChosen.<a class="code hl_function" href="../../d5/d4e/classCGeom2DPoint.html#a1dff4e8adee61e6fe5c5062d6ba88f01">SetY</a>(dYEnd1);</div>
<div class="line"><a id="l00889" name="l00889"></a><span class="lineno">  889</span>            }</div>
<div class="line"><a id="l00890" name="l00890"></a><span class="lineno">  890</span>            <span class="keywordflow">else</span></div>
<div class="line"><a id="l00891" name="l00891"></a><span class="lineno">  891</span>            {</div>
<div class="line"><a id="l00892" name="l00892"></a><span class="lineno">  892</span>               PtChosen.<a class="code hl_function" href="../../d5/d4e/classCGeom2DPoint.html#af5dfdef4b78c0703800049b064483278">SetX</a>(dXEnd2);</div>
<div class="line"><a id="l00893" name="l00893"></a><span class="lineno">  893</span>               PtChosen.<a class="code hl_function" href="../../d5/d4e/classCGeom2DPoint.html#a1dff4e8adee61e6fe5c5062d6ba88f01">SetY</a>(dYEnd2);</div>
<div class="line"><a id="l00894" name="l00894"></a><span class="lineno">  894</span>            }</div>
<div class="line"><a id="l00895" name="l00895"></a><span class="lineno">  895</span>         }</div>
<div class="line"><a id="l00896" name="l00896"></a><span class="lineno">  896</span>      }</div>
<div class="line"><a id="l00897" name="l00897"></a><span class="lineno">  897</span>   }</div>
<div class="line"><a id="l00898" name="l00898"></a><span class="lineno">  898</span>   <span class="keywordflow">else</span> <span class="comment">// nHand == LEFT_HANDED</span></div>
<div class="line"><a id="l00899" name="l00899"></a><span class="lineno">  899</span>   {</div>
<div class="line"><a id="l00900" name="l00900"></a><span class="lineno">  900</span>      <span class="comment">// The sea is to the left of the linking line. So which way is the linking line oriented? First check the N-S component</span></div>
<div class="line"><a id="l00901" name="l00901"></a><span class="lineno">  901</span>      <span class="keywordflow">if</span> (PtAfter-&gt;<a class="code hl_function" href="../../d5/d4e/classCGeom2DPoint.html#a216921dc2c592d9468e6430fee7c7719">dGetY</a>() &gt; PtBefore-&gt;<a class="code hl_function" href="../../d5/d4e/classCGeom2DPoint.html#a216921dc2c592d9468e6430fee7c7719">dGetY</a>())</div>
<div class="line"><a id="l00902" name="l00902"></a><span class="lineno">  902</span>      {</div>
<div class="line"><a id="l00903" name="l00903"></a><span class="lineno">  903</span>         <span class="comment">// We are going S to N and the sea is to the left: the normal endpoint is to the W. We want the smaller of the two x values</span></div>
<div class="line"><a id="l00904" name="l00904"></a><span class="lineno">  904</span>         <span class="keywordflow">if</span> (dXEnd1 &lt; dXEnd2)</div>
<div class="line"><a id="l00905" name="l00905"></a><span class="lineno">  905</span>         {</div>
<div class="line"><a id="l00906" name="l00906"></a><span class="lineno">  906</span>            PtChosen.<a class="code hl_function" href="../../d5/d4e/classCGeom2DPoint.html#af5dfdef4b78c0703800049b064483278">SetX</a>(dXEnd1);</div>
<div class="line"><a id="l00907" name="l00907"></a><span class="lineno">  907</span>            PtChosen.<a class="code hl_function" href="../../d5/d4e/classCGeom2DPoint.html#a1dff4e8adee61e6fe5c5062d6ba88f01">SetY</a>(dYEnd1);</div>
<div class="line"><a id="l00908" name="l00908"></a><span class="lineno">  908</span>         }</div>
<div class="line"><a id="l00909" name="l00909"></a><span class="lineno">  909</span>         <span class="keywordflow">else</span></div>
<div class="line"><a id="l00910" name="l00910"></a><span class="lineno">  910</span>         {</div>
<div class="line"><a id="l00911" name="l00911"></a><span class="lineno">  911</span>            PtChosen.<a class="code hl_function" href="../../d5/d4e/classCGeom2DPoint.html#af5dfdef4b78c0703800049b064483278">SetX</a>(dXEnd2);</div>
<div class="line"><a id="l00912" name="l00912"></a><span class="lineno">  912</span>            PtChosen.<a class="code hl_function" href="../../d5/d4e/classCGeom2DPoint.html#a1dff4e8adee61e6fe5c5062d6ba88f01">SetY</a>(dYEnd2);</div>
<div class="line"><a id="l00913" name="l00913"></a><span class="lineno">  913</span>         }</div>
<div class="line"><a id="l00914" name="l00914"></a><span class="lineno">  914</span>      }</div>
<div class="line"><a id="l00915" name="l00915"></a><span class="lineno">  915</span>      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (PtAfter-&gt;<a class="code hl_function" href="../../d5/d4e/classCGeom2DPoint.html#a216921dc2c592d9468e6430fee7c7719">dGetY</a>() &lt; PtBefore-&gt;<a class="code hl_function" href="../../d5/d4e/classCGeom2DPoint.html#a216921dc2c592d9468e6430fee7c7719">dGetY</a>())</div>
<div class="line"><a id="l00916" name="l00916"></a><span class="lineno">  916</span>      {</div>
<div class="line"><a id="l00917" name="l00917"></a><span class="lineno">  917</span>         <span class="comment">// We are going N to S and the sea is to the left: the normal endpoint is to the E. We want the larger of the two x values</span></div>
<div class="line"><a id="l00918" name="l00918"></a><span class="lineno">  918</span>         <span class="keywordflow">if</span> (dXEnd1 &gt; dXEnd2)</div>
<div class="line"><a id="l00919" name="l00919"></a><span class="lineno">  919</span>         {</div>
<div class="line"><a id="l00920" name="l00920"></a><span class="lineno">  920</span>            PtChosen.<a class="code hl_function" href="../../d5/d4e/classCGeom2DPoint.html#af5dfdef4b78c0703800049b064483278">SetX</a>(dXEnd1);</div>
<div class="line"><a id="l00921" name="l00921"></a><span class="lineno">  921</span>            PtChosen.<a class="code hl_function" href="../../d5/d4e/classCGeom2DPoint.html#a1dff4e8adee61e6fe5c5062d6ba88f01">SetY</a>(dYEnd1);</div>
<div class="line"><a id="l00922" name="l00922"></a><span class="lineno">  922</span>         }</div>
<div class="line"><a id="l00923" name="l00923"></a><span class="lineno">  923</span>         <span class="keywordflow">else</span></div>
<div class="line"><a id="l00924" name="l00924"></a><span class="lineno">  924</span>         {</div>
<div class="line"><a id="l00925" name="l00925"></a><span class="lineno">  925</span>            PtChosen.<a class="code hl_function" href="../../d5/d4e/classCGeom2DPoint.html#af5dfdef4b78c0703800049b064483278">SetX</a>(dXEnd2);</div>
<div class="line"><a id="l00926" name="l00926"></a><span class="lineno">  926</span>            PtChosen.<a class="code hl_function" href="../../d5/d4e/classCGeom2DPoint.html#a1dff4e8adee61e6fe5c5062d6ba88f01">SetY</a>(dYEnd2);</div>
<div class="line"><a id="l00927" name="l00927"></a><span class="lineno">  927</span>         }</div>
<div class="line"><a id="l00928" name="l00928"></a><span class="lineno">  928</span>      }</div>
<div class="line"><a id="l00929" name="l00929"></a><span class="lineno">  929</span>      <span class="keywordflow">else</span></div>
<div class="line"><a id="l00930" name="l00930"></a><span class="lineno">  930</span>      {</div>
<div class="line"><a id="l00931" name="l00931"></a><span class="lineno">  931</span>         <span class="comment">// No N-S component i.e. the linking line is exactly W-E. So check the W-E component</span></div>
<div class="line"><a id="l00932" name="l00932"></a><span class="lineno">  932</span>         <span class="keywordflow">if</span> (PtAfter-&gt;<a class="code hl_function" href="../../d5/d4e/classCGeom2DPoint.html#a250f937d03cfdf6e0244b74ad2bf96a4">dGetX</a>() &gt; PtBefore-&gt;<a class="code hl_function" href="../../d5/d4e/classCGeom2DPoint.html#a250f937d03cfdf6e0244b74ad2bf96a4">dGetX</a>())</div>
<div class="line"><a id="l00933" name="l00933"></a><span class="lineno">  933</span>         {</div>
<div class="line"><a id="l00934" name="l00934"></a><span class="lineno">  934</span>            <span class="comment">// We are going W to E and the sea is to the left: the normal endpoint is to the N. We want the larger of the two y values</span></div>
<div class="line"><a id="l00935" name="l00935"></a><span class="lineno">  935</span>            <span class="keywordflow">if</span> (dYEnd1 &gt; dYEnd2)</div>
<div class="line"><a id="l00936" name="l00936"></a><span class="lineno">  936</span>            {</div>
<div class="line"><a id="l00937" name="l00937"></a><span class="lineno">  937</span>               PtChosen.<a class="code hl_function" href="../../d5/d4e/classCGeom2DPoint.html#af5dfdef4b78c0703800049b064483278">SetX</a>(dXEnd1);</div>
<div class="line"><a id="l00938" name="l00938"></a><span class="lineno">  938</span>               PtChosen.<a class="code hl_function" href="../../d5/d4e/classCGeom2DPoint.html#a1dff4e8adee61e6fe5c5062d6ba88f01">SetY</a>(dYEnd1);</div>
<div class="line"><a id="l00939" name="l00939"></a><span class="lineno">  939</span>            }</div>
<div class="line"><a id="l00940" name="l00940"></a><span class="lineno">  940</span>            <span class="keywordflow">else</span></div>
<div class="line"><a id="l00941" name="l00941"></a><span class="lineno">  941</span>            {</div>
<div class="line"><a id="l00942" name="l00942"></a><span class="lineno">  942</span>               PtChosen.<a class="code hl_function" href="../../d5/d4e/classCGeom2DPoint.html#af5dfdef4b78c0703800049b064483278">SetX</a>(dXEnd2);</div>
<div class="line"><a id="l00943" name="l00943"></a><span class="lineno">  943</span>               PtChosen.<a class="code hl_function" href="../../d5/d4e/classCGeom2DPoint.html#a1dff4e8adee61e6fe5c5062d6ba88f01">SetY</a>(dYEnd2);</div>
<div class="line"><a id="l00944" name="l00944"></a><span class="lineno">  944</span>            }</div>
<div class="line"><a id="l00945" name="l00945"></a><span class="lineno">  945</span>         }</div>
<div class="line"><a id="l00946" name="l00946"></a><span class="lineno">  946</span>         <span class="keywordflow">else</span> <span class="comment">// Do not check for (PtAfter-&gt;dGetX() == PtBefore-&gt;dGetX()), since this would mean the two points are co-incident</span></div>
<div class="line"><a id="l00947" name="l00947"></a><span class="lineno">  947</span>         {</div>
<div class="line"><a id="l00948" name="l00948"></a><span class="lineno">  948</span>            <span class="comment">// We are going E to W and the sea is to the left: the normal endpoint is to the S. We want the smaller of the two y values</span></div>
<div class="line"><a id="l00949" name="l00949"></a><span class="lineno">  949</span>            <span class="keywordflow">if</span> (dYEnd1 &lt; dYEnd2)</div>
<div class="line"><a id="l00950" name="l00950"></a><span class="lineno">  950</span>            {</div>
<div class="line"><a id="l00951" name="l00951"></a><span class="lineno">  951</span>               PtChosen.<a class="code hl_function" href="../../d5/d4e/classCGeom2DPoint.html#af5dfdef4b78c0703800049b064483278">SetX</a>(dXEnd1);</div>
<div class="line"><a id="l00952" name="l00952"></a><span class="lineno">  952</span>               PtChosen.<a class="code hl_function" href="../../d5/d4e/classCGeom2DPoint.html#a1dff4e8adee61e6fe5c5062d6ba88f01">SetY</a>(dYEnd1);</div>
<div class="line"><a id="l00953" name="l00953"></a><span class="lineno">  953</span>            }</div>
<div class="line"><a id="l00954" name="l00954"></a><span class="lineno">  954</span>            <span class="keywordflow">else</span></div>
<div class="line"><a id="l00955" name="l00955"></a><span class="lineno">  955</span>            {</div>
<div class="line"><a id="l00956" name="l00956"></a><span class="lineno">  956</span>               PtChosen.<a class="code hl_function" href="../../d5/d4e/classCGeom2DPoint.html#af5dfdef4b78c0703800049b064483278">SetX</a>(dXEnd2);</div>
<div class="line"><a id="l00957" name="l00957"></a><span class="lineno">  957</span>               PtChosen.<a class="code hl_function" href="../../d5/d4e/classCGeom2DPoint.html#a1dff4e8adee61e6fe5c5062d6ba88f01">SetY</a>(dYEnd2);</div>
<div class="line"><a id="l00958" name="l00958"></a><span class="lineno">  958</span>            }</div>
<div class="line"><a id="l00959" name="l00959"></a><span class="lineno">  959</span>         }</div>
<div class="line"><a id="l00960" name="l00960"></a><span class="lineno">  960</span>      }</div>
<div class="line"><a id="l00961" name="l00961"></a><span class="lineno">  961</span>   }</div>
<div class="line"><a id="l00962" name="l00962"></a><span class="lineno">  962</span> </div>
<div class="line"><a id="l00963" name="l00963"></a><span class="lineno">  963</span>   <span class="keywordflow">return</span> PtChosen;</div>
<div class="line"><a id="l00964" name="l00964"></a><span class="lineno">  964</span>}</div>
</div>
<div class="line"><a id="l00965" name="l00965"></a><span class="lineno">  965</span> </div>
<div class="line"><a id="l00966" name="l00966"></a><span class="lineno">  966</span><span class="comment">//===============================================================================================================================</span></div>
<div class="line"><a id="l00968" name="l00968"></a><span class="lineno">  968</span><span class="comment">//===============================================================================================================================</span></div>
<div class="foldopen" id="foldopen00969" data-start="{" data-end="}">
<div class="line"><a id="l00969" name="l00969"></a><span class="lineno"><a class="line" href="../../d1/d98/classCSimulation.html#a79672effdabadec1d3eebb9d08ef6248">  969</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="../../d1/d98/classCSimulation.html#a79672effdabadec1d3eebb9d08ef6248">CSimulation::CheckForIntersectingProfiles</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a id="l00970" name="l00970"></a><span class="lineno">  970</span>{</div>
<div class="line"><a id="l00971" name="l00971"></a><span class="lineno">  971</span>   <span class="comment">// Do once for every coastline object</span></div>
<div class="line"><a id="l00972" name="l00972"></a><span class="lineno">  972</span>   <span class="keywordtype">int</span> nCoastLines = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a25ada8139c82ca7beab3f279cff83184">m_VCoast</a>.size());</div>
<div class="line"><a id="l00973" name="l00973"></a><span class="lineno">  973</span>   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> nCoast = 0; nCoast &lt; nCoastLines; nCoast++)</div>
<div class="line"><a id="l00974" name="l00974"></a><span class="lineno">  974</span>   {</div>
<div class="line"><a id="l00975" name="l00975"></a><span class="lineno">  975</span>      <span class="keywordtype">int</span> nCoastSize = <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a25ada8139c82ca7beab3f279cff83184">m_VCoast</a>[nCoast].nGetCoastlineSize();</div>
<div class="line"><a id="l00976" name="l00976"></a><span class="lineno">  976</span> </div>
<div class="line"><a id="l00977" name="l00977"></a><span class="lineno">  977</span>      <span class="comment">// Do once for every profile, in along-coast sequence</span></div>
<div class="line"><a id="l00978" name="l00978"></a><span class="lineno">  978</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> nCoastPoint = 0; nCoastPoint &lt; nCoastSize; nCoastPoint++)</div>
<div class="line"><a id="l00979" name="l00979"></a><span class="lineno">  979</span>      {</div>
<div class="line"><a id="l00980" name="l00980"></a><span class="lineno">  980</span>         <span class="keywordflow">if</span> (! <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a25ada8139c82ca7beab3f279cff83184">m_VCoast</a>[nCoast].bIsProfileAtCoastPoint(nCoastPoint))</div>
<div class="line"><a id="l00981" name="l00981"></a><span class="lineno">  981</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l00982" name="l00982"></a><span class="lineno">  982</span> </div>
<div class="line"><a id="l00983" name="l00983"></a><span class="lineno">  983</span>         <span class="comment">// There is a profile at this coast point</span></div>
<div class="line"><a id="l00984" name="l00984"></a><span class="lineno">  984</span>         <a class="code hl_class" href="../../da/dae/classCGeomProfile.html">CGeomProfile</a>* pFirstProfile = <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a25ada8139c82ca7beab3f279cff83184">m_VCoast</a>[nCoast].pGetProfileAtCoastPoint(nCoastPoint);</div>
<div class="line"><a id="l00985" name="l00985"></a><span class="lineno">  985</span>         <span class="keywordtype">int</span> nFirstProfile = pFirstProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#aacd98f9837c3c7cf7414764b73275fba">nGetCoastID</a>();</div>
<div class="line"><a id="l00986" name="l00986"></a><span class="lineno">  986</span> </div>
<div class="line"><a id="l00987" name="l00987"></a><span class="lineno">  987</span>         <span class="comment">// Only check this profile if it is problem free, and is not a start- or end-of-coast profile. Continue checking if it has been truncated, however</span></div>
<div class="line"><a id="l00988" name="l00988"></a><span class="lineno">  988</span>         <span class="keywordflow">if</span> (! pFirstProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#a549667479e1bf1e9bf5dc1119aeba017">bProfileOKIncTruncated</a>())</div>
<div class="line"><a id="l00989" name="l00989"></a><span class="lineno">  989</span>         {</div>
<div class="line"><a id="l00990" name="l00990"></a><span class="lineno">  990</span>            <span class="comment">// LogStream &lt;&lt; m_ulIter &lt;&lt; &quot;: nCoastPoint = &quot; &lt;&lt; nCoastPoint &lt;&lt; &quot; pFirstProfile = &quot; &lt;&lt; pFirstProfile-&gt;nGetCoastID() &lt;&lt; &quot; is not OK (could be a start- or end-of-coast profile), abandoning&quot; &lt;&lt; endl;</span></div>
<div class="line"><a id="l00991" name="l00991"></a><span class="lineno">  991</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l00992" name="l00992"></a><span class="lineno">  992</span>         }</div>
<div class="line"><a id="l00993" name="l00993"></a><span class="lineno">  993</span> </div>
<div class="line"><a id="l00994" name="l00994"></a><span class="lineno">  994</span>         <span class="comment">// OK we have found a first profile. Now go along the coast in alternate directions: first down-coast (in the direction of increasing coast point numbers) then up-coast</span></div>
<div class="line"><a id="l00995" name="l00995"></a><span class="lineno">  995</span>         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> nDirection = <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#a29fcc12f725cf70f82b391b4fd46d171">DIRECTION_DOWNCOAST</a>; nDirection &lt;= <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#abe5cabe81fdbe153e73fd894b3794e50">DIRECTION_UPCOAST</a>; nDirection++)</div>
<div class="line"><a id="l00996" name="l00996"></a><span class="lineno">  996</span>         {</div>
<div class="line"><a id="l00997" name="l00997"></a><span class="lineno">  997</span>            <span class="comment">// In this direction, look at profiles which are increasingly close to the first profile</span></div>
<div class="line"><a id="l00998" name="l00998"></a><span class="lineno">  998</span>            <span class="keywordtype">int</span> nStartPoint;</div>
<div class="line"><a id="l00999" name="l00999"></a><span class="lineno">  999</span>            <span class="keywordflow">if</span> (nDirection == <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#a29fcc12f725cf70f82b391b4fd46d171">DIRECTION_DOWNCOAST</a>)</div>
<div class="line"><a id="l01000" name="l01000"></a><span class="lineno"> 1000</span>               nStartPoint = 0;</div>
<div class="line"><a id="l01001" name="l01001"></a><span class="lineno"> 1001</span>            <span class="keywordflow">else</span></div>
<div class="line"><a id="l01002" name="l01002"></a><span class="lineno"> 1002</span>               nStartPoint = nCoastSize - 1;</div>
<div class="line"><a id="l01003" name="l01003"></a><span class="lineno"> 1003</span> </div>
<div class="line"><a id="l01004" name="l01004"></a><span class="lineno"> 1004</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> nSecondCoastPoint = nStartPoint; (nDirection == <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#a29fcc12f725cf70f82b391b4fd46d171">DIRECTION_DOWNCOAST</a>) ? nSecondCoastPoint &lt; nCoastPoint : nSecondCoastPoint &gt; nCoastPoint; (nDirection == <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#a29fcc12f725cf70f82b391b4fd46d171">DIRECTION_DOWNCOAST</a>) ? nSecondCoastPoint++ : nSecondCoastPoint--)</div>
<div class="line"><a id="l01005" name="l01005"></a><span class="lineno"> 1005</span>            {</div>
<div class="line"><a id="l01006" name="l01006"></a><span class="lineno"> 1006</span>               <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a25ada8139c82ca7beab3f279cff83184">m_VCoast</a>[nCoast].bIsProfileAtCoastPoint(nSecondCoastPoint))</div>
<div class="line"><a id="l01007" name="l01007"></a><span class="lineno"> 1007</span>               {</div>
<div class="line"><a id="l01008" name="l01008"></a><span class="lineno"> 1008</span>                  <span class="comment">// There is a profile at the second coast point, so get a pointer to it</span></div>
<div class="line"><a id="l01009" name="l01009"></a><span class="lineno"> 1009</span>                  <a class="code hl_class" href="../../da/dae/classCGeomProfile.html">CGeomProfile</a>* pSecondProfile = <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a25ada8139c82ca7beab3f279cff83184">m_VCoast</a>[nCoast].pGetProfileAtCoastPoint(nSecondCoastPoint);</div>
<div class="line"><a id="l01010" name="l01010"></a><span class="lineno"> 1010</span>                  <span class="keywordtype">int</span> nSecondProfile = pSecondProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#aacd98f9837c3c7cf7414764b73275fba">nGetCoastID</a>();</div>
<div class="line"><a id="l01011" name="l01011"></a><span class="lineno"> 1011</span> </div>
<div class="line"><a id="l01012" name="l01012"></a><span class="lineno"> 1012</span>                  <span class="comment">// LogStream &lt;&lt; m_ulIter &lt;&lt; &quot;: &quot; &lt;&lt; (nDirection == DIRECTION_DOWNCOAST ? &quot;down&quot; : &quot;up&quot;) &lt;&lt; &quot;-coast search, nCoastPoint = &quot; &lt;&lt; nCoastPoint &lt;&lt; &quot; nSecondCoastPoint = &quot; &lt;&lt; nSecondCoastPoint &lt;&lt; &quot; (profiles &quot; &lt;&lt; pFirstProfile-&gt;nGetCoastID() &lt;&lt; &quot; and &quot; &lt;&lt; pSecondProfile-&gt;nGetCoastID() &lt;&lt; &quot;)&quot; &lt;&lt; endl;</span></div>
<div class="line"><a id="l01013" name="l01013"></a><span class="lineno"> 1013</span> </div>
<div class="line"><a id="l01014" name="l01014"></a><span class="lineno"> 1014</span>                  <span class="comment">// Only check this profile if it is problem free, and is not a start- or end-of-coast profile. Continue checking if it has been truncated, however</span></div>
<div class="line"><a id="l01015" name="l01015"></a><span class="lineno"> 1015</span>                  <span class="keywordflow">if</span> (! pSecondProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#a549667479e1bf1e9bf5dc1119aeba017">bProfileOKIncTruncated</a>())</div>
<div class="line"><a id="l01016" name="l01016"></a><span class="lineno"> 1016</span>                  {</div>
<div class="line"><a id="l01017" name="l01017"></a><span class="lineno"> 1017</span>                     <span class="comment">// LogStream &lt;&lt; m_ulIter &lt;&lt; &quot;: second profile = &quot; &lt;&lt; pSecondProfile-&gt;nGetCoastID() &lt;&lt; &quot; is not OK (could be a start- or end-of-coast profile), abandoning&quot; &lt;&lt; endl;</span></div>
<div class="line"><a id="l01018" name="l01018"></a><span class="lineno"> 1018</span>                     <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l01019" name="l01019"></a><span class="lineno"> 1019</span>                  }</div>
<div class="line"><a id="l01020" name="l01020"></a><span class="lineno"> 1020</span> </div>
<div class="line"><a id="l01021" name="l01021"></a><span class="lineno"> 1021</span>                  <span class="comment">// Only check these two profiles for intersection if they are are not co-incident in the final line segment of both profiles (i.e. the profiles have not already intersected)</span></div>
<div class="line"><a id="l01022" name="l01022"></a><span class="lineno"> 1022</span>                  <span class="keywordflow">if</span> ((pFirstProfile-&gt;<a class="code hl_function" href="../../d0/d89/classCGeomMultiLine.html#a3063e454f1e7ef2b32484cf8c7db0e97">bFindProfileInCoincidentProfilesOfLastLineSegment</a>(nSecondProfile)) || (pSecondProfile-&gt;<a class="code hl_function" href="../../d0/d89/classCGeomMultiLine.html#a3063e454f1e7ef2b32484cf8c7db0e97">bFindProfileInCoincidentProfilesOfLastLineSegment</a>(nFirstProfile)))</div>
<div class="line"><a id="l01023" name="l01023"></a><span class="lineno"> 1023</span>                  {</div>
<div class="line"><a id="l01024" name="l01024"></a><span class="lineno"> 1024</span>                     <span class="comment">// LogStream &lt;&lt; m_ulIter &lt;&lt; &quot;: profiles &quot; &lt;&lt; pFirstProfile-&gt;nGetCoastID() &lt;&lt; &quot; and &quot; &lt;&lt; pSecondProfile-&gt;nGetCoastID() &lt;&lt; &quot; are are not co-incident in the final line segment of both profiles (i.e. the profiles have not already intersected), abandoning&quot; &lt;&lt; endl;</span></div>
<div class="line"><a id="l01025" name="l01025"></a><span class="lineno"> 1025</span>                     <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l01026" name="l01026"></a><span class="lineno"> 1026</span>                  }</div>
<div class="line"><a id="l01027" name="l01027"></a><span class="lineno"> 1027</span> </div>
<div class="line"><a id="l01028" name="l01028"></a><span class="lineno"> 1028</span>                  <span class="comment">// OK go for it</span></div>
<div class="line"><a id="l01029" name="l01029"></a><span class="lineno"> 1029</span>                  <span class="keywordtype">int</span> nProf1LineSeg = 0;</div>
<div class="line"><a id="l01030" name="l01030"></a><span class="lineno"> 1030</span>                  <span class="keywordtype">int</span> nProf2LineSeg = 0;</div>
<div class="line"><a id="l01031" name="l01031"></a><span class="lineno"> 1031</span>                  <span class="keywordtype">double</span> dIntersectX = 0;</div>
<div class="line"><a id="l01032" name="l01032"></a><span class="lineno"> 1032</span>                  <span class="keywordtype">double</span> dIntersectY = 0;</div>
<div class="line"><a id="l01033" name="l01033"></a><span class="lineno"> 1033</span>                  <span class="keywordtype">double</span> dAvgEndX = 0;</div>
<div class="line"><a id="l01034" name="l01034"></a><span class="lineno"> 1034</span>                  <span class="keywordtype">double</span> dAvgEndY = 0;</div>
<div class="line"><a id="l01035" name="l01035"></a><span class="lineno"> 1035</span> </div>
<div class="line"><a id="l01036" name="l01036"></a><span class="lineno"> 1036</span>                  <span class="keywordflow">if</span> (<a class="code hl_function" href="../../d1/d98/classCSimulation.html#a9332a150a41ac2a38157b22fe3483f15">bCheckForIntersection</a>(pFirstProfile, pSecondProfile, nProf1LineSeg, nProf2LineSeg, dIntersectX, dIntersectY, dAvgEndX, dAvgEndY))</div>
<div class="line"><a id="l01037" name="l01037"></a><span class="lineno"> 1037</span>                  {</div>
<div class="line"><a id="l01038" name="l01038"></a><span class="lineno"> 1038</span>                     <span class="comment">// The profiles intersect. Decide which profile to truncate, and which to retain</span></div>
<div class="line"><a id="l01039" name="l01039"></a><span class="lineno"> 1039</span>                     <span class="keywordtype">int</span> nPoint = -1;</div>
<div class="line"><a id="l01040" name="l01040"></a><span class="lineno"> 1040</span> </div>
<div class="line"><a id="l01041" name="l01041"></a><span class="lineno"> 1041</span>                     <span class="keywordflow">if</span> (pFirstProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#a9fc2d8b0adabc8dfa5b7f8b8400d6252">bIsIntervention</a>())</div>
<div class="line"><a id="l01042" name="l01042"></a><span class="lineno"> 1042</span>                     {</div>
<div class="line"><a id="l01043" name="l01043"></a><span class="lineno"> 1043</span>                        <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a222962121613613a48f518e0c2110f21">LogStream</a> &lt;&lt; <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#ad67e8c5b30a0572f64ecfb5c062c2edc">m_ulIter</a> &lt;&lt; <span class="stringliteral">&quot;: profiles &quot;</span> &lt;&lt; nFirstProfile &lt;&lt; <span class="stringliteral">&quot; and &quot;</span> &lt;&lt; nSecondProfile &lt;&lt; <span class="stringliteral">&quot; intersect, truncate &quot;</span> &lt;&lt; nFirstProfile &lt;&lt; <span class="stringliteral">&quot; since it is an intervention profile&quot;</span>&lt;&lt; endl;</div>
<div class="line"><a id="l01044" name="l01044"></a><span class="lineno"> 1044</span> </div>
<div class="line"><a id="l01045" name="l01045"></a><span class="lineno"> 1045</span>                        <span class="comment">// Truncate the first profile, since it is an intervention profile</span></div>
<div class="line"><a id="l01046" name="l01046"></a><span class="lineno"> 1046</span>                        <a class="code hl_function" href="../../d1/d98/classCSimulation.html#add4b97b29fde8394685fa5802467731d">TruncateOneProfileRetainOtherProfile</a>(nCoast, pFirstProfile, pSecondProfile, dIntersectX, dIntersectY, nProf1LineSeg, nProf2LineSeg, <span class="keyword">false</span>);</div>
<div class="line"><a id="l01047" name="l01047"></a><span class="lineno"> 1047</span>                     }</div>
<div class="line"><a id="l01048" name="l01048"></a><span class="lineno"> 1048</span> </div>
<div class="line"><a id="l01049" name="l01049"></a><span class="lineno"> 1049</span>                     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pSecondProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#a9fc2d8b0adabc8dfa5b7f8b8400d6252">bIsIntervention</a>())</div>
<div class="line"><a id="l01050" name="l01050"></a><span class="lineno"> 1050</span>                     {</div>
<div class="line"><a id="l01051" name="l01051"></a><span class="lineno"> 1051</span>                        <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a222962121613613a48f518e0c2110f21">LogStream</a> &lt;&lt; <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#ad67e8c5b30a0572f64ecfb5c062c2edc">m_ulIter</a> &lt;&lt; <span class="stringliteral">&quot;: profiles &quot;</span> &lt;&lt; nFirstProfile &lt;&lt; <span class="stringliteral">&quot; and &quot;</span> &lt;&lt; nSecondProfile &lt;&lt; <span class="stringliteral">&quot; intersect, truncate &quot;</span> &lt;&lt; nSecondProfile &lt;&lt; <span class="stringliteral">&quot; since it is an intervention profile&quot;</span>&lt;&lt; endl;</div>
<div class="line"><a id="l01052" name="l01052"></a><span class="lineno"> 1052</span> </div>
<div class="line"><a id="l01053" name="l01053"></a><span class="lineno"> 1053</span>                        <span class="comment">// Truncate the second profile, since it is an intervention profile</span></div>
<div class="line"><a id="l01054" name="l01054"></a><span class="lineno"> 1054</span>                        <a class="code hl_function" href="../../d1/d98/classCSimulation.html#add4b97b29fde8394685fa5802467731d">TruncateOneProfileRetainOtherProfile</a>(nCoast, pSecondProfile, pFirstProfile, dIntersectX, dIntersectY, nProf2LineSeg, nProf1LineSeg, <span class="keyword">false</span>);</div>
<div class="line"><a id="l01055" name="l01055"></a><span class="lineno"> 1055</span>                     }</div>
<div class="line"><a id="l01056" name="l01056"></a><span class="lineno"> 1056</span> </div>
<div class="line"><a id="l01057" name="l01057"></a><span class="lineno"> 1057</span>                     <span class="comment">// Is the point of intersection already present in the first profile (i.e. because there has already been an intersection at this point between the first profile and some other profile)?</span></div>
<div class="line"><a id="l01058" name="l01058"></a><span class="lineno"> 1058</span>                     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pFirstProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#a442e3a6584e1a5b76e7ace39828f2bfc">bIsPointInProfile</a>(dIntersectX, dIntersectY, nPoint))</div>
<div class="line"><a id="l01059" name="l01059"></a><span class="lineno"> 1059</span>                     {</div>
<div class="line"><a id="l01060" name="l01060"></a><span class="lineno"> 1060</span>                        <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a222962121613613a48f518e0c2110f21">LogStream</a> &lt;&lt; <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#ad67e8c5b30a0572f64ecfb5c062c2edc">m_ulIter</a> &lt;&lt; <span class="stringliteral">&quot;: profiles &quot;</span> &lt;&lt; nFirstProfile &lt;&lt; <span class="stringliteral">&quot; and &quot;</span> &lt;&lt; nSecondProfile &lt;&lt; <span class="stringliteral">&quot; intersect, but point {&quot;</span> &lt;&lt; dIntersectX &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; dIntersectY &lt;&lt; <span class="stringliteral">&quot;} is already present in profile &quot;</span> &lt;&lt; nFirstProfile &lt;&lt; <span class="stringliteral">&quot; as point &quot;</span> &lt;&lt; nPoint &lt;&lt; endl;</div>
<div class="line"><a id="l01061" name="l01061"></a><span class="lineno"> 1061</span> </div>
<div class="line"><a id="l01062" name="l01062"></a><span class="lineno"> 1062</span>                        <span class="comment">// Truncate the second profile and merge it with the first profile</span></div>
<div class="line"><a id="l01063" name="l01063"></a><span class="lineno"> 1063</span>                        <a class="code hl_function" href="../../d1/d98/classCSimulation.html#add4b97b29fde8394685fa5802467731d">TruncateOneProfileRetainOtherProfile</a>(nCoast, pSecondProfile, pFirstProfile, dIntersectX, dIntersectY, nProf2LineSeg, nProf1LineSeg, <span class="keyword">true</span>);</div>
<div class="line"><a id="l01064" name="l01064"></a><span class="lineno"> 1064</span>                     }</div>
<div class="line"><a id="l01065" name="l01065"></a><span class="lineno"> 1065</span> </div>
<div class="line"><a id="l01066" name="l01066"></a><span class="lineno"> 1066</span>                     <span class="comment">// Is the point of intersection already present in the second profile?</span></div>
<div class="line"><a id="l01067" name="l01067"></a><span class="lineno"> 1067</span>                     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pSecondProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#a442e3a6584e1a5b76e7ace39828f2bfc">bIsPointInProfile</a>(dIntersectX, dIntersectY, nPoint))</div>
<div class="line"><a id="l01068" name="l01068"></a><span class="lineno"> 1068</span>                     {</div>
<div class="line"><a id="l01069" name="l01069"></a><span class="lineno"> 1069</span>                        <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a222962121613613a48f518e0c2110f21">LogStream</a> &lt;&lt; <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#ad67e8c5b30a0572f64ecfb5c062c2edc">m_ulIter</a> &lt;&lt; <span class="stringliteral">&quot;: profiles &quot;</span> &lt;&lt; nFirstProfile &lt;&lt; <span class="stringliteral">&quot; and &quot;</span> &lt;&lt; nSecondProfile &lt;&lt; <span class="stringliteral">&quot; intersect, but point {&quot;</span> &lt;&lt; dIntersectX &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; dIntersectY &lt;&lt; <span class="stringliteral">&quot;} is already present in profile &quot;</span> &lt;&lt; nSecondProfile &lt;&lt; <span class="stringliteral">&quot; as point &quot;</span> &lt;&lt; nPoint &lt;&lt; endl;</div>
<div class="line"><a id="l01070" name="l01070"></a><span class="lineno"> 1070</span> </div>
<div class="line"><a id="l01071" name="l01071"></a><span class="lineno"> 1071</span>                        <span class="comment">// Truncate the first profile and merge it with the second profile</span></div>
<div class="line"><a id="l01072" name="l01072"></a><span class="lineno"> 1072</span>                        <a class="code hl_function" href="../../d1/d98/classCSimulation.html#add4b97b29fde8394685fa5802467731d">TruncateOneProfileRetainOtherProfile</a>(nCoast, pFirstProfile, pSecondProfile, dIntersectX, dIntersectY, nProf1LineSeg, nProf2LineSeg, <span class="keyword">true</span>);</div>
<div class="line"><a id="l01073" name="l01073"></a><span class="lineno"> 1073</span>                     }</div>
<div class="line"><a id="l01074" name="l01074"></a><span class="lineno"> 1074</span> </div>
<div class="line"><a id="l01075" name="l01075"></a><span class="lineno"> 1075</span>                     <span class="keywordflow">else</span></div>
<div class="line"><a id="l01076" name="l01076"></a><span class="lineno"> 1076</span>                     {</div>
<div class="line"><a id="l01077" name="l01077"></a><span class="lineno"> 1077</span>                        <span class="comment">// The point of intersection is not already present in either profile, so get the number of line segments of each profile</span></div>
<div class="line"><a id="l01078" name="l01078"></a><span class="lineno"> 1078</span>                        <span class="keywordtype">int</span> nFirstProfileLineSegments = pFirstProfile-&gt;<a class="code hl_function" href="../../d0/d89/classCGeomMultiLine.html#ae22f845fd065108959610678de571cdb">nGetNumLineSegments</a>();</div>
<div class="line"><a id="l01079" name="l01079"></a><span class="lineno"> 1079</span>                        <span class="keywordtype">int</span> nSecondProfileLineSegments = pSecondProfile-&gt;<a class="code hl_function" href="../../d0/d89/classCGeomMultiLine.html#ae22f845fd065108959610678de571cdb">nGetNumLineSegments</a>();</div>
<div class="line"><a id="l01080" name="l01080"></a><span class="lineno"> 1080</span> </div>
<div class="line"><a id="l01081" name="l01081"></a><span class="lineno"> 1081</span>                        <span class="comment">// assert(nProf1LineSeg &lt; nFirstProfileLineSegments);</span></div>
<div class="line"><a id="l01082" name="l01082"></a><span class="lineno"> 1082</span>                        <span class="comment">// assert(nProf2LineSeg &lt; nSecondProfileLineSegments);</span></div>
<div class="line"><a id="l01083" name="l01083"></a><span class="lineno"> 1083</span> </div>
<div class="line"><a id="l01084" name="l01084"></a><span class="lineno"> 1084</span>                        <span class="comment">//  Next check whether the point of intersection is on the final line segment of both profiles</span></div>
<div class="line"><a id="l01085" name="l01085"></a><span class="lineno"> 1085</span>                        <span class="keywordflow">if</span> ((nProf1LineSeg == (nFirstProfileLineSegments - 1)) &amp;&amp; (nProf2LineSeg == (nSecondProfileLineSegments - 1)))</div>
<div class="line"><a id="l01086" name="l01086"></a><span class="lineno"> 1086</span>                        {</div>
<div class="line"><a id="l01087" name="l01087"></a><span class="lineno"> 1087</span>                           <span class="comment">// Yes, the point of intersection is on the final line segment of both profiles, so merge the profiles seaward of the point of intersection</span></div>
<div class="line"><a id="l01088" name="l01088"></a><span class="lineno"> 1088</span>                           <a class="code hl_function" href="../../d1/d98/classCSimulation.html#a545c6a6a1c33942a35ef3ee15c26896f">MergeProfilesAtFinalLineSegments</a>(nCoast, pFirstProfile, pSecondProfile, nFirstProfileLineSegments, nSecondProfileLineSegments, dIntersectX, dIntersectY, dAvgEndX, dAvgEndY);</div>
<div class="line"><a id="l01089" name="l01089"></a><span class="lineno"> 1089</span> </div>
<div class="line"><a id="l01090" name="l01090"></a><span class="lineno"> 1090</span>                           <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a222962121613613a48f518e0c2110f21">LogStream</a> &lt;&lt; <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#ad67e8c5b30a0572f64ecfb5c062c2edc">m_ulIter</a> &lt;&lt; <span class="stringliteral">&quot;: &quot;</span> &lt;&lt; ((nDirection == <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#a29fcc12f725cf70f82b391b4fd46d171">DIRECTION_DOWNCOAST</a>) ? <span class="stringliteral">&quot;down&quot;</span> : <span class="stringliteral">&quot;up&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;-coast search, end-segment intersection between profiles &quot;</span> &lt;&lt; nFirstProfile &lt;&lt; <span class="stringliteral">&quot; and &quot;</span> &lt;&lt; nSecondProfile &lt;&lt; <span class="stringliteral">&quot; at [&quot;</span> &lt;&lt; dIntersectX &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; dIntersectY &lt;&lt; <span class="stringliteral">&quot;] in line segment [&quot;</span> &lt;&lt; nProf1LineSeg &lt;&lt; <span class="stringliteral">&quot;] of &quot;</span> &lt;&lt; nFirstProfileLineSegments &lt;&lt; <span class="stringliteral">&quot; segments, and line segment [&quot;</span> &lt;&lt; nProf2LineSeg &lt;&lt; <span class="stringliteral">&quot;] of &quot;</span> &lt;&lt; nSecondProfileLineSegments &lt;&lt; <span class="stringliteral">&quot; segments, respectively&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a id="l01091" name="l01091"></a><span class="lineno"> 1091</span> </div>
<div class="line"><a id="l01092" name="l01092"></a><span class="lineno"> 1092</span>                           <span class="comment">// // DEBUG CODE =============================================================================================</span></div>
<div class="line"><a id="l01093" name="l01093"></a><span class="lineno"> 1093</span>                           <span class="comment">// int nSizeTmp = pFirstProfile-&gt;nGetProfileSize();</span></div>
<div class="line"><a id="l01094" name="l01094"></a><span class="lineno"> 1094</span>                           <span class="comment">// CGeom2DPoint PtEndTmp = *pFirstProfile-&gt;pPtGetPointInProfile(nSizeTmp-1);</span></div>
<div class="line"><a id="l01095" name="l01095"></a><span class="lineno"> 1095</span>                           <span class="comment">//</span></div>
<div class="line"><a id="l01096" name="l01096"></a><span class="lineno"> 1096</span>                           <span class="comment">// LogStream &lt;&lt; m_ulIter &lt;&lt; &quot;: end of first profile (&quot; &lt;&lt; nFirstProfile &lt;&lt; &quot;) is point &quot; &lt;&lt; nSizeTmp-1 &lt;&lt; &quot; at [&quot; &lt;&lt; dExtCRSXToGridX(PtEndTmp.dGetX()) &lt;&lt; &quot;][&quot; &lt;&lt; dExtCRSYToGridY(PtEndTmp.dGetY()) &lt;&lt; &quot;} = {&quot; &lt;&lt; PtEndTmp.dGetX() &lt;&lt; &quot;, &quot; &lt;&lt; PtEndTmp.dGetY() &lt;&lt; &quot;}&quot; &lt;&lt; endl;</span></div>
<div class="line"><a id="l01097" name="l01097"></a><span class="lineno"> 1097</span>                           <span class="comment">//</span></div>
<div class="line"><a id="l01098" name="l01098"></a><span class="lineno"> 1098</span>                           <span class="comment">// nSizeTmp = pSecondProfile-&gt;nGetProfileSize();</span></div>
<div class="line"><a id="l01099" name="l01099"></a><span class="lineno"> 1099</span>                           <span class="comment">// PtEndTmp = *pSecondProfile-&gt;pPtGetPointInProfile(nSizeTmp-1);</span></div>
<div class="line"><a id="l01100" name="l01100"></a><span class="lineno"> 1100</span>                           <span class="comment">//</span></div>
<div class="line"><a id="l01101" name="l01101"></a><span class="lineno"> 1101</span>                           <span class="comment">// LogStream &lt;&lt; m_ulIter &lt;&lt; &quot;: end of second profile (&quot; &lt;&lt; nSecondProfile &lt;&lt; &quot;) is point &quot; &lt;&lt; nSizeTmp-1 &lt;&lt; &quot; at [&quot; &lt;&lt; dExtCRSXToGridX(PtEndTmp.dGetX()) &lt;&lt; &quot;][&quot; &lt;&lt; dExtCRSYToGridY(PtEndTmp.dGetY()) &lt;&lt; &quot;} = {&quot; &lt;&lt; PtEndTmp.dGetX() &lt;&lt; &quot;, &quot; &lt;&lt; PtEndTmp.dGetY() &lt;&lt; &quot;}&quot; &lt;&lt; endl;</span></div>
<div class="line"><a id="l01102" name="l01102"></a><span class="lineno"> 1102</span>                           <span class="comment">// // DEBUG CODE =============================================================================================</span></div>
<div class="line"><a id="l01103" name="l01103"></a><span class="lineno"> 1103</span>                        }</div>
<div class="line"><a id="l01104" name="l01104"></a><span class="lineno"> 1104</span>                        <span class="keywordflow">else</span></div>
<div class="line"><a id="l01105" name="l01105"></a><span class="lineno"> 1105</span>                        {</div>
<div class="line"><a id="l01106" name="l01106"></a><span class="lineno"> 1106</span>                           <span class="comment">// The profiles intersect, but the point of intersection is not on the final line segment of both profiles. One of the profiles will be truncated, the other profile will be retained</span></div>
<div class="line"><a id="l01107" name="l01107"></a><span class="lineno"> 1107</span>                           <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a222962121613613a48f518e0c2110f21">LogStream</a> &lt;&lt; <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#ad67e8c5b30a0572f64ecfb5c062c2edc">m_ulIter</a> &lt;&lt; <span class="stringliteral">&quot;: &quot;</span> &lt;&lt; ((nDirection == <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#a29fcc12f725cf70f82b391b4fd46d171">DIRECTION_DOWNCOAST</a>) ? <span class="stringliteral">&quot;down&quot;</span> : <span class="stringliteral">&quot;up&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;-coast search, intersection (NOT both end segments) between profiles &quot;</span> &lt;&lt; nFirstProfile &lt;&lt; <span class="stringliteral">&quot; and &quot;</span> &lt;&lt; nSecondProfile &lt;&lt; <span class="stringliteral">&quot; at [&quot;</span> &lt;&lt; dIntersectX &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; dIntersectY &lt;&lt; <span class="stringliteral">&quot;] in line segment [&quot;</span> &lt;&lt; nProf1LineSeg &lt;&lt; <span class="stringliteral">&quot;] of &quot;</span> &lt;&lt; nFirstProfileLineSegments &lt;&lt; <span class="stringliteral">&quot;, and line segment [&quot;</span> &lt;&lt; nProf2LineSeg &lt;&lt; <span class="stringliteral">&quot;] of &quot;</span> &lt;&lt; nSecondProfileLineSegments &lt;&lt; <span class="stringliteral">&quot;, respectively&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a id="l01108" name="l01108"></a><span class="lineno"> 1108</span> </div>
<div class="line"><a id="l01109" name="l01109"></a><span class="lineno"> 1109</span>                           <span class="comment">// Decide which profile to truncate, and which to retain</span></div>
<div class="line"><a id="l01110" name="l01110"></a><span class="lineno"> 1110</span>                           <span class="keywordflow">if</span> (pFirstProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#a9fc2d8b0adabc8dfa5b7f8b8400d6252">bIsIntervention</a>())</div>
<div class="line"><a id="l01111" name="l01111"></a><span class="lineno"> 1111</span>                           {</div>
<div class="line"><a id="l01112" name="l01112"></a><span class="lineno"> 1112</span>                              <span class="comment">// Truncate the first profile, since it is an intervention profile</span></div>
<div class="line"><a id="l01113" name="l01113"></a><span class="lineno"> 1113</span>                              <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a222962121613613a48f518e0c2110f21">LogStream</a> &lt;&lt; <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#ad67e8c5b30a0572f64ecfb5c062c2edc">m_ulIter</a> &lt;&lt; <span class="stringliteral">&quot;: pFirstProfile = &quot;</span> &lt;&lt; pFirstProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#aacd98f9837c3c7cf7414764b73275fba">nGetCoastID</a>() &lt;&lt; <span class="stringliteral">&quot; pSecondProfile = &quot;</span> &lt;&lt; pSecondProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#aacd98f9837c3c7cf7414764b73275fba">nGetCoastID</a>() &lt;&lt; <span class="stringliteral">&quot;, pFirstProfile is an intervention profile, so truncate pFirstProfile (&quot;</span> &lt;&lt; pFirstProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#aacd98f9837c3c7cf7414764b73275fba">nGetCoastID</a>() &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a id="l01114" name="l01114"></a><span class="lineno"> 1114</span>                              <a class="code hl_function" href="../../d1/d98/classCSimulation.html#add4b97b29fde8394685fa5802467731d">TruncateOneProfileRetainOtherProfile</a>(nCoast, pFirstProfile, pSecondProfile, dIntersectX, dIntersectY, nProf1LineSeg, nProf2LineSeg, <span class="keyword">false</span>);</div>
<div class="line"><a id="l01115" name="l01115"></a><span class="lineno"> 1115</span>                           }</div>
<div class="line"><a id="l01116" name="l01116"></a><span class="lineno"> 1116</span> </div>
<div class="line"><a id="l01117" name="l01117"></a><span class="lineno"> 1117</span>                           <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pSecondProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#a9fc2d8b0adabc8dfa5b7f8b8400d6252">bIsIntervention</a>())</div>
<div class="line"><a id="l01118" name="l01118"></a><span class="lineno"> 1118</span>                           {</div>
<div class="line"><a id="l01119" name="l01119"></a><span class="lineno"> 1119</span>                              <span class="comment">// Truncate the second profile, since it is an intervention profile</span></div>
<div class="line"><a id="l01120" name="l01120"></a><span class="lineno"> 1120</span>                              <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a222962121613613a48f518e0c2110f21">LogStream</a> &lt;&lt; <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#ad67e8c5b30a0572f64ecfb5c062c2edc">m_ulIter</a> &lt;&lt; <span class="stringliteral">&quot;: pFirstProfile = &quot;</span> &lt;&lt; pFirstProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#aacd98f9837c3c7cf7414764b73275fba">nGetCoastID</a>() &lt;&lt; <span class="stringliteral">&quot; pSecondProfile = &quot;</span> &lt;&lt; pSecondProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#aacd98f9837c3c7cf7414764b73275fba">nGetCoastID</a>() &lt;&lt; <span class="stringliteral">&quot;, pSecondProfile is an intervention profile, so truncate pSecondProfile (&quot;</span> &lt;&lt; pSecondProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#aacd98f9837c3c7cf7414764b73275fba">nGetCoastID</a>() &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a id="l01121" name="l01121"></a><span class="lineno"> 1121</span>                              <a class="code hl_function" href="../../d1/d98/classCSimulation.html#add4b97b29fde8394685fa5802467731d">TruncateOneProfileRetainOtherProfile</a>(nCoast, pSecondProfile, pFirstProfile, dIntersectX, dIntersectY, nProf2LineSeg, nProf1LineSeg, <span class="keyword">false</span>);</div>
<div class="line"><a id="l01122" name="l01122"></a><span class="lineno"> 1122</span>                           }</div>
<div class="line"><a id="l01123" name="l01123"></a><span class="lineno"> 1123</span> </div>
<div class="line"><a id="l01124" name="l01124"></a><span class="lineno"> 1124</span>                           <span class="keywordflow">else</span> <span class="keywordflow">if</span> (nFirstProfileLineSegments &lt; nSecondProfileLineSegments)</div>
<div class="line"><a id="l01125" name="l01125"></a><span class="lineno"> 1125</span>                           {</div>
<div class="line"><a id="l01126" name="l01126"></a><span class="lineno"> 1126</span>                              <span class="comment">// Truncate the first profile, since it has a smaller number of line segments</span></div>
<div class="line"><a id="l01127" name="l01127"></a><span class="lineno"> 1127</span>                              <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a222962121613613a48f518e0c2110f21">LogStream</a> &lt;&lt; <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#ad67e8c5b30a0572f64ecfb5c062c2edc">m_ulIter</a> &lt;&lt; <span class="stringliteral">&quot;: pFirstProfile = &quot;</span> &lt;&lt; pFirstProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#aacd98f9837c3c7cf7414764b73275fba">nGetCoastID</a>() &lt;&lt; <span class="stringliteral">&quot; pSecondProfile = &quot;</span> &lt;&lt; pSecondProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#aacd98f9837c3c7cf7414764b73275fba">nGetCoastID</a>() &lt;&lt; <span class="stringliteral">&quot;, pFirstProfile has a smaller number of line segments, so truncate pFirstProfile (&quot;</span> &lt;&lt; pFirstProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#aacd98f9837c3c7cf7414764b73275fba">nGetCoastID</a>() &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a id="l01128" name="l01128"></a><span class="lineno"> 1128</span>                              <a class="code hl_function" href="../../d1/d98/classCSimulation.html#add4b97b29fde8394685fa5802467731d">TruncateOneProfileRetainOtherProfile</a>(nCoast, pFirstProfile, pSecondProfile, dIntersectX, dIntersectY, nProf1LineSeg, nProf2LineSeg, <span class="keyword">false</span>);</div>
<div class="line"><a id="l01129" name="l01129"></a><span class="lineno"> 1129</span>                           }</div>
<div class="line"><a id="l01130" name="l01130"></a><span class="lineno"> 1130</span> </div>
<div class="line"><a id="l01131" name="l01131"></a><span class="lineno"> 1131</span>                           <span class="keywordflow">else</span> <span class="keywordflow">if</span> (nFirstProfileLineSegments &gt; nSecondProfileLineSegments)</div>
<div class="line"><a id="l01132" name="l01132"></a><span class="lineno"> 1132</span>                           {</div>
<div class="line"><a id="l01133" name="l01133"></a><span class="lineno"> 1133</span>                              <span class="comment">// Truncate the second profile, since it has a smaller number of line segments</span></div>
<div class="line"><a id="l01134" name="l01134"></a><span class="lineno"> 1134</span>                              <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a222962121613613a48f518e0c2110f21">LogStream</a> &lt;&lt; <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#ad67e8c5b30a0572f64ecfb5c062c2edc">m_ulIter</a> &lt;&lt; <span class="stringliteral">&quot;: pFirstProfile = &quot;</span> &lt;&lt; pFirstProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#aacd98f9837c3c7cf7414764b73275fba">nGetCoastID</a>() &lt;&lt; <span class="stringliteral">&quot; pSecondProfile = &quot;</span> &lt;&lt; pSecondProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#aacd98f9837c3c7cf7414764b73275fba">nGetCoastID</a>() &lt;&lt; <span class="stringliteral">&quot;, pSecondProfile has a smaller number of line segments, so truncate pSecondProfile (&quot;</span> &lt;&lt; pSecondProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#aacd98f9837c3c7cf7414764b73275fba">nGetCoastID</a>() &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a id="l01135" name="l01135"></a><span class="lineno"> 1135</span>                              <a class="code hl_function" href="../../d1/d98/classCSimulation.html#add4b97b29fde8394685fa5802467731d">TruncateOneProfileRetainOtherProfile</a>(nCoast, pSecondProfile, pFirstProfile, dIntersectX, dIntersectY, nProf2LineSeg, nProf1LineSeg, <span class="keyword">false</span>);</div>
<div class="line"><a id="l01136" name="l01136"></a><span class="lineno"> 1136</span>                           }</div>
<div class="line"><a id="l01137" name="l01137"></a><span class="lineno"> 1137</span> </div>
<div class="line"><a id="l01138" name="l01138"></a><span class="lineno"> 1138</span>                           <span class="keywordflow">else</span></div>
<div class="line"><a id="l01139" name="l01139"></a><span class="lineno"> 1139</span>                           {</div>
<div class="line"><a id="l01140" name="l01140"></a><span class="lineno"> 1140</span>                              <span class="comment">// Both profiles have the same number of line segments, so choose randomly. Draw a sample from the unit normal distribution using random number generator 1</span></div>
<div class="line"><a id="l01141" name="l01141"></a><span class="lineno"> 1141</span>                              <span class="keywordtype">double</span> dRand = <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a39b5fdbebb3ad6db9ca36ed73f7c47d6">m_dGetFromUnitNormalDist</a>(<a class="code hl_variable" href="../../d1/d98/classCSimulation.html#aab026ce32dae1272a2633b41dd9217d5">m_Rand</a>[0]);</div>
<div class="line"><a id="l01142" name="l01142"></a><span class="lineno"> 1142</span>                              <span class="keywordflow">if</span> (dRand &gt;= 0.0)</div>
<div class="line"><a id="l01143" name="l01143"></a><span class="lineno"> 1143</span>                              {</div>
<div class="line"><a id="l01144" name="l01144"></a><span class="lineno"> 1144</span>                                 <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a222962121613613a48f518e0c2110f21">LogStream</a> &lt;&lt; <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#ad67e8c5b30a0572f64ecfb5c062c2edc">m_ulIter</a> &lt;&lt; <span class="stringliteral">&quot;: pFirstProfile = &quot;</span> &lt;&lt; pFirstProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#aacd98f9837c3c7cf7414764b73275fba">nGetCoastID</a>() &lt;&lt; <span class="stringliteral">&quot; pSecondProfile = &quot;</span> &lt;&lt; pSecondProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#aacd98f9837c3c7cf7414764b73275fba">nGetCoastID</a>() &lt;&lt; <span class="stringliteral">&quot;, same number of line segment, randomly  truncate pFirstProfile&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a id="l01145" name="l01145"></a><span class="lineno"> 1145</span>                                 <a class="code hl_function" href="../../d1/d98/classCSimulation.html#add4b97b29fde8394685fa5802467731d">TruncateOneProfileRetainOtherProfile</a>(nCoast, pFirstProfile, pSecondProfile, dIntersectX, dIntersectY, nProf1LineSeg, nProf2LineSeg, <span class="keyword">false</span>);</div>
<div class="line"><a id="l01146" name="l01146"></a><span class="lineno"> 1146</span>                              }</div>
<div class="line"><a id="l01147" name="l01147"></a><span class="lineno"> 1147</span>                              <span class="keywordflow">else</span></div>
<div class="line"><a id="l01148" name="l01148"></a><span class="lineno"> 1148</span>                              {</div>
<div class="line"><a id="l01149" name="l01149"></a><span class="lineno"> 1149</span>                                 <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a222962121613613a48f518e0c2110f21">LogStream</a> &lt;&lt; <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#ad67e8c5b30a0572f64ecfb5c062c2edc">m_ulIter</a> &lt;&lt; <span class="stringliteral">&quot;: pFirstProfile = &quot;</span> &lt;&lt; pFirstProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#aacd98f9837c3c7cf7414764b73275fba">nGetCoastID</a>() &lt;&lt; <span class="stringliteral">&quot; pSecondProfile = &quot;</span> &lt;&lt; pSecondProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#aacd98f9837c3c7cf7414764b73275fba">nGetCoastID</a>() &lt;&lt; <span class="stringliteral">&quot;, same number of line segment, randomly  truncate pSecondProfile&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a id="l01150" name="l01150"></a><span class="lineno"> 1150</span>                                 <a class="code hl_function" href="../../d1/d98/classCSimulation.html#add4b97b29fde8394685fa5802467731d">TruncateOneProfileRetainOtherProfile</a>(nCoast, pSecondProfile, pFirstProfile, dIntersectX, dIntersectY, nProf2LineSeg, nProf1LineSeg, <span class="keyword">false</span>);</div>
<div class="line"><a id="l01151" name="l01151"></a><span class="lineno"> 1151</span>                              }</div>
<div class="line"><a id="l01152" name="l01152"></a><span class="lineno"> 1152</span>                           }</div>
<div class="line"><a id="l01153" name="l01153"></a><span class="lineno"> 1153</span>                        }</div>
<div class="line"><a id="l01154" name="l01154"></a><span class="lineno"> 1154</span>                     }</div>
<div class="line"><a id="l01155" name="l01155"></a><span class="lineno"> 1155</span>                  }</div>
<div class="line"><a id="l01156" name="l01156"></a><span class="lineno"> 1156</span>               }</div>
<div class="line"><a id="l01157" name="l01157"></a><span class="lineno"> 1157</span>            }</div>
<div class="line"><a id="l01158" name="l01158"></a><span class="lineno"> 1158</span>         }</div>
<div class="line"><a id="l01159" name="l01159"></a><span class="lineno"> 1159</span>      }</div>
<div class="line"><a id="l01160" name="l01160"></a><span class="lineno"> 1160</span>   }</div>
<div class="line"><a id="l01161" name="l01161"></a><span class="lineno"> 1161</span>}</div>
</div>
<div class="line"><a id="l01162" name="l01162"></a><span class="lineno"> 1162</span> </div>
<div class="line"><a id="l01163" name="l01163"></a><span class="lineno"> 1163</span><span class="comment">//===============================================================================================================================</span></div>
<div class="line"><a id="l01165" name="l01165"></a><span class="lineno"> 1165</span><span class="comment">//===============================================================================================================================</span></div>
<div class="foldopen" id="foldopen01166" data-start="{" data-end="}">
<div class="line"><a id="l01166" name="l01166"></a><span class="lineno"><a class="line" href="../../d1/d98/classCSimulation.html#aed074f354a224885417cf8180c86c3df"> 1166</a></span><span class="keywordtype">int</span> <a class="code hl_function" href="../../d1/d98/classCSimulation.html#aed074f354a224885417cf8180c86c3df">CSimulation::nCheckAllProfiles</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a id="l01167" name="l01167"></a><span class="lineno"> 1167</span>{</div>
<div class="line"><a id="l01168" name="l01168"></a><span class="lineno"> 1168</span>   <span class="comment">// Check to see which coastline-normal profiles intersect. Then modify intersecting profiles so that the sections of each profile seaward of the point of intersection are &#39;shared&#39; i.e. are multi-lines. This creates the boundaries of the triangular polygons</span></div>
<div class="line"><a id="l01169" name="l01169"></a><span class="lineno"> 1169</span>   <a class="code hl_function" href="../../d1/d98/classCSimulation.html#a79672effdabadec1d3eebb9d08ef6248">CheckForIntersectingProfiles</a>();</div>
<div class="line"><a id="l01170" name="l01170"></a><span class="lineno"> 1170</span> </div>
<div class="line"><a id="l01171" name="l01171"></a><span class="lineno"> 1171</span>   <span class="comment">// Again check the normal profiles for insufficient length: is the water depth at the end point less than the depth of closure? We do this again because some profiles may have been shortened as a result of intersection. Do once for every coastline object</span></div>
<div class="line"><a id="l01172" name="l01172"></a><span class="lineno"> 1172</span>   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nCoast = 0; nCoast &lt; <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a25ada8139c82ca7beab3f279cff83184">m_VCoast</a>.size(); nCoast++)</div>
<div class="line"><a id="l01173" name="l01173"></a><span class="lineno"> 1173</span>   {</div>
<div class="line"><a id="l01174" name="l01174"></a><span class="lineno"> 1174</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n = 0; n &lt; <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a25ada8139c82ca7beab3f279cff83184">m_VCoast</a>[nCoast].nGetNumProfiles(); n++)</div>
<div class="line"><a id="l01175" name="l01175"></a><span class="lineno"> 1175</span>      {</div>
<div class="line"><a id="l01176" name="l01176"></a><span class="lineno"> 1176</span>         <a class="code hl_class" href="../../da/dae/classCGeomProfile.html">CGeomProfile</a>* pProfile = <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a25ada8139c82ca7beab3f279cff83184">m_VCoast</a>[nCoast].pGetProfileWithDownCoastSeq(n);</div>
<div class="line"><a id="l01177" name="l01177"></a><span class="lineno"> 1177</span>         <span class="keywordtype">int</span> nProfile = pProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#aacd98f9837c3c7cf7414764b73275fba">nGetCoastID</a>();</div>
<div class="line"><a id="l01178" name="l01178"></a><span class="lineno"> 1178</span> </div>
<div class="line"><a id="l01179" name="l01179"></a><span class="lineno"> 1179</span>         <span class="keywordflow">if</span> (pProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#a8dc4e3ce21668f7149ca11aeb7efadf7">bProfileOK</a>())</div>
<div class="line"><a id="l01180" name="l01180"></a><span class="lineno"> 1180</span>         {</div>
<div class="line"><a id="l01181" name="l01181"></a><span class="lineno"> 1181</span>            <span class="keywordtype">int</span> nSize = pProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#abaf88697019588a2b0901bd19044aee4">nGetProfileSize</a>();</div>
<div class="line"><a id="l01182" name="l01182"></a><span class="lineno"> 1182</span> </div>
<div class="line"><a id="l01183" name="l01183"></a><span class="lineno"> 1183</span>            <span class="comment">// Safety check</span></div>
<div class="line"><a id="l01184" name="l01184"></a><span class="lineno"> 1184</span>            <span class="keywordflow">if</span> (nSize == 0)</div>
<div class="line"><a id="l01185" name="l01185"></a><span class="lineno"> 1185</span>            {</div>
<div class="line"><a id="l01186" name="l01186"></a><span class="lineno"> 1186</span>               <span class="comment">// pProfile-&gt;SetTooShort(true);</span></div>
<div class="line"><a id="l01187" name="l01187"></a><span class="lineno"> 1187</span>               <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a25ada8139c82ca7beab3f279cff83184">m_VCoast</a>[nCoast].pGetProfile(nProfile)-&gt;SetTooShort(<span class="keyword">true</span>);</div>
<div class="line"><a id="l01188" name="l01188"></a><span class="lineno"> 1188</span>               <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a222962121613613a48f518e0c2110f21">LogStream</a> &lt;&lt; <span class="stringliteral">&quot;Profile &quot;</span> &lt;&lt; nProfile &lt;&lt; <span class="stringliteral">&quot; is too short, size = &quot;</span> &lt;&lt; nSize &lt;&lt; endl;</div>
<div class="line"><a id="l01189" name="l01189"></a><span class="lineno"> 1189</span>               <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l01190" name="l01190"></a><span class="lineno"> 1190</span>            }</div>
<div class="line"><a id="l01191" name="l01191"></a><span class="lineno"> 1191</span> </div>
<div class="line"><a id="l01192" name="l01192"></a><span class="lineno"> 1192</span>            <a class="code hl_class" href="../../d5/d4e/classCGeom2DPoint.html">CGeom2DPoint</a> <span class="keyword">const</span>* pPtEnd = pProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#aaa8ddb9c775927bdb7940f7826f90a74">pPtGetPointInProfile</a>(nSize - 1);</div>
<div class="line"><a id="l01193" name="l01193"></a><span class="lineno"> 1193</span>            <a class="code hl_class" href="../../d6/d0d/classCGeom2DIPoint.html">CGeom2DIPoint</a> PtiEnd = <a class="code hl_function" href="../../d1/d98/classCSimulation.html#a1cdb36fc97d2f40d471edc2d59734960">PtiExtCRSToGridRound</a>(pPtEnd);</div>
<div class="line"><a id="l01194" name="l01194"></a><span class="lineno"> 1194</span>            <span class="keywordtype">int</span> nXEnd = PtiEnd.<a class="code hl_function" href="../../d6/d0d/classCGeom2DIPoint.html#af84c687b2d0be01ab41cbcc0565f4f3f">nGetX</a>();</div>
<div class="line"><a id="l01195" name="l01195"></a><span class="lineno"> 1195</span>            <span class="keywordtype">int</span> nYEnd = PtiEnd.<a class="code hl_function" href="../../d6/d0d/classCGeom2DIPoint.html#a4d9c20bcca90dcb9d519b664aba09cbd">nGetY</a>();</div>
<div class="line"><a id="l01196" name="l01196"></a><span class="lineno"> 1196</span> </div>
<div class="line"><a id="l01197" name="l01197"></a><span class="lineno"> 1197</span>            <span class="comment">// Safety checks: the point may be outside the grid, so keep it within the grid</span></div>
<div class="line"><a id="l01198" name="l01198"></a><span class="lineno"> 1198</span>            nXEnd = <a class="code hl_function" href="../../d6/d2a/cme_8h.html#a068017859403c0629d89f8d348f6c224">tMin</a>(nXEnd, <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1652253500dab35e6f6f9f734207e20b">m_nXGridSize</a> - 1);</div>
<div class="line"><a id="l01199" name="l01199"></a><span class="lineno"> 1199</span>            nYEnd = <a class="code hl_function" href="../../d6/d2a/cme_8h.html#a068017859403c0629d89f8d348f6c224">tMin</a>(nYEnd, <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a3755fdc07c0ac9f2ce6c2237cfef50ce">m_nYGridSize</a> - 1);</div>
<div class="line"><a id="l01200" name="l01200"></a><span class="lineno"> 1200</span>            nXEnd = <a class="code hl_function" href="../../d6/d2a/cme_8h.html#a7e895b460cef877dec4d12ead0c74f15">tMax</a>(nXEnd, 0);</div>
<div class="line"><a id="l01201" name="l01201"></a><span class="lineno"> 1201</span>            nYEnd = <a class="code hl_function" href="../../d6/d2a/cme_8h.html#a7e895b460cef877dec4d12ead0c74f15">tMax</a>(nYEnd, 0);</div>
<div class="line"><a id="l01202" name="l01202"></a><span class="lineno"> 1202</span> </div>
<div class="line"><a id="l01203" name="l01203"></a><span class="lineno"> 1203</span>            <span class="comment">// pProfile-&gt;SetEndPoint(&amp;PtiEnd);</span></div>
<div class="line"><a id="l01204" name="l01204"></a><span class="lineno"> 1204</span>            <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a25ada8139c82ca7beab3f279cff83184">m_VCoast</a>[nCoast].pGetProfile(nProfile)-&gt;SetEndPoint(&amp;PtiEnd);</div>
<div class="line"><a id="l01205" name="l01205"></a><span class="lineno"> 1205</span> </div>
<div class="line"><a id="l01206" name="l01206"></a><span class="lineno"> 1206</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[nXEnd][nYEnd].dGetSeaDepth() &lt; <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#aecac3135005148dc01ee8ba3871b7fbf">m_dDepthOfClosure</a>)</div>
<div class="line"><a id="l01207" name="l01207"></a><span class="lineno"> 1207</span>            {</div>
<div class="line"><a id="l01208" name="l01208"></a><span class="lineno"> 1208</span>               <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a0245d3cbdd603fbeced6ca1465eb3f16">m_nLogFileDetail</a> &gt;= <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#a540d8a94fc09b0b14fd8ab657445b67a">LOG_FILE_MIDDLE_DETAIL</a>)</div>
<div class="line"><a id="l01209" name="l01209"></a><span class="lineno"> 1209</span>                  <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a222962121613613a48f518e0c2110f21">LogStream</a> &lt;&lt; <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#ad67e8c5b30a0572f64ecfb5c062c2edc">m_ulIter</a> &lt;&lt; <span class="stringliteral">&quot;: coast &quot;</span> &lt;&lt; nCoast &lt;&lt; <span class="stringliteral">&quot;, profile &quot;</span> &lt;&lt; nProfile &lt;&lt; <span class="stringliteral">&quot; is invalid, is too short for depth of closure &quot;</span> &lt;&lt; <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#aecac3135005148dc01ee8ba3871b7fbf">m_dDepthOfClosure</a> &lt;&lt; <span class="stringliteral">&quot; at end point [&quot;</span> &lt;&lt; nXEnd &lt;&lt; <span class="stringliteral">&quot;][&quot;</span> &lt;&lt; nYEnd &lt;&lt; <span class="stringliteral">&quot;] = {&quot;</span> &lt;&lt; pPtEnd-&gt;<a class="code hl_function" href="../../d5/d4e/classCGeom2DPoint.html#a250f937d03cfdf6e0244b74ad2bf96a4">dGetX</a>() &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; pPtEnd-&gt;<a class="code hl_function" href="../../d5/d4e/classCGeom2DPoint.html#a216921dc2c592d9468e6430fee7c7719">dGetY</a>() &lt;&lt; <span class="stringliteral">&quot;}, flagging as too short&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a id="l01210" name="l01210"></a><span class="lineno"> 1210</span> </div>
<div class="line"><a id="l01211" name="l01211"></a><span class="lineno"> 1211</span>               <span class="comment">// pProfile-&gt;SetTooShort(true);</span></div>
<div class="line"><a id="l01212" name="l01212"></a><span class="lineno"> 1212</span>               <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a25ada8139c82ca7beab3f279cff83184">m_VCoast</a>[nCoast].pGetProfile(nProfile)-&gt;SetTooShort(<span class="keyword">true</span>);</div>
<div class="line"><a id="l01213" name="l01213"></a><span class="lineno"> 1213</span>            }</div>
<div class="line"><a id="l01214" name="l01214"></a><span class="lineno"> 1214</span>         }</div>
<div class="line"><a id="l01215" name="l01215"></a><span class="lineno"> 1215</span>      }</div>
<div class="line"><a id="l01216" name="l01216"></a><span class="lineno"> 1216</span> </div>
<div class="line"><a id="l01217" name="l01217"></a><span class="lineno"> 1217</span>      <span class="comment">// For this coast, put all valid coastline-normal profiles (apart from the profiles at the start and end of the coast, since they have already been done) onto the raster grid. But if the profile is not long enough, crosses a coastline, hits dry land, or hits another profile, then mark the profile as invalid</span></div>
<div class="line"><a id="l01218" name="l01218"></a><span class="lineno"> 1218</span>      <span class="keywordtype">int</span> nValidProfiles = 0;</div>
<div class="line"><a id="l01219" name="l01219"></a><span class="lineno"> 1219</span>      <a class="code hl_function" href="../../d1/d98/classCSimulation.html#a2cc64ec1030d1a3bdd062076f05367fc">MarkProfilesOnGrid</a>(nCoast, nValidProfiles);</div>
<div class="line"><a id="l01220" name="l01220"></a><span class="lineno"> 1220</span> </div>
<div class="line"><a id="l01221" name="l01221"></a><span class="lineno"> 1221</span>      <span class="keywordflow">if</span> (nValidProfiles == 0)</div>
<div class="line"><a id="l01222" name="l01222"></a><span class="lineno"> 1222</span>      {</div>
<div class="line"><a id="l01223" name="l01223"></a><span class="lineno"> 1223</span>         <span class="comment">// Problem! No valid profiles, so quit</span></div>
<div class="line"><a id="l01224" name="l01224"></a><span class="lineno"> 1224</span>         cerr &lt;&lt; <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#ad67e8c5b30a0572f64ecfb5c062c2edc">m_ulIter</a> &lt;&lt; <span class="stringliteral">&quot;: &quot;</span> &lt;&lt; <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#a292fc90846543ca4814daa9f759feb05">ERR</a> &lt;&lt; <span class="stringliteral">&quot;no coastline-normal profiles created&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a id="l01225" name="l01225"></a><span class="lineno"> 1225</span>         <span class="keywordflow">return</span> <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#a9acebe36530eff4f7cf08ea03d7da760">RTN_ERR_NO_PROFILES_2</a>;</div>
<div class="line"><a id="l01226" name="l01226"></a><span class="lineno"> 1226</span>      }</div>
<div class="line"><a id="l01227" name="l01227"></a><span class="lineno"> 1227</span> </div>
<div class="line"><a id="l01228" name="l01228"></a><span class="lineno"> 1228</span>      <span class="comment">// // DEBUG CODE ===========================================================================================================</span></div>
<div class="line"><a id="l01229" name="l01229"></a><span class="lineno"> 1229</span>      <span class="comment">// if (m_ulIter == 109)</span></div>
<div class="line"><a id="l01230" name="l01230"></a><span class="lineno"> 1230</span>      <span class="comment">// {</span></div>
<div class="line"><a id="l01231" name="l01231"></a><span class="lineno"> 1231</span>      <span class="comment">//    string strOutFile = m_strOutPath;</span></div>
<div class="line"><a id="l01232" name="l01232"></a><span class="lineno"> 1232</span>      <span class="comment">//    strOutFile += &quot;00_profile_raster_&quot;;</span></div>
<div class="line"><a id="l01233" name="l01233"></a><span class="lineno"> 1233</span>      <span class="comment">//    strOutFile += to_string(m_ulIter);</span></div>
<div class="line"><a id="l01234" name="l01234"></a><span class="lineno"> 1234</span>      <span class="comment">//    strOutFile += &quot;.tif&quot;;</span></div>
<div class="line"><a id="l01235" name="l01235"></a><span class="lineno"> 1235</span>      <span class="comment">//</span></div>
<div class="line"><a id="l01236" name="l01236"></a><span class="lineno"> 1236</span>      <span class="comment">//    GDALDriver* pDriver = GetGDALDriverManager()-&gt;GetDriverByName(&quot;gtiff&quot;);</span></div>
<div class="line"><a id="l01237" name="l01237"></a><span class="lineno"> 1237</span>      <span class="comment">//    GDALDataset* pDataSet = pDriver-&gt;Create(strOutFile.c_str(), m_nXGridSize, m_nYGridSize, 1, GDT_Float64, m_papszGDALRasterOptions);</span></div>
<div class="line"><a id="l01238" name="l01238"></a><span class="lineno"> 1238</span>      <span class="comment">//    pDataSet-&gt;SetProjection(m_strGDALBasementDEMProjection.c_str());</span></div>
<div class="line"><a id="l01239" name="l01239"></a><span class="lineno"> 1239</span>      <span class="comment">//    pDataSet-&gt;SetGeoTransform(m_dGeoTransform);</span></div>
<div class="line"><a id="l01240" name="l01240"></a><span class="lineno"> 1240</span>      <span class="comment">//</span></div>
<div class="line"><a id="l01241" name="l01241"></a><span class="lineno"> 1241</span>      <span class="comment">//    int nn = 0;</span></div>
<div class="line"><a id="l01242" name="l01242"></a><span class="lineno"> 1242</span>      <span class="comment">//    double* pdRaster = new double[m_nXGridSize * m_nYGridSize];</span></div>
<div class="line"><a id="l01243" name="l01243"></a><span class="lineno"> 1243</span>      <span class="comment">//    for (int nY = 0; nY &lt; m_nYGridSize; nY++)</span></div>
<div class="line"><a id="l01244" name="l01244"></a><span class="lineno"> 1244</span>      <span class="comment">//    {</span></div>
<div class="line"><a id="l01245" name="l01245"></a><span class="lineno"> 1245</span>      <span class="comment">//       for (int nX = 0; nX &lt; m_nXGridSize; nX++)</span></div>
<div class="line"><a id="l01246" name="l01246"></a><span class="lineno"> 1246</span>      <span class="comment">//       {</span></div>
<div class="line"><a id="l01247" name="l01247"></a><span class="lineno"> 1247</span>      <span class="comment">//          if (m_pRasterGrid-&gt;m_Cell[nX][nY].bIsCoastline())</span></div>
<div class="line"><a id="l01248" name="l01248"></a><span class="lineno"> 1248</span>      <span class="comment">//             pdRaster[nn] = -1;</span></div>
<div class="line"><a id="l01249" name="l01249"></a><span class="lineno"> 1249</span>      <span class="comment">//          else</span></div>
<div class="line"><a id="l01250" name="l01250"></a><span class="lineno"> 1250</span>      <span class="comment">//          {</span></div>
<div class="line"><a id="l01251" name="l01251"></a><span class="lineno"> 1251</span>      <span class="comment">//</span></div>
<div class="line"><a id="l01252" name="l01252"></a><span class="lineno"> 1252</span>      <span class="comment">// //         pdRaster[nn] = m_pRasterGrid-&gt;m_Cell[nX][nY].nGetPolygonID();</span></div>
<div class="line"><a id="l01253" name="l01253"></a><span class="lineno"> 1253</span>      <span class="comment">//             pdRaster[nn] = m_pRasterGrid-&gt;m_Cell[nX][nY].nGetProfileID();</span></div>
<div class="line"><a id="l01254" name="l01254"></a><span class="lineno"> 1254</span>      <span class="comment">//          }</span></div>
<div class="line"><a id="l01255" name="l01255"></a><span class="lineno"> 1255</span>      <span class="comment">//</span></div>
<div class="line"><a id="l01256" name="l01256"></a><span class="lineno"> 1256</span>      <span class="comment">//          nn++;</span></div>
<div class="line"><a id="l01257" name="l01257"></a><span class="lineno"> 1257</span>      <span class="comment">//       }</span></div>
<div class="line"><a id="l01258" name="l01258"></a><span class="lineno"> 1258</span>      <span class="comment">//    }</span></div>
<div class="line"><a id="l01259" name="l01259"></a><span class="lineno"> 1259</span>      <span class="comment">//</span></div>
<div class="line"><a id="l01260" name="l01260"></a><span class="lineno"> 1260</span>      <span class="comment">//    GDALRasterBand* pBand = pDataSet-&gt;GetRasterBand(1);</span></div>
<div class="line"><a id="l01261" name="l01261"></a><span class="lineno"> 1261</span>      <span class="comment">//    pBand-&gt;SetNoDataValue(m_dMissingValue);</span></div>
<div class="line"><a id="l01262" name="l01262"></a><span class="lineno"> 1262</span>      <span class="comment">//    int nRet1 = pBand-&gt;RasterIO(GF_Write, 0, 0, m_nXGridSize, m_nYGridSize, pdRaster, m_nXGridSize, m_nYGridSize, GDT_Float64, 0, 0, NULL);</span></div>
<div class="line"><a id="l01263" name="l01263"></a><span class="lineno"> 1263</span>      <span class="comment">//</span></div>
<div class="line"><a id="l01264" name="l01264"></a><span class="lineno"> 1264</span>      <span class="comment">//    if (nRet1 == CE_Failure)</span></div>
<div class="line"><a id="l01265" name="l01265"></a><span class="lineno"> 1265</span>      <span class="comment">//       return RTN_ERR_GRIDCREATE;</span></div>
<div class="line"><a id="l01266" name="l01266"></a><span class="lineno"> 1266</span>      <span class="comment">//</span></div>
<div class="line"><a id="l01267" name="l01267"></a><span class="lineno"> 1267</span>      <span class="comment">//    GDALClose(pDataSet);</span></div>
<div class="line"><a id="l01268" name="l01268"></a><span class="lineno"> 1268</span>      <span class="comment">//    delete[] pdRaster;</span></div>
<div class="line"><a id="l01269" name="l01269"></a><span class="lineno"> 1269</span>      <span class="comment">// }</span></div>
<div class="line"><a id="l01270" name="l01270"></a><span class="lineno"> 1270</span>      <span class="comment">// // DEBUG CODE ===========================================================================================================</span></div>
<div class="line"><a id="l01271" name="l01271"></a><span class="lineno"> 1271</span>   }</div>
<div class="line"><a id="l01272" name="l01272"></a><span class="lineno"> 1272</span> </div>
<div class="line"><a id="l01273" name="l01273"></a><span class="lineno"> 1273</span>   <span class="keywordflow">return</span> <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#aa768cb14b5c6123ee95e6e4ebd9fe331">RTN_OK</a>;</div>
<div class="line"><a id="l01274" name="l01274"></a><span class="lineno"> 1274</span>}</div>
</div>
<div class="line"><a id="l01275" name="l01275"></a><span class="lineno"> 1275</span> </div>
<div class="line"><a id="l01276" name="l01276"></a><span class="lineno"> 1276</span><span class="comment">//===============================================================================================================================</span></div>
<div class="line"><a id="l01278" name="l01278"></a><span class="lineno"> 1278</span><span class="comment">//===============================================================================================================================</span></div>
<div class="foldopen" id="foldopen01279" data-start="{" data-end="}">
<div class="line"><a id="l01279" name="l01279"></a><span class="lineno"><a class="line" href="../../d1/d98/classCSimulation.html#a9332a150a41ac2a38157b22fe3483f15"> 1279</a></span><span class="keywordtype">bool</span> <a class="code hl_function" href="../../d1/d98/classCSimulation.html#a9332a150a41ac2a38157b22fe3483f15">CSimulation::bCheckForIntersection</a>(<a class="code hl_class" href="../../da/dae/classCGeomProfile.html">CGeomProfile</a>* <span class="keyword">const</span> pVProfile1, <a class="code hl_class" href="../../da/dae/classCGeomProfile.html">CGeomProfile</a>* <span class="keyword">const</span> pVProfile2, <span class="keywordtype">int</span>&amp;nProfile1LineSegment, <span class="keywordtype">int</span>&amp; nProfile2LineSegment, <span class="keywordtype">double</span>&amp; dXIntersect, <span class="keywordtype">double</span>&amp; dYIntersect, <span class="keywordtype">double</span>&amp; dXAvgEnd, <span class="keywordtype">double</span>&amp; dYAvgEnd)</div>
<div class="line"><a id="l01280" name="l01280"></a><span class="lineno"> 1280</span>{</div>
<div class="line"><a id="l01281" name="l01281"></a><span class="lineno"> 1281</span>   <span class="comment">// For both profiles, look at all line segments</span></div>
<div class="line"><a id="l01282" name="l01282"></a><span class="lineno"> 1282</span>   <span class="keywordtype">int</span> nProfile1NumSegments = pVProfile1-&gt;<a class="code hl_function" href="../../d0/d89/classCGeomMultiLine.html#ae22f845fd065108959610678de571cdb">nGetNumLineSegments</a>();</div>
<div class="line"><a id="l01283" name="l01283"></a><span class="lineno"> 1283</span>   <span class="keywordtype">int</span> nProfile2NumSegments = pVProfile2-&gt;<a class="code hl_function" href="../../d0/d89/classCGeomMultiLine.html#ae22f845fd065108959610678de571cdb">nGetNumLineSegments</a>();</div>
<div class="line"><a id="l01284" name="l01284"></a><span class="lineno"> 1284</span>   <span class="comment">//       nProfile1Size = pVProfile1-&gt;nGetProfileSize(),</span></div>
<div class="line"><a id="l01285" name="l01285"></a><span class="lineno"> 1285</span>   <span class="comment">//       nProfile2Size = pVProfile2-&gt;nGetProfileSize();</span></div>
<div class="line"><a id="l01286" name="l01286"></a><span class="lineno"> 1286</span> </div>
<div class="line"><a id="l01287" name="l01287"></a><span class="lineno"> 1287</span>   <span class="comment">//    assert(nProfile1Size == nProfile1NumSegments+1);</span></div>
<div class="line"><a id="l01288" name="l01288"></a><span class="lineno"> 1288</span>   <span class="comment">//    assert(nProfile2Size == nProfile2NumSegments+1);</span></div>
<div class="line"><a id="l01289" name="l01289"></a><span class="lineno"> 1289</span> </div>
<div class="line"><a id="l01290" name="l01290"></a><span class="lineno"> 1290</span>   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nProfile1NumSegments; i++)</div>
<div class="line"><a id="l01291" name="l01291"></a><span class="lineno"> 1291</span>   {</div>
<div class="line"><a id="l01292" name="l01292"></a><span class="lineno"> 1292</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; nProfile2NumSegments; j++)</div>
<div class="line"><a id="l01293" name="l01293"></a><span class="lineno"> 1293</span>      {</div>
<div class="line"><a id="l01294" name="l01294"></a><span class="lineno"> 1294</span>         <span class="comment">// In external coordinates</span></div>
<div class="line"><a id="l01295" name="l01295"></a><span class="lineno"> 1295</span>         <span class="keywordtype">double</span> dX1 = pVProfile1-&gt;<a class="code hl_function" href="../../d9/d0e/classCA2DShape.html#a20acae762de7cf6769eb938621f6a842">pPtVGetPoints</a>()-&gt;at(i).dGetX();</div>
<div class="line"><a id="l01296" name="l01296"></a><span class="lineno"> 1296</span>         <span class="keywordtype">double</span> dY1 = pVProfile1-&gt;<a class="code hl_function" href="../../d9/d0e/classCA2DShape.html#a20acae762de7cf6769eb938621f6a842">pPtVGetPoints</a>()-&gt;at(i).dGetY();</div>
<div class="line"><a id="l01297" name="l01297"></a><span class="lineno"> 1297</span>         <span class="keywordtype">double</span> dX2 = pVProfile1-&gt;<a class="code hl_function" href="../../d9/d0e/classCA2DShape.html#a20acae762de7cf6769eb938621f6a842">pPtVGetPoints</a>()-&gt;at(i + 1).dGetX();</div>
<div class="line"><a id="l01298" name="l01298"></a><span class="lineno"> 1298</span>         <span class="keywordtype">double</span> dY2 = pVProfile1-&gt;<a class="code hl_function" href="../../d9/d0e/classCA2DShape.html#a20acae762de7cf6769eb938621f6a842">pPtVGetPoints</a>()-&gt;at(i + 1).dGetY();</div>
<div class="line"><a id="l01299" name="l01299"></a><span class="lineno"> 1299</span> </div>
<div class="line"><a id="l01300" name="l01300"></a><span class="lineno"> 1300</span>         <span class="keywordtype">double</span> dX3 = pVProfile2-&gt;<a class="code hl_function" href="../../d9/d0e/classCA2DShape.html#a20acae762de7cf6769eb938621f6a842">pPtVGetPoints</a>()-&gt;at(j).dGetX();</div>
<div class="line"><a id="l01301" name="l01301"></a><span class="lineno"> 1301</span>         <span class="keywordtype">double</span> dY3 = pVProfile2-&gt;<a class="code hl_function" href="../../d9/d0e/classCA2DShape.html#a20acae762de7cf6769eb938621f6a842">pPtVGetPoints</a>()-&gt;at(j).dGetY();</div>
<div class="line"><a id="l01302" name="l01302"></a><span class="lineno"> 1302</span>         <span class="keywordtype">double</span> dX4 = pVProfile2-&gt;<a class="code hl_function" href="../../d9/d0e/classCA2DShape.html#a20acae762de7cf6769eb938621f6a842">pPtVGetPoints</a>()-&gt;at(j + 1).dGetX();</div>
<div class="line"><a id="l01303" name="l01303"></a><span class="lineno"> 1303</span>         <span class="keywordtype">double</span> dY4 = pVProfile2-&gt;<a class="code hl_function" href="../../d9/d0e/classCA2DShape.html#a20acae762de7cf6769eb938621f6a842">pPtVGetPoints</a>()-&gt;at(j + 1).dGetY();</div>
<div class="line"><a id="l01304" name="l01304"></a><span class="lineno"> 1304</span> </div>
<div class="line"><a id="l01305" name="l01305"></a><span class="lineno"> 1305</span>         <span class="comment">// Uses Cramer&#39;s Rule to solve the equations. Modified from code at http://stackoverflow.com/questions/563198/how-do-you-detect-where-two-line-segments-intersect (in turn based on Andre LeMothe&#39;s &quot;Tricks of the Windows Game Programming Gurus&quot;)</span></div>
<div class="line"><a id="l01306" name="l01306"></a><span class="lineno"> 1306</span>         <span class="keywordtype">double</span> dDiffX1 = dX2 - dX1;</div>
<div class="line"><a id="l01307" name="l01307"></a><span class="lineno"> 1307</span>         <span class="keywordtype">double</span> dDiffY1 = dY2 - dY1;</div>
<div class="line"><a id="l01308" name="l01308"></a><span class="lineno"> 1308</span>         <span class="keywordtype">double</span> dDiffX2 = dX4 - dX3;</div>
<div class="line"><a id="l01309" name="l01309"></a><span class="lineno"> 1309</span>         <span class="keywordtype">double</span> dDiffY2 = dY4 - dY3;</div>
<div class="line"><a id="l01310" name="l01310"></a><span class="lineno"> 1310</span> </div>
<div class="line"><a id="l01311" name="l01311"></a><span class="lineno"> 1311</span>         <span class="keywordtype">double</span> dS = -999;</div>
<div class="line"><a id="l01312" name="l01312"></a><span class="lineno"> 1312</span>         <span class="keywordtype">double</span> dT = -999;</div>
<div class="line"><a id="l01313" name="l01313"></a><span class="lineno"> 1313</span>         <span class="keywordtype">double</span> dTmp = 0;</div>
<div class="line"><a id="l01314" name="l01314"></a><span class="lineno"> 1314</span> </div>
<div class="line"><a id="l01315" name="l01315"></a><span class="lineno"> 1315</span>         dTmp = -dDiffX2 * dDiffY1 + dDiffX1 * dDiffY2;</div>
<div class="line"><a id="l01316" name="l01316"></a><span class="lineno"> 1316</span>         <span class="keywordflow">if</span> (! <a class="code hl_function" href="../../d6/d2a/cme_8h.html#a61afa8560a3b39c80657661a1d8f76ab">bFPIsEqual</a>(dTmp, 0.0, <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#a08b1623863ee3bd4300a8892de323722">TOLERANCE</a>))</div>
<div class="line"><a id="l01317" name="l01317"></a><span class="lineno"> 1317</span>            dS = (-dDiffY1 * (dX1 - dX3) + dDiffX1 * (dY1 - dY3)) / dTmp;</div>
<div class="line"><a id="l01318" name="l01318"></a><span class="lineno"> 1318</span> </div>
<div class="line"><a id="l01319" name="l01319"></a><span class="lineno"> 1319</span>         dTmp = -dDiffX2 * dDiffY1 + dDiffX1 * dDiffY2;</div>
<div class="line"><a id="l01320" name="l01320"></a><span class="lineno"> 1320</span>         <span class="keywordflow">if</span> (! <a class="code hl_function" href="../../d6/d2a/cme_8h.html#a61afa8560a3b39c80657661a1d8f76ab">bFPIsEqual</a>(dTmp, 0.0, <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#a08b1623863ee3bd4300a8892de323722">TOLERANCE</a>))</div>
<div class="line"><a id="l01321" name="l01321"></a><span class="lineno"> 1321</span>            dT = (dDiffX2 * (dY1 - dY3) - dDiffY2 * (dX1 - dX3)) / dTmp;</div>
<div class="line"><a id="l01322" name="l01322"></a><span class="lineno"> 1322</span> </div>
<div class="line"><a id="l01323" name="l01323"></a><span class="lineno"> 1323</span>         <span class="keywordflow">if</span> (dS &gt;= 0 &amp;&amp; dS &lt;= 1 &amp;&amp; dT &gt;= 0 &amp;&amp; dT &lt;= 1)</div>
<div class="line"><a id="l01324" name="l01324"></a><span class="lineno"> 1324</span>         {</div>
<div class="line"><a id="l01325" name="l01325"></a><span class="lineno"> 1325</span>            <span class="comment">// Collision detected, calculate intersection coordinates</span></div>
<div class="line"><a id="l01326" name="l01326"></a><span class="lineno"> 1326</span>            dXIntersect = dX1 + (dT * dDiffX1);</div>
<div class="line"><a id="l01327" name="l01327"></a><span class="lineno"> 1327</span>            dYIntersect = dY1 + (dT * dDiffY1);</div>
<div class="line"><a id="l01328" name="l01328"></a><span class="lineno"> 1328</span> </div>
<div class="line"><a id="l01329" name="l01329"></a><span class="lineno"> 1329</span>            <span class="comment">// And calc the average end-point coordinates</span></div>
<div class="line"><a id="l01330" name="l01330"></a><span class="lineno"> 1330</span>            dXAvgEnd = (dX2 + dX4) / 2;</div>
<div class="line"><a id="l01331" name="l01331"></a><span class="lineno"> 1331</span>            dYAvgEnd = (dY2 + dY4) / 2;</div>
<div class="line"><a id="l01332" name="l01332"></a><span class="lineno"> 1332</span> </div>
<div class="line"><a id="l01333" name="l01333"></a><span class="lineno"> 1333</span>            <span class="comment">// Get the line segments at which intersection occurred</span></div>
<div class="line"><a id="l01334" name="l01334"></a><span class="lineno"> 1334</span>            nProfile1LineSegment = i;</div>
<div class="line"><a id="l01335" name="l01335"></a><span class="lineno"> 1335</span>            nProfile2LineSegment = j;</div>
<div class="line"><a id="l01336" name="l01336"></a><span class="lineno"> 1336</span> </div>
<div class="line"><a id="l01337" name="l01337"></a><span class="lineno"> 1337</span>            <span class="comment">//             LogStream &lt;&lt; &quot;\t&quot; &lt;&lt; &quot;INTERSECTION dX2 = &quot; &lt;&lt; dX2 &lt;&lt; &quot; dX4 = &quot; &lt;&lt; dX4 &lt;&lt; &quot; dY2 = &quot; &lt;&lt; dY2 &lt;&lt; &quot; dY4 = &quot; &lt;&lt; dY4 &lt;&lt; endl;</span></div>
<div class="line"><a id="l01338" name="l01338"></a><span class="lineno"> 1338</span>            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l01339" name="l01339"></a><span class="lineno"> 1339</span>         }</div>
<div class="line"><a id="l01340" name="l01340"></a><span class="lineno"> 1340</span>      }</div>
<div class="line"><a id="l01341" name="l01341"></a><span class="lineno"> 1341</span>   }</div>
<div class="line"><a id="l01342" name="l01342"></a><span class="lineno"> 1342</span> </div>
<div class="line"><a id="l01343" name="l01343"></a><span class="lineno"> 1343</span>   <span class="comment">// No intersection</span></div>
<div class="line"><a id="l01344" name="l01344"></a><span class="lineno"> 1344</span>   <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l01345" name="l01345"></a><span class="lineno"> 1345</span>}</div>
</div>
<div class="line"><a id="l01346" name="l01346"></a><span class="lineno"> 1346</span> </div>
<div class="line"><a id="l01347" name="l01347"></a><span class="lineno"> 1347</span><span class="comment">//===============================================================================================================================</span></div>
<div class="line"><a id="l01349" name="l01349"></a><span class="lineno"> 1349</span><span class="comment">//===============================================================================================================================</span></div>
<div class="foldopen" id="foldopen01350" data-start="{" data-end="}">
<div class="line"><a id="l01350" name="l01350"></a><span class="lineno"><a class="line" href="../../d1/d98/classCSimulation.html#a2cc64ec1030d1a3bdd062076f05367fc"> 1350</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="../../d1/d98/classCSimulation.html#a2cc64ec1030d1a3bdd062076f05367fc">CSimulation::MarkProfilesOnGrid</a>(<span class="keywordtype">int</span> <span class="keyword">const</span> nCoast, <span class="keywordtype">int</span>&amp; nValidProfiles)</div>
<div class="line"><a id="l01351" name="l01351"></a><span class="lineno"> 1351</span>{</div>
<div class="line"><a id="l01352" name="l01352"></a><span class="lineno"> 1352</span>   <span class="comment">// How many profiles on this coast?</span></div>
<div class="line"><a id="l01353" name="l01353"></a><span class="lineno"> 1353</span>   <span class="keywordtype">int</span> nProfiles = <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a25ada8139c82ca7beab3f279cff83184">m_VCoast</a>[nCoast].nGetNumProfiles();</div>
<div class="line"><a id="l01354" name="l01354"></a><span class="lineno"> 1354</span>   <span class="keywordflow">if</span> (nProfiles == 0)</div>
<div class="line"><a id="l01355" name="l01355"></a><span class="lineno"> 1355</span>   {</div>
<div class="line"><a id="l01356" name="l01356"></a><span class="lineno"> 1356</span>      <span class="comment">// This can happen if the coastline is very short, so just give a warning and carry on with the next coastline</span></div>
<div class="line"><a id="l01357" name="l01357"></a><span class="lineno"> 1357</span>      <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a0245d3cbdd603fbeced6ca1465eb3f16">m_nLogFileDetail</a> &gt;= <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#a540d8a94fc09b0b14fd8ab657445b67a">LOG_FILE_MIDDLE_DETAIL</a>)</div>
<div class="line"><a id="l01358" name="l01358"></a><span class="lineno"> 1358</span>         <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a222962121613613a48f518e0c2110f21">LogStream</a> &lt;&lt; <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#a957ca99e98618160534cafb0929f743d">WARN</a> &lt;&lt; <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#ad67e8c5b30a0572f64ecfb5c062c2edc">m_ulIter</a> &lt;&lt; <span class="stringliteral">&quot;: coast &quot;</span> &lt;&lt; nCoast &lt;&lt; <span class="stringliteral">&quot; has no profiles&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a id="l01359" name="l01359"></a><span class="lineno"> 1359</span> </div>
<div class="line"><a id="l01360" name="l01360"></a><span class="lineno"> 1360</span>      <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l01361" name="l01361"></a><span class="lineno"> 1361</span>   }</div>
<div class="line"><a id="l01362" name="l01362"></a><span class="lineno"> 1362</span> </div>
<div class="line"><a id="l01363" name="l01363"></a><span class="lineno"> 1363</span>   <span class="keyword">static</span> <span class="keywordtype">bool</span> bDownCoast = <span class="keyword">true</span>;</div>
<div class="line"><a id="l01364" name="l01364"></a><span class="lineno"> 1364</span> </div>
<div class="line"><a id="l01365" name="l01365"></a><span class="lineno"> 1365</span>   <span class="comment">// Now do this for every profile, alternate between up-coast and down-coast directions</span></div>
<div class="line"><a id="l01366" name="l01366"></a><span class="lineno"> 1366</span>   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n = 0; n &lt; nProfiles; n++)</div>
<div class="line"><a id="l01367" name="l01367"></a><span class="lineno"> 1367</span>   {</div>
<div class="line"><a id="l01368" name="l01368"></a><span class="lineno"> 1368</span>      <a class="code hl_class" href="../../da/dae/classCGeomProfile.html">CGeomProfile</a>* pProfile;</div>
<div class="line"><a id="l01369" name="l01369"></a><span class="lineno"> 1369</span> </div>
<div class="line"><a id="l01370" name="l01370"></a><span class="lineno"> 1370</span>      <span class="keywordflow">if</span> (bDownCoast)</div>
<div class="line"><a id="l01371" name="l01371"></a><span class="lineno"> 1371</span>         pProfile = <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a25ada8139c82ca7beab3f279cff83184">m_VCoast</a>[nCoast].pGetProfileWithDownCoastSeq(n);</div>
<div class="line"><a id="l01372" name="l01372"></a><span class="lineno"> 1372</span>      <span class="keywordflow">else</span></div>
<div class="line"><a id="l01373" name="l01373"></a><span class="lineno"> 1373</span>         pProfile = <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a25ada8139c82ca7beab3f279cff83184">m_VCoast</a>[nCoast].pGetProfileWithUpCoastSeq(n);</div>
<div class="line"><a id="l01374" name="l01374"></a><span class="lineno"> 1374</span> </div>
<div class="line"><a id="l01375" name="l01375"></a><span class="lineno"> 1375</span>      <span class="comment">// Don&#39;t do this for the first and last profiles (i.e. the profiles at the start and end of the coast) since these are put onto the grid elsewhere</span></div>
<div class="line"><a id="l01376" name="l01376"></a><span class="lineno"> 1376</span>      <span class="keywordflow">if</span> ((pProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#ac591314b290b032ffc8a70d22df64ec0">bStartOfCoast</a>()) || (pProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#aec35bc03fc47a65349def96364c99bbd">bEndOfCoast</a>()))</div>
<div class="line"><a id="l01377" name="l01377"></a><span class="lineno"> 1377</span>         <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l01378" name="l01378"></a><span class="lineno"> 1378</span> </div>
<div class="line"><a id="l01379" name="l01379"></a><span class="lineno"> 1379</span>      <span class="keywordtype">int</span> nProfile = pProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#aacd98f9837c3c7cf7414764b73275fba">nGetCoastID</a>();</div>
<div class="line"><a id="l01380" name="l01380"></a><span class="lineno"> 1380</span> </div>
<div class="line"><a id="l01381" name="l01381"></a><span class="lineno"> 1381</span>      <span class="comment">// If this profile has a problem, then forget about it</span></div>
<div class="line"><a id="l01382" name="l01382"></a><span class="lineno"> 1382</span>      <span class="comment">// if (! pProfile-&gt;bProfileOK())</span></div>
<div class="line"><a id="l01383" name="l01383"></a><span class="lineno"> 1383</span>      <span class="comment">// {</span></div>
<div class="line"><a id="l01384" name="l01384"></a><span class="lineno"> 1384</span>      <span class="comment">//    LogStream &lt;&lt; m_ulIter &lt;&lt; &quot;: in MarkProfilesOnGrid() profile &quot; &lt;&lt; nProfile &lt;&lt; &quot; is not OK&quot; &lt;&lt; endl;</span></div>
<div class="line"><a id="l01385" name="l01385"></a><span class="lineno"> 1385</span>      <span class="comment">//    continue;</span></div>
<div class="line"><a id="l01386" name="l01386"></a><span class="lineno"> 1386</span>      <span class="comment">// }</span></div>
<div class="line"><a id="l01387" name="l01387"></a><span class="lineno"> 1387</span> </div>
<div class="line"><a id="l01388" name="l01388"></a><span class="lineno"> 1388</span>      <span class="keywordtype">int</span> nPoints = pProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#abaf88697019588a2b0901bd19044aee4">nGetProfileSize</a>();</div>
<div class="line"><a id="l01389" name="l01389"></a><span class="lineno"> 1389</span>      <span class="keywordflow">if</span> (nPoints &lt; 2)</div>
<div class="line"><a id="l01390" name="l01390"></a><span class="lineno"> 1390</span>      {</div>
<div class="line"><a id="l01391" name="l01391"></a><span class="lineno"> 1391</span>         <span class="comment">// Need at least two points in the profile, so this profile is invalid: mark it</span></div>
<div class="line"><a id="l01392" name="l01392"></a><span class="lineno"> 1392</span>         <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a25ada8139c82ca7beab3f279cff83184">m_VCoast</a>[nCoast].pGetProfile(nProfile)-&gt;SetTooShort(<span class="keyword">true</span>);</div>
<div class="line"><a id="l01393" name="l01393"></a><span class="lineno"> 1393</span> </div>
<div class="line"><a id="l01394" name="l01394"></a><span class="lineno"> 1394</span>         <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a0245d3cbdd603fbeced6ca1465eb3f16">m_nLogFileDetail</a> &gt;= <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#a540d8a94fc09b0b14fd8ab657445b67a">LOG_FILE_MIDDLE_DETAIL</a>)</div>
<div class="line"><a id="l01395" name="l01395"></a><span class="lineno"> 1395</span>            <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a222962121613613a48f518e0c2110f21">LogStream</a> &lt;&lt; <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#ad67e8c5b30a0572f64ecfb5c062c2edc">m_ulIter</a> &lt;&lt; <span class="stringliteral">&quot;: coast &quot;</span> &lt;&lt; nCoast &lt;&lt; <span class="stringliteral">&quot;, profile &quot;</span> &lt;&lt; nProfile &lt;&lt; <span class="stringliteral">&quot; is invalid, has only &quot;</span> &lt;&lt; nPoints &lt;&lt; <span class="stringliteral">&quot; points&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a id="l01396" name="l01396"></a><span class="lineno"> 1396</span> </div>
<div class="line"><a id="l01397" name="l01397"></a><span class="lineno"> 1397</span>         <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l01398" name="l01398"></a><span class="lineno"> 1398</span>      }</div>
<div class="line"><a id="l01399" name="l01399"></a><span class="lineno"> 1399</span> </div>
<div class="line"><a id="l01400" name="l01400"></a><span class="lineno"> 1400</span>      <span class="comment">// OK, go for it: set up temporary vectors to hold the x-y coords (in grid CRS) of the cells which we will mark</span></div>
<div class="line"><a id="l01401" name="l01401"></a><span class="lineno"> 1401</span>      vector&lt;CGeom2DIPoint&gt; VCellsToMark;</div>
<div class="line"><a id="l01402" name="l01402"></a><span class="lineno"> 1402</span>      vector&lt;bool&gt; bVShared;</div>
<div class="line"><a id="l01403" name="l01403"></a><span class="lineno"> 1403</span>      <span class="keywordtype">bool</span> bTooShort = <span class="keyword">false</span>;</div>
<div class="line"><a id="l01404" name="l01404"></a><span class="lineno"> 1404</span>      <span class="keywordtype">bool</span> bTruncated = <span class="keyword">false</span>;</div>
<div class="line"><a id="l01405" name="l01405"></a><span class="lineno"> 1405</span>      <span class="keywordtype">bool</span> bHitCoast = <span class="keyword">false</span>;</div>
<div class="line"><a id="l01406" name="l01406"></a><span class="lineno"> 1406</span>      <span class="keywordtype">bool</span> bHitLand = <span class="keyword">false</span>;</div>
<div class="line"><a id="l01407" name="l01407"></a><span class="lineno"> 1407</span>      <span class="keywordtype">bool</span> bHitIntervention = <span class="keyword">false</span>;</div>
<div class="line"><a id="l01408" name="l01408"></a><span class="lineno"> 1408</span>      <span class="keywordtype">bool</span> bHitAnotherProfile = <span class="keyword">false</span>;       <span class="comment">// TODO 044</span></div>
<div class="line"><a id="l01409" name="l01409"></a><span class="lineno"> 1409</span> </div>
<div class="line"><a id="l01410" name="l01410"></a><span class="lineno"> 1410</span>      <a class="code hl_function" href="../../d1/d98/classCSimulation.html#a412f38f95d9e0e6797323316b510ab71">CreateRasterizedProfile</a>(nCoast, pProfile, &amp;VCellsToMark, &amp;bVShared, bTooShort, bTruncated, bHitCoast, bHitLand, bHitIntervention, bHitAnotherProfile);     <span class="comment">// TODO 044</span></div>
<div class="line"><a id="l01411" name="l01411"></a><span class="lineno"> 1411</span> </div>
<div class="line"><a id="l01412" name="l01412"></a><span class="lineno"> 1412</span>      <span class="keywordflow">if</span> ((bTruncated &amp;&amp; (! <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#a3199710e1049a0b077b1cb4276d262d1">ACCEPT_TRUNCATED_PROFILES</a>)) || bTooShort || bHitCoast || bHitLand || bHitIntervention || bHitAnotherProfile || VCellsToMark.size() == 0)</div>
<div class="line"><a id="l01413" name="l01413"></a><span class="lineno"> 1413</span>         <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l01414" name="l01414"></a><span class="lineno"> 1414</span> </div>
<div class="line"><a id="l01415" name="l01415"></a><span class="lineno"> 1415</span>      <span class="comment">// This profile is fine</span></div>
<div class="line"><a id="l01416" name="l01416"></a><span class="lineno"> 1416</span>      nValidProfiles++;</div>
<div class="line"><a id="l01417" name="l01417"></a><span class="lineno"> 1417</span> </div>
<div class="line"><a id="l01418" name="l01418"></a><span class="lineno"> 1418</span>      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> k = 0; k &lt; VCellsToMark.size(); k++)</div>
<div class="line"><a id="l01419" name="l01419"></a><span class="lineno"> 1419</span>      {</div>
<div class="line"><a id="l01420" name="l01420"></a><span class="lineno"> 1420</span>         <span class="comment">// Ignore duplicate points</span></div>
<div class="line"><a id="l01421" name="l01421"></a><span class="lineno"> 1421</span>         <span class="keywordflow">if</span> ((k &gt; 0) &amp;&amp; (VCellsToMark[k] == <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a25ada8139c82ca7beab3f279cff83184">m_VCoast</a>[nCoast].pGetProfile(nProfile)-&gt;pPtiGetLastCellInProfile()))</div>
<div class="line"><a id="l01422" name="l01422"></a><span class="lineno"> 1422</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l01423" name="l01423"></a><span class="lineno"> 1423</span> </div>
<div class="line"><a id="l01424" name="l01424"></a><span class="lineno"> 1424</span>         <span class="comment">// Mark each cell in the raster grid</span></div>
<div class="line"><a id="l01425" name="l01425"></a><span class="lineno"> 1425</span>         <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[VCellsToMark[k].nGetX()][VCellsToMark[k].nGetY()].SetProfileID(nProfile);</div>
<div class="line"><a id="l01426" name="l01426"></a><span class="lineno"> 1426</span> </div>
<div class="line"><a id="l01427" name="l01427"></a><span class="lineno"> 1427</span>         <span class="comment">// Store the raster grid coordinates in the profile object</span></div>
<div class="line"><a id="l01428" name="l01428"></a><span class="lineno"> 1428</span>         <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a25ada8139c82ca7beab3f279cff83184">m_VCoast</a>[nCoast].pGetProfile(nProfile)-&gt;AppendCellInProfile(VCellsToMark[k].nGetX(), VCellsToMark[k].nGetY());</div>
<div class="line"><a id="l01429" name="l01429"></a><span class="lineno"> 1429</span> </div>
<div class="line"><a id="l01430" name="l01430"></a><span class="lineno"> 1430</span>         <span class="comment">// And also store the external coordinates in the profile object</span></div>
<div class="line"><a id="l01431" name="l01431"></a><span class="lineno"> 1431</span>         <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a25ada8139c82ca7beab3f279cff83184">m_VCoast</a>[nCoast].pGetProfile(nProfile)-&gt;AppendCellInProfileExtCRS(<a class="code hl_function" href="../../d1/d98/classCSimulation.html#ad79b925ac5f358c6f867b6e47dad74bd">dGridCentroidXToExtCRSX</a>(VCellsToMark[k].nGetX()), <a class="code hl_function" href="../../d1/d98/classCSimulation.html#a7e2a4bd69ce79377fee86aa5598903f8">dGridCentroidYToExtCRSY</a>(VCellsToMark[k].nGetY()));</div>
<div class="line"><a id="l01432" name="l01432"></a><span class="lineno"> 1432</span> </div>
<div class="line"><a id="l01433" name="l01433"></a><span class="lineno"> 1433</span>         <span class="comment">// Mark the shared (i.e. multi-line) parts of the profile (if any)</span></div>
<div class="line"><a id="l01434" name="l01434"></a><span class="lineno"> 1434</span>         <span class="comment">//             if (bVShared[k])</span></div>
<div class="line"><a id="l01435" name="l01435"></a><span class="lineno"> 1435</span>         <span class="comment">//             {</span></div>
<div class="line"><a id="l01436" name="l01436"></a><span class="lineno"> 1436</span>         <span class="comment">//                m_VCoast[nCoast].pGetProfile(nProfile)-&gt;AppendPointShared(true);</span></div>
<div class="line"><a id="l01437" name="l01437"></a><span class="lineno"> 1437</span>         <span class="comment">// //                  LogStream &lt;&lt; m_ulIter &lt;&lt; &quot;: profile &quot; &lt;&lt; j &lt;&lt; &quot; point &quot; &lt;&lt; k &lt;&lt; &quot; marked as shared&quot; &lt;&lt; endl;</span></div>
<div class="line"><a id="l01438" name="l01438"></a><span class="lineno"> 1438</span>         <span class="comment">//             }</span></div>
<div class="line"><a id="l01439" name="l01439"></a><span class="lineno"> 1439</span>         <span class="comment">//             else</span></div>
<div class="line"><a id="l01440" name="l01440"></a><span class="lineno"> 1440</span>         <span class="comment">//             {</span></div>
<div class="line"><a id="l01441" name="l01441"></a><span class="lineno"> 1441</span>         <span class="comment">//                m_VCoast[nCoast].pGetProfile(nProfile)-&gt;AppendPointShared(false);</span></div>
<div class="line"><a id="l01442" name="l01442"></a><span class="lineno"> 1442</span>         <span class="comment">// //                  LogStream &lt;&lt; m_ulIter &lt;&lt; &quot;: profile &quot; &lt;&lt; nProfile &lt;&lt; &quot; point &quot; &lt;&lt; k &lt;&lt; &quot; marked as NOT shared&quot; &lt;&lt; endl;</span></div>
<div class="line"><a id="l01443" name="l01443"></a><span class="lineno"> 1443</span>         <span class="comment">//             }</span></div>
<div class="line"><a id="l01444" name="l01444"></a><span class="lineno"> 1444</span> </div>
<div class="line"><a id="l01445" name="l01445"></a><span class="lineno"> 1445</span>      }</div>
<div class="line"><a id="l01446" name="l01446"></a><span class="lineno"> 1446</span> </div>
<div class="line"><a id="l01447" name="l01447"></a><span class="lineno"> 1447</span>      <span class="comment">// Get the deep water wave height and orientation values at the end of the profile</span></div>
<div class="line"><a id="l01448" name="l01448"></a><span class="lineno"> 1448</span>      <span class="keywordtype">double</span> dDeepWaterWaveHeight = <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[VCellsToMark.back().nGetX()][VCellsToMark.back().nGetY()].dGetCellDeepWaterWaveHeight();</div>
<div class="line"><a id="l01449" name="l01449"></a><span class="lineno"> 1449</span>      <span class="keywordtype">double</span> dDeepWaterWaveAngle = <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[VCellsToMark.back().nGetX()][VCellsToMark.back().nGetY()].dGetCellDeepWaterWaveAngle();</div>
<div class="line"><a id="l01450" name="l01450"></a><span class="lineno"> 1450</span>      <span class="keywordtype">double</span> dDeepWaterWavePeriod = <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[VCellsToMark.back().nGetX()][VCellsToMark.back().nGetY()].dGetCellDeepWaterWavePeriod();</div>
<div class="line"><a id="l01451" name="l01451"></a><span class="lineno"> 1451</span> </div>
<div class="line"><a id="l01452" name="l01452"></a><span class="lineno"> 1452</span>      <span class="comment">// And store them for this profile</span></div>
<div class="line"><a id="l01453" name="l01453"></a><span class="lineno"> 1453</span>      <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a25ada8139c82ca7beab3f279cff83184">m_VCoast</a>[nCoast].pGetProfile(nProfile)-&gt;SetProfileDeepWaterWaveHeight(dDeepWaterWaveHeight);</div>
<div class="line"><a id="l01454" name="l01454"></a><span class="lineno"> 1454</span>      <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a25ada8139c82ca7beab3f279cff83184">m_VCoast</a>[nCoast].pGetProfile(nProfile)-&gt;SetProfileDeepWaterWaveAngle(dDeepWaterWaveAngle);</div>
<div class="line"><a id="l01455" name="l01455"></a><span class="lineno"> 1455</span>      <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a25ada8139c82ca7beab3f279cff83184">m_VCoast</a>[nCoast].pGetProfile(nProfile)-&gt;SetProfileDeepWaterWavePeriod(dDeepWaterWavePeriod);</div>
<div class="line"><a id="l01456" name="l01456"></a><span class="lineno"> 1456</span>   }</div>
<div class="line"><a id="l01457" name="l01457"></a><span class="lineno"> 1457</span> </div>
<div class="line"><a id="l01458" name="l01458"></a><span class="lineno"> 1458</span>   bDownCoast = ! bDownCoast;</div>
<div class="line"><a id="l01459" name="l01459"></a><span class="lineno"> 1459</span>}</div>
</div>
<div class="line"><a id="l01460" name="l01460"></a><span class="lineno"> 1460</span> </div>
<div class="line"><a id="l01461" name="l01461"></a><span class="lineno"> 1461</span><span class="comment">//===============================================================================================================================</span></div>
<div class="line"><a id="l01463" name="l01463"></a><span class="lineno"> 1463</span><span class="comment">//===============================================================================================================================</span></div>
<div class="foldopen" id="foldopen01464" data-start="{" data-end="}">
<div class="line"><a id="l01464" name="l01464"></a><span class="lineno"><a class="line" href="../../d1/d98/classCSimulation.html#a412f38f95d9e0e6797323316b510ab71"> 1464</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="../../d1/d98/classCSimulation.html#a412f38f95d9e0e6797323316b510ab71">CSimulation::CreateRasterizedProfile</a>(<span class="keywordtype">int</span> <span class="keyword">const</span> nCoast, <a class="code hl_class" href="../../da/dae/classCGeomProfile.html">CGeomProfile</a>* pProfile, vector&lt;CGeom2DIPoint&gt;* pVIPointsOut, vector&lt;bool&gt;* pbVShared, <span class="keywordtype">bool</span>&amp; bTooShort, <span class="keywordtype">bool</span>&amp; bTruncated, <span class="keywordtype">bool</span>&amp; bHitCoast, <span class="keywordtype">bool</span>&amp; bHitLand, <span class="keywordtype">bool</span>&amp; bHitIntervention, <span class="keywordtype">bool</span>&amp; bHitAnotherProfile)      <span class="comment">// TODO 044</span></div>
<div class="line"><a id="l01465" name="l01465"></a><span class="lineno"> 1465</span>{</div>
<div class="line"><a id="l01466" name="l01466"></a><span class="lineno"> 1466</span>   <span class="keywordtype">int</span> nProfile = pProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#aacd98f9837c3c7cf7414764b73275fba">nGetCoastID</a>();</div>
<div class="line"><a id="l01467" name="l01467"></a><span class="lineno"> 1467</span>   <span class="keywordtype">int</span> nSeg = 0;</div>
<div class="line"><a id="l01468" name="l01468"></a><span class="lineno"> 1468</span>   <span class="keywordtype">int</span> nNumSegments = pProfile-&gt;<a class="code hl_function" href="../../d0/d89/classCGeomMultiLine.html#ae22f845fd065108959610678de571cdb">nGetNumLineSegments</a>();</div>
<div class="line"><a id="l01469" name="l01469"></a><span class="lineno"> 1469</span> </div>
<div class="line"><a id="l01470" name="l01470"></a><span class="lineno"> 1470</span>   pVIPointsOut-&gt;clear();</div>
<div class="line"><a id="l01471" name="l01471"></a><span class="lineno"> 1471</span> </div>
<div class="line"><a id="l01472" name="l01472"></a><span class="lineno"> 1472</span>   <span class="comment">// LogStream &lt;&lt; m_ulIter &lt;&lt; &quot;: in CreateRasterizedProfile() *pPtiStart for profile &quot; &lt;&lt; nProfile &lt;&lt; &quot; is [&quot; &lt;&lt; pPtiStart-&gt;nGetX() &lt;&lt; &quot;][&quot; &lt;&lt; pPtiStart-&gt;nGetY() &lt;&lt; &quot;]&quot; &lt;&lt; endl;</span></div>
<div class="line"><a id="l01473" name="l01473"></a><span class="lineno"> 1473</span>   <span class="keywordtype">int</span> nXStartLast = <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#a01aa8b423260b337ddff2016107b51a0">INT_NODATA</a>;</div>
<div class="line"><a id="l01474" name="l01474"></a><span class="lineno"> 1474</span>   <span class="keywordtype">int</span> nYStartLast = <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#a01aa8b423260b337ddff2016107b51a0">INT_NODATA</a>;</div>
<div class="line"><a id="l01475" name="l01475"></a><span class="lineno"> 1475</span>   <span class="keywordtype">int</span> nXEndLast = <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#a01aa8b423260b337ddff2016107b51a0">INT_NODATA</a>;</div>
<div class="line"><a id="l01476" name="l01476"></a><span class="lineno"> 1476</span>   <span class="keywordtype">int</span> nYEndLast = <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#a01aa8b423260b337ddff2016107b51a0">INT_NODATA</a>;</div>
<div class="line"><a id="l01477" name="l01477"></a><span class="lineno"> 1477</span> </div>
<div class="line"><a id="l01478" name="l01478"></a><span class="lineno"> 1478</span>   <span class="comment">// Do for every segment of this profile</span></div>
<div class="line"><a id="l01479" name="l01479"></a><span class="lineno"> 1479</span>   <span class="keywordflow">for</span> (nSeg = 0; nSeg &lt; nNumSegments; nSeg++)</div>
<div class="line"><a id="l01480" name="l01480"></a><span class="lineno"> 1480</span>   {</div>
<div class="line"><a id="l01481" name="l01481"></a><span class="lineno"> 1481</span>      <span class="comment">// Do once for every line segment</span></div>
<div class="line"><a id="l01482" name="l01482"></a><span class="lineno"> 1482</span>      <a class="code hl_class" href="../../d6/d0d/classCGeom2DIPoint.html">CGeom2DIPoint</a> PtiSegStart;</div>
<div class="line"><a id="l01483" name="l01483"></a><span class="lineno"> 1483</span>      <span class="keywordflow">if</span> (nSeg == 0)</div>
<div class="line"><a id="l01484" name="l01484"></a><span class="lineno"> 1484</span>      {</div>
<div class="line"><a id="l01485" name="l01485"></a><span class="lineno"> 1485</span>         <span class="comment">// If this is the first segment, use the profile start point to prevent Ext CRS to Grid CGS rounding errors</span></div>
<div class="line"><a id="l01486" name="l01486"></a><span class="lineno"> 1486</span>         PtiSegStart = pProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#abe0557d3f6bd86e02facefb28b9fab41">pPtiGetStartPoint</a>();</div>
<div class="line"><a id="l01487" name="l01487"></a><span class="lineno"> 1487</span>      }</div>
<div class="line"><a id="l01488" name="l01488"></a><span class="lineno"> 1488</span>      <span class="keywordflow">else</span></div>
<div class="line"><a id="l01489" name="l01489"></a><span class="lineno"> 1489</span>      {</div>
<div class="line"><a id="l01490" name="l01490"></a><span class="lineno"> 1490</span>         <a class="code hl_class" href="../../d5/d4e/classCGeom2DPoint.html">CGeom2DPoint</a>* pPtSegStart = pProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#aaa8ddb9c775927bdb7940f7826f90a74">pPtGetPointInProfile</a>(nSeg);</div>
<div class="line"><a id="l01491" name="l01491"></a><span class="lineno"> 1491</span> </div>
<div class="line"><a id="l01492" name="l01492"></a><span class="lineno"> 1492</span>         <span class="comment">// Convert from the external CRS to grid CRS</span></div>
<div class="line"><a id="l01493" name="l01493"></a><span class="lineno"> 1493</span>         PtiSegStart = <a class="code hl_function" href="../../d1/d98/classCSimulation.html#a1cdb36fc97d2f40d471edc2d59734960">PtiExtCRSToGridRound</a>(pPtSegStart);</div>
<div class="line"><a id="l01494" name="l01494"></a><span class="lineno"> 1494</span>      }</div>
<div class="line"><a id="l01495" name="l01495"></a><span class="lineno"> 1495</span> </div>
<div class="line"><a id="l01496" name="l01496"></a><span class="lineno"> 1496</span>      <a class="code hl_class" href="../../d5/d4e/classCGeom2DPoint.html">CGeom2DPoint</a>* pPtSegEnd = pProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#aaa8ddb9c775927bdb7940f7826f90a74">pPtGetPointInProfile</a>(nSeg + 1); <span class="comment">// This is OK</span></div>
<div class="line"><a id="l01497" name="l01497"></a><span class="lineno"> 1497</span> </div>
<div class="line"><a id="l01498" name="l01498"></a><span class="lineno"> 1498</span>      <span class="comment">// Convert from the external CRS to grid CRS</span></div>
<div class="line"><a id="l01499" name="l01499"></a><span class="lineno"> 1499</span>      <a class="code hl_class" href="../../d6/d0d/classCGeom2DIPoint.html">CGeom2DIPoint</a> PtiSegEnd = <a class="code hl_function" href="../../d1/d98/classCSimulation.html#a1cdb36fc97d2f40d471edc2d59734960">PtiExtCRSToGridRound</a>(pPtSegEnd);</div>
<div class="line"><a id="l01500" name="l01500"></a><span class="lineno"> 1500</span> </div>
<div class="line"><a id="l01501" name="l01501"></a><span class="lineno"> 1501</span>      <span class="comment">// Safety check</span></div>
<div class="line"><a id="l01502" name="l01502"></a><span class="lineno"> 1502</span>      <span class="keywordflow">if</span> (PtiSegStart == PtiSegEnd)</div>
<div class="line"><a id="l01503" name="l01503"></a><span class="lineno"> 1503</span>         <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l01504" name="l01504"></a><span class="lineno"> 1504</span> </div>
<div class="line"><a id="l01505" name="l01505"></a><span class="lineno"> 1505</span>      <span class="keywordtype">int</span> nXStart = PtiSegStart.<a class="code hl_function" href="../../d6/d0d/classCGeom2DIPoint.html#af84c687b2d0be01ab41cbcc0565f4f3f">nGetX</a>();</div>
<div class="line"><a id="l01506" name="l01506"></a><span class="lineno"> 1506</span>      <span class="keywordtype">int</span> nYStart = PtiSegStart.<a class="code hl_function" href="../../d6/d0d/classCGeom2DIPoint.html#a4d9c20bcca90dcb9d519b664aba09cbd">nGetY</a>();</div>
<div class="line"><a id="l01507" name="l01507"></a><span class="lineno"> 1507</span>      <span class="keywordtype">int</span> nXEnd = PtiSegEnd.<a class="code hl_function" href="../../d6/d0d/classCGeom2DIPoint.html#af84c687b2d0be01ab41cbcc0565f4f3f">nGetX</a>();</div>
<div class="line"><a id="l01508" name="l01508"></a><span class="lineno"> 1508</span>      <span class="keywordtype">int</span> nYEnd = PtiSegEnd.<a class="code hl_function" href="../../d6/d0d/classCGeom2DIPoint.html#a4d9c20bcca90dcb9d519b664aba09cbd">nGetY</a>();</div>
<div class="line"><a id="l01509" name="l01509"></a><span class="lineno"> 1509</span> </div>
<div class="line"><a id="l01510" name="l01510"></a><span class="lineno"> 1510</span>      <span class="keywordtype">bool</span> bShared = <span class="keyword">false</span>;</div>
<div class="line"><a id="l01511" name="l01511"></a><span class="lineno"> 1511</span>      <span class="keywordflow">if</span> (pProfile-&gt;<a class="code hl_function" href="../../d0/d89/classCGeomMultiLine.html#a3516022bd96ee15709653b3bb7cc0155">nGetNumCoincidentProfilesInLineSegment</a>(nSeg) &gt; 1)</div>
<div class="line"><a id="l01512" name="l01512"></a><span class="lineno"> 1512</span>      {</div>
<div class="line"><a id="l01513" name="l01513"></a><span class="lineno"> 1513</span>         bShared = <span class="keyword">true</span>;</div>
<div class="line"><a id="l01514" name="l01514"></a><span class="lineno"> 1514</span> </div>
<div class="line"><a id="l01515" name="l01515"></a><span class="lineno"> 1515</span>         <span class="comment">// If this is the second or more of several coincident line segments (i.e. it has the same start and end points as the previous line segment) then ignore it</span></div>
<div class="line"><a id="l01516" name="l01516"></a><span class="lineno"> 1516</span>         <span class="keywordflow">if</span> ((nXStart == nXStartLast) &amp;&amp; (nYStart == nYStartLast) &amp;&amp; (nXEnd == nXEndLast) &amp;&amp; (nYEnd == nYEndLast))</div>
<div class="line"><a id="l01517" name="l01517"></a><span class="lineno"> 1517</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l01518" name="l01518"></a><span class="lineno"> 1518</span>      }</div>
<div class="line"><a id="l01519" name="l01519"></a><span class="lineno"> 1519</span> </div>
<div class="line"><a id="l01520" name="l01520"></a><span class="lineno"> 1520</span>      <span class="comment">// Interpolate between cells by a simple DDA line algorithm, see http://en.wikipedia.org/wiki/Digital_differential_analyzer_(graphics_algorithm) Note that Bresenham&#39;s algorithm gave occasional gaps</span></div>
<div class="line"><a id="l01521" name="l01521"></a><span class="lineno"> 1521</span>      <span class="keywordtype">double</span> dXInc = nXEnd - nXStart;</div>
<div class="line"><a id="l01522" name="l01522"></a><span class="lineno"> 1522</span>      <span class="keywordtype">double</span> dYInc = nYEnd - nYStart;</div>
<div class="line"><a id="l01523" name="l01523"></a><span class="lineno"> 1523</span>      <span class="keywordtype">double</span> dLength = <a class="code hl_function" href="../../d6/d2a/cme_8h.html#a7e895b460cef877dec4d12ead0c74f15">tMax</a>(<a class="code hl_function" href="../../d6/d2a/cme_8h.html#ae3b6dc50cfc97050529faa5e0bd66136">tAbs</a>(dXInc), <a class="code hl_function" href="../../d6/d2a/cme_8h.html#ae3b6dc50cfc97050529faa5e0bd66136">tAbs</a>(dYInc));</div>
<div class="line"><a id="l01524" name="l01524"></a><span class="lineno"> 1524</span> </div>
<div class="line"><a id="l01525" name="l01525"></a><span class="lineno"> 1525</span>      dXInc /= dLength;</div>
<div class="line"><a id="l01526" name="l01526"></a><span class="lineno"> 1526</span>      dYInc /= dLength;</div>
<div class="line"><a id="l01527" name="l01527"></a><span class="lineno"> 1527</span> </div>
<div class="line"><a id="l01528" name="l01528"></a><span class="lineno"> 1528</span>      <span class="keywordtype">double</span> dX = nXStart;</div>
<div class="line"><a id="l01529" name="l01529"></a><span class="lineno"> 1529</span>      <span class="keywordtype">double</span> dY = nYStart;</div>
<div class="line"><a id="l01530" name="l01530"></a><span class="lineno"> 1530</span> </div>
<div class="line"><a id="l01531" name="l01531"></a><span class="lineno"> 1531</span>      <span class="comment">// Process each interpolated point</span></div>
<div class="line"><a id="l01532" name="l01532"></a><span class="lineno"> 1532</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> m = 0; m &lt;= <a class="code hl_function" href="../../d2/dfd/utils__global_8cpp.html#a20842d0a19d0ca952c91f3e1eb175fee">nRound</a>(dLength); m++)</div>
<div class="line"><a id="l01533" name="l01533"></a><span class="lineno"> 1533</span>      {</div>
<div class="line"><a id="l01534" name="l01534"></a><span class="lineno"> 1534</span>         <span class="keywordtype">int</span> nX = <a class="code hl_function" href="../../d2/dfd/utils__global_8cpp.html#a20842d0a19d0ca952c91f3e1eb175fee">nRound</a>(dX);</div>
<div class="line"><a id="l01535" name="l01535"></a><span class="lineno"> 1535</span>         <span class="keywordtype">int</span> nY = <a class="code hl_function" href="../../d2/dfd/utils__global_8cpp.html#a20842d0a19d0ca952c91f3e1eb175fee">nRound</a>(dY);</div>
<div class="line"><a id="l01536" name="l01536"></a><span class="lineno"> 1536</span> </div>
<div class="line"><a id="l01537" name="l01537"></a><span class="lineno"> 1537</span>         <span class="comment">// Do some checking of this interpolated point, but only if this is not a grid-edge profile (these profiles are always valid)</span></div>
<div class="line"><a id="l01538" name="l01538"></a><span class="lineno"> 1538</span>         <span class="keywordflow">if</span> ((! pProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#ac591314b290b032ffc8a70d22df64ec0">bStartOfCoast</a>()) &amp;&amp; (! pProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#aec35bc03fc47a65349def96364c99bbd">bEndOfCoast</a>()))</div>
<div class="line"><a id="l01539" name="l01539"></a><span class="lineno"> 1539</span>         {</div>
<div class="line"><a id="l01540" name="l01540"></a><span class="lineno"> 1540</span>            <span class="comment">// Is the interpolated point within the valid raster grid?</span></div>
<div class="line"><a id="l01541" name="l01541"></a><span class="lineno"> 1541</span>            <span class="keywordflow">if</span> (! <a class="code hl_function" href="../../d1/d98/classCSimulation.html#ac900a5701df97da22278fae928951f50">bIsWithinValidGrid</a>(nX, nY))</div>
<div class="line"><a id="l01542" name="l01542"></a><span class="lineno"> 1542</span>            {</div>
<div class="line"><a id="l01543" name="l01543"></a><span class="lineno"> 1543</span>               <span class="comment">// It is outside the valid grid, so mark this profile and quit the loop</span></div>
<div class="line"><a id="l01544" name="l01544"></a><span class="lineno"> 1544</span>               bTruncated = <span class="keyword">true</span>;</div>
<div class="line"><a id="l01545" name="l01545"></a><span class="lineno"> 1545</span> </div>
<div class="line"><a id="l01546" name="l01546"></a><span class="lineno"> 1546</span>               <span class="keywordflow">if</span> (! <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#a3199710e1049a0b077b1cb4276d262d1">ACCEPT_TRUNCATED_PROFILES</a>)</div>
<div class="line"><a id="l01547" name="l01547"></a><span class="lineno"> 1547</span>                  pProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#a753c1ed80d2ebd882faa4181b16aa8c0">SetTruncated</a>(<span class="keyword">true</span>);</div>
<div class="line"><a id="l01548" name="l01548"></a><span class="lineno"> 1548</span> </div>
<div class="line"><a id="l01549" name="l01549"></a><span class="lineno"> 1549</span>               <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a0245d3cbdd603fbeced6ca1465eb3f16">m_nLogFileDetail</a> &gt;= <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#a540d8a94fc09b0b14fd8ab657445b67a">LOG_FILE_MIDDLE_DETAIL</a>)</div>
<div class="line"><a id="l01550" name="l01550"></a><span class="lineno"> 1550</span>                  <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a222962121613613a48f518e0c2110f21">LogStream</a> &lt;&lt; <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#ad67e8c5b30a0572f64ecfb5c062c2edc">m_ulIter</a> &lt;&lt; <span class="stringliteral">&quot;: profile &quot;</span> &lt;&lt; nProfile &lt;&lt; <span class="stringliteral">&quot; is invalid, truncated at [&quot;</span> &lt;&lt; nX &lt;&lt; <span class="stringliteral">&quot;][&quot;</span> &lt;&lt; nY &lt;&lt; <span class="stringliteral">&quot;] = {&quot;</span> &lt;&lt; <a class="code hl_function" href="../../d1/d98/classCSimulation.html#ad79b925ac5f358c6f867b6e47dad74bd">dGridCentroidXToExtCRSX</a>(nX) &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; <a class="code hl_function" href="../../d1/d98/classCSimulation.html#a7e2a4bd69ce79377fee86aa5598903f8">dGridCentroidYToExtCRSY</a>(nY) &lt;&lt; <span class="stringliteral">&quot;}&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a id="l01551" name="l01551"></a><span class="lineno"> 1551</span> </div>
<div class="line"><a id="l01552" name="l01552"></a><span class="lineno"> 1552</span>               <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01553" name="l01553"></a><span class="lineno"> 1553</span>            }</div>
<div class="line"><a id="l01554" name="l01554"></a><span class="lineno"> 1554</span> </div>
<div class="line"><a id="l01555" name="l01555"></a><span class="lineno"> 1555</span>            <span class="comment">// If this is the first line segment of the profile, then once we are clear of the coastline (say, when m &gt; 3), check if this profile hits land at this interpolated point. NOTE Get problems here since if the coastline vector has been heavily smoothed, this can result is &#39;false positives&#39; profiles marked as invalid which are not actually invalid, because the profile hits land when m = 0 or m = 1. This results in some cells being flagged as profile cells which are actually inland</span></div>
<div class="line"><a id="l01556" name="l01556"></a><span class="lineno"> 1556</span>            <span class="keywordflow">if</span> (m &gt; <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#a8f6a3504fb8861c1f92c19af69ea2250">PROFILE_CHECK_DIST_FROM_COAST</a>)</div>
<div class="line"><a id="l01557" name="l01557"></a><span class="lineno"> 1557</span>            {</div>
<div class="line"><a id="l01558" name="l01558"></a><span class="lineno"> 1558</span>               <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[nX][nY].bIsCoastline())</div>
<div class="line"><a id="l01559" name="l01559"></a><span class="lineno"> 1559</span>               {</div>
<div class="line"><a id="l01560" name="l01560"></a><span class="lineno"> 1560</span>                  <span class="comment">// We&#39;ve hit a coastline so set a switch and mark the profile, then quit</span></div>
<div class="line"><a id="l01561" name="l01561"></a><span class="lineno"> 1561</span>                  bHitCoast = <span class="keyword">true</span>;</div>
<div class="line"><a id="l01562" name="l01562"></a><span class="lineno"> 1562</span>                  pProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#a45410879aaf7f8f9abc073fc54363d03">SetHitCoast</a>(<span class="keyword">true</span>);</div>
<div class="line"><a id="l01563" name="l01563"></a><span class="lineno"> 1563</span> </div>
<div class="line"><a id="l01564" name="l01564"></a><span class="lineno"> 1564</span>                  <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a0245d3cbdd603fbeced6ca1465eb3f16">m_nLogFileDetail</a> &gt;= <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#aa58b13ad2e88aaa20449bfea242396a4">LOG_FILE_ALL</a>)</div>
<div class="line"><a id="l01565" name="l01565"></a><span class="lineno"> 1565</span>                     <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a222962121613613a48f518e0c2110f21">LogStream</a> &lt;&lt; <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#ad67e8c5b30a0572f64ecfb5c062c2edc">m_ulIter</a> &lt;&lt; <span class="stringliteral">&quot;: coast &quot;</span> &lt;&lt; nCoast &lt;&lt; <span class="stringliteral">&quot; profile &quot;</span> &lt;&lt; nProfile &lt;&lt; <span class="stringliteral">&quot; is invalid, hit coast at [&quot;</span> &lt;&lt; nX &lt;&lt; <span class="stringliteral">&quot;][&quot;</span> &lt;&lt; nY &lt;&lt; <span class="stringliteral">&quot;] = {&quot;</span> &lt;&lt; <a class="code hl_function" href="../../d1/d98/classCSimulation.html#ad79b925ac5f358c6f867b6e47dad74bd">dGridCentroidXToExtCRSX</a>(nX) &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; <a class="code hl_function" href="../../d1/d98/classCSimulation.html#a7e2a4bd69ce79377fee86aa5598903f8">dGridCentroidYToExtCRSY</a>(nY) &lt;&lt; <span class="stringliteral">&quot;}&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a id="l01566" name="l01566"></a><span class="lineno"> 1566</span> </div>
<div class="line"><a id="l01567" name="l01567"></a><span class="lineno"> 1567</span>                  <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l01568" name="l01568"></a><span class="lineno"> 1568</span>               }</div>
<div class="line"><a id="l01569" name="l01569"></a><span class="lineno"> 1569</span> </div>
<div class="line"><a id="l01570" name="l01570"></a><span class="lineno"> 1570</span>               <span class="comment">// Two diagonal(ish) raster lines can cross each other without any intersection, so must also test an adjacent cell for intersection (does not matter which adjacent cell)</span></div>
<div class="line"><a id="l01571" name="l01571"></a><span class="lineno"> 1571</span>               <span class="keywordflow">if</span> (<a class="code hl_function" href="../../d1/d98/classCSimulation.html#ac900a5701df97da22278fae928951f50">bIsWithinValidGrid</a>(nX, nY + 1) &amp;&amp; <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[nX][nY + 1].bIsCoastline())</div>
<div class="line"><a id="l01572" name="l01572"></a><span class="lineno"> 1572</span>               {</div>
<div class="line"><a id="l01573" name="l01573"></a><span class="lineno"> 1573</span>                  <span class="comment">// We&#39;ve hit a coastline so set a switch and mark the profile, then quit</span></div>
<div class="line"><a id="l01574" name="l01574"></a><span class="lineno"> 1574</span>                  bHitCoast = <span class="keyword">true</span>;</div>
<div class="line"><a id="l01575" name="l01575"></a><span class="lineno"> 1575</span>                  pProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#a45410879aaf7f8f9abc073fc54363d03">SetHitCoast</a>(<span class="keyword">true</span>);</div>
<div class="line"><a id="l01576" name="l01576"></a><span class="lineno"> 1576</span> </div>
<div class="line"><a id="l01577" name="l01577"></a><span class="lineno"> 1577</span>                  <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a0245d3cbdd603fbeced6ca1465eb3f16">m_nLogFileDetail</a> &gt;= <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#aa58b13ad2e88aaa20449bfea242396a4">LOG_FILE_ALL</a>)</div>
<div class="line"><a id="l01578" name="l01578"></a><span class="lineno"> 1578</span>                     <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a222962121613613a48f518e0c2110f21">LogStream</a> &lt;&lt; <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#ad67e8c5b30a0572f64ecfb5c062c2edc">m_ulIter</a> &lt;&lt; <span class="stringliteral">&quot;: coast &quot;</span> &lt;&lt; nCoast &lt;&lt; <span class="stringliteral">&quot; profile &quot;</span> &lt;&lt; nProfile &lt;&lt; <span class="stringliteral">&quot; is invalid, hit coast at [&quot;</span> &lt;&lt; nX &lt;&lt; <span class="stringliteral">&quot;][&quot;</span> &lt;&lt; nY + 1 &lt;&lt; <span class="stringliteral">&quot;] = {&quot;</span> &lt;&lt; <a class="code hl_function" href="../../d1/d98/classCSimulation.html#ad79b925ac5f358c6f867b6e47dad74bd">dGridCentroidXToExtCRSX</a>(nX) &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; <a class="code hl_function" href="../../d1/d98/classCSimulation.html#a7e2a4bd69ce79377fee86aa5598903f8">dGridCentroidYToExtCRSY</a>(nY + 1) &lt;&lt; <span class="stringliteral">&quot;}&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a id="l01579" name="l01579"></a><span class="lineno"> 1579</span> </div>
<div class="line"><a id="l01580" name="l01580"></a><span class="lineno"> 1580</span>                  <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l01581" name="l01581"></a><span class="lineno"> 1581</span>               }</div>
<div class="line"><a id="l01582" name="l01582"></a><span class="lineno"> 1582</span> </div>
<div class="line"><a id="l01583" name="l01583"></a><span class="lineno"> 1583</span>               <span class="keywordflow">if</span> (! <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[nX][nY].bIsInContiguousSea())</div>
<div class="line"><a id="l01584" name="l01584"></a><span class="lineno"> 1584</span>               {</div>
<div class="line"><a id="l01585" name="l01585"></a><span class="lineno"> 1585</span>                  <span class="comment">// We&#39;ve hit dry land, so set a switch and mark the profile</span></div>
<div class="line"><a id="l01586" name="l01586"></a><span class="lineno"> 1586</span>                  bHitLand = <span class="keyword">true</span>;</div>
<div class="line"><a id="l01587" name="l01587"></a><span class="lineno"> 1587</span>                  pProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#ad5381cb54ceb34b7a566f2757b76ebcb">SetHitLand</a>(<span class="keyword">true</span>);</div>
<div class="line"><a id="l01588" name="l01588"></a><span class="lineno"> 1588</span> </div>
<div class="line"><a id="l01589" name="l01589"></a><span class="lineno"> 1589</span>                  <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a222962121613613a48f518e0c2110f21">LogStream</a> &lt;&lt; <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#ad67e8c5b30a0572f64ecfb5c062c2edc">m_ulIter</a> &lt;&lt; <span class="stringliteral">&quot;: profile &quot;</span> &lt;&lt; nProfile &lt;&lt; <span class="stringliteral">&quot; HIT LAND at [&quot;</span> &lt;&lt; nX &lt;&lt; <span class="stringliteral">&quot;][&quot;</span> &lt;&lt; nY &lt;&lt; <span class="stringliteral">&quot;] = {&quot;</span> &lt;&lt; <a class="code hl_function" href="../../d1/d98/classCSimulation.html#ad79b925ac5f358c6f867b6e47dad74bd">dGridCentroidXToExtCRSX</a>(nX) &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; <a class="code hl_function" href="../../d1/d98/classCSimulation.html#a7e2a4bd69ce79377fee86aa5598903f8">dGridCentroidYToExtCRSY</a>(nY) &lt;&lt; <span class="stringliteral">&quot;}, elevation = &quot;</span> &lt;&lt; <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[nX][nY].dGetSedimentTopElev() &lt;&lt; <span class="stringliteral">&quot;, SWL = &quot;</span> &lt;&lt; <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a115ab27bae37ce2d0de57cbdaeaba852">m_dThisIterSWL</a> &lt;&lt; endl;</div>
<div class="line"><a id="l01590" name="l01590"></a><span class="lineno"> 1590</span> </div>
<div class="line"><a id="l01591" name="l01591"></a><span class="lineno"> 1591</span>                  <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l01592" name="l01592"></a><span class="lineno"> 1592</span>               }</div>
<div class="line"><a id="l01593" name="l01593"></a><span class="lineno"> 1593</span> </div>
<div class="line"><a id="l01594" name="l01594"></a><span class="lineno"> 1594</span>               <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[nX][nY].nGetInterventionClass() != <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#a01aa8b423260b337ddff2016107b51a0">INT_NODATA</a>)</div>
<div class="line"><a id="l01595" name="l01595"></a><span class="lineno"> 1595</span>               {</div>
<div class="line"><a id="l01596" name="l01596"></a><span class="lineno"> 1596</span>                  <span class="comment">// We&#39;ve hit an intervention, so set a switch and mark the profile</span></div>
<div class="line"><a id="l01597" name="l01597"></a><span class="lineno"> 1597</span>                  bHitIntervention = <span class="keyword">true</span>;</div>
<div class="line"><a id="l01598" name="l01598"></a><span class="lineno"> 1598</span>                  pProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#aa0bea5b6aab5cb9b77d67b56d8012318">SetHitIntervention</a>(<span class="keyword">true</span>);</div>
<div class="line"><a id="l01599" name="l01599"></a><span class="lineno"> 1599</span> </div>
<div class="line"><a id="l01600" name="l01600"></a><span class="lineno"> 1600</span>                  <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a222962121613613a48f518e0c2110f21">LogStream</a> &lt;&lt; <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#ad67e8c5b30a0572f64ecfb5c062c2edc">m_ulIter</a> &lt;&lt; <span class="stringliteral">&quot;: profile &quot;</span> &lt;&lt; nProfile &lt;&lt; <span class="stringliteral">&quot; HIT INTERVENTION at [&quot;</span> &lt;&lt; nX &lt;&lt; <span class="stringliteral">&quot;][&quot;</span> &lt;&lt; nY &lt;&lt; <span class="stringliteral">&quot;] = {&quot;</span> &lt;&lt; <a class="code hl_function" href="../../d1/d98/classCSimulation.html#ad79b925ac5f358c6f867b6e47dad74bd">dGridCentroidXToExtCRSX</a>(nX) &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; <a class="code hl_function" href="../../d1/d98/classCSimulation.html#a7e2a4bd69ce79377fee86aa5598903f8">dGridCentroidYToExtCRSY</a>(nY) &lt;&lt; <span class="stringliteral">&quot;}, elevation = &quot;</span> &lt;&lt; <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[nX][nY].dGetSedimentTopElev() &lt;&lt; <span class="stringliteral">&quot;, SWL = &quot;</span> &lt;&lt; <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a115ab27bae37ce2d0de57cbdaeaba852">m_dThisIterSWL</a> &lt;&lt; endl;</div>
<div class="line"><a id="l01601" name="l01601"></a><span class="lineno"> 1601</span> </div>
<div class="line"><a id="l01602" name="l01602"></a><span class="lineno"> 1602</span>                  <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l01603" name="l01603"></a><span class="lineno"> 1603</span>               }</div>
<div class="line"><a id="l01604" name="l01604"></a><span class="lineno"> 1604</span>            }</div>
<div class="line"><a id="l01605" name="l01605"></a><span class="lineno"> 1605</span> </div>
<div class="line"><a id="l01606" name="l01606"></a><span class="lineno"> 1606</span>            <span class="comment">// Now check to see if we hit another profile which is not a coincident normal to this normal</span></div>
<div class="line"><a id="l01607" name="l01607"></a><span class="lineno"> 1607</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[nX][nY].bIsProfile())</div>
<div class="line"><a id="l01608" name="l01608"></a><span class="lineno"> 1608</span>            {</div>
<div class="line"><a id="l01609" name="l01609"></a><span class="lineno"> 1609</span>               <span class="comment">// We&#39;ve hit a raster cell which is already marked as &#39;under&#39; a normal profile. Get the number of the profile which marked this cell</span></div>
<div class="line"><a id="l01610" name="l01610"></a><span class="lineno"> 1610</span>               <span class="keywordtype">int</span> nHitProfile = <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[nX][nY].nGetProfileID();</div>
<div class="line"><a id="l01611" name="l01611"></a><span class="lineno"> 1611</span>               </div>
<div class="line"><a id="l01612" name="l01612"></a><span class="lineno"> 1612</span>               <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a222962121613613a48f518e0c2110f21">LogStream</a> &lt;&lt; <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#ad67e8c5b30a0572f64ecfb5c062c2edc">m_ulIter</a> &lt;&lt; <span class="stringliteral">&quot;: profile &quot;</span> &lt;&lt; nProfile &lt;&lt; <span class="stringliteral">&quot; HIT ANOTHER PROFILE (&quot;</span> &lt;&lt; nHitProfile &lt;&lt; <span class="stringliteral">&quot;) at [&quot;</span> &lt;&lt; nX &lt;&lt; <span class="stringliteral">&quot;][&quot;</span> &lt;&lt; nY &lt;&lt; <span class="stringliteral">&quot;] = {&quot;</span> &lt;&lt; <a class="code hl_function" href="../../d1/d98/classCSimulation.html#ad79b925ac5f358c6f867b6e47dad74bd">dGridCentroidXToExtCRSX</a>(nX) &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; <a class="code hl_function" href="../../d1/d98/classCSimulation.html#a7e2a4bd69ce79377fee86aa5598903f8">dGridCentroidYToExtCRSY</a>(nY) &lt;&lt; <span class="stringliteral">&quot;}, elevation = &quot;</span> &lt;&lt; <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">m_pRasterGrid</a>-&gt;m_Cell[nX][nY].dGetSedimentTopElev() &lt;&lt; <span class="stringliteral">&quot;, SWL = &quot;</span> &lt;&lt; <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a115ab27bae37ce2d0de57cbdaeaba852">m_dThisIterSWL</a> &lt;&lt; endl;</div>
<div class="line"><a id="l01613" name="l01613"></a><span class="lineno"> 1613</span> </div>
<div class="line"><a id="l01614" name="l01614"></a><span class="lineno"> 1614</span>               <span class="comment">// Is this the number of a coincident profile of this profile?</span></div>
<div class="line"><a id="l01615" name="l01615"></a><span class="lineno"> 1615</span>               <span class="keywordflow">if</span> (! pProfile-&gt;<a class="code hl_function" href="../../d0/d89/classCGeomMultiLine.html#a3063e454f1e7ef2b32484cf8c7db0e97">bFindProfileInCoincidentProfilesOfLastLineSegment</a>(nHitProfile))</div>
<div class="line"><a id="l01616" name="l01616"></a><span class="lineno"> 1616</span>               {</div>
<div class="line"><a id="l01617" name="l01617"></a><span class="lineno"> 1617</span>                  <span class="comment">// It isn&#39;t a coincident profile, so we have just hit an unrelated profile. Mark this profile as invalid and move on</span></div>
<div class="line"><a id="l01618" name="l01618"></a><span class="lineno"> 1618</span>                  pProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#a6d4286ac64e3fe9aef428c93fdcd4230">SetHitAnotherProfile</a>(<span class="keyword">true</span>);</div>
<div class="line"><a id="l01619" name="l01619"></a><span class="lineno"> 1619</span>                  bHitAnotherProfile = <span class="keyword">true</span>;</div>
<div class="line"><a id="l01620" name="l01620"></a><span class="lineno"> 1620</span>                  </div>
<div class="line"><a id="l01621" name="l01621"></a><span class="lineno"> 1621</span>                  <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l01622" name="l01622"></a><span class="lineno"> 1622</span>               }</div>
<div class="line"><a id="l01623" name="l01623"></a><span class="lineno"> 1623</span>            }</div>
<div class="line"><a id="l01624" name="l01624"></a><span class="lineno"> 1624</span>         }</div>
<div class="line"><a id="l01625" name="l01625"></a><span class="lineno"> 1625</span> </div>
<div class="line"><a id="l01626" name="l01626"></a><span class="lineno"> 1626</span>         <span class="comment">// Append this point to the output vector</span></div>
<div class="line"><a id="l01627" name="l01627"></a><span class="lineno"> 1627</span>         pVIPointsOut-&gt;push_back(<a class="code hl_class" href="../../d6/d0d/classCGeom2DIPoint.html">CGeom2DIPoint</a>(nX, nY)); <span class="comment">// Is in raster grid coordinates</span></div>
<div class="line"><a id="l01628" name="l01628"></a><span class="lineno"> 1628</span>         pbVShared-&gt;push_back(bShared);</div>
<div class="line"><a id="l01629" name="l01629"></a><span class="lineno"> 1629</span> </div>
<div class="line"><a id="l01630" name="l01630"></a><span class="lineno"> 1630</span>         <span class="comment">// And increment for next time</span></div>
<div class="line"><a id="l01631" name="l01631"></a><span class="lineno"> 1631</span>         dX += dXInc;</div>
<div class="line"><a id="l01632" name="l01632"></a><span class="lineno"> 1632</span>         dY += dYInc;</div>
<div class="line"><a id="l01633" name="l01633"></a><span class="lineno"> 1633</span>      }</div>
<div class="line"><a id="l01634" name="l01634"></a><span class="lineno"> 1634</span> </div>
<div class="line"><a id="l01635" name="l01635"></a><span class="lineno"> 1635</span>      nXStartLast = nXStart;</div>
<div class="line"><a id="l01636" name="l01636"></a><span class="lineno"> 1636</span>      nYStartLast = nYStart;</div>
<div class="line"><a id="l01637" name="l01637"></a><span class="lineno"> 1637</span>      nXEndLast = nXEnd;</div>
<div class="line"><a id="l01638" name="l01638"></a><span class="lineno"> 1638</span>      nYEndLast = nYEnd;</div>
<div class="line"><a id="l01639" name="l01639"></a><span class="lineno"> 1639</span> </div>
<div class="line"><a id="l01640" name="l01640"></a><span class="lineno"> 1640</span>      <span class="keywordflow">if</span> (bTruncated)</div>
<div class="line"><a id="l01641" name="l01641"></a><span class="lineno"> 1641</span>         <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01642" name="l01642"></a><span class="lineno"> 1642</span>   }</div>
<div class="line"><a id="l01643" name="l01643"></a><span class="lineno"> 1643</span> </div>
<div class="line"><a id="l01644" name="l01644"></a><span class="lineno"> 1644</span>   <span class="keywordflow">if</span> (bTruncated)</div>
<div class="line"><a id="l01645" name="l01645"></a><span class="lineno"> 1645</span>   {</div>
<div class="line"><a id="l01646" name="l01646"></a><span class="lineno"> 1646</span>      <span class="keywordflow">if</span> (nSeg &lt; (nNumSegments - 1))</div>
<div class="line"><a id="l01647" name="l01647"></a><span class="lineno"> 1647</span>         <span class="comment">// We are truncating the profile, so remove any line segments after this one</span></div>
<div class="line"><a id="l01648" name="l01648"></a><span class="lineno"> 1648</span>         pProfile-&gt;<a class="code hl_function" href="../../d0/d89/classCGeomMultiLine.html#a5b5c8a7d272d53dd98279480f7a6a976">TruncateLineSegments</a>(nSeg);</div>
<div class="line"><a id="l01649" name="l01649"></a><span class="lineno"> 1649</span> </div>
<div class="line"><a id="l01650" name="l01650"></a><span class="lineno"> 1650</span>      <span class="comment">// Shorten the vector input. Ignore CPPCheck errors here, since we know that pVIPointsOut is not empty</span></div>
<div class="line"><a id="l01651" name="l01651"></a><span class="lineno"> 1651</span>      <span class="keywordtype">int</span> nLastX = pVIPointsOut-&gt;at(pVIPointsOut-&gt;size() - 1).nGetX();</div>
<div class="line"><a id="l01652" name="l01652"></a><span class="lineno"> 1652</span>      <span class="keywordtype">int</span> nLastY = pVIPointsOut-&gt;at(pVIPointsOut-&gt;size() - 1).nGetY();</div>
<div class="line"><a id="l01653" name="l01653"></a><span class="lineno"> 1653</span> </div>
<div class="line"><a id="l01654" name="l01654"></a><span class="lineno"> 1654</span>      pProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#aaa8ddb9c775927bdb7940f7826f90a74">pPtGetPointInProfile</a>(nSeg + 1)-&gt;<a class="code hl_function" href="../../d5/d4e/classCGeom2DPoint.html#af5dfdef4b78c0703800049b064483278">SetX</a>(<a class="code hl_function" href="../../d1/d98/classCSimulation.html#ad79b925ac5f358c6f867b6e47dad74bd">dGridCentroidXToExtCRSX</a>(nLastX));</div>
<div class="line"><a id="l01655" name="l01655"></a><span class="lineno"> 1655</span>      pProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#aaa8ddb9c775927bdb7940f7826f90a74">pPtGetPointInProfile</a>(nSeg + 1)-&gt;<a class="code hl_function" href="../../d5/d4e/classCGeom2DPoint.html#a1dff4e8adee61e6fe5c5062d6ba88f01">SetY</a>(<a class="code hl_function" href="../../d1/d98/classCSimulation.html#a7e2a4bd69ce79377fee86aa5598903f8">dGridCentroidYToExtCRSY</a>(nLastY));</div>
<div class="line"><a id="l01656" name="l01656"></a><span class="lineno"> 1656</span>   }</div>
<div class="line"><a id="l01657" name="l01657"></a><span class="lineno"> 1657</span> </div>
<div class="line"><a id="l01658" name="l01658"></a><span class="lineno"> 1658</span>   <span class="comment">// // DEBUG CODE =====================================================================================</span></div>
<div class="line"><a id="l01659" name="l01659"></a><span class="lineno"> 1659</span>   <span class="comment">// LogStream &lt;&lt; &quot;====================&quot; &lt;&lt; endl;</span></div>
<div class="line"><a id="l01660" name="l01660"></a><span class="lineno"> 1660</span>   <span class="comment">// LogStream &lt;&lt; m_ulIter &lt;&lt; &quot;: for profile &quot; &lt;&lt; nProfile &lt;&lt; &quot; pPtiStart = [&quot; &lt;&lt; pPtiStart-&gt;nGetX() &lt;&lt; &quot;][&quot; &lt;&lt; pPtiStart-&gt;nGetY() &lt;&lt; &quot;] pPtiEnd = [&quot; &lt;&lt; pPtiEnd-&gt;nGetX() &lt;&lt; &quot;][&quot; &lt;&lt; pPtiEnd-&gt;nGetY() &lt;&lt; &quot;] pVIPointsOut-&gt;size() = &quot; &lt;&lt; pVIPointsOut-&gt;size() &lt;&lt; endl;</span></div>
<div class="line"><a id="l01661" name="l01661"></a><span class="lineno"> 1661</span>   <span class="comment">// // for (int n = 0; n &lt; static_cast&lt;int&gt;(pVIPointsOut-&gt;size()); n++)</span></div>
<div class="line"><a id="l01662" name="l01662"></a><span class="lineno"> 1662</span>   <span class="comment">// //    LogStream &lt;&lt; &quot;\t[&quot; &lt;&lt; pVIPointsOut-&gt;at(n).nGetX() &lt;&lt; &quot;][&quot; &lt;&lt; pVIPointsOut-&gt;at(n).nGetY() &lt;&lt; &quot;]&quot; &lt;&lt; endl;</span></div>
<div class="line"><a id="l01663" name="l01663"></a><span class="lineno"> 1663</span>   <span class="comment">// LogStream &lt;&lt; &quot;====================&quot; &lt;&lt; endl;</span></div>
<div class="line"><a id="l01664" name="l01664"></a><span class="lineno"> 1664</span>   <span class="comment">// // DEBUG CODE =====================================================================================</span></div>
<div class="line"><a id="l01665" name="l01665"></a><span class="lineno"> 1665</span> </div>
<div class="line"><a id="l01666" name="l01666"></a><span class="lineno"> 1666</span>   <span class="keywordflow">if</span> (pVIPointsOut-&gt;size() &lt; 3)</div>
<div class="line"><a id="l01667" name="l01667"></a><span class="lineno"> 1667</span>   {</div>
<div class="line"><a id="l01668" name="l01668"></a><span class="lineno"> 1668</span>      <span class="comment">// Coastline-normal profiles cannot be very short (e.g. with less than 3 cells), since we cannot calculate along-profile slope properly for such short profiles</span></div>
<div class="line"><a id="l01669" name="l01669"></a><span class="lineno"> 1669</span>      bTooShort = <span class="keyword">true</span>;</div>
<div class="line"><a id="l01670" name="l01670"></a><span class="lineno"> 1670</span>      pProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#afef14f6eea8432a83715ec8eb68eac14">SetTooShort</a>(<span class="keyword">true</span>);</div>
<div class="line"><a id="l01671" name="l01671"></a><span class="lineno"> 1671</span> </div>
<div class="line"><a id="l01672" name="l01672"></a><span class="lineno"> 1672</span>      <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a0245d3cbdd603fbeced6ca1465eb3f16">m_nLogFileDetail</a> &gt;= <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#a540d8a94fc09b0b14fd8ab657445b67a">LOG_FILE_MIDDLE_DETAIL</a>)</div>
<div class="line"><a id="l01673" name="l01673"></a><span class="lineno"> 1673</span>      {</div>
<div class="line"><a id="l01674" name="l01674"></a><span class="lineno"> 1674</span>         <span class="comment">// Ignore CPPCheck errors here, since we know that pVIPointsOut is not empty</span></div>
<div class="line"><a id="l01675" name="l01675"></a><span class="lineno"> 1675</span>         <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a222962121613613a48f518e0c2110f21">LogStream</a> &lt;&lt; <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#ad67e8c5b30a0572f64ecfb5c062c2edc">m_ulIter</a> &lt;&lt; <span class="stringliteral">&quot;: profile &quot;</span> &lt;&lt; nProfile &lt;&lt; <span class="stringliteral">&quot; is invalid, is too short, only &quot;</span> &lt;&lt; pVIPointsOut-&gt;size() &lt;&lt; <span class="stringliteral">&quot; points, HitLand?&quot;</span> &lt;&lt; bHitLand &lt;&lt; <span class="stringliteral">&quot;. From [&quot;</span> &lt;&lt; pVIPointsOut-&gt;at(0).nGetX() &lt;&lt; <span class="stringliteral">&quot;][&quot;</span> &lt;&lt; pVIPointsOut-&gt;at(0).nGetY() &lt;&lt; <span class="stringliteral">&quot;] = {&quot;</span> &lt;&lt; <a class="code hl_function" href="../../d1/d98/classCSimulation.html#ad79b925ac5f358c6f867b6e47dad74bd">dGridCentroidXToExtCRSX</a>(pVIPointsOut-&gt;at(0).nGetX()) &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; <a class="code hl_function" href="../../d1/d98/classCSimulation.html#a7e2a4bd69ce79377fee86aa5598903f8">dGridCentroidYToExtCRSY</a>(pVIPointsOut-&gt;at(0).nGetY()) &lt;&lt; <span class="stringliteral">&quot;} to [&quot;</span> &lt;&lt; pVIPointsOut-&gt;at(pVIPointsOut-&gt;size() - 1).nGetX() &lt;&lt; <span class="stringliteral">&quot;][&quot;</span> &lt;&lt; pVIPointsOut-&gt;at(pVIPointsOut-&gt;size() - 1).nGetY() &lt;&lt; <span class="stringliteral">&quot;] = {&quot;</span> &lt;&lt; <a class="code hl_function" href="../../d1/d98/classCSimulation.html#ad79b925ac5f358c6f867b6e47dad74bd">dGridCentroidXToExtCRSX</a>(pVIPointsOut-&gt;at(pVIPointsOut-&gt;size() - 1).nGetX()) &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; <a class="code hl_function" href="../../d1/d98/classCSimulation.html#a7e2a4bd69ce79377fee86aa5598903f8">dGridCentroidYToExtCRSY</a>(pVIPointsOut-&gt;at(pVIPointsOut-&gt;size() - 1).nGetY()) &lt;&lt; <span class="stringliteral">&quot;}&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a id="l01676" name="l01676"></a><span class="lineno"> 1676</span>      }</div>
<div class="line"><a id="l01677" name="l01677"></a><span class="lineno"> 1677</span>   }</div>
<div class="line"><a id="l01678" name="l01678"></a><span class="lineno"> 1678</span>}</div>
</div>
<div class="line"><a id="l01679" name="l01679"></a><span class="lineno"> 1679</span> </div>
<div class="line"><a id="l01680" name="l01680"></a><span class="lineno"> 1680</span><span class="comment">//===============================================================================================================================</span></div>
<div class="line"><a id="l01682" name="l01682"></a><span class="lineno"> 1682</span><span class="comment">//===============================================================================================================================</span></div>
<div class="foldopen" id="foldopen01683" data-start="{" data-end="}">
<div class="line"><a id="l01683" name="l01683"></a><span class="lineno"><a class="line" href="../../d1/d98/classCSimulation.html#a545c6a6a1c33942a35ef3ee15c26896f"> 1683</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="../../d1/d98/classCSimulation.html#a545c6a6a1c33942a35ef3ee15c26896f">CSimulation::MergeProfilesAtFinalLineSegments</a>(<span class="keywordtype">int</span> <span class="keyword">const</span> nCoast, <a class="code hl_class" href="../../da/dae/classCGeomProfile.html">CGeomProfile</a>* pFirstProfile, <a class="code hl_class" href="../../da/dae/classCGeomProfile.html">CGeomProfile</a>* pSecondProfile, <span class="keywordtype">int</span> <span class="keyword">const</span> nFirstProfileLineSegments, <span class="keywordtype">int</span> <span class="keyword">const</span> nSecondProfileLineSegments, <span class="keywordtype">double</span> <span class="keyword">const</span> dIntersectX, <span class="keywordtype">double</span> <span class="keyword">const</span> dIntersectY, <span class="keywordtype">double</span> <span class="keyword">const</span> dAvgEndX, <span class="keywordtype">double</span> <span class="keyword">const</span> dAvgEndY)</div>
<div class="line"><a id="l01684" name="l01684"></a><span class="lineno"> 1684</span>{</div>
<div class="line"><a id="l01685" name="l01685"></a><span class="lineno"> 1685</span>   <span class="comment">// The point of intersection is on the final (most seaward) line segment of both profiles. Put together a vector of coincident profile numbers (with no duplicates) for both profiles</span></div>
<div class="line"><a id="l01686" name="l01686"></a><span class="lineno"> 1686</span>   <span class="keywordtype">int</span> nCombinedLastSeg = 0;</div>
<div class="line"><a id="l01687" name="l01687"></a><span class="lineno"> 1687</span>   vector&lt;pair&lt;int, int&gt;&gt; prVCombinedProfilesCoincidentProfilesLastSeg;</div>
<div class="line"><a id="l01688" name="l01688"></a><span class="lineno"> 1688</span> </div>
<div class="line"><a id="l01689" name="l01689"></a><span class="lineno"> 1689</span>   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n = 0; n &lt; pFirstProfile-&gt;<a class="code hl_function" href="../../d0/d89/classCGeomMultiLine.html#ab0146cd34539f41588924571dbfb2054">pprVGetPairedCoincidentProfilesForLineSegment</a>(nFirstProfileLineSegments - 1)-&gt;size(); n++)</div>
<div class="line"><a id="l01690" name="l01690"></a><span class="lineno"> 1690</span>   {</div>
<div class="line"><a id="l01691" name="l01691"></a><span class="lineno"> 1691</span>      pair&lt;int, int&gt; prTmp;</div>
<div class="line"><a id="l01692" name="l01692"></a><span class="lineno"> 1692</span>      prTmp.first = pFirstProfile-&gt;<a class="code hl_function" href="../../d0/d89/classCGeomMultiLine.html#ab0146cd34539f41588924571dbfb2054">pprVGetPairedCoincidentProfilesForLineSegment</a>(nFirstProfileLineSegments - 1)-&gt;at(n).first;</div>
<div class="line"><a id="l01693" name="l01693"></a><span class="lineno"> 1693</span>      prTmp.second = pFirstProfile-&gt;<a class="code hl_function" href="../../d0/d89/classCGeomMultiLine.html#ab0146cd34539f41588924571dbfb2054">pprVGetPairedCoincidentProfilesForLineSegment</a>(nFirstProfileLineSegments - 1)-&gt;at(n).second;</div>
<div class="line"><a id="l01694" name="l01694"></a><span class="lineno"> 1694</span> </div>
<div class="line"><a id="l01695" name="l01695"></a><span class="lineno"> 1695</span>      <span class="keywordtype">bool</span> bFound = <span class="keyword">false</span>;</div>
<div class="line"><a id="l01696" name="l01696"></a><span class="lineno"> 1696</span>      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> m = 0; m &lt; prVCombinedProfilesCoincidentProfilesLastSeg.size(); m++)</div>
<div class="line"><a id="l01697" name="l01697"></a><span class="lineno"> 1697</span>      {</div>
<div class="line"><a id="l01698" name="l01698"></a><span class="lineno"> 1698</span>         <span class="keywordflow">if</span> (prVCombinedProfilesCoincidentProfilesLastSeg[m].first == prTmp.first)</div>
<div class="line"><a id="l01699" name="l01699"></a><span class="lineno"> 1699</span>         {</div>
<div class="line"><a id="l01700" name="l01700"></a><span class="lineno"> 1700</span>            bFound = <span class="keyword">true</span>;</div>
<div class="line"><a id="l01701" name="l01701"></a><span class="lineno"> 1701</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01702" name="l01702"></a><span class="lineno"> 1702</span>         }</div>
<div class="line"><a id="l01703" name="l01703"></a><span class="lineno"> 1703</span>      }</div>
<div class="line"><a id="l01704" name="l01704"></a><span class="lineno"> 1704</span> </div>
<div class="line"><a id="l01705" name="l01705"></a><span class="lineno"> 1705</span>      <span class="keywordflow">if</span> (! bFound)</div>
<div class="line"><a id="l01706" name="l01706"></a><span class="lineno"> 1706</span>      {</div>
<div class="line"><a id="l01707" name="l01707"></a><span class="lineno"> 1707</span>         prVCombinedProfilesCoincidentProfilesLastSeg.push_back(prTmp);</div>
<div class="line"><a id="l01708" name="l01708"></a><span class="lineno"> 1708</span>         nCombinedLastSeg++;</div>
<div class="line"><a id="l01709" name="l01709"></a><span class="lineno"> 1709</span>      }</div>
<div class="line"><a id="l01710" name="l01710"></a><span class="lineno"> 1710</span>   }</div>
<div class="line"><a id="l01711" name="l01711"></a><span class="lineno"> 1711</span> </div>
<div class="line"><a id="l01712" name="l01712"></a><span class="lineno"> 1712</span>   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n = 0; n &lt; pSecondProfile-&gt;<a class="code hl_function" href="../../d0/d89/classCGeomMultiLine.html#ab0146cd34539f41588924571dbfb2054">pprVGetPairedCoincidentProfilesForLineSegment</a>(nSecondProfileLineSegments - 1)-&gt;size(); n++)</div>
<div class="line"><a id="l01713" name="l01713"></a><span class="lineno"> 1713</span>   {</div>
<div class="line"><a id="l01714" name="l01714"></a><span class="lineno"> 1714</span>      pair&lt;int, int&gt; prTmp;</div>
<div class="line"><a id="l01715" name="l01715"></a><span class="lineno"> 1715</span>      prTmp.first = pSecondProfile-&gt;<a class="code hl_function" href="../../d0/d89/classCGeomMultiLine.html#ab0146cd34539f41588924571dbfb2054">pprVGetPairedCoincidentProfilesForLineSegment</a>(nSecondProfileLineSegments - 1)-&gt;at(n).first;</div>
<div class="line"><a id="l01716" name="l01716"></a><span class="lineno"> 1716</span>      prTmp.second = pSecondProfile-&gt;<a class="code hl_function" href="../../d0/d89/classCGeomMultiLine.html#ab0146cd34539f41588924571dbfb2054">pprVGetPairedCoincidentProfilesForLineSegment</a>(nSecondProfileLineSegments - 1)-&gt;at(n).second;</div>
<div class="line"><a id="l01717" name="l01717"></a><span class="lineno"> 1717</span> </div>
<div class="line"><a id="l01718" name="l01718"></a><span class="lineno"> 1718</span>      <span class="keywordtype">bool</span> bFound = <span class="keyword">false</span>;</div>
<div class="line"><a id="l01719" name="l01719"></a><span class="lineno"> 1719</span>      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> m = 0; m &lt; prVCombinedProfilesCoincidentProfilesLastSeg.size(); m++)</div>
<div class="line"><a id="l01720" name="l01720"></a><span class="lineno"> 1720</span>      {</div>
<div class="line"><a id="l01721" name="l01721"></a><span class="lineno"> 1721</span>         <span class="keywordflow">if</span> (prVCombinedProfilesCoincidentProfilesLastSeg[m].first == prTmp.first)</div>
<div class="line"><a id="l01722" name="l01722"></a><span class="lineno"> 1722</span>         {</div>
<div class="line"><a id="l01723" name="l01723"></a><span class="lineno"> 1723</span>            bFound = <span class="keyword">true</span>;</div>
<div class="line"><a id="l01724" name="l01724"></a><span class="lineno"> 1724</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01725" name="l01725"></a><span class="lineno"> 1725</span>         }</div>
<div class="line"><a id="l01726" name="l01726"></a><span class="lineno"> 1726</span>      }</div>
<div class="line"><a id="l01727" name="l01727"></a><span class="lineno"> 1727</span> </div>
<div class="line"><a id="l01728" name="l01728"></a><span class="lineno"> 1728</span>      <span class="keywordflow">if</span> (! bFound)</div>
<div class="line"><a id="l01729" name="l01729"></a><span class="lineno"> 1729</span>      {</div>
<div class="line"><a id="l01730" name="l01730"></a><span class="lineno"> 1730</span>         prVCombinedProfilesCoincidentProfilesLastSeg.push_back(prTmp);</div>
<div class="line"><a id="l01731" name="l01731"></a><span class="lineno"> 1731</span>         nCombinedLastSeg++;</div>
<div class="line"><a id="l01732" name="l01732"></a><span class="lineno"> 1732</span>      }</div>
<div class="line"><a id="l01733" name="l01733"></a><span class="lineno"> 1733</span>   }</div>
<div class="line"><a id="l01734" name="l01734"></a><span class="lineno"> 1734</span> </div>
<div class="line"><a id="l01735" name="l01735"></a><span class="lineno"> 1735</span>   <span class="comment">// Increment the number of each line segment</span></div>
<div class="line"><a id="l01736" name="l01736"></a><span class="lineno"> 1736</span>   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> m = 0; m &lt; nCombinedLastSeg; m++)</div>
<div class="line"><a id="l01737" name="l01737"></a><span class="lineno"> 1737</span>      prVCombinedProfilesCoincidentProfilesLastSeg[m].second++;</div>
<div class="line"><a id="l01738" name="l01738"></a><span class="lineno"> 1738</span> </div>
<div class="line"><a id="l01739" name="l01739"></a><span class="lineno"> 1739</span>   vector&lt;pair&lt;int, int&gt;&gt; prVFirstProfileCoincidentProfilesLastSeg = *pFirstProfile-&gt;<a class="code hl_function" href="../../d0/d89/classCGeomMultiLine.html#ab0146cd34539f41588924571dbfb2054">pprVGetPairedCoincidentProfilesForLineSegment</a>(nFirstProfileLineSegments - 1);</div>
<div class="line"><a id="l01740" name="l01740"></a><span class="lineno"> 1740</span>   vector&lt;pair&lt;int, int&gt;&gt; prVSecondProfileCoincidentProfilesLastSeg = *pSecondProfile-&gt;<a class="code hl_function" href="../../d0/d89/classCGeomMultiLine.html#ab0146cd34539f41588924571dbfb2054">pprVGetPairedCoincidentProfilesForLineSegment</a>(nSecondProfileLineSegments - 1);</div>
<div class="line"><a id="l01741" name="l01741"></a><span class="lineno"> 1741</span>   <span class="keywordtype">int</span> nNumFirstProfileCoincidentProfilesLastSeg = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(prVFirstProfileCoincidentProfilesLastSeg.size());</div>
<div class="line"><a id="l01742" name="l01742"></a><span class="lineno"> 1742</span>   <span class="keywordtype">int</span> nNumSecondProfileCoincidentProfilesLastSeg = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(prVSecondProfileCoincidentProfilesLastSeg.size());</div>
<div class="line"><a id="l01743" name="l01743"></a><span class="lineno"> 1743</span> </div>
<div class="line"><a id="l01744" name="l01744"></a><span class="lineno"> 1744</span>   <span class="comment">//   LogStream &lt;&lt; m_ulIter &lt;&lt; &quot;: END-SEGMENT INTERSECTION between profiles &quot; &lt;&lt; nFirstProfile &lt;&lt; &quot; and &quot; &lt;&lt; nSecondProfile &lt;&lt; &quot; at line segment &quot; &lt;&lt; nFirstProfileLineSegments-1 &lt;&lt; &quot;/&quot; &lt;&lt; nFirstProfileLineSegments-1 &lt;&lt; &quot;, and line segment &quot; &lt;&lt; nSecondProfileLineSegments-1 &lt;&lt; &quot;/&quot; &lt;&lt; nSecondProfileLineSegments-1 &lt;&lt; &quot;, respectively. Both truncated at [&quot; &lt;&lt; dIntersectX &lt;&lt; &quot;, &quot; &lt;&lt; dIntersectY &lt;&lt; &quot;] then profiles {&quot; &lt;&lt; nFirstProfile &lt;&lt; &quot;} and {&quot; &lt;&lt; nSecondProfile &lt;&lt; &quot;} extended to [&quot; &lt;&lt; dAvgEndX &lt;&lt; &quot;, &quot; &lt;&lt; dAvgEndY &lt;&lt; &quot;]&quot; &lt;&lt; endl;</span></div>
<div class="line"><a id="l01745" name="l01745"></a><span class="lineno"> 1745</span> </div>
<div class="line"><a id="l01746" name="l01746"></a><span class="lineno"> 1746</span>   <span class="comment">// Truncate the first profile, and all co-incident profiles, at the point of intersection</span></div>
<div class="line"><a id="l01747" name="l01747"></a><span class="lineno"> 1747</span>   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n = 0; n &lt; nNumFirstProfileCoincidentProfilesLastSeg; n++)</div>
<div class="line"><a id="l01748" name="l01748"></a><span class="lineno"> 1748</span>   {</div>
<div class="line"><a id="l01749" name="l01749"></a><span class="lineno"> 1749</span>      <span class="keywordtype">int</span> nThisProfile = prVFirstProfileCoincidentProfilesLastSeg[n].first;</div>
<div class="line"><a id="l01750" name="l01750"></a><span class="lineno"> 1750</span>      <a class="code hl_class" href="../../da/dae/classCGeomProfile.html">CGeomProfile</a>* pThisProfile = <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a25ada8139c82ca7beab3f279cff83184">m_VCoast</a>[nCoast].pGetProfile(nThisProfile);</div>
<div class="line"><a id="l01751" name="l01751"></a><span class="lineno"> 1751</span>      <span class="keywordtype">int</span> nProfileLength = pThisProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#abaf88697019588a2b0901bd19044aee4">nGetProfileSize</a>();</div>
<div class="line"><a id="l01752" name="l01752"></a><span class="lineno"> 1752</span> </div>
<div class="line"><a id="l01753" name="l01753"></a><span class="lineno"> 1753</span>      <span class="comment">// This is the final line segment of the first &#39;main&#39; profile. We are assuming that it is also the final line segment of all co-incident profiles. This is fine, altho&#39; each profile may well have a different number of line segments landwards i.e. the number of the line segment may be different for each co-incident profile</span></div>
<div class="line"><a id="l01754" name="l01754"></a><span class="lineno"> 1754</span>      pThisProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#ab9adb1e70e847258501607c9b1330d18">SetPointInProfile</a>(nProfileLength - 1, dIntersectX, dIntersectY);</div>
<div class="line"><a id="l01755" name="l01755"></a><span class="lineno"> 1755</span>   }</div>
<div class="line"><a id="l01756" name="l01756"></a><span class="lineno"> 1756</span> </div>
<div class="line"><a id="l01757" name="l01757"></a><span class="lineno"> 1757</span>   <span class="comment">// Truncate the second profile, and all co-incident profiles, at the point of intersection</span></div>
<div class="line"><a id="l01758" name="l01758"></a><span class="lineno"> 1758</span>   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n = 0; n &lt; nNumSecondProfileCoincidentProfilesLastSeg; n++)</div>
<div class="line"><a id="l01759" name="l01759"></a><span class="lineno"> 1759</span>   {</div>
<div class="line"><a id="l01760" name="l01760"></a><span class="lineno"> 1760</span>      <span class="keywordtype">int</span> nThisProfile = prVSecondProfileCoincidentProfilesLastSeg[n].first;</div>
<div class="line"><a id="l01761" name="l01761"></a><span class="lineno"> 1761</span>      <a class="code hl_class" href="../../da/dae/classCGeomProfile.html">CGeomProfile</a>* pThisProfile = <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a25ada8139c82ca7beab3f279cff83184">m_VCoast</a>[nCoast].pGetProfile(nThisProfile);</div>
<div class="line"><a id="l01762" name="l01762"></a><span class="lineno"> 1762</span>      <span class="keywordtype">int</span> nProfileLength = pThisProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#abaf88697019588a2b0901bd19044aee4">nGetProfileSize</a>();</div>
<div class="line"><a id="l01763" name="l01763"></a><span class="lineno"> 1763</span> </div>
<div class="line"><a id="l01764" name="l01764"></a><span class="lineno"> 1764</span>      <span class="comment">// This is the final line segment of the second &#39;main&#39; profile. We are assuming that it is also the final line segment of all co-incident profiles. This is fine, altho&#39; each profile may well have a different number of line segments landwards i.e. the number of the line segment may be different for each co-incident profile</span></div>
<div class="line"><a id="l01765" name="l01765"></a><span class="lineno"> 1765</span>      pThisProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#ab9adb1e70e847258501607c9b1330d18">SetPointInProfile</a>(nProfileLength - 1, dIntersectX, dIntersectY);</div>
<div class="line"><a id="l01766" name="l01766"></a><span class="lineno"> 1766</span>   }</div>
<div class="line"><a id="l01767" name="l01767"></a><span class="lineno"> 1767</span> </div>
<div class="line"><a id="l01768" name="l01768"></a><span class="lineno"> 1768</span>   <span class="comment">// Append a new straight line segment to the existing line segment(s) of the first profile, and to all co-incident profiles</span></div>
<div class="line"><a id="l01769" name="l01769"></a><span class="lineno"> 1769</span>   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> nThisLineSeg = 0; nThisLineSeg &lt; nNumFirstProfileCoincidentProfilesLastSeg; nThisLineSeg++)</div>
<div class="line"><a id="l01770" name="l01770"></a><span class="lineno"> 1770</span>   {</div>
<div class="line"><a id="l01771" name="l01771"></a><span class="lineno"> 1771</span>      <span class="keywordtype">int</span> nThisProfile = prVFirstProfileCoincidentProfilesLastSeg[nThisLineSeg].first;</div>
<div class="line"><a id="l01772" name="l01772"></a><span class="lineno"> 1772</span>      <a class="code hl_class" href="../../da/dae/classCGeomProfile.html">CGeomProfile</a>* pThisProfile = <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a25ada8139c82ca7beab3f279cff83184">m_VCoast</a>[nCoast].pGetProfile(nThisProfile);</div>
<div class="line"><a id="l01773" name="l01773"></a><span class="lineno"> 1773</span> </div>
<div class="line"><a id="l01774" name="l01774"></a><span class="lineno"> 1774</span>      <span class="comment">// Update this profile</span></div>
<div class="line"><a id="l01775" name="l01775"></a><span class="lineno"> 1775</span>      pThisProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#a19aac71e045a17e2c6d98f020f2319fa">AppendPointInProfile</a>(dAvgEndX, dAvgEndY);</div>
<div class="line"><a id="l01776" name="l01776"></a><span class="lineno"> 1776</span> </div>
<div class="line"><a id="l01777" name="l01777"></a><span class="lineno"> 1777</span>      <span class="comment">// Append details of the combined profiles</span></div>
<div class="line"><a id="l01778" name="l01778"></a><span class="lineno"> 1778</span>      pThisProfile-&gt;<a class="code hl_function" href="../../d0/d89/classCGeomMultiLine.html#a3f99a9c2ac66b75c432941ec88fc8538">AppendLineSegment</a>();</div>
<div class="line"><a id="l01779" name="l01779"></a><span class="lineno"> 1779</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> m = 0; m &lt; nCombinedLastSeg; m++)</div>
<div class="line"><a id="l01780" name="l01780"></a><span class="lineno"> 1780</span>         pThisProfile-&gt;<a class="code hl_function" href="../../d0/d89/classCGeomMultiLine.html#a679d5893191ff6dc5ab6b9acd1f5c770">AppendCoincidentProfileToLineSegments</a>(prVCombinedProfilesCoincidentProfilesLastSeg[m]);</div>
<div class="line"><a id="l01781" name="l01781"></a><span class="lineno"> 1781</span>   }</div>
<div class="line"><a id="l01782" name="l01782"></a><span class="lineno"> 1782</span> </div>
<div class="line"><a id="l01783" name="l01783"></a><span class="lineno"> 1783</span>   <span class="comment">// Append a new straight line segment to the existing line segment(s) of the second profile, and to all co-incident profiles</span></div>
<div class="line"><a id="l01784" name="l01784"></a><span class="lineno"> 1784</span>   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> nThisLineSeg = 0; nThisLineSeg &lt; nNumSecondProfileCoincidentProfilesLastSeg; nThisLineSeg++)</div>
<div class="line"><a id="l01785" name="l01785"></a><span class="lineno"> 1785</span>   {</div>
<div class="line"><a id="l01786" name="l01786"></a><span class="lineno"> 1786</span>      <span class="keywordtype">int</span> nThisProfile = prVSecondProfileCoincidentProfilesLastSeg[nThisLineSeg].first;</div>
<div class="line"><a id="l01787" name="l01787"></a><span class="lineno"> 1787</span>      <a class="code hl_class" href="../../da/dae/classCGeomProfile.html">CGeomProfile</a>* pThisProfile = <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a25ada8139c82ca7beab3f279cff83184">m_VCoast</a>[nCoast].pGetProfile(nThisProfile);</div>
<div class="line"><a id="l01788" name="l01788"></a><span class="lineno"> 1788</span> </div>
<div class="line"><a id="l01789" name="l01789"></a><span class="lineno"> 1789</span>      <span class="comment">// Update this profile</span></div>
<div class="line"><a id="l01790" name="l01790"></a><span class="lineno"> 1790</span>      pThisProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#a19aac71e045a17e2c6d98f020f2319fa">AppendPointInProfile</a>(dAvgEndX, dAvgEndY);</div>
<div class="line"><a id="l01791" name="l01791"></a><span class="lineno"> 1791</span> </div>
<div class="line"><a id="l01792" name="l01792"></a><span class="lineno"> 1792</span>      <span class="comment">// Append details of the combined profiles</span></div>
<div class="line"><a id="l01793" name="l01793"></a><span class="lineno"> 1793</span>      pThisProfile-&gt;<a class="code hl_function" href="../../d0/d89/classCGeomMultiLine.html#a3f99a9c2ac66b75c432941ec88fc8538">AppendLineSegment</a>();</div>
<div class="line"><a id="l01794" name="l01794"></a><span class="lineno"> 1794</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> m = 0; m &lt; nCombinedLastSeg; m++)</div>
<div class="line"><a id="l01795" name="l01795"></a><span class="lineno"> 1795</span>         pThisProfile-&gt;<a class="code hl_function" href="../../d0/d89/classCGeomMultiLine.html#a679d5893191ff6dc5ab6b9acd1f5c770">AppendCoincidentProfileToLineSegments</a>(prVCombinedProfilesCoincidentProfilesLastSeg[m]);</div>
<div class="line"><a id="l01796" name="l01796"></a><span class="lineno"> 1796</span>   }</div>
<div class="line"><a id="l01797" name="l01797"></a><span class="lineno"> 1797</span> </div>
<div class="line"><a id="l01798" name="l01798"></a><span class="lineno"> 1798</span>   <span class="comment">// // DEBUG CODE ****************************************************************</span></div>
<div class="line"><a id="l01799" name="l01799"></a><span class="lineno"> 1799</span>   <span class="comment">// int nFirstProfileLineSeg= pFirstProfile-&gt;nGetNumLineSegments();</span></div>
<div class="line"><a id="l01800" name="l01800"></a><span class="lineno"> 1800</span>   <span class="comment">// int nSecondProfileLineSeg = pSecondProfile-&gt;nGetNumLineSegments();</span></div>
<div class="line"><a id="l01801" name="l01801"></a><span class="lineno"> 1801</span>   <span class="comment">//</span></div>
<div class="line"><a id="l01802" name="l01802"></a><span class="lineno"> 1802</span>   <span class="comment">// LogStream &lt;&lt; &quot;\tProfile {&quot; &lt;&lt; nFirstProfile &lt;&lt; &quot;} now has &quot; &lt;&lt; nFirstProfileLineSeg &lt;&lt; &quot; line segments&quot; &lt;&lt; endl;</span></div>
<div class="line"><a id="l01803" name="l01803"></a><span class="lineno"> 1803</span>   <span class="comment">// for (int m = 0; m &lt; nFirstProfileLineSeg; m++)</span></div>
<div class="line"><a id="l01804" name="l01804"></a><span class="lineno"> 1804</span>   <span class="comment">// {</span></div>
<div class="line"><a id="l01805" name="l01805"></a><span class="lineno"> 1805</span>   <span class="comment">//    vector&lt;pair&lt;int, int&gt; &gt; prVCoincidentProfiles = *pFirstProfile-&gt;pprVGetPairedCoincidentProfilesForLineSegment(m);</span></div>
<div class="line"><a id="l01806" name="l01806"></a><span class="lineno"> 1806</span>   <span class="comment">//    LogStream &lt;&lt; &quot;\tCo-incident profiles and line segments for line segment &quot; &lt;&lt; m &lt;&lt; &quot; of profile {&quot; &lt;&lt; nFirstProfile &lt;&lt; &quot;} are {&quot;;</span></div>
<div class="line"><a id="l01807" name="l01807"></a><span class="lineno"> 1807</span>   <span class="comment">//    for (int nn = 0; nn &lt; prVCoincidentProfiles.size(); nn++)</span></div>
<div class="line"><a id="l01808" name="l01808"></a><span class="lineno"> 1808</span>   <span class="comment">//       LogStream &lt;&lt; &quot; &quot; &lt;&lt; prVCoincidentProfiles[nn].first &lt;&lt; &quot;[&quot; &lt;&lt; prVCoincidentProfiles[nn].second &lt;&lt; &quot;] &quot;;</span></div>
<div class="line"><a id="l01809" name="l01809"></a><span class="lineno"> 1809</span>   <span class="comment">//    LogStream &lt;&lt; &quot; }&quot; &lt;&lt; endl;</span></div>
<div class="line"><a id="l01810" name="l01810"></a><span class="lineno"> 1810</span>   <span class="comment">// }</span></div>
<div class="line"><a id="l01811" name="l01811"></a><span class="lineno"> 1811</span>   <span class="comment">// LogStream &lt;&lt; &quot;\tProfile {&quot; &lt;&lt; nSecondProfile &lt;&lt; &quot;} now has &quot; &lt;&lt; nSecondProfileLineSeg &lt;&lt; &quot; line segments&quot; &lt;&lt; endl;</span></div>
<div class="line"><a id="l01812" name="l01812"></a><span class="lineno"> 1812</span>   <span class="comment">// for (int m = 0; m &lt; nSecondProfileLineSeg; m++)</span></div>
<div class="line"><a id="l01813" name="l01813"></a><span class="lineno"> 1813</span>   <span class="comment">// {</span></div>
<div class="line"><a id="l01814" name="l01814"></a><span class="lineno"> 1814</span>   <span class="comment">//    vector&lt;pair&lt;int, int&gt; &gt; prVCoincidentProfiles = *pSecondProfile-&gt;pprVGetPairedCoincidentProfilesForLineSegment(m);</span></div>
<div class="line"><a id="l01815" name="l01815"></a><span class="lineno"> 1815</span>   <span class="comment">//    LogStream &lt;&lt; &quot;\tCo-incident profiles and line segments for line segment &quot; &lt;&lt; m &lt;&lt; &quot; of profile {&quot; &lt;&lt; nSecondProfile &lt;&lt; &quot;} are {&quot;;</span></div>
<div class="line"><a id="l01816" name="l01816"></a><span class="lineno"> 1816</span>   <span class="comment">//    for (int nn = 0; nn &lt; prVCoincidentProfiles.size(); nn++)</span></div>
<div class="line"><a id="l01817" name="l01817"></a><span class="lineno"> 1817</span>   <span class="comment">//       LogStream &lt;&lt; &quot; &quot; &lt;&lt; prVCoincidentProfiles[nn].first &lt;&lt; &quot;[&quot; &lt;&lt; prVCoincidentProfiles[nn].second &lt;&lt; &quot;] &quot;;</span></div>
<div class="line"><a id="l01818" name="l01818"></a><span class="lineno"> 1818</span>   <span class="comment">//    LogStream &lt;&lt; &quot; }&quot; &lt;&lt; endl;</span></div>
<div class="line"><a id="l01819" name="l01819"></a><span class="lineno"> 1819</span>   <span class="comment">// }</span></div>
<div class="line"><a id="l01820" name="l01820"></a><span class="lineno"> 1820</span>   <span class="comment">// // DEBUG CODE ******************************************************************</span></div>
<div class="line"><a id="l01821" name="l01821"></a><span class="lineno"> 1821</span>}</div>
</div>
<div class="line"><a id="l01822" name="l01822"></a><span class="lineno"> 1822</span> </div>
<div class="line"><a id="l01823" name="l01823"></a><span class="lineno"> 1823</span><span class="comment">//===============================================================================================================================</span></div>
<div class="line"><a id="l01825" name="l01825"></a><span class="lineno"> 1825</span><span class="comment">//===============================================================================================================================</span></div>
<div class="foldopen" id="foldopen01826" data-start="{" data-end="}">
<div class="line"><a id="l01826" name="l01826"></a><span class="lineno"><a class="line" href="../../d1/d98/classCSimulation.html#add4b97b29fde8394685fa5802467731d"> 1826</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="../../d1/d98/classCSimulation.html#add4b97b29fde8394685fa5802467731d">CSimulation::TruncateOneProfileRetainOtherProfile</a>(<span class="keywordtype">int</span> <span class="keyword">const</span> nCoast, <a class="code hl_class" href="../../da/dae/classCGeomProfile.html">CGeomProfile</a>* pProfileToTruncate, <a class="code hl_class" href="../../da/dae/classCGeomProfile.html">CGeomProfile</a>* pProfileToRetain, <span class="keywordtype">double</span> dIntersectX, <span class="keywordtype">double</span> dIntersectY, <span class="keywordtype">int</span> nProfileToTruncateIntersectLineSeg, <span class="keywordtype">int</span> nProfileToRetainIntersectLineSeg, <span class="keywordtype">bool</span> <span class="keyword">const</span> bAlreadyPresent)</div>
<div class="line"><a id="l01827" name="l01827"></a><span class="lineno"> 1827</span>{</div>
<div class="line"><a id="l01828" name="l01828"></a><span class="lineno"> 1828</span>   <span class="comment">// // Occasionally, profiles cross each other, with the crossing not detected. So check for intersection between pProfileToTruncate and all profiles (starting from the last i.e. in reverse order) in all segments (starting from the last i.e. in reverse order) of pProfileToRetain&#39;s CGeomMultiLine</span></div>
<div class="line"><a id="l01829" name="l01829"></a><span class="lineno"> 1829</span>   <span class="comment">// bool bFound = false;</span></div>
<div class="line"><a id="l01830" name="l01830"></a><span class="lineno"> 1830</span>   <span class="comment">// int nNumSegProfRetain = pProfileToRetain-&gt;nGetNumLineSegments();</span></div>
<div class="line"><a id="l01831" name="l01831"></a><span class="lineno"> 1831</span>   <span class="comment">// for (int nSeg = nNumSegProfRetain-1; nSeg &gt;= 0; nSeg--)</span></div>
<div class="line"><a id="l01832" name="l01832"></a><span class="lineno"> 1832</span>   <span class="comment">// {</span></div>
<div class="line"><a id="l01833" name="l01833"></a><span class="lineno"> 1833</span>   <span class="comment">//    if (bFound)</span></div>
<div class="line"><a id="l01834" name="l01834"></a><span class="lineno"> 1834</span>   <span class="comment">//       break;</span></div>
<div class="line"><a id="l01835" name="l01835"></a><span class="lineno"> 1835</span>   <span class="comment">//</span></div>
<div class="line"><a id="l01836" name="l01836"></a><span class="lineno"> 1836</span>   <span class="comment">//    int nNumProfInSeg = pProfileToRetain-&gt;nGetNumCoincidentProfilesInLineSegment(nSeg);</span></div>
<div class="line"><a id="l01837" name="l01837"></a><span class="lineno"> 1837</span>   <span class="comment">//    for (int nProf = nNumProfInSeg-1; nProf &gt;= 0; nProf--)</span></div>
<div class="line"><a id="l01838" name="l01838"></a><span class="lineno"> 1838</span>   <span class="comment">//    {</span></div>
<div class="line"><a id="l01839" name="l01839"></a><span class="lineno"> 1839</span>   <span class="comment">//       int nThisProf =  pProfileToRetain-&gt;nGetCoincidentProfileForLineSegment(nSeg, nProf);</span></div>
<div class="line"><a id="l01840" name="l01840"></a><span class="lineno"> 1840</span>   <span class="comment">//       CGeomProfile* pThisProf = m_VCoast[nCoast].pGetProfile(nThisProf);</span></div>
<div class="line"><a id="l01841" name="l01841"></a><span class="lineno"> 1841</span>   <span class="comment">//</span></div>
<div class="line"><a id="l01842" name="l01842"></a><span class="lineno"> 1842</span>   <span class="comment">//       int nProfToTruncLineSeg = 0;</span></div>
<div class="line"><a id="l01843" name="l01843"></a><span class="lineno"> 1843</span>   <span class="comment">//       int nThisProfLineSeg = 0;</span></div>
<div class="line"><a id="l01844" name="l01844"></a><span class="lineno"> 1844</span>   <span class="comment">//       double dTmpIntersectX = 0;</span></div>
<div class="line"><a id="l01845" name="l01845"></a><span class="lineno"> 1845</span>   <span class="comment">//       double dTmpIntersectY = 0;</span></div>
<div class="line"><a id="l01846" name="l01846"></a><span class="lineno"> 1846</span>   <span class="comment">//       double dAvgEndX = 0;</span></div>
<div class="line"><a id="l01847" name="l01847"></a><span class="lineno"> 1847</span>   <span class="comment">//       double dAvgEndY = 0;</span></div>
<div class="line"><a id="l01848" name="l01848"></a><span class="lineno"> 1848</span>   <span class="comment">//</span></div>
<div class="line"><a id="l01849" name="l01849"></a><span class="lineno"> 1849</span>   <span class="comment">//       if (bCheckForIntersection(pProfileToTruncate, pThisProf, nProfToTruncLineSeg, nThisProfLineSeg, dTmpIntersectX, dTmpIntersectY, dAvgEndX, dAvgEndY))</span></div>
<div class="line"><a id="l01850" name="l01850"></a><span class="lineno"> 1850</span>   <span class="comment">//       {</span></div>
<div class="line"><a id="l01851" name="l01851"></a><span class="lineno"> 1851</span>   <span class="comment">//          // An intersection was found: so the profile with which pProfileToTruncate intersects becomes the new pProfileToRetain, and dIntersectX, dIntersectY, nProfileToTruncateIntersectLineSeg, and nProfileToRetainIntersectLineSeg are also changed</span></div>
<div class="line"><a id="l01852" name="l01852"></a><span class="lineno"> 1852</span>   <span class="comment">//          pProfileToRetain = pThisProf;</span></div>
<div class="line"><a id="l01853" name="l01853"></a><span class="lineno"> 1853</span>   <span class="comment">//          dIntersectX = dTmpIntersectX;</span></div>
<div class="line"><a id="l01854" name="l01854"></a><span class="lineno"> 1854</span>   <span class="comment">//          dIntersectY = dTmpIntersectY;</span></div>
<div class="line"><a id="l01855" name="l01855"></a><span class="lineno"> 1855</span>   <span class="comment">//          nProfileToRetainIntersectLineSeg = nThisProfLineSeg;</span></div>
<div class="line"><a id="l01856" name="l01856"></a><span class="lineno"> 1856</span>   <span class="comment">//          nProfileToTruncateIntersectLineSeg = nProfToTruncLineSeg;</span></div>
<div class="line"><a id="l01857" name="l01857"></a><span class="lineno"> 1857</span>   <span class="comment">//</span></div>
<div class="line"><a id="l01858" name="l01858"></a><span class="lineno"> 1858</span>   <span class="comment">//          bFound = true;</span></div>
<div class="line"><a id="l01859" name="l01859"></a><span class="lineno"> 1859</span>   <span class="comment">//          break;</span></div>
<div class="line"><a id="l01860" name="l01860"></a><span class="lineno"> 1860</span>   <span class="comment">//       }</span></div>
<div class="line"><a id="l01861" name="l01861"></a><span class="lineno"> 1861</span>   <span class="comment">//    }</span></div>
<div class="line"><a id="l01862" name="l01862"></a><span class="lineno"> 1862</span>   <span class="comment">// }</span></div>
<div class="line"><a id="l01863" name="l01863"></a><span class="lineno"> 1863</span> </div>
<div class="line"><a id="l01864" name="l01864"></a><span class="lineno"> 1864</span>   <span class="comment">// Insert the intersection point into the main retain-profile if it is not already in the profile, and do the same for all co-incident profiles of the main retain-profile. Also add details of the to-truncate profile (and all its coincident profiles) to every line segment of the main to-retain profile which is seaward of the point of intersection</span></div>
<div class="line"><a id="l01865" name="l01865"></a><span class="lineno"> 1865</span>   <span class="keywordtype">int</span> nRet = <a class="code hl_function" href="../../d1/d98/classCSimulation.html#aa01cba56311299ba9391bcb653107dc4">nInsertPointIntoProfilesIfNeededThenUpdate</a>(nCoast, pProfileToRetain, dIntersectX, dIntersectY, nProfileToRetainIntersectLineSeg, pProfileToTruncate, nProfileToTruncateIntersectLineSeg, bAlreadyPresent);</div>
<div class="line"><a id="l01866" name="l01866"></a><span class="lineno"> 1866</span>   <span class="keywordflow">if</span> (nRet != <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#aa768cb14b5c6123ee95e6e4ebd9fe331">RTN_OK</a>)</div>
<div class="line"><a id="l01867" name="l01867"></a><span class="lineno"> 1867</span>   {</div>
<div class="line"><a id="l01868" name="l01868"></a><span class="lineno"> 1868</span>      <span class="comment">// LogStream &lt;&lt; m_ulIter &lt;&lt; &quot;: error in nInsertPointIntoProfilesIfNeededThenUpdate()&quot; &lt;&lt; endl;</span></div>
<div class="line"><a id="l01869" name="l01869"></a><span class="lineno"> 1869</span>      <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l01870" name="l01870"></a><span class="lineno"> 1870</span>   }</div>
<div class="line"><a id="l01871" name="l01871"></a><span class="lineno"> 1871</span> </div>
<div class="line"><a id="l01872" name="l01872"></a><span class="lineno"> 1872</span>   <span class="comment">// Get all profile points of the main retain-profile seawards from the intersection point, and do the same for the corresponding line segments (including coincident profiles). This also includes details of the main to-truncate profile (and all its coincident profiles)</span></div>
<div class="line"><a id="l01873" name="l01873"></a><span class="lineno"> 1873</span>   vector&lt;CGeom2DPoint&gt; PtVProfileLastPart;</div>
<div class="line"><a id="l01874" name="l01874"></a><span class="lineno"> 1874</span>   vector&lt;vector&lt;pair&lt;int, int&gt;&gt;&gt; prVLineSegLastPart;</div>
<div class="line"><a id="l01875" name="l01875"></a><span class="lineno"> 1875</span>   <span class="keywordflow">if</span> (bAlreadyPresent)</div>
<div class="line"><a id="l01876" name="l01876"></a><span class="lineno"> 1876</span>   {</div>
<div class="line"><a id="l01877" name="l01877"></a><span class="lineno"> 1877</span>      PtVProfileLastPart = pProfileToRetain-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#a72b3263ad5f64527b4c21307139b3c5f">PtVGetThisPointAndAllAfter</a>(nProfileToRetainIntersectLineSeg);</div>
<div class="line"><a id="l01878" name="l01878"></a><span class="lineno"> 1878</span>      prVLineSegLastPart = pProfileToRetain-&gt;<a class="code hl_function" href="../../d0/d89/classCGeomMultiLine.html#a66541bcbd102c19829637e60f8fe7860">prVVGetAllLineSegAfter</a>(nProfileToRetainIntersectLineSeg);</div>
<div class="line"><a id="l01879" name="l01879"></a><span class="lineno"> 1879</span>   }</div>
<div class="line"><a id="l01880" name="l01880"></a><span class="lineno"> 1880</span>   <span class="keywordflow">else</span></div>
<div class="line"><a id="l01881" name="l01881"></a><span class="lineno"> 1881</span>   {</div>
<div class="line"><a id="l01882" name="l01882"></a><span class="lineno"> 1882</span>      PtVProfileLastPart = pProfileToRetain-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#a72b3263ad5f64527b4c21307139b3c5f">PtVGetThisPointAndAllAfter</a>(nProfileToRetainIntersectLineSeg + 1);</div>
<div class="line"><a id="l01883" name="l01883"></a><span class="lineno"> 1883</span>      prVLineSegLastPart = pProfileToRetain-&gt;<a class="code hl_function" href="../../d0/d89/classCGeomMultiLine.html#a66541bcbd102c19829637e60f8fe7860">prVVGetAllLineSegAfter</a>(nProfileToRetainIntersectLineSeg + 1);</div>
<div class="line"><a id="l01884" name="l01884"></a><span class="lineno"> 1884</span>   }</div>
<div class="line"><a id="l01885" name="l01885"></a><span class="lineno"> 1885</span> </div>
<div class="line"><a id="l01886" name="l01886"></a><span class="lineno"> 1886</span>   <span class="comment">//    assert(PtVProfileLastPart.size() &gt; 1);</span></div>
<div class="line"><a id="l01887" name="l01887"></a><span class="lineno"> 1887</span>   <span class="comment">//    assert(prVLineSegLastPart.size() &gt; 0);</span></div>
<div class="line"><a id="l01888" name="l01888"></a><span class="lineno"> 1888</span> </div>
<div class="line"><a id="l01889" name="l01889"></a><span class="lineno"> 1889</span>   <span class="comment">// Truncate the truncate-profile at the point of intersection, and do the same for all its co-incident profiles. Then append the profile points of the main to-retain profile seaward from the intersection point, and do the same for the corresponding line segments (including coincident profiles)</span></div>
<div class="line"><a id="l01890" name="l01890"></a><span class="lineno"> 1890</span>   <a class="code hl_function" href="../../d1/d98/classCSimulation.html#a9d247d1e2cdf21052d912096a0a5be25">TruncateProfileAndAppendNew</a>(nCoast, pProfileToTruncate, nProfileToTruncateIntersectLineSeg, &amp;PtVProfileLastPart, &amp;prVLineSegLastPart);</div>
<div class="line"><a id="l01891" name="l01891"></a><span class="lineno"> 1891</span> </div>
<div class="line"><a id="l01892" name="l01892"></a><span class="lineno"> 1892</span>   <span class="comment">//    assert(m_VCoast[nCoast].pGetProfile(nProfileToTruncate)-&gt;nGetProfileSize() &gt; 1);</span></div>
<div class="line"><a id="l01893" name="l01893"></a><span class="lineno"> 1893</span>   <span class="comment">//    assert(pProfileToRetain-&gt;nGetNumLineSegments() &gt; 0);</span></div>
<div class="line"><a id="l01894" name="l01894"></a><span class="lineno"> 1894</span>   <span class="comment">//    assert(m_VCoast[nCoast].pGetProfile(nProfileToTruncate)-&gt;nGetNumLineSegments() &gt; 0);</span></div>
<div class="line"><a id="l01895" name="l01895"></a><span class="lineno"> 1895</span>}</div>
</div>
<div class="line"><a id="l01896" name="l01896"></a><span class="lineno"> 1896</span> </div>
<div class="line"><a id="l01897" name="l01897"></a><span class="lineno"> 1897</span><span class="comment">//===============================================================================================================================</span></div>
<div class="line"><a id="l01899" name="l01899"></a><span class="lineno"> 1899</span><span class="comment">//===============================================================================================================================</span></div>
<div class="foldopen" id="foldopen01900" data-start="{" data-end="}">
<div class="line"><a id="l01900" name="l01900"></a><span class="lineno"><a class="line" href="../../d1/d98/classCSimulation.html#aa01cba56311299ba9391bcb653107dc4"> 1900</a></span><span class="keywordtype">int</span> <a class="code hl_function" href="../../d1/d98/classCSimulation.html#aa01cba56311299ba9391bcb653107dc4">CSimulation::nInsertPointIntoProfilesIfNeededThenUpdate</a>(<span class="keywordtype">int</span> <span class="keyword">const</span> nCoast, <a class="code hl_class" href="../../da/dae/classCGeomProfile.html">CGeomProfile</a>* pProfileToRetain, <span class="keywordtype">double</span> <span class="keyword">const</span> dIntersectX, <span class="keywordtype">double</span> <span class="keyword">const</span> dIntersectY, <span class="keywordtype">int</span> <span class="keyword">const</span> nProfileToRetainIntersectLineSeg, <a class="code hl_class" href="../../da/dae/classCGeomProfile.html">CGeomProfile</a>* pProfileToTruncate, <span class="keywordtype">int</span> <span class="keyword">const</span> nProfileToTruncateIntersectLineSeg, <span class="keywordtype">bool</span> <span class="keyword">const</span> bAlreadyPresent)</div>
<div class="line"><a id="l01901" name="l01901"></a><span class="lineno"> 1901</span>{</div>
<div class="line"><a id="l01902" name="l01902"></a><span class="lineno"> 1902</span>   <span class="comment">// // DEBUG CODE ****************************************************************</span></div>
<div class="line"><a id="l01903" name="l01903"></a><span class="lineno"> 1903</span>   <span class="comment">// // Get the index numbers of all coincident profiles for the &#39;main&#39; to-retain profile for the line segment in which intersection occurred</span></div>
<div class="line"><a id="l01904" name="l01904"></a><span class="lineno"> 1904</span>   <span class="comment">// vector&lt;pair&lt;int, int&gt; &gt; prVRetainCoincidentProfilesCHECK1 = *m_VCoast[nCoast].pGetProfile(nMainProfile)-&gt;pprVGetPairedCoincidentProfilesForLineSegment(nProfileToRetainIntersectLineSeg);</span></div>
<div class="line"><a id="l01905" name="l01905"></a><span class="lineno"> 1905</span>   <span class="comment">// int nNumRetainCoincidentCHECK1 = prVRetainCoincidentProfilesCHECK1.size();</span></div>
<div class="line"><a id="l01906" name="l01906"></a><span class="lineno"> 1906</span>   <span class="comment">// for (int nn = 0; nn &lt; nNumRetainCoincidentCHECK1; nn++)</span></div>
<div class="line"><a id="l01907" name="l01907"></a><span class="lineno"> 1907</span>   <span class="comment">// {</span></div>
<div class="line"><a id="l01908" name="l01908"></a><span class="lineno"> 1908</span>   <span class="comment">//    int nThisProfile = prVRetainCoincidentProfilesCHECK1[nn].first;</span></div>
<div class="line"><a id="l01909" name="l01909"></a><span class="lineno"> 1909</span>   <span class="comment">//    LogStream &lt;&lt; &quot;\tBEFORE nInsertPointIntoProfilesIfNeededThenUpdate(): &quot; &lt;&lt; (nThisProfile == nMainProfile ? &quot;MAIN&quot; : &quot;COINCIDENT&quot;) &lt;&lt; &quot; to-retain profile {&quot; &lt;&lt; nThisProfile &lt;&lt; &quot;} has &quot; &lt;&lt; m_VCoast[nCoast].pGetProfile(nThisProfile)-&gt;nGetProfileSize() &lt;&lt; &quot; points &quot;;</span></div>
<div class="line"><a id="l01910" name="l01910"></a><span class="lineno"> 1910</span>   <span class="comment">//    for (int nn = 0; nn &lt; m_VCoast[nCoast].pGetProfile(nThisProfile)-&gt;nGetProfileSize(); nn++)</span></div>
<div class="line"><a id="l01911" name="l01911"></a><span class="lineno"> 1911</span>   <span class="comment">//       LogStream &lt;&lt; &quot;[&quot; &lt;&lt; m_VCoast[nCoast].pGetProfile(nThisProfile)-&gt;pPtGetPointInProfile(nn)-&gt;dGetX() &lt;&lt; &quot;, &quot; &lt;&lt; m_VCoast[nCoast].pGetProfile(nThisProfile)-&gt;pPtGetPointInProfile(nn)-&gt;dGetY() &lt;&lt; &quot;] &quot;;</span></div>
<div class="line"><a id="l01912" name="l01912"></a><span class="lineno"> 1912</span>   <span class="comment">//    LogStream &lt;&lt; &quot;), and &quot; &lt;&lt; m_VCoast[nCoast].pGetProfile(nThisProfile)-&gt;nGetNumLineSegments() &lt;&lt; &quot; line segments, co-incident profiles and their line segments are &quot;;</span></div>
<div class="line"><a id="l01913" name="l01913"></a><span class="lineno"> 1913</span>   <span class="comment">//    for (int mm = 0; mm &lt; m_VCoast[nCoast].pGetProfile(nThisProfile)-&gt;nGetNumLineSegments(); mm++)</span></div>
<div class="line"><a id="l01914" name="l01914"></a><span class="lineno"> 1914</span>   <span class="comment">//    {</span></div>
<div class="line"><a id="l01915" name="l01915"></a><span class="lineno"> 1915</span>   <span class="comment">//       vector&lt;pair&lt;int, int&gt; &gt; prVTmp = *m_VCoast[nCoast].pGetProfile(nThisProfile)-&gt;pprVGetPairedCoincidentProfilesForLineSegment(mm);</span></div>
<div class="line"><a id="l01916" name="l01916"></a><span class="lineno"> 1916</span>   <span class="comment">//       LogStream &lt;&lt; &quot;{ &quot;;</span></div>
<div class="line"><a id="l01917" name="l01917"></a><span class="lineno"> 1917</span>   <span class="comment">//       for (int nn = 0; nn &lt; m_VCoast[nCoast].pGetProfile(nThisProfile)-&gt;nGetNumCoincidentProfilesInLineSegment(mm); nn++)</span></div>
<div class="line"><a id="l01918" name="l01918"></a><span class="lineno"> 1918</span>   <span class="comment">//          LogStream &lt;&lt; prVTmp[nn].first &lt;&lt; &quot;[&quot; &lt;&lt; prVTmp[nn].second &lt;&lt; &quot;] &quot;;</span></div>
<div class="line"><a id="l01919" name="l01919"></a><span class="lineno"> 1919</span>   <span class="comment">//       LogStream &lt;&lt; &quot;} &quot;;</span></div>
<div class="line"><a id="l01920" name="l01920"></a><span class="lineno"> 1920</span>   <span class="comment">//    }</span></div>
<div class="line"><a id="l01921" name="l01921"></a><span class="lineno"> 1921</span>   <span class="comment">//    LogStream &lt;&lt; endl;</span></div>
<div class="line"><a id="l01922" name="l01922"></a><span class="lineno"> 1922</span>   <span class="comment">//</span></div>
<div class="line"><a id="l01923" name="l01923"></a><span class="lineno"> 1923</span>   <span class="comment">//    for (int nPoint = 0; nPoint &lt; m_VCoast[nCoast].pGetProfile(nThisProfile)-&gt;nGetProfileSize()-1; nPoint++)</span></div>
<div class="line"><a id="l01924" name="l01924"></a><span class="lineno"> 1924</span>   <span class="comment">//    {</span></div>
<div class="line"><a id="l01925" name="l01925"></a><span class="lineno"> 1925</span>   <span class="comment">//       CGeom2DPoint</span></div>
<div class="line"><a id="l01926" name="l01926"></a><span class="lineno"> 1926</span>   <span class="comment">//          Pt1 = *m_VCoast[nCoast].pGetProfile(nThisProfile)-&gt;pPtGetPointInProfile(nPoint),</span></div>
<div class="line"><a id="l01927" name="l01927"></a><span class="lineno"> 1927</span>   <span class="comment">//          Pt2 = *m_VCoast[nCoast].pGetProfile(nThisProfile)-&gt;pPtGetPointInProfile(nPoint+1);</span></div>
<div class="line"><a id="l01928" name="l01928"></a><span class="lineno"> 1928</span>   <span class="comment">//</span></div>
<div class="line"><a id="l01929" name="l01929"></a><span class="lineno"> 1929</span>   <span class="comment">//       if (Pt1 == Pt2)</span></div>
<div class="line"><a id="l01930" name="l01930"></a><span class="lineno"> 1930</span>   <span class="comment">//          LogStream &lt;&lt; m_ulIter &lt;&lt; &quot;: IDENTICAL POINTS before changes, in profile {&quot; &lt;&lt; nThisProfile &lt;&lt; &quot;} points = &quot; &lt;&lt; nPoint &lt;&lt; &quot; and &quot; &lt;&lt; nPoint+1 &lt;&lt; endl;</span></div>
<div class="line"><a id="l01931" name="l01931"></a><span class="lineno"> 1931</span>   <span class="comment">//    }</span></div>
<div class="line"><a id="l01932" name="l01932"></a><span class="lineno"> 1932</span>   <span class="comment">// }</span></div>
<div class="line"><a id="l01933" name="l01933"></a><span class="lineno"> 1933</span>   <span class="comment">//</span></div>
<div class="line"><a id="l01934" name="l01934"></a><span class="lineno"> 1934</span>   <span class="comment">// // Get the index numbers of all coincident profiles for the &#39;main&#39; to-truncate profile for the line segment in which intersection occurred</span></div>
<div class="line"><a id="l01935" name="l01935"></a><span class="lineno"> 1935</span>   <span class="comment">// vector&lt;pair&lt;int, int&gt; &gt; prVTruncateCoincidentProfilesCHECK1 = *m_VCoast[nCoast].pGetProfile(nProfileToTruncate)-&gt;pprVGetPairedCoincidentProfilesForLineSegment(nProfileToTruncateIntersectLineSeg);</span></div>
<div class="line"><a id="l01936" name="l01936"></a><span class="lineno"> 1936</span>   <span class="comment">// int nNumTruncateCoincidentCHECK1 = prVTruncateCoincidentProfilesCHECK1.size();</span></div>
<div class="line"><a id="l01937" name="l01937"></a><span class="lineno"> 1937</span>   <span class="comment">// for (int nn = 0; nn &lt; nNumTruncateCoincidentCHECK1; nn++)</span></div>
<div class="line"><a id="l01938" name="l01938"></a><span class="lineno"> 1938</span>   <span class="comment">// {</span></div>
<div class="line"><a id="l01939" name="l01939"></a><span class="lineno"> 1939</span>   <span class="comment">//    int nThisProfile = prVTruncateCoincidentProfilesCHECK1[nn].first;</span></div>
<div class="line"><a id="l01940" name="l01940"></a><span class="lineno"> 1940</span>   <span class="comment">//    LogStream &lt;&lt; &quot;\tBEFORE nInsertPointIntoProfilesIfNeededThenUpdate(): &quot; &lt;&lt; (nThisProfile == nProfileToTruncate ? &quot;MAIN&quot; : &quot;COINCIDENT&quot;) &lt;&lt; &quot; to-truncate profile {&quot; &lt;&lt; nThisProfile &lt;&lt; &quot;} has &quot; &lt;&lt; m_VCoast[nCoast].pGetProfile(nThisProfile)-&gt;nGetProfileSize() &lt;&lt; &quot; points &quot;;</span></div>
<div class="line"><a id="l01941" name="l01941"></a><span class="lineno"> 1941</span>   <span class="comment">//    for (int nn = 0; nn &lt; m_VCoast[nCoast].pGetProfile(nThisProfile)-&gt;nGetProfileSize(); nn++)</span></div>
<div class="line"><a id="l01942" name="l01942"></a><span class="lineno"> 1942</span>   <span class="comment">//       LogStream &lt;&lt; &quot;[&quot; &lt;&lt; m_VCoast[nCoast].pGetProfile(nThisProfile)-&gt;pPtGetPointInProfile(nn)-&gt;dGetX() &lt;&lt; &quot;, &quot; &lt;&lt; m_VCoast[nCoast].pGetProfile(nThisProfile)-&gt;pPtGetPointInProfile(nn)-&gt;dGetY() &lt;&lt; &quot;] &quot;;</span></div>
<div class="line"><a id="l01943" name="l01943"></a><span class="lineno"> 1943</span>   <span class="comment">//    LogStream &lt;&lt; &quot;), and &quot; &lt;&lt; m_VCoast[nCoast].pGetProfile(nThisProfile)-&gt;nGetNumLineSegments() &lt;&lt; &quot; line segments, co-incident profiles and their line segments are &quot;;</span></div>
<div class="line"><a id="l01944" name="l01944"></a><span class="lineno"> 1944</span>   <span class="comment">//    for (int mm = 0; mm &lt; m_VCoast[nCoast].pGetProfile(nThisProfile)-&gt;nGetNumLineSegments(); mm++)</span></div>
<div class="line"><a id="l01945" name="l01945"></a><span class="lineno"> 1945</span>   <span class="comment">//    {</span></div>
<div class="line"><a id="l01946" name="l01946"></a><span class="lineno"> 1946</span>   <span class="comment">//       vector&lt;pair&lt;int, int&gt; &gt; prVTmp = *m_VCoast[nCoast].pGetProfile(nThisProfile)-&gt;pprVGetPairedCoincidentProfilesForLineSegment(mm);</span></div>
<div class="line"><a id="l01947" name="l01947"></a><span class="lineno"> 1947</span>   <span class="comment">//       LogStream &lt;&lt; &quot;{ &quot;;</span></div>
<div class="line"><a id="l01948" name="l01948"></a><span class="lineno"> 1948</span>   <span class="comment">//       for (int nn = 0; nn &lt; m_VCoast[nCoast].pGetProfile(nThisProfile)-&gt;nGetNumCoincidentProfilesInLineSegment(mm); nn++)</span></div>
<div class="line"><a id="l01949" name="l01949"></a><span class="lineno"> 1949</span>   <span class="comment">//          LogStream &lt;&lt; prVTmp[nn].first &lt;&lt; &quot;[&quot; &lt;&lt; prVTmp[nn].second &lt;&lt; &quot;] &quot;;</span></div>
<div class="line"><a id="l01950" name="l01950"></a><span class="lineno"> 1950</span>   <span class="comment">//       LogStream &lt;&lt; &quot;} &quot;;</span></div>
<div class="line"><a id="l01951" name="l01951"></a><span class="lineno"> 1951</span>   <span class="comment">//    }</span></div>
<div class="line"><a id="l01952" name="l01952"></a><span class="lineno"> 1952</span>   <span class="comment">//    LogStream &lt;&lt; endl;</span></div>
<div class="line"><a id="l01953" name="l01953"></a><span class="lineno"> 1953</span>   <span class="comment">//</span></div>
<div class="line"><a id="l01954" name="l01954"></a><span class="lineno"> 1954</span>   <span class="comment">//    for (int nPoint = 0; nPoint &lt; m_VCoast[nCoast].pGetProfile(nThisProfile)-&gt;nGetProfileSize()-1; nPoint++)</span></div>
<div class="line"><a id="l01955" name="l01955"></a><span class="lineno"> 1955</span>   <span class="comment">//    {</span></div>
<div class="line"><a id="l01956" name="l01956"></a><span class="lineno"> 1956</span>   <span class="comment">//       CGeom2DPoint</span></div>
<div class="line"><a id="l01957" name="l01957"></a><span class="lineno"> 1957</span>   <span class="comment">//          Pt1 = *m_VCoast[nCoast].pGetProfile(nThisProfile)-&gt;pPtGetPointInProfile(nPoint),</span></div>
<div class="line"><a id="l01958" name="l01958"></a><span class="lineno"> 1958</span>   <span class="comment">//          Pt2 = *m_VCoast[nCoast].pGetProfile(nThisProfile)-&gt;pPtGetPointInProfile(nPoint+1);</span></div>
<div class="line"><a id="l01959" name="l01959"></a><span class="lineno"> 1959</span>   <span class="comment">//</span></div>
<div class="line"><a id="l01960" name="l01960"></a><span class="lineno"> 1960</span>   <span class="comment">//       if (Pt1 == Pt2)</span></div>
<div class="line"><a id="l01961" name="l01961"></a><span class="lineno"> 1961</span>   <span class="comment">//          LogStream &lt;&lt; m_ulIter &lt;&lt; &quot;: IDENTICAL POINTS before changes, in profile {&quot; &lt;&lt; nThisProfile &lt;&lt; &quot;} points = &quot; &lt;&lt; nPoint &lt;&lt; &quot; and &quot; &lt;&lt; nPoint+1 &lt;&lt; endl;</span></div>
<div class="line"><a id="l01962" name="l01962"></a><span class="lineno"> 1962</span>   <span class="comment">//    }</span></div>
<div class="line"><a id="l01963" name="l01963"></a><span class="lineno"> 1963</span>   <span class="comment">// }</span></div>
<div class="line"><a id="l01964" name="l01964"></a><span class="lineno"> 1964</span>   <span class="comment">// // DEBUG CODE ******************************************************************</span></div>
<div class="line"><a id="l01965" name="l01965"></a><span class="lineno"> 1965</span> </div>
<div class="line"><a id="l01966" name="l01966"></a><span class="lineno"> 1966</span>   <span class="keywordtype">int</span> nProfileToRetain = pProfileToRetain-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#aacd98f9837c3c7cf7414764b73275fba">nGetCoastID</a>();</div>
<div class="line"><a id="l01967" name="l01967"></a><span class="lineno"> 1967</span> </div>
<div class="line"><a id="l01968" name="l01968"></a><span class="lineno"> 1968</span>   <span class="comment">// Get the index numbers of all coincident profiles for the &#39;main&#39; to-retain profile for the line segment in which intersection occurs</span></div>
<div class="line"><a id="l01969" name="l01969"></a><span class="lineno"> 1969</span>   vector&lt;pair&lt;int, int&gt;&gt; prVCoincidentProfiles = *pProfileToRetain-&gt;<a class="code hl_function" href="../../d0/d89/classCGeomMultiLine.html#ab0146cd34539f41588924571dbfb2054">pprVGetPairedCoincidentProfilesForLineSegment</a>(nProfileToRetainIntersectLineSeg);</div>
<div class="line"><a id="l01970" name="l01970"></a><span class="lineno"> 1970</span>   <span class="keywordtype">int</span> nNumCoincident = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(prVCoincidentProfiles.size());</div>
<div class="line"><a id="l01971" name="l01971"></a><span class="lineno"> 1971</span>   vector&lt;int&gt; nLineSegAfterIntersect(nNumCoincident, -1); <span class="comment">// The line segment after the point of intersection, for each co-incident profile</span></div>
<div class="line"><a id="l01972" name="l01972"></a><span class="lineno"> 1972</span> </div>
<div class="line"><a id="l01973" name="l01973"></a><span class="lineno"> 1973</span>   <span class="comment">// Do this for the main profile and all profiles which are co-incident for this line segment</span></div>
<div class="line"><a id="l01974" name="l01974"></a><span class="lineno"> 1974</span>   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> nn = 0; nn &lt; nNumCoincident; nn++)</div>
<div class="line"><a id="l01975" name="l01975"></a><span class="lineno"> 1975</span>   {</div>
<div class="line"><a id="l01976" name="l01976"></a><span class="lineno"> 1976</span>      <span class="keywordtype">int</span> nThisProfile = prVCoincidentProfiles[nn].first;  <span class="comment">// The number of this profile</span></div>
<div class="line"><a id="l01977" name="l01977"></a><span class="lineno"> 1977</span>      <span class="keywordtype">int</span> nThisLineSeg = prVCoincidentProfiles[nn].second; <span class="comment">// The line segment of this profile</span></div>
<div class="line"><a id="l01978" name="l01978"></a><span class="lineno"> 1978</span>      <a class="code hl_class" href="../../da/dae/classCGeomProfile.html">CGeomProfile</a>* pThisProfile = <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a25ada8139c82ca7beab3f279cff83184">m_VCoast</a>[nCoast].pGetProfile(nThisProfile);</div>
<div class="line"><a id="l01979" name="l01979"></a><span class="lineno"> 1979</span> </div>
<div class="line"><a id="l01980" name="l01980"></a><span class="lineno"> 1980</span>      <span class="comment">// Is the intersection point already present in the to-retain profile?</span></div>
<div class="line"><a id="l01981" name="l01981"></a><span class="lineno"> 1981</span>      <span class="keywordflow">if</span> (! bAlreadyPresent)</div>
<div class="line"><a id="l01982" name="l01982"></a><span class="lineno"> 1982</span>      {</div>
<div class="line"><a id="l01983" name="l01983"></a><span class="lineno"> 1983</span>         <span class="comment">// It is not already present, so insert it and also update the associated multi-line</span></div>
<div class="line"><a id="l01984" name="l01984"></a><span class="lineno"> 1984</span>         <span class="keywordflow">if</span> (! pThisProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#a7928f1a673869c0fa0bef5ff894d75c2">bInsertIntersection</a>(dIntersectX, dIntersectY, nThisLineSeg))</div>
<div class="line"><a id="l01985" name="l01985"></a><span class="lineno"> 1985</span>         {</div>
<div class="line"><a id="l01986" name="l01986"></a><span class="lineno"> 1986</span>            <span class="comment">// Error</span></div>
<div class="line"><a id="l01987" name="l01987"></a><span class="lineno"> 1987</span>            <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a222962121613613a48f518e0c2110f21">LogStream</a> &lt;&lt; <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#a957ca99e98618160534cafb0929f743d">WARN</a> &lt;&lt; <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#ad67e8c5b30a0572f64ecfb5c062c2edc">m_ulIter</a> &lt;&lt; <span class="stringliteral">&quot;: cannot insert a line segment after the final line segment (&quot;</span> &lt;&lt; nThisLineSeg &lt;&lt; <span class="stringliteral">&quot;) for &quot;</span> &lt;&lt; (nThisProfile == nProfileToRetain ? <span class="stringliteral">&quot;main&quot;</span> : <span class="stringliteral">&quot;co-incident&quot;</span>) &lt;&lt; <span class="stringliteral">&quot; profile (&quot;</span> &lt;&lt; nThisProfile &lt;&lt; <span class="stringliteral">&quot;), abandoning&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a id="l01988" name="l01988"></a><span class="lineno"> 1988</span> </div>
<div class="line"><a id="l01989" name="l01989"></a><span class="lineno"> 1989</span>            <span class="keywordflow">return</span> <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#abd7b3a789b8f318e39b67dc1cf4a2673">RTN_ERR_CANNOT_INSERT_POINT</a>;</div>
<div class="line"><a id="l01990" name="l01990"></a><span class="lineno"> 1990</span>         }</div>
<div class="line"><a id="l01991" name="l01991"></a><span class="lineno"> 1991</span> </div>
<div class="line"><a id="l01992" name="l01992"></a><span class="lineno"> 1992</span>         <span class="comment">//          LogStream &lt;&lt; &quot;\tIntersection point NOT already in &quot; &lt;&lt; (nThisProfile == nProfileToRetain ? &quot;main&quot; : &quot;co-incident&quot;) &lt;&lt; &quot; profile {&quot; &lt;&lt; nThisProfile &lt;&lt; &quot;}, inserted it as point &quot; &lt;&lt; nThisLineSeg+1 &lt;&lt; endl;</span></div>
<div class="line"><a id="l01993" name="l01993"></a><span class="lineno"> 1993</span>      }</div>
<div class="line"><a id="l01994" name="l01994"></a><span class="lineno"> 1994</span> </div>
<div class="line"><a id="l01995" name="l01995"></a><span class="lineno"> 1995</span>      <span class="comment">// Get the line segment after intersection</span></div>
<div class="line"><a id="l01996" name="l01996"></a><span class="lineno"> 1996</span>      nLineSegAfterIntersect[nn] = nThisLineSeg + 1;</div>
<div class="line"><a id="l01997" name="l01997"></a><span class="lineno"> 1997</span>   }</div>
<div class="line"><a id="l01998" name="l01998"></a><span class="lineno"> 1998</span> </div>
<div class="line"><a id="l01999" name="l01999"></a><span class="lineno"> 1999</span>   <span class="comment">// for (int nn = 0; nn &lt; nNumCoincident; nn++)</span></div>
<div class="line"><a id="l02000" name="l02000"></a><span class="lineno"> 2000</span>   <span class="comment">//    LogStream &lt;&lt; &quot;\tFor profile &quot; &lt;&lt; prVCoincidentProfiles[nn].first &lt;&lt; &quot; line segment [&quot; &lt;&lt; nLineSegAfterIntersect[nn] &lt;&lt; &quot;] is immediately after the intersection point&quot; &lt;&lt; endl;</span></div>
<div class="line"><a id="l02001" name="l02001"></a><span class="lineno"> 2001</span> </div>
<div class="line"><a id="l02002" name="l02002"></a><span class="lineno"> 2002</span>   <span class="comment">// Get the coincident profiles for the to-truncate profile, at the line segment where intersection occurs</span></div>
<div class="line"><a id="l02003" name="l02003"></a><span class="lineno"> 2003</span>   vector&lt;pair&lt;int, int&gt;&gt; prVToTruncateCoincidentProfiles = *pProfileToTruncate-&gt;<a class="code hl_function" href="../../d0/d89/classCGeomMultiLine.html#ab0146cd34539f41588924571dbfb2054">pprVGetPairedCoincidentProfilesForLineSegment</a>(nProfileToTruncateIntersectLineSeg);</div>
<div class="line"><a id="l02004" name="l02004"></a><span class="lineno"> 2004</span>   <span class="keywordtype">int</span> nNumToTruncateCoincident = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(prVToTruncateCoincidentProfiles.size());</div>
<div class="line"><a id="l02005" name="l02005"></a><span class="lineno"> 2005</span> </div>
<div class="line"><a id="l02006" name="l02006"></a><span class="lineno"> 2006</span>   <span class="comment">// Now add the number of the to-truncate profile, and all its coincident profiles, to all line segments which are seaward of the point of intersection. Do this for the main profile and all profiles which are co-incident for this line segment</span></div>
<div class="line"><a id="l02007" name="l02007"></a><span class="lineno"> 2007</span>   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> nn = 0; nn &lt; nNumCoincident; nn++)</div>
<div class="line"><a id="l02008" name="l02008"></a><span class="lineno"> 2008</span>   {</div>
<div class="line"><a id="l02009" name="l02009"></a><span class="lineno"> 2009</span>      <span class="keywordtype">int</span> nThisProfile = prVCoincidentProfiles[nn].first;      <span class="comment">// The number of this profile</span></div>
<div class="line"><a id="l02010" name="l02010"></a><span class="lineno"> 2010</span>      <a class="code hl_class" href="../../da/dae/classCGeomProfile.html">CGeomProfile</a>* pThisProfile = <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a25ada8139c82ca7beab3f279cff83184">m_VCoast</a>[nCoast].pGetProfile(nThisProfile);</div>
<div class="line"><a id="l02011" name="l02011"></a><span class="lineno"> 2011</span> </div>
<div class="line"><a id="l02012" name="l02012"></a><span class="lineno"> 2012</span>      <span class="comment">// Get the number of line segments for this to-retain profile (will have just increased, if we just inserted a point)</span></div>
<div class="line"><a id="l02013" name="l02013"></a><span class="lineno"> 2013</span>      <span class="keywordtype">int</span> nNumLineSegs = pThisProfile-&gt;<a class="code hl_function" href="../../d0/d89/classCGeomMultiLine.html#ae22f845fd065108959610678de571cdb">nGetNumLineSegments</a>();</div>
<div class="line"><a id="l02014" name="l02014"></a><span class="lineno"> 2014</span> </div>
<div class="line"><a id="l02015" name="l02015"></a><span class="lineno"> 2015</span>      <span class="comment">// Do for all line segments seaward of the point of intersection</span></div>
<div class="line"><a id="l02016" name="l02016"></a><span class="lineno"> 2016</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> nLineSeg = nLineSegAfterIntersect[nn], nIncr = 0; nLineSeg &lt; nNumLineSegs; nLineSeg++, nIncr++)</div>
<div class="line"><a id="l02017" name="l02017"></a><span class="lineno"> 2017</span>      {</div>
<div class="line"><a id="l02018" name="l02018"></a><span class="lineno"> 2018</span>         <span class="comment">// // This can happen occasionally TEST</span></div>
<div class="line"><a id="l02019" name="l02019"></a><span class="lineno"> 2019</span>         <span class="comment">// if (nThisProfile == nProfileToTruncateIntersectLineSeg)</span></div>
<div class="line"><a id="l02020" name="l02020"></a><span class="lineno"> 2020</span>         <span class="comment">// {</span></div>
<div class="line"><a id="l02021" name="l02021"></a><span class="lineno"> 2021</span>         <span class="comment">//    LogStream &lt;&lt; &quot;\t*** ERROR nThisProfile = &quot; &lt;&lt; nThisProfile &lt;&lt; &quot; nProfileToTruncateIntersectLineSeg = &quot; &lt;&lt; nProfileToTruncateIntersectLineSeg &lt;&lt; &quot;, ignoring&quot; &lt;&lt; endl;</span></div>
<div class="line"><a id="l02022" name="l02022"></a><span class="lineno"> 2022</span>         <span class="comment">//    pThisProfile-&gt;SetHitAnotherProfile(true);</span></div>
<div class="line"><a id="l02023" name="l02023"></a><span class="lineno"> 2023</span>         <span class="comment">//    continue;</span></div>
<div class="line"><a id="l02024" name="l02024"></a><span class="lineno"> 2024</span>         <span class="comment">// }</span></div>
<div class="line"><a id="l02025" name="l02025"></a><span class="lineno"> 2025</span> </div>
<div class="line"><a id="l02026" name="l02026"></a><span class="lineno"> 2026</span>         <span class="comment">// Add the number of the to-truncate profile, and all its coincident profiles, to this line segment</span></div>
<div class="line"><a id="l02027" name="l02027"></a><span class="lineno"> 2027</span>         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> m = 0; m &lt; nNumToTruncateCoincident; m++)</div>
<div class="line"><a id="l02028" name="l02028"></a><span class="lineno"> 2028</span>         {</div>
<div class="line"><a id="l02029" name="l02029"></a><span class="lineno"> 2029</span>            <span class="keywordtype">int</span> nProfileToAdd = prVToTruncateCoincidentProfiles[m].first;</div>
<div class="line"><a id="l02030" name="l02030"></a><span class="lineno"> 2030</span>            <span class="keywordtype">int</span> nProfileToAddLineSeg = prVToTruncateCoincidentProfiles[m].second;</div>
<div class="line"><a id="l02031" name="l02031"></a><span class="lineno"> 2031</span> </div>
<div class="line"><a id="l02032" name="l02032"></a><span class="lineno"> 2032</span>            <span class="comment">// LogStream &lt;&lt; &quot;\tAdding &quot; &lt;&lt; (nProfileToAdd == nProfileToTruncateIntersectLineSeg ? &quot;main&quot; : &quot;co-incident&quot;) &lt;&lt; &quot; truncate-profile &quot; &lt;&lt; nProfileToAdd &lt;&lt; &quot;, line segment [&quot; &lt;&lt; nProfileToAddLineSeg + nIncr &lt;&lt; &quot;] to line segment &quot; &lt;&lt; nLineSeg &lt;&lt; &quot; of &quot; &lt;&lt; (nThisProfile == nProfileToRetain ? &quot;main&quot; : &quot;co-incident&quot;) &lt;&lt; &quot; to-retain profile &quot; &lt;&lt; nThisProfile &lt;&lt; endl;</span></div>
<div class="line"><a id="l02033" name="l02033"></a><span class="lineno"> 2033</span> </div>
<div class="line"><a id="l02034" name="l02034"></a><span class="lineno"> 2034</span>            pThisProfile-&gt;<a class="code hl_function" href="../../d0/d89/classCGeomMultiLine.html#add6b741fa71f3eae355876dcc4232ec8">AddCoincidentProfileToExistingLineSegment</a>(nLineSeg, nProfileToAdd, nProfileToAddLineSeg + nIncr);</div>
<div class="line"><a id="l02035" name="l02035"></a><span class="lineno"> 2035</span>         }</div>
<div class="line"><a id="l02036" name="l02036"></a><span class="lineno"> 2036</span>      }</div>
<div class="line"><a id="l02037" name="l02037"></a><span class="lineno"> 2037</span>   }</div>
<div class="line"><a id="l02038" name="l02038"></a><span class="lineno"> 2038</span> </div>
<div class="line"><a id="l02039" name="l02039"></a><span class="lineno"> 2039</span>   <span class="comment">// // DEBUG CODE ****************************************************************</span></div>
<div class="line"><a id="l02040" name="l02040"></a><span class="lineno"> 2040</span>   <span class="comment">// Get the index numbers of all coincident profiles for the &#39;main&#39; profile for the line segment in which intersection occurred</span></div>
<div class="line"><a id="l02041" name="l02041"></a><span class="lineno"> 2041</span>   <span class="comment">//    vector&lt;pair&lt;int, int&gt; &gt; prVCoincidentProfilesCHECK2 = *m_VCoast[nCoast].pGetProfile(nProfileToRetain)-&gt;pprVGetPairedCoincidentProfilesForLineSegment(nProfileToRetainIntersectLineSeg);</span></div>
<div class="line"><a id="l02042" name="l02042"></a><span class="lineno"> 2042</span>   <span class="comment">//    int nNumCoincidentCHECK2 = prVCoincidentProfilesCHECK2.size();</span></div>
<div class="line"><a id="l02043" name="l02043"></a><span class="lineno"> 2043</span>   <span class="comment">//    for (int nn = 0; nn &lt; nNumCoincidentCHECK2; nn++)</span></div>
<div class="line"><a id="l02044" name="l02044"></a><span class="lineno"> 2044</span>   <span class="comment">//    {</span></div>
<div class="line"><a id="l02045" name="l02045"></a><span class="lineno"> 2045</span>   <span class="comment">//       int nThisProfile = prVCoincidentProfilesCHECK2[nn].first;</span></div>
<div class="line"><a id="l02046" name="l02046"></a><span class="lineno"> 2046</span>   <span class="comment">//       LogStream &lt;&lt; &quot;\tAFTER nInsertPointIntoProfilesIfNeededThenUpdate(): &quot; &lt;&lt; (nThisProfile == nProfileToRetain ? &quot;MAIN&quot; : &quot;COINCIDENT&quot;) &lt;&lt; &quot; to-retain profile {&quot; &lt;&lt; nThisProfile &lt;&lt; &quot;} has &quot; &lt;&lt; m_VCoast[nCoast].pGetProfile(nThisProfile)-&gt;nGetProfileSize() &lt;&lt; &quot; points &quot;;</span></div>
<div class="line"><a id="l02047" name="l02047"></a><span class="lineno"> 2047</span>   <span class="comment">//       for (int nn = 0; nn &lt; m_VCoast[nCoast].pGetProfile(nThisProfile)-&gt;nGetProfileSize(); nn++)</span></div>
<div class="line"><a id="l02048" name="l02048"></a><span class="lineno"> 2048</span>   <span class="comment">//          LogStream &lt;&lt; &quot;[&quot; &lt;&lt; m_VCoast[nCoast].pGetProfile(nThisProfile)-&gt;pPtGetPointInProfile(nn)-&gt;dGetX() &lt;&lt; &quot;, &quot; &lt;&lt; m_VCoast[nCoast].pGetProfile(nThisProfile)-&gt;pPtGetPointInProfile(nn)-&gt;dGetY() &lt;&lt; &quot;] &quot;;</span></div>
<div class="line"><a id="l02049" name="l02049"></a><span class="lineno"> 2049</span>   <span class="comment">//       LogStream &lt;&lt; &quot;), and &quot; &lt;&lt; m_VCoast[nCoast].pGetProfile(nThisProfile)-&gt;nGetNumLineSegments() &lt;&lt; &quot; line segments, co-incident profiles and their line segments are &quot;;</span></div>
<div class="line"><a id="l02050" name="l02050"></a><span class="lineno"> 2050</span>   <span class="comment">//       for (int nLineSeg = 0; nLineSeg &lt; m_VCoast[nCoast].pGetProfile(nThisProfile)-&gt;nGetNumLineSegments(); nLineSeg++)</span></div>
<div class="line"><a id="l02051" name="l02051"></a><span class="lineno"> 2051</span>   <span class="comment">//       {</span></div>
<div class="line"><a id="l02052" name="l02052"></a><span class="lineno"> 2052</span>   <span class="comment">//          vector&lt;pair&lt;int, int&gt; &gt; prVTmp = *m_VCoast[nCoast].pGetProfile(nThisProfile)-&gt;pprVGetPairedCoincidentProfilesForLineSegment(nLineSeg);</span></div>
<div class="line"><a id="l02053" name="l02053"></a><span class="lineno"> 2053</span>   <span class="comment">//          LogStream &lt;&lt; &quot;{ &quot;;</span></div>
<div class="line"><a id="l02054" name="l02054"></a><span class="lineno"> 2054</span>   <span class="comment">//          for (int nn = 0; nn &lt; m_VCoast[nCoast].pGetProfile(nThisProfile)-&gt;nGetNumCoincidentProfilesInLineSegment(nLineSeg); nn++)</span></div>
<div class="line"><a id="l02055" name="l02055"></a><span class="lineno"> 2055</span>   <span class="comment">//             LogStream &lt;&lt; prVTmp[nn].first &lt;&lt; &quot;[&quot; &lt;&lt; prVTmp[nn].second &lt;&lt; &quot;] &quot;;</span></div>
<div class="line"><a id="l02056" name="l02056"></a><span class="lineno"> 2056</span>   <span class="comment">//          LogStream &lt;&lt; &quot;} &quot;;</span></div>
<div class="line"><a id="l02057" name="l02057"></a><span class="lineno"> 2057</span>   <span class="comment">//       }</span></div>
<div class="line"><a id="l02058" name="l02058"></a><span class="lineno"> 2058</span>   <span class="comment">//       LogStream &lt;&lt; endl;</span></div>
<div class="line"><a id="l02059" name="l02059"></a><span class="lineno"> 2059</span>   <span class="comment">//</span></div>
<div class="line"><a id="l02060" name="l02060"></a><span class="lineno"> 2060</span>   <span class="comment">//       for (int nPoint = 0; nPoint &lt; m_VCoast[nCoast].pGetProfile(nThisProfile)-&gt;nGetProfileSize()-1; nPoint++)</span></div>
<div class="line"><a id="l02061" name="l02061"></a><span class="lineno"> 2061</span>   <span class="comment">//       {</span></div>
<div class="line"><a id="l02062" name="l02062"></a><span class="lineno"> 2062</span>   <span class="comment">//          CGeom2DPoint</span></div>
<div class="line"><a id="l02063" name="l02063"></a><span class="lineno"> 2063</span>   <span class="comment">//             Pt1 = *m_VCoast[nCoast].pGetProfile(nThisProfile)-&gt;pPtGetPointInProfile(nPoint),</span></div>
<div class="line"><a id="l02064" name="l02064"></a><span class="lineno"> 2064</span>   <span class="comment">//             Pt2 = *m_VCoast[nCoast].pGetProfile(nThisProfile)-&gt;pPtGetPointInProfile(nPoint+1);</span></div>
<div class="line"><a id="l02065" name="l02065"></a><span class="lineno"> 2065</span>   <span class="comment">//</span></div>
<div class="line"><a id="l02066" name="l02066"></a><span class="lineno"> 2066</span>   <span class="comment">//          if (Pt1 == Pt2)</span></div>
<div class="line"><a id="l02067" name="l02067"></a><span class="lineno"> 2067</span>   <span class="comment">//             LogStream &lt;&lt; m_ulIter &lt;&lt; &quot;: IDENTICAL POINTS before changes, in profile {&quot; &lt;&lt; nThisProfile &lt;&lt; &quot;} points = &quot; &lt;&lt; nPoint &lt;&lt; &quot; and &quot; &lt;&lt; nPoint+1 &lt;&lt; endl;</span></div>
<div class="line"><a id="l02068" name="l02068"></a><span class="lineno"> 2068</span>   <span class="comment">//       }</span></div>
<div class="line"><a id="l02069" name="l02069"></a><span class="lineno"> 2069</span>   <span class="comment">//    }</span></div>
<div class="line"><a id="l02070" name="l02070"></a><span class="lineno"> 2070</span>   <span class="comment">// // DEBUG CODE ******************************************************************</span></div>
<div class="line"><a id="l02071" name="l02071"></a><span class="lineno"> 2071</span> </div>
<div class="line"><a id="l02072" name="l02072"></a><span class="lineno"> 2072</span>   <span class="keywordflow">return</span> <a class="code hl_variable" href="../../d6/d2a/cme_8h.html#aa768cb14b5c6123ee95e6e4ebd9fe331">RTN_OK</a>;</div>
<div class="line"><a id="l02073" name="l02073"></a><span class="lineno"> 2073</span>}</div>
</div>
<div class="line"><a id="l02074" name="l02074"></a><span class="lineno"> 2074</span> </div>
<div class="line"><a id="l02075" name="l02075"></a><span class="lineno"> 2075</span><span class="comment">//===============================================================================================================================</span></div>
<div class="line"><a id="l02077" name="l02077"></a><span class="lineno"> 2077</span><span class="comment">//===============================================================================================================================</span></div>
<div class="foldopen" id="foldopen02078" data-start="{" data-end="}">
<div class="line"><a id="l02078" name="l02078"></a><span class="lineno"><a class="line" href="../../d1/d98/classCSimulation.html#a9d247d1e2cdf21052d912096a0a5be25"> 2078</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="../../d1/d98/classCSimulation.html#a9d247d1e2cdf21052d912096a0a5be25">CSimulation::TruncateProfileAndAppendNew</a>(<span class="keywordtype">int</span> <span class="keyword">const</span> nCoast, <a class="code hl_class" href="../../da/dae/classCGeomProfile.html">CGeomProfile</a>* pProfileToRetain, <span class="keywordtype">int</span> <span class="keyword">const</span> nMainProfileIntersectLineSeg, vector&lt;CGeom2DPoint&gt; <span class="keyword">const</span>* pPtVProfileLastPart, vector&lt;vector&lt;pair&lt;int, int&gt;&gt;&gt; <span class="keyword">const</span>* pprVLineSegLastPart)</div>
<div class="line"><a id="l02079" name="l02079"></a><span class="lineno"> 2079</span>{</div>
<div class="line"><a id="l02080" name="l02080"></a><span class="lineno"> 2080</span>   <span class="comment">// // DEBUG CODE ****************************************************************</span></div>
<div class="line"><a id="l02081" name="l02081"></a><span class="lineno"> 2081</span>   <span class="comment">// Get the index numbers of all coincident profiles for the &#39;main&#39; profile for the line segment in which intersection occurred</span></div>
<div class="line"><a id="l02082" name="l02082"></a><span class="lineno"> 2082</span>   <span class="comment">//    vector&lt;pair&lt;int, int&gt; &gt; prVCoincidentProfilesCHECK1 = *m_VCoast[nCoast].pGetProfile(nMainProfile)-&gt;pprVGetPairedCoincidentProfilesForLineSegment(nMainProfileIntersectLineSeg);</span></div>
<div class="line"><a id="l02083" name="l02083"></a><span class="lineno"> 2083</span>   <span class="comment">//    int nNumCoincidentCHECK1 = prVCoincidentProfilesCHECK1.size();</span></div>
<div class="line"><a id="l02084" name="l02084"></a><span class="lineno"> 2084</span>   <span class="comment">//</span></div>
<div class="line"><a id="l02085" name="l02085"></a><span class="lineno"> 2085</span>   <span class="comment">//    LogStream &lt;&lt; &quot;\tTruncating profile {&quot; &lt;&lt; nMainProfile &lt;&lt; &quot;}, intersection is at [&quot; &lt;&lt; dIntersectX &lt;&lt; &quot;, &quot; &lt;&lt; dIntersectY &lt;&lt; &quot;] in line segment &quot; &lt;&lt; nMainProfileIntersectLineSeg &lt;&lt; endl;</span></div>
<div class="line"><a id="l02086" name="l02086"></a><span class="lineno"> 2086</span>   <span class="comment">//    for (int nn = 0; nn &lt; nNumCoincidentCHECK1; nn++)</span></div>
<div class="line"><a id="l02087" name="l02087"></a><span class="lineno"> 2087</span>   <span class="comment">//    {</span></div>
<div class="line"><a id="l02088" name="l02088"></a><span class="lineno"> 2088</span>   <span class="comment">//       int nThisProfile = prVCoincidentProfilesCHECK1[nn].first;</span></div>
<div class="line"><a id="l02089" name="l02089"></a><span class="lineno"> 2089</span>   <span class="comment">//       LogStream &lt;&lt; &quot;\tBEFORE TruncateProfileAndAppendNew(): &quot; &lt;&lt; (nThisProfile == nMainProfile ? &quot;MAIN&quot; : &quot;COINCIDENT&quot;) &lt;&lt; &quot; to-truncate profile {&quot; &lt;&lt; nThisProfile &lt;&lt; &quot;} has &quot; &lt;&lt; m_VCoast[nCoast].pGetProfile(nThisProfile)-&gt;nGetProfileSize() &lt;&lt; &quot; points (&quot;;</span></div>
<div class="line"><a id="l02090" name="l02090"></a><span class="lineno"> 2090</span>   <span class="comment">//       for (int nn = 0; nn &lt; m_VCoast[nCoast].pGetProfile(nThisProfile)-&gt;nGetProfileSize(); nn++)</span></div>
<div class="line"><a id="l02091" name="l02091"></a><span class="lineno"> 2091</span>   <span class="comment">//          LogStream &lt;&lt; &quot;[&quot; &lt;&lt; m_VCoast[nCoast].pGetProfile(nThisProfile)-&gt;pPtGetPointInProfile(nn)-&gt;dGetX() &lt;&lt; &quot;, &quot; &lt;&lt; m_VCoast[nCoast].pGetProfile(nThisProfile)-&gt;pPtGetPointInProfile(nn)-&gt;dGetY() &lt;&lt; &quot;] &quot;;</span></div>
<div class="line"><a id="l02092" name="l02092"></a><span class="lineno"> 2092</span>   <span class="comment">//       LogStream &lt;&lt; &quot;), and &quot; &lt;&lt; m_VCoast[nCoast].pGetProfile(nThisProfile)-&gt;nGetNumLineSegments() &lt;&lt; &quot; line segments, co-incident profiles are &quot;;</span></div>
<div class="line"><a id="l02093" name="l02093"></a><span class="lineno"> 2093</span>   <span class="comment">//       for (int nLineSeg = 0; nLineSeg &lt; m_VCoast[nCoast].pGetProfile(nThisProfile)-&gt;nGetNumLineSegments(); nLineSeg++)</span></div>
<div class="line"><a id="l02094" name="l02094"></a><span class="lineno"> 2094</span>   <span class="comment">//       {</span></div>
<div class="line"><a id="l02095" name="l02095"></a><span class="lineno"> 2095</span>   <span class="comment">//          vector&lt;pair&lt;int, int&gt; &gt; prVTmp = *m_VCoast[nCoast].pGetProfile(nThisProfile)-&gt;pprVGetPairedCoincidentProfilesForLineSegment(nLineSeg);</span></div>
<div class="line"><a id="l02096" name="l02096"></a><span class="lineno"> 2096</span>   <span class="comment">//          LogStream &lt;&lt; &quot;{ &quot;;</span></div>
<div class="line"><a id="l02097" name="l02097"></a><span class="lineno"> 2097</span>   <span class="comment">//          for (int nn = 0; nn &lt; m_VCoast[nCoast].pGetProfile(nThisProfile)-&gt;nGetNumCoincidentProfilesInLineSegment(nLineSeg); nn++)</span></div>
<div class="line"><a id="l02098" name="l02098"></a><span class="lineno"> 2098</span>   <span class="comment">//             LogStream &lt;&lt; prVTmp[nn].first &lt;&lt; &quot;[&quot; &lt;&lt; prVTmp[nn].second &lt;&lt; &quot;] &quot;;</span></div>
<div class="line"><a id="l02099" name="l02099"></a><span class="lineno"> 2099</span>   <span class="comment">//          LogStream &lt;&lt; &quot;} &quot;;</span></div>
<div class="line"><a id="l02100" name="l02100"></a><span class="lineno"> 2100</span>   <span class="comment">//       }</span></div>
<div class="line"><a id="l02101" name="l02101"></a><span class="lineno"> 2101</span>   <span class="comment">//       LogStream &lt;&lt; endl;</span></div>
<div class="line"><a id="l02102" name="l02102"></a><span class="lineno"> 2102</span>   <span class="comment">//</span></div>
<div class="line"><a id="l02103" name="l02103"></a><span class="lineno"> 2103</span>   <span class="comment">//       for (int nPoint = 0; nPoint &lt; m_VCoast[nCoast].pGetProfile(nThisProfile)-&gt;nGetProfileSize()-1; nPoint++)</span></div>
<div class="line"><a id="l02104" name="l02104"></a><span class="lineno"> 2104</span>   <span class="comment">//       {</span></div>
<div class="line"><a id="l02105" name="l02105"></a><span class="lineno"> 2105</span>   <span class="comment">//          CGeom2DPoint</span></div>
<div class="line"><a id="l02106" name="l02106"></a><span class="lineno"> 2106</span>   <span class="comment">//             Pt1 = *m_VCoast[nCoast].pGetProfile(nThisProfile)-&gt;pPtGetPointInProfile(nPoint),</span></div>
<div class="line"><a id="l02107" name="l02107"></a><span class="lineno"> 2107</span>   <span class="comment">//             Pt2 = *m_VCoast[nCoast].pGetProfile(nThisProfile)-&gt;pPtGetPointInProfile(nPoint+1);</span></div>
<div class="line"><a id="l02108" name="l02108"></a><span class="lineno"> 2108</span>   <span class="comment">//</span></div>
<div class="line"><a id="l02109" name="l02109"></a><span class="lineno"> 2109</span>   <span class="comment">//          if (Pt1 == Pt2)</span></div>
<div class="line"><a id="l02110" name="l02110"></a><span class="lineno"> 2110</span>   <span class="comment">//             LogStream &lt;&lt; m_ulIter &lt;&lt; &quot;: IDENTICAL POINTS before changes, in profile {&quot; &lt;&lt; nThisProfile &lt;&lt; &quot;} points = &quot; &lt;&lt; nPoint &lt;&lt; &quot; and &quot; &lt;&lt; nPoint+1 &lt;&lt; endl;</span></div>
<div class="line"><a id="l02111" name="l02111"></a><span class="lineno"> 2111</span>   <span class="comment">//       }</span></div>
<div class="line"><a id="l02112" name="l02112"></a><span class="lineno"> 2112</span>   <span class="comment">//    }</span></div>
<div class="line"><a id="l02113" name="l02113"></a><span class="lineno"> 2113</span>   <span class="comment">//    LogStream &lt;&lt; &quot;\tPart-profile to append is &quot;;</span></div>
<div class="line"><a id="l02114" name="l02114"></a><span class="lineno"> 2114</span>   <span class="comment">//    for (int mm = 0; mm &lt; pPtVProfileLastPart-&gt;size(); mm++)</span></div>
<div class="line"><a id="l02115" name="l02115"></a><span class="lineno"> 2115</span>   <span class="comment">//       LogStream &lt;&lt; &quot;[&quot; &lt;&lt; pPtVProfileLastPart-&gt;at(mm).dGetX() &lt;&lt; &quot;, &quot; &lt;&lt; pPtVProfileLastPart-&gt;at(mm).dGetY() &lt;&lt; &quot;] &quot;;</span></div>
<div class="line"><a id="l02116" name="l02116"></a><span class="lineno"> 2116</span>   <span class="comment">//    LogStream &lt;&lt; endl;</span></div>
<div class="line"><a id="l02117" name="l02117"></a><span class="lineno"> 2117</span>   <span class="comment">//    LogStream &lt;&lt; &quot;\tPart line-segment to append is &quot;;</span></div>
<div class="line"><a id="l02118" name="l02118"></a><span class="lineno"> 2118</span>   <span class="comment">//    for (int mm = 0; mm &lt; pprVLineSegLastPart-&gt;size(); mm++)</span></div>
<div class="line"><a id="l02119" name="l02119"></a><span class="lineno"> 2119</span>   <span class="comment">//    {</span></div>
<div class="line"><a id="l02120" name="l02120"></a><span class="lineno"> 2120</span>   <span class="comment">//       vector&lt;pair&lt;int, int&gt; &gt; prVTmp = pprVLineSegLastPart-&gt;at(mm);</span></div>
<div class="line"><a id="l02121" name="l02121"></a><span class="lineno"> 2121</span>   <span class="comment">//       LogStream &lt;&lt; &quot;{ &quot;;</span></div>
<div class="line"><a id="l02122" name="l02122"></a><span class="lineno"> 2122</span>   <span class="comment">//       for (int nn = 0; nn &lt; prVTmp.size(); nn++)</span></div>
<div class="line"><a id="l02123" name="l02123"></a><span class="lineno"> 2123</span>   <span class="comment">//          LogStream &lt;&lt; prVTmp[nn].first &lt;&lt; &quot;[&quot; &lt;&lt; prVTmp[nn].second &lt;&lt; &quot;] &quot;;</span></div>
<div class="line"><a id="l02124" name="l02124"></a><span class="lineno"> 2124</span>   <span class="comment">//       LogStream &lt;&lt; &quot;} &quot;;</span></div>
<div class="line"><a id="l02125" name="l02125"></a><span class="lineno"> 2125</span>   <span class="comment">//    }</span></div>
<div class="line"><a id="l02126" name="l02126"></a><span class="lineno"> 2126</span>   <span class="comment">//    LogStream &lt;&lt; endl;</span></div>
<div class="line"><a id="l02127" name="l02127"></a><span class="lineno"> 2127</span>   <span class="comment">// // DEBUG CODE ******************************************************************</span></div>
<div class="line"><a id="l02128" name="l02128"></a><span class="lineno"> 2128</span> </div>
<div class="line"><a id="l02129" name="l02129"></a><span class="lineno"> 2129</span>   <span class="comment">// Get the index numbers of all coincident profiles for the &#39;main&#39; profile for the line segment in which intersection occurs</span></div>
<div class="line"><a id="l02130" name="l02130"></a><span class="lineno"> 2130</span>   vector&lt;pair&lt;int, int&gt;&gt; prVCoincidentProfiles = *pProfileToRetain-&gt;<a class="code hl_function" href="../../d0/d89/classCGeomMultiLine.html#ab0146cd34539f41588924571dbfb2054">pprVGetPairedCoincidentProfilesForLineSegment</a>(nMainProfileIntersectLineSeg);</div>
<div class="line"><a id="l02131" name="l02131"></a><span class="lineno"> 2131</span>   <span class="keywordtype">int</span> nNumCoincident = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(prVCoincidentProfiles.size());</div>
<div class="line"><a id="l02132" name="l02132"></a><span class="lineno"> 2132</span> </div>
<div class="line"><a id="l02133" name="l02133"></a><span class="lineno"> 2133</span>   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> nn = 0; nn &lt; nNumCoincident; nn++)</div>
<div class="line"><a id="l02134" name="l02134"></a><span class="lineno"> 2134</span>   {</div>
<div class="line"><a id="l02135" name="l02135"></a><span class="lineno"> 2135</span>      <span class="comment">// Do this for the main to-truncate profile, and do the same for all its co-incident profiles</span></div>
<div class="line"><a id="l02136" name="l02136"></a><span class="lineno"> 2136</span>      <span class="keywordtype">int</span> nThisProfile = prVCoincidentProfiles[nn].first;</div>
<div class="line"><a id="l02137" name="l02137"></a><span class="lineno"> 2137</span>      <span class="keywordtype">int</span> nThisProfileLineSeg = prVCoincidentProfiles[nn].second;</div>
<div class="line"><a id="l02138" name="l02138"></a><span class="lineno"> 2138</span>      <a class="code hl_class" href="../../da/dae/classCGeomProfile.html">CGeomProfile</a>* pThisProfile = <a class="code hl_variable" href="../../d1/d98/classCSimulation.html#a25ada8139c82ca7beab3f279cff83184">m_VCoast</a>[nCoast].pGetProfile(nThisProfile);</div>
<div class="line"><a id="l02139" name="l02139"></a><span class="lineno"> 2139</span> </div>
<div class="line"><a id="l02140" name="l02140"></a><span class="lineno"> 2140</span>      <span class="comment">//       if (nThisProfile == nMainProfile)</span></div>
<div class="line"><a id="l02141" name="l02141"></a><span class="lineno"> 2141</span>      <span class="comment">//          assert(nThisProfileLineSeg == nMainProfileIntersectLineSeg);</span></div>
<div class="line"><a id="l02142" name="l02142"></a><span class="lineno"> 2142</span> </div>
<div class="line"><a id="l02143" name="l02143"></a><span class="lineno"> 2143</span>      <span class="comment">// Truncate the profile</span></div>
<div class="line"><a id="l02144" name="l02144"></a><span class="lineno"> 2144</span>      <span class="comment">//      LogStream &lt;&lt; &quot;\tTruncating &quot; &lt;&lt; (nThisProfile == nMainProfile ? &quot;MAIN&quot; : &quot;COINCIDENT&quot;) &lt;&lt; &quot; to-truncate profile {&quot; &lt;&lt; nThisProfile &lt;&lt; &quot;} at line segment &quot; &lt;&lt; nThisProfileLineSeg+1 &lt;&lt; endl;</span></div>
<div class="line"><a id="l02145" name="l02145"></a><span class="lineno"> 2145</span>      pThisProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#a0abde0df28990b1a8c20664d2bdcb07f">TruncateProfile</a>(nThisProfileLineSeg + 1);</div>
<div class="line"><a id="l02146" name="l02146"></a><span class="lineno"> 2146</span> </div>
<div class="line"><a id="l02147" name="l02147"></a><span class="lineno"> 2147</span>      <span class="comment">// Reduce the number of line segments for this profile</span></div>
<div class="line"><a id="l02148" name="l02148"></a><span class="lineno"> 2148</span>      pThisProfile-&gt;<a class="code hl_function" href="../../d0/d89/classCGeomMultiLine.html#a5b5c8a7d272d53dd98279480f7a6a976">TruncateLineSegments</a>(nThisProfileLineSeg + 1);</div>
<div class="line"><a id="l02149" name="l02149"></a><span class="lineno"> 2149</span> </div>
<div class="line"><a id="l02150" name="l02150"></a><span class="lineno"> 2150</span>      <span class="comment">// Append the profile points from the last part of the retain-profile</span></div>
<div class="line"><a id="l02151" name="l02151"></a><span class="lineno"> 2151</span>      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> mm = 0; mm &lt; pPtVProfileLastPart-&gt;size(); mm++)</div>
<div class="line"><a id="l02152" name="l02152"></a><span class="lineno"> 2152</span>      {</div>
<div class="line"><a id="l02153" name="l02153"></a><span class="lineno"> 2153</span>         <a class="code hl_class" href="../../d5/d4e/classCGeom2DPoint.html">CGeom2DPoint</a> Pt = pPtVProfileLastPart-&gt;at(mm);</div>
<div class="line"><a id="l02154" name="l02154"></a><span class="lineno"> 2154</span>         pThisProfile-&gt;<a class="code hl_function" href="../../da/dae/classCGeomProfile.html#a19aac71e045a17e2c6d98f020f2319fa">AppendPointInProfile</a>(&amp;Pt);</div>
<div class="line"><a id="l02155" name="l02155"></a><span class="lineno"> 2155</span>      }</div>
<div class="line"><a id="l02156" name="l02156"></a><span class="lineno"> 2156</span> </div>
<div class="line"><a id="l02157" name="l02157"></a><span class="lineno"> 2157</span>      <span class="comment">// Append the line segments, and their co-incident profile numbers, from the last part of the retain-profile</span></div>
<div class="line"><a id="l02158" name="l02158"></a><span class="lineno"> 2158</span>      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> mm = 0; mm &lt; pprVLineSegLastPart-&gt;size(); mm++)</div>
<div class="line"><a id="l02159" name="l02159"></a><span class="lineno"> 2159</span>      {</div>
<div class="line"><a id="l02160" name="l02160"></a><span class="lineno"> 2160</span>         vector&lt;pair&lt;int, int&gt;&gt; prVTmp = pprVLineSegLastPart-&gt;at(mm);</div>
<div class="line"><a id="l02161" name="l02161"></a><span class="lineno"> 2161</span> </div>
<div class="line"><a id="l02162" name="l02162"></a><span class="lineno"> 2162</span>         pThisProfile-&gt;<a class="code hl_function" href="../../d0/d89/classCGeomMultiLine.html#a3f99a9c2ac66b75c432941ec88fc8538">AppendLineSegment</a>(&amp;prVTmp);</div>
<div class="line"><a id="l02163" name="l02163"></a><span class="lineno"> 2163</span>      }</div>
<div class="line"><a id="l02164" name="l02164"></a><span class="lineno"> 2164</span> </div>
<div class="line"><a id="l02165" name="l02165"></a><span class="lineno"> 2165</span>      <span class="comment">// Fix the line seg numbers for this profile</span></div>
<div class="line"><a id="l02166" name="l02166"></a><span class="lineno"> 2166</span>      vector&lt;int&gt; nVProf;</div>
<div class="line"><a id="l02167" name="l02167"></a><span class="lineno"> 2167</span>      vector&lt;int&gt; nVProfsLineSeg;</div>
<div class="line"><a id="l02168" name="l02168"></a><span class="lineno"> 2168</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> nSeg = 0; nSeg &lt; pThisProfile-&gt;<a class="code hl_function" href="../../d0/d89/classCGeomMultiLine.html#ae22f845fd065108959610678de571cdb">nGetNumLineSegments</a>(); nSeg++)</div>
<div class="line"><a id="l02169" name="l02169"></a><span class="lineno"> 2169</span>      {</div>
<div class="line"><a id="l02170" name="l02170"></a><span class="lineno"> 2170</span>         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> nCoinc = 0; nCoinc &lt; pThisProfile-&gt;<a class="code hl_function" href="../../d0/d89/classCGeomMultiLine.html#a3516022bd96ee15709653b3bb7cc0155">nGetNumCoincidentProfilesInLineSegment</a>(nSeg); nCoinc++)</div>
<div class="line"><a id="l02171" name="l02171"></a><span class="lineno"> 2171</span>         {</div>
<div class="line"><a id="l02172" name="l02172"></a><span class="lineno"> 2172</span>            <span class="keywordtype">int</span> nProf = pThisProfile-&gt;<a class="code hl_function" href="../../d0/d89/classCGeomMultiLine.html#a5682956da0d84c928fbafa6f4ff25201">nGetProf</a>(nSeg, nCoinc);</div>
<div class="line"><a id="l02173" name="l02173"></a><span class="lineno"> 2173</span>            <span class="keywordtype">int</span> nProfsLineSeg = pThisProfile-&gt;<a class="code hl_function" href="../../d0/d89/classCGeomMultiLine.html#a0598f98c4103cde329147da13ded7c61">nGetProfsLineSeg</a>(nSeg, nCoinc);</div>
<div class="line"><a id="l02174" name="l02174"></a><span class="lineno"> 2174</span> </div>
<div class="line"><a id="l02175" name="l02175"></a><span class="lineno"> 2175</span>            <span class="keyword">auto</span> it = find(nVProf.begin(), nVProf.end(), nProf);</div>
<div class="line"><a id="l02176" name="l02176"></a><span class="lineno"> 2176</span>            <span class="keywordflow">if</span> (it == nVProf.end())</div>
<div class="line"><a id="l02177" name="l02177"></a><span class="lineno"> 2177</span>            {</div>
<div class="line"><a id="l02178" name="l02178"></a><span class="lineno"> 2178</span>               <span class="comment">// Not found</span></div>
<div class="line"><a id="l02179" name="l02179"></a><span class="lineno"> 2179</span>               nVProf.push_back(nProf);</div>
<div class="line"><a id="l02180" name="l02180"></a><span class="lineno"> 2180</span>               nVProfsLineSeg.push_back(nProfsLineSeg);</div>
<div class="line"><a id="l02181" name="l02181"></a><span class="lineno"> 2181</span>            }</div>
<div class="line"><a id="l02182" name="l02182"></a><span class="lineno"> 2182</span>            <span class="keywordflow">else</span></div>
<div class="line"><a id="l02183" name="l02183"></a><span class="lineno"> 2183</span>            {</div>
<div class="line"><a id="l02184" name="l02184"></a><span class="lineno"> 2184</span>               <span class="comment">// Found</span></div>
<div class="line"><a id="l02185" name="l02185"></a><span class="lineno"> 2185</span>               <span class="keywordtype">int</span> nPos = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(it - nVProf.begin());</div>
<div class="line"><a id="l02186" name="l02186"></a><span class="lineno"> 2186</span>               <span class="keywordtype">int</span> nNewProfsLineSeg = nVProfsLineSeg[nPos];</div>
<div class="line"><a id="l02187" name="l02187"></a><span class="lineno"> 2187</span>               nNewProfsLineSeg++;</div>
<div class="line"><a id="l02188" name="l02188"></a><span class="lineno"> 2188</span> </div>
<div class="line"><a id="l02189" name="l02189"></a><span class="lineno"> 2189</span>               nVProfsLineSeg[nPos] = nNewProfsLineSeg;</div>
<div class="line"><a id="l02190" name="l02190"></a><span class="lineno"> 2190</span>               pThisProfile-&gt;<a class="code hl_function" href="../../d0/d89/classCGeomMultiLine.html#aaf7c0ab9f64c31133be98ac87b114072">SetProfsLineSeg</a>(nSeg, nCoinc, nNewProfsLineSeg);</div>
<div class="line"><a id="l02191" name="l02191"></a><span class="lineno"> 2191</span>            }</div>
<div class="line"><a id="l02192" name="l02192"></a><span class="lineno"> 2192</span>         }</div>
<div class="line"><a id="l02193" name="l02193"></a><span class="lineno"> 2193</span>      }</div>
<div class="line"><a id="l02194" name="l02194"></a><span class="lineno"> 2194</span> </div>
<div class="line"><a id="l02195" name="l02195"></a><span class="lineno"> 2195</span>      <span class="comment">//       assert(pThisProfile-&gt;nGetProfileSize() &gt; 1);</span></div>
<div class="line"><a id="l02196" name="l02196"></a><span class="lineno"> 2196</span>   }</div>
<div class="line"><a id="l02197" name="l02197"></a><span class="lineno"> 2197</span> </div>
<div class="line"><a id="l02198" name="l02198"></a><span class="lineno"> 2198</span>   <span class="comment">// // DEBUG CODE ****************************************************************</span></div>
<div class="line"><a id="l02199" name="l02199"></a><span class="lineno"> 2199</span>   <span class="comment">// Get the index numbers of all coincident profiles for the &#39;main&#39; to-truncate profile for the line segment in which intersection occurred</span></div>
<div class="line"><a id="l02200" name="l02200"></a><span class="lineno"> 2200</span>   <span class="comment">//    vector&lt;pair&lt;int, int&gt; &gt; prVToTruncateCoincidentProfilesCHECK2 = *m_VCoast[nCoast].pGetProfile(nMainProfile)-&gt;pprVGetPairedCoincidentProfilesForLineSegment(nMainProfileIntersectLineSeg);</span></div>
<div class="line"><a id="l02201" name="l02201"></a><span class="lineno"> 2201</span>   <span class="comment">//    int nNumToTruncateCoincidentCHECK2 = prVToTruncateCoincidentProfilesCHECK2.size();</span></div>
<div class="line"><a id="l02202" name="l02202"></a><span class="lineno"> 2202</span>   <span class="comment">//    for (int nn = 0; nn &lt; nNumToTruncateCoincidentCHECK2; nn++)</span></div>
<div class="line"><a id="l02203" name="l02203"></a><span class="lineno"> 2203</span>   <span class="comment">//    {</span></div>
<div class="line"><a id="l02204" name="l02204"></a><span class="lineno"> 2204</span>   <span class="comment">//       int nThisProfile = prVToTruncateCoincidentProfilesCHECK2[nn].first;</span></div>
<div class="line"><a id="l02205" name="l02205"></a><span class="lineno"> 2205</span>   <span class="comment">//       LogStream &lt;&lt; &quot;\tAFTER TruncateProfileAndAppendNew(): &quot; &lt;&lt; (nThisProfile == nMainProfile ? &quot;MAIN&quot; : &quot;COINCIDENT&quot;) &lt;&lt; &quot; to-truncate profile {&quot; &lt;&lt; nThisProfile &lt;&lt; &quot;} has &quot; &lt;&lt; m_VCoast[nCoast].pGetProfile(nThisProfile)-&gt;nGetProfileSize() &lt;&lt; &quot; points (&quot;;</span></div>
<div class="line"><a id="l02206" name="l02206"></a><span class="lineno"> 2206</span>   <span class="comment">//       for (int nn = 0; nn &lt; m_VCoast[nCoast].pGetProfile(nThisProfile)-&gt;nGetProfileSize(); nn++)</span></div>
<div class="line"><a id="l02207" name="l02207"></a><span class="lineno"> 2207</span>   <span class="comment">//          LogStream &lt;&lt; &quot;[&quot; &lt;&lt; m_VCoast[nCoast].pGetProfile(nThisProfile)-&gt;pPtGetPointInProfile(nn)-&gt;dGetX() &lt;&lt; &quot;, &quot; &lt;&lt; m_VCoast[nCoast].pGetProfile(nThisProfile)-&gt;pPtGetPointInProfile(nn)-&gt;dGetY() &lt;&lt; &quot;] &quot;;</span></div>
<div class="line"><a id="l02208" name="l02208"></a><span class="lineno"> 2208</span>   <span class="comment">//       LogStream &lt;&lt; &quot;), and &quot; &lt;&lt; m_VCoast[nCoast].pGetProfile(nThisProfile)-&gt;nGetNumLineSegments() &lt;&lt; &quot; line segments, co-incident profiles are &quot;;</span></div>
<div class="line"><a id="l02209" name="l02209"></a><span class="lineno"> 2209</span>   <span class="comment">//       for (int mm = 0; mm &lt; m_VCoast[nCoast].pGetProfile(nThisProfile)-&gt;nGetNumLineSegments(); mm++)</span></div>
<div class="line"><a id="l02210" name="l02210"></a><span class="lineno"> 2210</span>   <span class="comment">//       {</span></div>
<div class="line"><a id="l02211" name="l02211"></a><span class="lineno"> 2211</span>   <span class="comment">//          vector&lt;pair&lt;int, int&gt; &gt; prVTmp = *m_VCoast[nCoast].pGetProfile(nThisProfile)-&gt;pprVGetPairedCoincidentProfilesForLineSegment(mm);</span></div>
<div class="line"><a id="l02212" name="l02212"></a><span class="lineno"> 2212</span>   <span class="comment">//          LogStream &lt;&lt; &quot;{ &quot;;</span></div>
<div class="line"><a id="l02213" name="l02213"></a><span class="lineno"> 2213</span>   <span class="comment">//          for (int nn = 0; nn &lt; m_VCoast[nCoast].pGetProfile(nThisProfile)-&gt;nGetNumCoincidentProfilesInLineSegment(mm); nn++)</span></div>
<div class="line"><a id="l02214" name="l02214"></a><span class="lineno"> 2214</span>   <span class="comment">//             LogStream &lt;&lt; prVTmp[nn].first &lt;&lt; &quot;[&quot; &lt;&lt; prVTmp[nn].second &lt;&lt; &quot;] &quot;;</span></div>
<div class="line"><a id="l02215" name="l02215"></a><span class="lineno"> 2215</span>   <span class="comment">//          LogStream &lt;&lt; &quot;} &quot;;</span></div>
<div class="line"><a id="l02216" name="l02216"></a><span class="lineno"> 2216</span>   <span class="comment">//       }</span></div>
<div class="line"><a id="l02217" name="l02217"></a><span class="lineno"> 2217</span>   <span class="comment">//       LogStream &lt;&lt; endl;</span></div>
<div class="line"><a id="l02218" name="l02218"></a><span class="lineno"> 2218</span>   <span class="comment">//</span></div>
<div class="line"><a id="l02219" name="l02219"></a><span class="lineno"> 2219</span>   <span class="comment">//       for (int nPoint = 0; nPoint &lt; m_VCoast[nCoast].pGetProfile(nThisProfile)-&gt;nGetProfileSize()-1; nPoint++)</span></div>
<div class="line"><a id="l02220" name="l02220"></a><span class="lineno"> 2220</span>   <span class="comment">//       {</span></div>
<div class="line"><a id="l02221" name="l02221"></a><span class="lineno"> 2221</span>   <span class="comment">//          CGeom2DPoint</span></div>
<div class="line"><a id="l02222" name="l02222"></a><span class="lineno"> 2222</span>   <span class="comment">//             Pt1 = *m_VCoast[nCoast].pGetProfile(nThisProfile)-&gt;pPtGetPointInProfile(nPoint),</span></div>
<div class="line"><a id="l02223" name="l02223"></a><span class="lineno"> 2223</span>   <span class="comment">//             Pt2 = *m_VCoast[nCoast].pGetProfile(nThisProfile)-&gt;pPtGetPointInProfile(nPoint+1);</span></div>
<div class="line"><a id="l02224" name="l02224"></a><span class="lineno"> 2224</span>   <span class="comment">//</span></div>
<div class="line"><a id="l02225" name="l02225"></a><span class="lineno"> 2225</span>   <span class="comment">//          if (Pt1 == Pt2)</span></div>
<div class="line"><a id="l02226" name="l02226"></a><span class="lineno"> 2226</span>   <span class="comment">//             LogStream &lt;&lt; m_ulIter &lt;&lt; &quot;: IDENTICAL POINTS before changes, in profile {&quot; &lt;&lt; nThisProfile &lt;&lt; &quot;} points = &quot; &lt;&lt; nPoint &lt;&lt; &quot; and &quot; &lt;&lt; nPoint+1 &lt;&lt; endl;</span></div>
<div class="line"><a id="l02227" name="l02227"></a><span class="lineno"> 2227</span>   <span class="comment">//       }</span></div>
<div class="line"><a id="l02228" name="l02228"></a><span class="lineno"> 2228</span>   <span class="comment">//    }</span></div>
<div class="line"><a id="l02229" name="l02229"></a><span class="lineno"> 2229</span>   <span class="comment">// // DEBUG CODE ******************************************************************</span></div>
<div class="line"><a id="l02230" name="l02230"></a><span class="lineno"> 2230</span>}</div>
</div>
<div class="ttc" id="aclassCA2DShape_html_a20acae762de7cf6769eb938621f6a842"><div class="ttname"><a href="../../d9/d0e/classCA2DShape.html#a20acae762de7cf6769eb938621f6a842">CA2DShape::pPtVGetPoints</a></div><div class="ttdeci">vector&lt; CGeom2DPoint &gt; * pPtVGetPoints(void)</div><div class="ttdoc">Returns the address of the vector which represents this 2D shape.</div><div class="ttdef"><b>Definition</b> <a href="../../da/dfd/2d__shape_8cpp_source.html#l00130">2d_shape.cpp:130</a></div></div>
<div class="ttc" id="aclassCGeom2DIPoint_html"><div class="ttname"><a href="../../d6/d0d/classCGeom2DIPoint.html">CGeom2DIPoint</a></div><div class="ttdoc">Geometry class used to represent 2D point objects with integer coordinates.</div><div class="ttdef"><b>Definition</b> <a href="../../d2/d66/2di__point_8h_source.html#l00028">2di_point.h:29</a></div></div>
<div class="ttc" id="aclassCGeom2DIPoint_html_a4d9c20bcca90dcb9d519b664aba09cbd"><div class="ttname"><a href="../../d6/d0d/classCGeom2DIPoint.html#a4d9c20bcca90dcb9d519b664aba09cbd">CGeom2DIPoint::nGetY</a></div><div class="ttdeci">int nGetY(void) const</div><div class="ttdoc">Returns the CGeom2DIPoint object&#39;s integer Y coordinate.</div><div class="ttdef"><b>Definition</b> <a href="../../d8/dc5/2di__point_8cpp_source.html#l00048">2di_point.cpp:48</a></div></div>
<div class="ttc" id="aclassCGeom2DIPoint_html_a5ffded2cbbf18f6f3e6595824476b727"><div class="ttname"><a href="../../d6/d0d/classCGeom2DIPoint.html#a5ffded2cbbf18f6f3e6595824476b727">CGeom2DIPoint::SetXY</a></div><div class="ttdeci">void SetXY(int const, int const)</div><div class="ttdoc">The two integer parameters set values for the CGeom2DIPoint object&#39;s X and Y coordinates.</div><div class="ttdef"><b>Definition</b> <a href="../../d8/dc5/2di__point_8cpp_source.html#l00078">2di_point.cpp:78</a></div></div>
<div class="ttc" id="aclassCGeom2DIPoint_html_af84c687b2d0be01ab41cbcc0565f4f3f"><div class="ttname"><a href="../../d6/d0d/classCGeom2DIPoint.html#af84c687b2d0be01ab41cbcc0565f4f3f">CGeom2DIPoint::nGetX</a></div><div class="ttdeci">int nGetX(void) const</div><div class="ttdoc">Returns the CGeom2DIPoint object&#39;s integer X coordinate.</div><div class="ttdef"><b>Definition</b> <a href="../../d8/dc5/2di__point_8cpp_source.html#l00042">2di_point.cpp:42</a></div></div>
<div class="ttc" id="aclassCGeom2DPoint_html"><div class="ttname"><a href="../../d5/d4e/classCGeom2DPoint.html">CGeom2DPoint</a></div><div class="ttdoc">Geometry class used to represent 2D point objects with floating-point coordinates.</div><div class="ttdef"><b>Definition</b> <a href="../../d0/dee/2d__point_8h_source.html#l00026">2d_point.h:27</a></div></div>
<div class="ttc" id="aclassCGeom2DPoint_html_a1dff4e8adee61e6fe5c5062d6ba88f01"><div class="ttname"><a href="../../d5/d4e/classCGeom2DPoint.html#a1dff4e8adee61e6fe5c5062d6ba88f01">CGeom2DPoint::SetY</a></div><div class="ttdeci">void SetY(double const)</div><div class="ttdoc">The double parameter sets a value for the CGeom2DIPoint object&#39;s Y coordinate.</div><div class="ttdef"><b>Definition</b> <a href="../../d2/d81/2d__point_8cpp_source.html#l00058">2d_point.cpp:58</a></div></div>
<div class="ttc" id="aclassCGeom2DPoint_html_a216921dc2c592d9468e6430fee7c7719"><div class="ttname"><a href="../../d5/d4e/classCGeom2DPoint.html#a216921dc2c592d9468e6430fee7c7719">CGeom2DPoint::dGetY</a></div><div class="ttdeci">double dGetY(void) const</div><div class="ttdoc">Returns the CGeom2DPoint object&#39;s double Y coordinate.</div><div class="ttdef"><b>Definition</b> <a href="../../d2/d81/2d__point_8cpp_source.html#l00046">2d_point.cpp:46</a></div></div>
<div class="ttc" id="aclassCGeom2DPoint_html_a250f937d03cfdf6e0244b74ad2bf96a4"><div class="ttname"><a href="../../d5/d4e/classCGeom2DPoint.html#a250f937d03cfdf6e0244b74ad2bf96a4">CGeom2DPoint::dGetX</a></div><div class="ttdeci">double dGetX(void) const</div><div class="ttdoc">Returns the CGeom2DPoint object&#39;s double X coordinate.</div><div class="ttdef"><b>Definition</b> <a href="../../d2/d81/2d__point_8cpp_source.html#l00040">2d_point.cpp:40</a></div></div>
<div class="ttc" id="aclassCGeom2DPoint_html_af5dfdef4b78c0703800049b064483278"><div class="ttname"><a href="../../d5/d4e/classCGeom2DPoint.html#af5dfdef4b78c0703800049b064483278">CGeom2DPoint::SetX</a></div><div class="ttdeci">void SetX(double const)</div><div class="ttdoc">The double parameter sets a value for the CGeom2DIPoint object&#39;s X coordinate.</div><div class="ttdef"><b>Definition</b> <a href="../../d2/d81/2d__point_8cpp_source.html#l00052">2d_point.cpp:52</a></div></div>
<div class="ttc" id="aclassCGeomMultiLine_html_a0598f98c4103cde329147da13ded7c61"><div class="ttname"><a href="../../d0/d89/classCGeomMultiLine.html#a0598f98c4103cde329147da13ded7c61">CGeomMultiLine::nGetProfsLineSeg</a></div><div class="ttdeci">int nGetProfsLineSeg(int const, int const) const</div><div class="ttdoc">Returns the profile&#39;s own line segment, given a line segment and the index of the co-incident profile...</div><div class="ttdef"><b>Definition</b> <a href="../../db/d80/multi__line_8cpp_source.html#l00259">multi_line.cpp:259</a></div></div>
<div class="ttc" id="aclassCGeomMultiLine_html_a3063e454f1e7ef2b32484cf8c7db0e97"><div class="ttname"><a href="../../d0/d89/classCGeomMultiLine.html#a3063e454f1e7ef2b32484cf8c7db0e97">CGeomMultiLine::bFindProfileInCoincidentProfilesOfLastLineSegment</a></div><div class="ttdeci">bool bFindProfileInCoincidentProfilesOfLastLineSegment(int const)</div><div class="ttdoc">Returns true if the given profile number is amongst the coincident profiles of the CGeomMultiLine obj...</div><div class="ttdef"><b>Definition</b> <a href="../../db/d80/multi__line_8cpp_source.html#l00179">multi_line.cpp:179</a></div></div>
<div class="ttc" id="aclassCGeomMultiLine_html_a3516022bd96ee15709653b3bb7cc0155"><div class="ttname"><a href="../../d0/d89/classCGeomMultiLine.html#a3516022bd96ee15709653b3bb7cc0155">CGeomMultiLine::nGetNumCoincidentProfilesInLineSegment</a></div><div class="ttdeci">int nGetNumCoincidentProfilesInLineSegment(int const)</div><div class="ttdoc">Returns the count of coincident profiles in a specified line segment, or -1 if the line segment does ...</div><div class="ttdef"><b>Definition</b> <a href="../../db/d80/multi__line_8cpp_source.html#l00169">multi_line.cpp:169</a></div></div>
<div class="ttc" id="aclassCGeomMultiLine_html_a3f99a9c2ac66b75c432941ec88fc8538"><div class="ttname"><a href="../../d0/d89/classCGeomMultiLine.html#a3f99a9c2ac66b75c432941ec88fc8538">CGeomMultiLine::AppendLineSegment</a></div><div class="ttdeci">void AppendLineSegment(void)</div><div class="ttdoc">Appends a new empty line segment.</div><div class="ttdef"><b>Definition</b> <a href="../../db/d80/multi__line_8cpp_source.html#l00040">multi_line.cpp:40</a></div></div>
<div class="ttc" id="aclassCGeomMultiLine_html_a5682956da0d84c928fbafa6f4ff25201"><div class="ttname"><a href="../../d0/d89/classCGeomMultiLine.html#a5682956da0d84c928fbafa6f4ff25201">CGeomMultiLine::nGetProf</a></div><div class="ttdeci">int nGetProf(int const, int const) const</div><div class="ttdoc">Returns the profile number, given a line segment and the index of the co-incident profile for that li...</div><div class="ttdef"><b>Definition</b> <a href="../../db/d80/multi__line_8cpp_source.html#l00253">multi_line.cpp:253</a></div></div>
<div class="ttc" id="aclassCGeomMultiLine_html_a5b5c8a7d272d53dd98279480f7a6a976"><div class="ttname"><a href="../../d0/d89/classCGeomMultiLine.html#a5b5c8a7d272d53dd98279480f7a6a976">CGeomMultiLine::TruncateLineSegments</a></div><div class="ttdeci">void TruncateLineSegments(int const)</div><div class="ttdoc">Cuts short the number of line segments.</div><div class="ttdef"><b>Definition</b> <a href="../../db/d80/multi__line_8cpp_source.html#l00079">multi_line.cpp:79</a></div></div>
<div class="ttc" id="aclassCGeomMultiLine_html_a66541bcbd102c19829637e60f8fe7860"><div class="ttname"><a href="../../d0/d89/classCGeomMultiLine.html#a66541bcbd102c19829637e60f8fe7860">CGeomMultiLine::prVVGetAllLineSegAfter</a></div><div class="ttdeci">vector&lt; vector&lt; pair&lt; int, int &gt; &gt; &gt; prVVGetAllLineSegAfter(int const)</div><div class="ttdoc">Returns a vector of the line segments which succeed the specified line segment number.</div><div class="ttdef"><b>Definition</b> <a href="../../db/d80/multi__line_8cpp_source.html#l00117">multi_line.cpp:117</a></div></div>
<div class="ttc" id="aclassCGeomMultiLine_html_a679d5893191ff6dc5ab6b9acd1f5c770"><div class="ttname"><a href="../../d0/d89/classCGeomMultiLine.html#a679d5893191ff6dc5ab6b9acd1f5c770">CGeomMultiLine::AppendCoincidentProfileToLineSegments</a></div><div class="ttdeci">void AppendCoincidentProfileToLineSegments(pair&lt; int, int &gt; const)</div><div class="ttdoc">Appends a coincident profile pair to the CGeomMultiLine object&#39;s final line segment.</div><div class="ttdef"><b>Definition</b> <a href="../../db/d80/multi__line_8cpp_source.html#l00133">multi_line.cpp:133</a></div></div>
<div class="ttc" id="aclassCGeomMultiLine_html_aaf7c0ab9f64c31133be98ac87b114072"><div class="ttname"><a href="../../d0/d89/classCGeomMultiLine.html#aaf7c0ab9f64c31133be98ac87b114072">CGeomMultiLine::SetProfsLineSeg</a></div><div class="ttdeci">void SetProfsLineSeg(int const, int const, int const)</div><div class="ttdoc">Sets a profile&#39;s own line segment number, given a line segment and the index of the co-incident profi...</div><div class="ttdef"><b>Definition</b> <a href="../../db/d80/multi__line_8cpp_source.html#l00265">multi_line.cpp:265</a></div></div>
<div class="ttc" id="aclassCGeomMultiLine_html_ab0146cd34539f41588924571dbfb2054"><div class="ttname"><a href="../../d0/d89/classCGeomMultiLine.html#ab0146cd34539f41588924571dbfb2054">CGeomMultiLine::pprVGetPairedCoincidentProfilesForLineSegment</a></div><div class="ttdeci">vector&lt; pair&lt; int, int &gt; &gt; * pprVGetPairedCoincidentProfilesForLineSegment(int const)</div><div class="ttdoc">Returns a vector of pairs (a line segment)</div><div class="ttdef"><b>Definition</b> <a href="../../db/d80/multi__line_8cpp_source.html#l00148">multi_line.cpp:148</a></div></div>
<div class="ttc" id="aclassCGeomMultiLine_html_add6b741fa71f3eae355876dcc4232ec8"><div class="ttname"><a href="../../d0/d89/classCGeomMultiLine.html#add6b741fa71f3eae355876dcc4232ec8">CGeomMultiLine::AddCoincidentProfileToExistingLineSegment</a></div><div class="ttdeci">void AddCoincidentProfileToExistingLineSegment(int const, int const, int const)</div><div class="ttdoc">Adds a coincident profile to a pre-existing line segment of the CGeomMultiLine object.</div><div class="ttdef"><b>Definition</b> <a href="../../db/d80/multi__line_8cpp_source.html#l00141">multi_line.cpp:141</a></div></div>
<div class="ttc" id="aclassCGeomMultiLine_html_ae22f845fd065108959610678de571cdb"><div class="ttname"><a href="../../d0/d89/classCGeomMultiLine.html#ae22f845fd065108959610678de571cdb">CGeomMultiLine::nGetNumLineSegments</a></div><div class="ttdeci">int nGetNumLineSegments(void) const</div><div class="ttdoc">Appends a line segment which then inherits from the preceding line segments.</div><div class="ttdef"><b>Definition</b> <a href="../../db/d80/multi__line_8cpp_source.html#l00073">multi_line.cpp:73</a></div></div>
<div class="ttc" id="aclassCGeomProfile_html"><div class="ttname"><a href="../../da/dae/classCGeomProfile.html">CGeomProfile</a></div><div class="ttdoc">Geometry class used to represent coast profile objects.</div><div class="ttdef"><b>Definition</b> <a href="../../de/d45/profile_8h_source.html#l00034">profile.h:35</a></div></div>
<div class="ttc" id="aclassCGeomProfile_html_a0abde0df28990b1a8c20664d2bdcb07f"><div class="ttname"><a href="../../da/dae/classCGeomProfile.html#a0abde0df28990b1a8c20664d2bdcb07f">CGeomProfile::TruncateProfile</a></div><div class="ttdeci">void TruncateProfile(int const)</div><div class="ttdoc">Truncates the profile.</div><div class="ttdef"><b>Definition</b> <a href="../../db/dfa/profile_8cpp_source.html#l00322">profile.cpp:322</a></div></div>
<div class="ttc" id="aclassCGeomProfile_html_a11548359d3db93535befcaf518468f64"><div class="ttname"><a href="../../da/dae/classCGeomProfile.html#a11548359d3db93535befcaf518468f64">CGeomProfile::SetEndOfCoast</a></div><div class="ttdeci">void SetEndOfCoast(bool const)</div><div class="ttdoc">Sets a switch to indicate whether this is an end-of-coast profile.</div><div class="ttdef"><b>Definition</b> <a href="../../db/dfa/profile_8cpp_source.html#l00115">profile.cpp:115</a></div></div>
<div class="ttc" id="aclassCGeomProfile_html_a19aac71e045a17e2c6d98f020f2319fa"><div class="ttname"><a href="../../da/dae/classCGeomProfile.html#a19aac71e045a17e2c6d98f020f2319fa">CGeomProfile::AppendPointInProfile</a></div><div class="ttdeci">void AppendPointInProfile(double const, double const)</div><div class="ttdoc">Appends a point to the profile.</div><div class="ttdef"><b>Definition</b> <a href="../../db/dfa/profile_8cpp_source.html#l00291">profile.cpp:291</a></div></div>
<div class="ttc" id="aclassCGeomProfile_html_a35cb69932b881c6323e749a250bcb3c6"><div class="ttname"><a href="../../da/dae/classCGeomProfile.html#a35cb69932b881c6323e749a250bcb3c6">CGeomProfile::SetProfileDeepWaterWavePeriod</a></div><div class="ttdeci">void SetProfileDeepWaterWavePeriod(double const)</div><div class="ttdoc">Sets the deep-water wave Period for this profile.</div><div class="ttdef"><b>Definition</b> <a href="../../db/dfa/profile_8cpp_source.html#l00595">profile.cpp:595</a></div></div>
<div class="ttc" id="aclassCGeomProfile_html_a442e3a6584e1a5b76e7ace39828f2bfc"><div class="ttname"><a href="../../da/dae/classCGeomProfile.html#a442e3a6584e1a5b76e7ace39828f2bfc">CGeomProfile::bIsPointInProfile</a></div><div class="ttdeci">bool bIsPointInProfile(double const, double const)</div><div class="ttdoc">Removes a line segment from the profile.</div><div class="ttdef"><b>Definition</b> <a href="../../db/dfa/profile_8cpp_source.html#l00368">profile.cpp:368</a></div></div>
<div class="ttc" id="aclassCGeomProfile_html_a45410879aaf7f8f9abc073fc54363d03"><div class="ttname"><a href="../../da/dae/classCGeomProfile.html#a45410879aaf7f8f9abc073fc54363d03">CGeomProfile::SetHitCoast</a></div><div class="ttdeci">void SetHitCoast(bool const)</div><div class="ttdoc">Sets a switch which indicates whether this profile has hit a coast.</div><div class="ttdef"><b>Definition</b> <a href="../../db/dfa/profile_8cpp_source.html#l00163">profile.cpp:163</a></div></div>
<div class="ttc" id="aclassCGeomProfile_html_a549667479e1bf1e9bf5dc1119aeba017"><div class="ttname"><a href="../../da/dae/classCGeomProfile.html#a549667479e1bf1e9bf5dc1119aeba017">CGeomProfile::bProfileOKIncTruncated</a></div><div class="ttdeci">bool bProfileOKIncTruncated(void) const</div><div class="ttdoc">Returns true if this is a problem-free profile, and is not a start-of-coast or an end-of-coast profil...</div><div class="ttdef"><b>Definition</b> <a href="../../db/dfa/profile_8cpp_source.html#l00229">profile.cpp:229</a></div></div>
<div class="ttc" id="aclassCGeomProfile_html_a5bb5e15188369a41d0ae784e6a9ed044"><div class="ttname"><a href="../../da/dae/classCGeomProfile.html#a5bb5e15188369a41d0ae784e6a9ed044">CGeomProfile::SetStartOfCoast</a></div><div class="ttdeci">void SetStartOfCoast(bool const)</div><div class="ttdoc">Sets a switch to indicate whether this is a start-of-coast profile.</div><div class="ttdef"><b>Definition</b> <a href="../../db/dfa/profile_8cpp_source.html#l00103">profile.cpp:103</a></div></div>
<div class="ttc" id="aclassCGeomProfile_html_a6152817d6ec950e1474313ca9824da46"><div class="ttname"><a href="../../da/dae/classCGeomProfile.html#a6152817d6ec950e1474313ca9824da46">CGeomProfile::AppendCellInProfileExtCRS</a></div><div class="ttdeci">void AppendCellInProfileExtCRS(double const, double const)</div><div class="ttdoc">Appends a cell (specified in the external coordinate system) to the profile.</div><div class="ttdef"><b>Definition</b> <a href="../../db/dfa/profile_8cpp_source.html#l00526">profile.cpp:526</a></div></div>
<div class="ttc" id="aclassCGeomProfile_html_a659efb6561fab81177a262e6e0d320f9"><div class="ttname"><a href="../../da/dae/classCGeomProfile.html#a659efb6561fab81177a262e6e0d320f9">CGeomProfile::SetUpCoastAdjacentProfile</a></div><div class="ttdeci">void SetUpCoastAdjacentProfile(CGeomProfile *)</div><div class="ttdef"><b>Definition</b> <a href="../../db/dfa/profile_8cpp_source.html#l00451">profile.cpp:451</a></div></div>
<div class="ttc" id="aclassCGeomProfile_html_a6d4286ac64e3fe9aef428c93fdcd4230"><div class="ttname"><a href="../../da/dae/classCGeomProfile.html#a6d4286ac64e3fe9aef428c93fdcd4230">CGeomProfile::SetHitAnotherProfile</a></div><div class="ttdeci">void SetHitAnotherProfile(bool const)</div><div class="ttdoc">Sets a switch which indicates whether this profile hits another profile badly.</div><div class="ttdef"><b>Definition</b> <a href="../../db/dfa/profile_8cpp_source.html#l00199">profile.cpp:199</a></div></div>
<div class="ttc" id="aclassCGeomProfile_html_a72b3263ad5f64527b4c21307139b3c5f"><div class="ttname"><a href="../../da/dae/classCGeomProfile.html#a72b3263ad5f64527b4c21307139b3c5f">CGeomProfile::PtVGetThisPointAndAllAfter</a></div><div class="ttdeci">vector&lt; CGeom2DPoint &gt; PtVGetThisPointAndAllAfter(int const)</div><div class="ttdoc">Returns a given point from the profile, and all points after this.</div><div class="ttdef"><b>Definition</b> <a href="../../db/dfa/profile_8cpp_source.html#l00355">profile.cpp:355</a></div></div>
<div class="ttc" id="aclassCGeomProfile_html_a753c1ed80d2ebd882faa4181b16aa8c0"><div class="ttname"><a href="../../da/dae/classCGeomProfile.html#a753c1ed80d2ebd882faa4181b16aa8c0">CGeomProfile::SetTruncated</a></div><div class="ttdeci">void SetTruncated(bool const)</div><div class="ttdoc">Sets a switch which indicates whether this profile is truncated.</div><div class="ttdef"><b>Definition</b> <a href="../../db/dfa/profile_8cpp_source.html#l00187">profile.cpp:187</a></div></div>
<div class="ttc" id="aclassCGeomProfile_html_a7928f1a673869c0fa0bef5ff894d75c2"><div class="ttname"><a href="../../da/dae/classCGeomProfile.html#a7928f1a673869c0fa0bef5ff894d75c2">CGeomProfile::bInsertIntersection</a></div><div class="ttdeci">bool bInsertIntersection(double const, double const, int const)</div><div class="ttdoc">Inserts an intersection into the profile.</div><div class="ttdef"><b>Definition</b> <a href="../../db/dfa/profile_8cpp_source.html#l00303">profile.cpp:303</a></div></div>
<div class="ttc" id="aclassCGeomProfile_html_a8dc4e3ce21668f7149ca11aeb7efadf7"><div class="ttname"><a href="../../da/dae/classCGeomProfile.html#a8dc4e3ce21668f7149ca11aeb7efadf7">CGeomProfile::bProfileOK</a></div><div class="ttdeci">bool bProfileOK(void) const</div><div class="ttdoc">Returns true if this is a problem-free profile, and is not a start-of-coast or an end-of-coast profil...</div><div class="ttdef"><b>Definition</b> <a href="../../db/dfa/profile_8cpp_source.html#l00211">profile.cpp:211</a></div></div>
<div class="ttc" id="aclassCGeomProfile_html_a8e440a77b79c7e47db4b825ae2d47593"><div class="ttname"><a href="../../da/dae/classCGeomProfile.html#a8e440a77b79c7e47db4b825ae2d47593">CGeomProfile::SetProfileDeepWaterWaveHeight</a></div><div class="ttdeci">void SetProfileDeepWaterWaveHeight(double const)</div><div class="ttdoc">Sets the deep-water wave height for this profile.</div><div class="ttdef"><b>Definition</b> <a href="../../db/dfa/profile_8cpp_source.html#l00571">profile.cpp:571</a></div></div>
<div class="ttc" id="aclassCGeomProfile_html_a95f2f276944ca8d48f6985a998d9efb6"><div class="ttname"><a href="../../da/dae/classCGeomProfile.html#a95f2f276944ca8d48f6985a998d9efb6">CGeomProfile::SetDownCoastAdjacentProfile</a></div><div class="ttdeci">void SetDownCoastAdjacentProfile(CGeomProfile *)</div><div class="ttdef"><b>Definition</b> <a href="../../db/dfa/profile_8cpp_source.html#l00461">profile.cpp:461</a></div></div>
<div class="ttc" id="aclassCGeomProfile_html_a9fc2d8b0adabc8dfa5b7f8b8400d6252"><div class="ttname"><a href="../../da/dae/classCGeomProfile.html#a9fc2d8b0adabc8dfa5b7f8b8400d6252">CGeomProfile::bIsIntervention</a></div><div class="ttdeci">bool bIsIntervention(void) const</div><div class="ttdoc">Returns true if this is an intervention profile.</div><div class="ttdef"><b>Definition</b> <a href="../../db/dfa/profile_8cpp_source.html#l00607">profile.cpp:607</a></div></div>
<div class="ttc" id="aclassCGeomProfile_html_aa089dda45ee56fe997e3e08a9ab2a305"><div class="ttname"><a href="../../da/dae/classCGeomProfile.html#aa089dda45ee56fe997e3e08a9ab2a305">CGeomProfile::nGetGlobalID</a></div><div class="ttdeci">int nGetGlobalID(void) const</div><div class="ttdoc">Returns the profile&#39;s global ID.</div><div class="ttdef"><b>Definition</b> <a href="../../db/dfa/profile_8cpp_source.html#l00073">profile.cpp:73</a></div></div>
<div class="ttc" id="aclassCGeomProfile_html_aa0bea5b6aab5cb9b77d67b56d8012318"><div class="ttname"><a href="../../da/dae/classCGeomProfile.html#aa0bea5b6aab5cb9b77d67b56d8012318">CGeomProfile::SetHitIntervention</a></div><div class="ttdeci">void SetHitIntervention(bool const)</div><div class="ttdoc">Sets a switch which indicates whether this profile has hit an intervention.</div><div class="ttdef"><b>Definition</b> <a href="../../db/dfa/profile_8cpp_source.html#l00151">profile.cpp:151</a></div></div>
<div class="ttc" id="aclassCGeomProfile_html_aaa8ddb9c775927bdb7940f7826f90a74"><div class="ttname"><a href="../../da/dae/classCGeomProfile.html#aaa8ddb9c775927bdb7940f7826f90a74">CGeomProfile::pPtGetPointInProfile</a></div><div class="ttdeci">CGeom2DPoint * pPtGetPointInProfile(int const)</div><div class="ttdoc">Returns a single point in the profile.</div><div class="ttdef"><b>Definition</b> <a href="../../db/dfa/profile_8cpp_source.html#l00349">profile.cpp:349</a></div></div>
<div class="ttc" id="aclassCGeomProfile_html_aacd98f9837c3c7cf7414764b73275fba"><div class="ttname"><a href="../../da/dae/classCGeomProfile.html#aacd98f9837c3c7cf7414764b73275fba">CGeomProfile::nGetCoastID</a></div><div class="ttdeci">int nGetCoastID(void) const</div><div class="ttdoc">Returns the profile&#39;s coast ID.</div><div class="ttdef"><b>Definition</b> <a href="../../db/dfa/profile_8cpp_source.html#l00067">profile.cpp:67</a></div></div>
<div class="ttc" id="aclassCGeomProfile_html_aafb35166293c29d0492621850d5d06d4"><div class="ttname"><a href="../../da/dae/classCGeomProfile.html#aafb35166293c29d0492621850d5d06d4">CGeomProfile::AppendCellInProfile</a></div><div class="ttdeci">void AppendCellInProfile(CGeom2DIPoint const *)</div><div class="ttdoc">Appends a cell to the profile.</div><div class="ttdef"><b>Definition</b> <a href="../../db/dfa/profile_8cpp_source.html#l00472">profile.cpp:472</a></div></div>
<div class="ttc" id="aclassCGeomProfile_html_ab9adb1e70e847258501607c9b1330d18"><div class="ttname"><a href="../../da/dae/classCGeomProfile.html#ab9adb1e70e847258501607c9b1330d18">CGeomProfile::SetPointInProfile</a></div><div class="ttdeci">void SetPointInProfile(int const, double const, double const)</div><div class="ttdoc">Sets a single point in the profile.</div><div class="ttdef"><b>Definition</b> <a href="../../db/dfa/profile_8cpp_source.html#l00284">profile.cpp:284</a></div></div>
<div class="ttc" id="aclassCGeomProfile_html_abaf88697019588a2b0901bd19044aee4"><div class="ttname"><a href="../../da/dae/classCGeomProfile.html#abaf88697019588a2b0901bd19044aee4">CGeomProfile::nGetProfileSize</a></div><div class="ttdeci">int nGetProfileSize(void) const</div><div class="ttdoc">Returns the number of points in the profile.</div><div class="ttdef"><b>Definition</b> <a href="../../db/dfa/profile_8cpp_source.html#l00342">profile.cpp:342</a></div></div>
<div class="ttc" id="aclassCGeomProfile_html_abe0557d3f6bd86e02facefb28b9fab41"><div class="ttname"><a href="../../da/dae/classCGeomProfile.html#abe0557d3f6bd86e02facefb28b9fab41">CGeomProfile::pPtiGetStartPoint</a></div><div class="ttdeci">CGeom2DIPoint * pPtiGetStartPoint(void)</div><div class="ttdoc">Returns a pointer to the location of the cell (grid CRS) on which the profile starts.</div><div class="ttdef"><b>Definition</b> <a href="../../db/dfa/profile_8cpp_source.html#l00085">profile.cpp:85</a></div></div>
<div class="ttc" id="aclassCGeomProfile_html_ac591314b290b032ffc8a70d22df64ec0"><div class="ttname"><a href="../../da/dae/classCGeomProfile.html#ac591314b290b032ffc8a70d22df64ec0">CGeomProfile::bStartOfCoast</a></div><div class="ttdeci">bool bStartOfCoast(void) const</div><div class="ttdoc">Returns the switch to indicate whether this is a start-of-coast profile.</div><div class="ttdef"><b>Definition</b> <a href="../../db/dfa/profile_8cpp_source.html#l00109">profile.cpp:109</a></div></div>
<div class="ttc" id="aclassCGeomProfile_html_acfba38cf7f54b2889544b4c0cb63e6d5"><div class="ttname"><a href="../../da/dae/classCGeomProfile.html#acfba38cf7f54b2889544b4c0cb63e6d5">CGeomProfile::SetEndPoint</a></div><div class="ttdeci">void SetEndPoint(CGeom2DIPoint const *)</div><div class="ttdoc">Sets the the location of the cell (grid CRS) on which the profile ends.</div><div class="ttdef"><b>Definition</b> <a href="../../db/dfa/profile_8cpp_source.html#l00091">profile.cpp:91</a></div></div>
<div class="ttc" id="aclassCGeomProfile_html_ad5381cb54ceb34b7a566f2757b76ebcb"><div class="ttname"><a href="../../da/dae/classCGeomProfile.html#ad5381cb54ceb34b7a566f2757b76ebcb">CGeomProfile::SetHitLand</a></div><div class="ttdeci">void SetHitLand(bool const)</div><div class="ttdoc">Sets a switch which indicates whether this profile has hit land.</div><div class="ttdef"><b>Definition</b> <a href="../../db/dfa/profile_8cpp_source.html#l00139">profile.cpp:139</a></div></div>
<div class="ttc" id="aclassCGeomProfile_html_ad6723e65baa685812bd966e5e2aad547"><div class="ttname"><a href="../../da/dae/classCGeomProfile.html#ad6723e65baa685812bd966e5e2aad547">CGeomProfile::SetPointsInProfile</a></div><div class="ttdeci">void SetPointsInProfile(vector&lt; CGeom2DPoint &gt; const *)</div><div class="ttdoc">Sets all points in the profile.</div><div class="ttdef"><b>Definition</b> <a href="../../db/dfa/profile_8cpp_source.html#l00278">profile.cpp:278</a></div></div>
<div class="ttc" id="aclassCGeomProfile_html_aec35bc03fc47a65349def96364c99bbd"><div class="ttname"><a href="../../da/dae/classCGeomProfile.html#aec35bc03fc47a65349def96364c99bbd">CGeomProfile::bEndOfCoast</a></div><div class="ttdeci">bool bEndOfCoast(void) const</div><div class="ttdoc">Returns the switch to indicate whether this is an end-of-coast profile.</div><div class="ttdef"><b>Definition</b> <a href="../../db/dfa/profile_8cpp_source.html#l00121">profile.cpp:121</a></div></div>
<div class="ttc" id="aclassCGeomProfile_html_af7caa9a58827f7ab1511e1acfda10bbb"><div class="ttname"><a href="../../da/dae/classCGeomProfile.html#af7caa9a58827f7ab1511e1acfda10bbb">CGeomProfile::SetProfileDeepWaterWaveAngle</a></div><div class="ttdeci">void SetProfileDeepWaterWaveAngle(double const)</div><div class="ttdoc">Sets the deep-water wave orientation for this profile.</div><div class="ttdef"><b>Definition</b> <a href="../../db/dfa/profile_8cpp_source.html#l00583">profile.cpp:583</a></div></div>
<div class="ttc" id="aclassCGeomProfile_html_afef14f6eea8432a83715ec8eb68eac14"><div class="ttname"><a href="../../da/dae/classCGeomProfile.html#afef14f6eea8432a83715ec8eb68eac14">CGeomProfile::SetTooShort</a></div><div class="ttdeci">void SetTooShort(bool const)</div><div class="ttdoc">Sets a switch which indicates whether this profile is too short to be useful.</div><div class="ttdef"><b>Definition</b> <a href="../../db/dfa/profile_8cpp_source.html#l00175">profile.cpp:175</a></div></div>
<div class="ttc" id="aclassCSimulation_html_a0245d3cbdd603fbeced6ca1465eb3f16"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#a0245d3cbdd603fbeced6ca1465eb3f16">CSimulation::m_nLogFileDetail</a></div><div class="ttdeci">int m_nLogFileDetail</div><div class="ttdoc">The level of detail in the log file output. Can be LOG_FILE_LOW_DETAIL, LOG_FILE_MIDDLE_DETAIL,...</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d6a/simulation_8h_source.html#l00531">simulation.h:531</a></div></div>
<div class="ttc" id="aclassCSimulation_html_a115ab27bae37ce2d0de57cbdaeaba852"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#a115ab27bae37ce2d0de57cbdaeaba852">CSimulation::m_dThisIterSWL</a></div><div class="ttdeci">double m_dThisIterSWL</div><div class="ttdoc">The still water level for this timestep (this includes tidal changes and any long-term SWL change)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d6a/simulation_8h_source.html#l00668">simulation.h:668</a></div></div>
<div class="ttc" id="aclassCSimulation_html_a1312f0ac2c93a6cb2bc41c23eb01c293"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#a1312f0ac2c93a6cb2bc41c23eb01c293">CSimulation::m_pRasterGrid</a></div><div class="ttdeci">CGeomRasterGrid * m_pRasterGrid</div><div class="ttdoc">Pointer to the raster grid object.</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d6a/simulation_8h_source.html#l01482">simulation.h:1482</a></div></div>
<div class="ttc" id="aclassCSimulation_html_a1652253500dab35e6f6f9f734207e20b"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#a1652253500dab35e6f6f9f734207e20b">CSimulation::m_nXGridSize</a></div><div class="ttdeci">int m_nXGridSize</div><div class="ttdoc">The size of the grid in the x direction.</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d6a/simulation_8h_source.html#l00429">simulation.h:429</a></div></div>
<div class="ttc" id="aclassCSimulation_html_a1cdb36fc97d2f40d471edc2d59734960"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#a1cdb36fc97d2f40d471edc2d59734960">CSimulation::PtiExtCRSToGridRound</a></div><div class="ttdeci">CGeom2DIPoint PtiExtCRSToGridRound(CGeom2DPoint const *) const</div><div class="ttdoc">Transforms a pointer to a CGeom2DPoint in the external CRS to the equivalent CGeom2DIPoint in the ras...</div><div class="ttdef"><b>Definition</b> <a href="../../db/df7/gis__utils_8cpp_source.html#l00128">gis_utils.cpp:128</a></div></div>
<div class="ttc" id="aclassCSimulation_html_a222962121613613a48f518e0c2110f21"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#a222962121613613a48f518e0c2110f21">CSimulation::LogStream</a></div><div class="ttdeci">ofstream LogStream</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d6a/simulation_8h_source.html#l01772">simulation.h:1772</a></div></div>
<div class="ttc" id="aclassCSimulation_html_a25ada8139c82ca7beab3f279cff83184"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#a25ada8139c82ca7beab3f279cff83184">CSimulation::m_VCoast</a></div><div class="ttdeci">vector&lt; CRWCoast &gt; m_VCoast</div><div class="ttdoc">The coastline objects.</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d6a/simulation_8h_source.html#l01485">simulation.h:1485</a></div></div>
<div class="ttc" id="aclassCSimulation_html_a25f96376f123bba1ac65b1a8588b3c24"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#a25f96376f123bba1ac65b1a8588b3c24">CSimulation::m_dCoastNormalLength</a></div><div class="ttdeci">double m_dCoastNormalLength</div><div class="ttdoc">Length of the coastline-normal profiles, in m.</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d6a/simulation_8h_source.html#l00782">simulation.h:782</a></div></div>
<div class="ttc" id="aclassCSimulation_html_a2cc64ec1030d1a3bdd062076f05367fc"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#a2cc64ec1030d1a3bdd062076f05367fc">CSimulation::MarkProfilesOnGrid</a></div><div class="ttdeci">void MarkProfilesOnGrid(int const, int &amp;)</div><div class="ttdoc">For this coastline, marks all coastline-normal profiles (apart from the two &#39;special&#39; ones at the sta...</div><div class="ttdef"><b>Definition</b> <a href="#l01350">create_profiles.cpp:1350</a></div></div>
<div class="ttc" id="aclassCSimulation_html_a3319d10c724017519510082073494022"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#a3319d10c724017519510082073494022">CSimulation::PtChooseEndPoint</a></div><div class="ttdeci">static CGeom2DPoint PtChooseEndPoint(int const, CGeom2DPoint const *, CGeom2DPoint const *, double const, double const, double const, double const)</div><div class="ttdoc">Choose which end point to use for the coastline-normal profile.</div><div class="ttdef"><b>Definition</b> <a href="#l00829">create_profiles.cpp:829</a></div></div>
<div class="ttc" id="aclassCSimulation_html_a3755fdc07c0ac9f2ce6c2237cfef50ce"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#a3755fdc07c0ac9f2ce6c2237cfef50ce">CSimulation::m_nYGridSize</a></div><div class="ttdeci">int m_nYGridSize</div><div class="ttdoc">The size of the grid in the y direction.</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d6a/simulation_8h_source.html#l00432">simulation.h:432</a></div></div>
<div class="ttc" id="aclassCSimulation_html_a39b5fdbebb3ad6db9ca36ed73f7c47d6"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#a39b5fdbebb3ad6db9ca36ed73f7c47d6">CSimulation::m_dGetFromUnitNormalDist</a></div><div class="ttdeci">normal_distribution&lt; double &gt; m_dGetFromUnitNormalDist</div><div class="ttdoc">c++11 unit normal distribution (mean = 0, stdev = 1)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d6a/simulation_8h_source.html#l01512">simulation.h:1512</a></div></div>
<div class="ttc" id="aclassCSimulation_html_a412f38f95d9e0e6797323316b510ab71"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#a412f38f95d9e0e6797323316b510ab71">CSimulation::CreateRasterizedProfile</a></div><div class="ttdeci">void CreateRasterizedProfile(int const, CGeomProfile *, vector&lt; CGeom2DIPoint &gt; *, vector&lt; bool &gt; *, bool &amp;, bool &amp;, bool &amp;, bool &amp;, bool &amp;, bool &amp;)</div><div class="ttdoc">Given a pointer to a coastline-normal profile, returns an output vector of cells which are &#39;under&#39; ev...</div><div class="ttdef"><b>Definition</b> <a href="#l01464">create_profiles.cpp:1464</a></div></div>
<div class="ttc" id="aclassCSimulation_html_a41d2806566f688547f97c0d573bb1611"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#a41d2806566f688547f97c0d573bb1611">CSimulation::PtAverage</a></div><div class="ttdeci">static CGeom2DPoint PtAverage(CGeom2DPoint const *, CGeom2DPoint const *)</div><div class="ttdoc">Returns a point (external CRS) which is the average of (i.e. is midway between) two other external CR...</div><div class="ttdef"><b>Definition</b> <a href="../../db/df7/gis__utils_8cpp_source.html#l00381">gis_utils.cpp:381</a></div></div>
<div class="ttc" id="aclassCSimulation_html_a45251d09c5a0822fd1ad9199016733d1"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#a45251d09c5a0822fd1ad9199016733d1">CSimulation::nLocateAndCreateGridEdgeProfile</a></div><div class="ttdeci">int nLocateAndCreateGridEdgeProfile(bool const, int const, int &amp;, int &amp;)</div><div class="ttdoc">Creates a &#39;special&#39; profile at each end of a coastline, at the edge of the raster grid....</div><div class="ttdef"><b>Definition</b> <a href="#l00526">create_profiles.cpp:526</a></div></div>
<div class="ttc" id="aclassCSimulation_html_a50e5297e7c9dd45da078e543c04151be"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#a50e5297e7c9dd45da078e543c04151be">CSimulation::m_nCoastNormalSpacing</a></div><div class="ttdeci">int m_nCoastNormalSpacing</div><div class="ttdoc">Average spacing between coastline normals, measured in cells.</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d6a/simulation_8h_source.html#l00450">simulation.h:450</a></div></div>
<div class="ttc" id="aclassCSimulation_html_a545c6a6a1c33942a35ef3ee15c26896f"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#a545c6a6a1c33942a35ef3ee15c26896f">CSimulation::MergeProfilesAtFinalLineSegments</a></div><div class="ttdeci">void MergeProfilesAtFinalLineSegments(int const, CGeomProfile *, CGeomProfile *, int const, int const, double const, double const, double const, double const)</div><div class="ttdoc">Merges two profiles which intersect at their final (most seaward) line segments, seaward of their poi...</div><div class="ttdef"><b>Definition</b> <a href="#l01683">create_profiles.cpp:1683</a></div></div>
<div class="ttc" id="aclassCSimulation_html_a6d38a32401702ff85a6bb65c884db477"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#a6d38a32401702ff85a6bb65c884db477">CSimulation::m_nCoastNormalInterventionSpacing</a></div><div class="ttdeci">int m_nCoastNormalInterventionSpacing</div><div class="ttdoc">Average spacing between coastline normals on interventions, measured in cells.</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d6a/simulation_8h_source.html#l00453">simulation.h:453</a></div></div>
<div class="ttc" id="aclassCSimulation_html_a79672effdabadec1d3eebb9d08ef6248"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#a79672effdabadec1d3eebb9d08ef6248">CSimulation::CheckForIntersectingProfiles</a></div><div class="ttdeci">void CheckForIntersectingProfiles(void)</div><div class="ttdoc">Checks all coastline-normal profiles for intersection, and modifies those that intersect.</div><div class="ttdef"><b>Definition</b> <a href="#l00969">create_profiles.cpp:969</a></div></div>
<div class="ttc" id="aclassCSimulation_html_a7e2a4bd69ce79377fee86aa5598903f8"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#a7e2a4bd69ce79377fee86aa5598903f8">CSimulation::dGridCentroidYToExtCRSY</a></div><div class="ttdeci">double dGridCentroidYToExtCRSY(int const) const</div><div class="ttdoc">Given the integer Y-axis ordinate of a cell in the raster grid CRS, returns the external CRS Y-axis o...</div><div class="ttdef"><b>Definition</b> <a href="../../db/df7/gis__utils_8cpp_source.html#l00071">gis_utils.cpp:71</a></div></div>
<div class="ttc" id="aclassCSimulation_html_a92e9b30175422af3683e614128c1e4ad"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#a92e9b30175422af3683e614128c1e4ad">CSimulation::m_VEdgeCell</a></div><div class="ttdeci">vector&lt; CGeom2DIPoint &gt; m_VEdgeCell</div><div class="ttdoc">Edge cells.</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d6a/simulation_8h_source.html#l01497">simulation.h:1497</a></div></div>
<div class="ttc" id="aclassCSimulation_html_a9332a150a41ac2a38157b22fe3483f15"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#a9332a150a41ac2a38157b22fe3483f15">CSimulation::bCheckForIntersection</a></div><div class="ttdeci">static bool bCheckForIntersection(CGeomProfile *const, CGeomProfile *const, int &amp;, int &amp;, double &amp;, double &amp;, double &amp;, double &amp;)</div><div class="ttdoc">Checks all line segments of a pair of coastline-normal profiles for intersection. If the lines inters...</div><div class="ttdef"><b>Definition</b> <a href="#l01279">create_profiles.cpp:1279</a></div></div>
<div class="ttc" id="aclassCSimulation_html_a9a8f66d4a55299b92d4b1cea9e1d095e"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#a9a8f66d4a55299b92d4b1cea9e1d095e">CSimulation::nGetCoastNormalEndPoint</a></div><div class="ttdeci">int nGetCoastNormalEndPoint(int const, int const, int const, CGeom2DPoint const *, double const, CGeom2DPoint *, CGeom2DIPoint *, bool const)</div><div class="ttdoc">Finds the end point of a coastline-normal line, given the start point on the vector coastline....</div><div class="ttdef"><b>Definition</b> <a href="#l00711">create_profiles.cpp:711</a></div></div>
<div class="ttc" id="aclassCSimulation_html_a9d247d1e2cdf21052d912096a0a5be25"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#a9d247d1e2cdf21052d912096a0a5be25">CSimulation::TruncateProfileAndAppendNew</a></div><div class="ttdeci">void TruncateProfileAndAppendNew(int const, CGeomProfile *, int const, vector&lt; CGeom2DPoint &gt; const *, vector&lt; vector&lt; pair&lt; int, int &gt; &gt; &gt; const *)</div><div class="ttdoc">Truncate a profile at the point of intersection, and do the same for all its co-incident profiles.</div><div class="ttdef"><b>Definition</b> <a href="#l02078">create_profiles.cpp:2078</a></div></div>
<div class="ttc" id="aclassCSimulation_html_a9fbe52d4e0f26ad432f12b7154c599e4"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#a9fbe52d4e0f26ad432f12b7154c599e4">CSimulation::dExtCRSXToGridX</a></div><div class="ttdeci">double dExtCRSXToGridX(double const) const</div><div class="ttdoc">Transforms an X-axis ordinate in the external CRS to the equivalent X-axis ordinate in the raster gri...</div><div class="ttdef"><b>Definition</b> <a href="../../db/df7/gis__utils_8cpp_source.html#l00110">gis_utils.cpp:110</a></div></div>
<div class="ttc" id="aclassCSimulation_html_aa01cba56311299ba9391bcb653107dc4"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#aa01cba56311299ba9391bcb653107dc4">CSimulation::nInsertPointIntoProfilesIfNeededThenUpdate</a></div><div class="ttdeci">int nInsertPointIntoProfilesIfNeededThenUpdate(int const, CGeomProfile *, double const, double const, int const, CGeomProfile *, int const, bool const)</div><div class="ttdoc">Inserts an intersection point into the profile that is to be retained, if that point is not already p...</div><div class="ttdef"><b>Definition</b> <a href="#l01900">create_profiles.cpp:1900</a></div></div>
<div class="ttc" id="aclassCSimulation_html_aa0eddb8270d03b9c1a0a6e96254ebfed"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#aa0eddb8270d03b9c1a0a6e96254ebfed">CSimulation::KeepWithinValidGrid</a></div><div class="ttdeci">void KeepWithinValidGrid(int, int, int &amp;, int &amp;) const</div><div class="ttdoc">Given two points in the grid CRS (the points assumed not to be coincident), this routine modifies the...</div><div class="ttdef"><b>Definition</b> <a href="../../db/df7/gis__utils_8cpp_source.html#l00206">gis_utils.cpp:206</a></div></div>
<div class="ttc" id="aclassCSimulation_html_aab026ce32dae1272a2633b41dd9217d5"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#aab026ce32dae1272a2633b41dd9217d5">CSimulation::m_Rand</a></div><div class="ttdeci">default_random_engine m_Rand[NUMBER_OF_RNGS]</div><div class="ttdoc">The c++11 random number generators.</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d6a/simulation_8h_source.html#l01509">simulation.h:1509</a></div></div>
<div class="ttc" id="aclassCSimulation_html_ab836aff6fe78298ad19c49b8c5d0ce12"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#ab836aff6fe78298ad19c49b8c5d0ce12">CSimulation::nCreateAllProfiles</a></div><div class="ttdeci">int nCreateAllProfiles(void)</div><div class="ttdoc">Create coastline-normal profiles for all coastlines. The first profiles are created &#39;around&#39; the most...</div><div class="ttdef"><b>Definition</b> <a href="#l00066">create_profiles.cpp:66</a></div></div>
<div class="ttc" id="aclassCSimulation_html_ac2e7e204d9e9b527d0a4c941f2e525ad"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#ac2e7e204d9e9b527d0a4c941f2e525ad">CSimulation::dExtCRSYToGridY</a></div><div class="ttdeci">double dExtCRSYToGridY(double const) const</div><div class="ttdoc">Transforms a Y-axis ordinate in the external CRS to the equivalent Y-axis ordinate in the raster grid...</div><div class="ttdef"><b>Definition</b> <a href="../../db/df7/gis__utils_8cpp_source.html#l00119">gis_utils.cpp:119</a></div></div>
<div class="ttc" id="aclassCSimulation_html_ac325da71378069a11991ee97e4cefb79"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#ac325da71378069a11991ee97e4cefb79">CSimulation::m_dCoastNormalRandSpacingFactor</a></div><div class="ttdeci">double m_dCoastNormalRandSpacingFactor</div><div class="ttdoc">Random factor for spacing of along-coast normals.</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d6a/simulation_8h_source.html#l00908">simulation.h:908</a></div></div>
<div class="ttc" id="aclassCSimulation_html_ac900a5701df97da22278fae928951f50"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#ac900a5701df97da22278fae928951f50">CSimulation::bIsWithinValidGrid</a></div><div class="ttdeci">bool bIsWithinValidGrid(int const, int const) const</div><div class="ttdoc">Checks whether the supplied point (an x-y pair, in the grid CRS) is within the raster grid,...</div><div class="ttdef"><b>Definition</b> <a href="../../db/df7/gis__utils_8cpp_source.html#l00170">gis_utils.cpp:170</a></div></div>
<div class="ttc" id="aclassCSimulation_html_acc448020e7a5073f9873c355645efeac"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#acc448020e7a5073f9873c355645efeac">CSimulation::nCreateProfile</a></div><div class="ttdeci">int nCreateProfile(int const, int const, int const, int const, int &amp;, bool const, CGeom2DIPoint const *)</div><div class="ttdoc">Creates a single coastline-normal profile (which may be an intervention profile)</div><div class="ttdef"><b>Definition</b> <a href="#l00448">create_profiles.cpp:448</a></div></div>
<div class="ttc" id="aclassCSimulation_html_ad62124f880fbfa18774fc5fdd4de2dae"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#ad62124f880fbfa18774fc5fdd4de2dae">CSimulation::LocateAndCreateProfiles</a></div><div class="ttdeci">void LocateAndCreateProfiles(int const, int &amp;, int &amp;, vector&lt; bool &gt; *, vector&lt; pair&lt; int, double &gt; &gt; const *)</div><div class="ttdoc">For a single coastline, locate the start points for all coastline-normal profiles (except the grid-ed...</div><div class="ttdef"><b>Definition</b> <a href="#l00286">create_profiles.cpp:286</a></div></div>
<div class="ttc" id="aclassCSimulation_html_ad63ccb95ae85ca79a6f511f3777a6fda"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#ad63ccb95ae85ca79a6f511f3777a6fda">CSimulation::AppendEnsureNoGap</a></div><div class="ttdeci">static void AppendEnsureNoGap(vector&lt; CGeom2DIPoint &gt; *, CGeom2DIPoint const *)</div><div class="ttdoc">Appends a CGeom2DIPoint to a vector&lt;CGeom2DIPoint&gt;, making sure that the new end point touches the pr...</div><div class="ttdef"><b>Definition</b> <a href="../../de/d06/utils_8cpp_source.html#l02317">utils.cpp:2317</a></div></div>
<div class="ttc" id="aclassCSimulation_html_ad67e8c5b30a0572f64ecfb5c062c2edc"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#ad67e8c5b30a0572f64ecfb5c062c2edc">CSimulation::m_ulIter</a></div><div class="ttdeci">unsigned long m_ulIter</div><div class="ttdoc">The number of the current iteration (time step)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d6a/simulation_8h_source.html#l00554">simulation.h:554</a></div></div>
<div class="ttc" id="aclassCSimulation_html_ad79b925ac5f358c6f867b6e47dad74bd"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#ad79b925ac5f358c6f867b6e47dad74bd">CSimulation::dGridCentroidXToExtCRSX</a></div><div class="ttdeci">double dGridCentroidXToExtCRSX(int const) const</div><div class="ttdoc">Given the integer X-axis ordinate of a cell in the raster grid CRS, returns the external CRS X-axis o...</div><div class="ttdef"><b>Definition</b> <a href="../../db/df7/gis__utils_8cpp_source.html#l00062">gis_utils.cpp:62</a></div></div>
<div class="ttc" id="aclassCSimulation_html_add4b97b29fde8394685fa5802467731d"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#add4b97b29fde8394685fa5802467731d">CSimulation::TruncateOneProfileRetainOtherProfile</a></div><div class="ttdeci">void TruncateOneProfileRetainOtherProfile(int const, CGeomProfile *, CGeomProfile *, double, double, int, int, bool const)</div><div class="ttdoc">Truncates one intersecting profile at the point of intersection, and retains the other profile.</div><div class="ttdef"><b>Definition</b> <a href="#l01826">create_profiles.cpp:1826</a></div></div>
<div class="ttc" id="aclassCSimulation_html_ae0de69c3d3acd6d52dc2ec2f456c0eb5"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#ae0de69c3d3acd6d52dc2ec2f456c0eb5">CSimulation::m_dCellSide</a></div><div class="ttdeci">double m_dCellSide</div><div class="ttdoc">Length of a cell side (in external CRS units)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d6a/simulation_8h_source.html#l00614">simulation.h:614</a></div></div>
<div class="ttc" id="aclassCSimulation_html_aecac3135005148dc01ee8ba3871b7fbf"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#aecac3135005148dc01ee8ba3871b7fbf">CSimulation::m_dDepthOfClosure</a></div><div class="ttdeci">double m_dDepthOfClosure</div><div class="ttdoc">Depth of closure (in m) TODO 007 can be calculated using Hallermeier, R.J. (1978) or Birkemeier (1985...</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d6a/simulation_8h_source.html#l00773">simulation.h:773</a></div></div>
<div class="ttc" id="aclassCSimulation_html_aed074f354a224885417cf8180c86c3df"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#aed074f354a224885417cf8180c86c3df">CSimulation::nCheckAllProfiles</a></div><div class="ttdeci">int nCheckAllProfiles(void)</div><div class="ttdoc">Check all coastline-normal profiles and modify the profiles if they intersect, then mark valid profil...</div><div class="ttdef"><b>Definition</b> <a href="#l01166">create_profiles.cpp:1166</a></div></div>
<div class="ttc" id="aclassCSimulation_html_afd26dea91f56fe78fa7c9740c81156d9"><div class="ttname"><a href="../../d1/d98/classCSimulation.html#afd26dea91f56fe78fa7c9740c81156d9">CSimulation::m_VEdgeCellEdge</a></div><div class="ttdeci">vector&lt; int &gt; m_VEdgeCellEdge</div><div class="ttdoc">The grid edge that each edge cell belongs to.</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d6a/simulation_8h_source.html#l01500">simulation.h:1500</a></div></div>
<div class="ttc" id="acme_8h_html"><div class="ttname"><a href="../../d6/d2a/cme_8h.html">cme.h</a></div><div class="ttdoc">This file contains global definitions for CoastalME.</div></div>
<div class="ttc" id="acme_8h_html_a01aa8b423260b337ddff2016107b51a0"><div class="ttname"><a href="../../d6/d2a/cme_8h.html#a01aa8b423260b337ddff2016107b51a0">INT_NODATA</a></div><div class="ttdeci">int const INT_NODATA</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d2a/cme_8h_source.html#l00365">cme.h:365</a></div></div>
<div class="ttc" id="acme_8h_html_a068017859403c0629d89f8d348f6c224"><div class="ttname"><a href="../../d6/d2a/cme_8h.html#a068017859403c0629d89f8d348f6c224">tMin</a></div><div class="ttdeci">T tMin(T a, T b)</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d2a/cme_8h_source.html#l01138">cme.h:1138</a></div></div>
<div class="ttc" id="acme_8h_html_a08b1623863ee3bd4300a8892de323722"><div class="ttname"><a href="../../d6/d2a/cme_8h.html#a08b1623863ee3bd4300a8892de323722">TOLERANCE</a></div><div class="ttdeci">double const TOLERANCE</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d2a/cme_8h_source.html#l00699">cme.h:699</a></div></div>
<div class="ttc" id="acme_8h_html_a1fcc0be2e2596fdd6617288a184a0493"><div class="ttname"><a href="../../d6/d2a/cme_8h.html#a1fcc0be2e2596fdd6617288a184a0493">RTN_ERR_COAST_CANT_FIND_EDGE_CELL</a></div><div class="ttdeci">int const RTN_ERR_COAST_CANT_FIND_EDGE_CELL</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d2a/cme_8h_source.html#l00638">cme.h:638</a></div></div>
<div class="ttc" id="acme_8h_html_a292fc90846543ca4814daa9f759feb05"><div class="ttname"><a href="../../d6/d2a/cme_8h.html#a292fc90846543ca4814daa9f759feb05">ERR</a></div><div class="ttdeci">string const ERR</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d2a/cme_8h_source.html#l00777">cme.h:777</a></div></div>
<div class="ttc" id="acme_8h_html_a29fcc12f725cf70f82b391b4fd46d171"><div class="ttname"><a href="../../d6/d2a/cme_8h.html#a29fcc12f725cf70f82b391b4fd46d171">DIRECTION_DOWNCOAST</a></div><div class="ttdeci">int const DIRECTION_DOWNCOAST</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d2a/cme_8h_source.html#l00395">cme.h:395</a></div></div>
<div class="ttc" id="acme_8h_html_a3199710e1049a0b077b1cb4276d262d1"><div class="ttname"><a href="../../d6/d2a/cme_8h.html#a3199710e1049a0b077b1cb4276d262d1">ACCEPT_TRUNCATED_PROFILES</a></div><div class="ttdeci">bool const ACCEPT_TRUNCATED_PROFILES</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d2a/cme_8h_source.html#l00346">cme.h:346</a></div></div>
<div class="ttc" id="acme_8h_html_a540d8a94fc09b0b14fd8ab657445b67a"><div class="ttname"><a href="../../d6/d2a/cme_8h.html#a540d8a94fc09b0b14fd8ab657445b67a">LOG_FILE_MIDDLE_DETAIL</a></div><div class="ttdeci">int const LOG_FILE_MIDDLE_DETAIL</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d2a/cme_8h_source.html#l00380">cme.h:380</a></div></div>
<div class="ttc" id="acme_8h_html_a61afa8560a3b39c80657661a1d8f76ab"><div class="ttname"><a href="../../d6/d2a/cme_8h.html#a61afa8560a3b39c80657661a1d8f76ab">bFPIsEqual</a></div><div class="ttdeci">bool bFPIsEqual(const T d1, const T d2, const T dEpsilon)</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d2a/cme_8h_source.html#l01178">cme.h:1178</a></div></div>
<div class="ttc" id="acme_8h_html_a7e895b460cef877dec4d12ead0c74f15"><div class="ttname"><a href="../../d6/d2a/cme_8h.html#a7e895b460cef877dec4d12ead0c74f15">tMax</a></div><div class="ttdeci">T tMax(T a, T b)</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d2a/cme_8h_source.html#l01125">cme.h:1125</a></div></div>
<div class="ttc" id="acme_8h_html_a826c2bcca39c6c900b6d87757b2ab393"><div class="ttname"><a href="../../d6/d2a/cme_8h.html#a826c2bcca39c6c900b6d87757b2ab393">RTN_ERR_PROFILE_END_INSUFFICIENT_DEPTH</a></div><div class="ttdeci">int const RTN_ERR_PROFILE_END_INSUFFICIENT_DEPTH</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d2a/cme_8h_source.html#l00608">cme.h:608</a></div></div>
<div class="ttc" id="acme_8h_html_a8f6a3504fb8861c1f92c19af69ea2250"><div class="ttname"><a href="../../d6/d2a/cme_8h.html#a8f6a3504fb8861c1f92c19af69ea2250">PROFILE_CHECK_DIST_FROM_COAST</a></div><div class="ttdeci">int const PROFILE_CHECK_DIST_FROM_COAST</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d2a/cme_8h_source.html#l00676">cme.h:676</a></div></div>
<div class="ttc" id="acme_8h_html_a957ca99e98618160534cafb0929f743d"><div class="ttname"><a href="../../d6/d2a/cme_8h.html#a957ca99e98618160534cafb0929f743d">WARN</a></div><div class="ttdeci">string const WARN</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d2a/cme_8h_source.html#l00778">cme.h:778</a></div></div>
<div class="ttc" id="acme_8h_html_a9acebe36530eff4f7cf08ea03d7da760"><div class="ttname"><a href="../../d6/d2a/cme_8h.html#a9acebe36530eff4f7cf08ea03d7da760">RTN_ERR_NO_PROFILES_2</a></div><div class="ttdeci">int const RTN_ERR_NO_PROFILES_2</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d2a/cme_8h_source.html#l00610">cme.h:610</a></div></div>
<div class="ttc" id="acme_8h_html_a9e2e05614e11bb2eeecad6383fbe17bd"><div class="ttname"><a href="../../d6/d2a/cme_8h.html#a9e2e05614e11bb2eeecad6383fbe17bd">RTN_ERR_PROFILE_ENDPOINT_IS_INLAND</a></div><div class="ttdeci">int const RTN_ERR_PROFILE_ENDPOINT_IS_INLAND</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d2a/cme_8h_source.html#l00606">cme.h:606</a></div></div>
<div class="ttc" id="acme_8h_html_aa58b13ad2e88aaa20449bfea242396a4"><div class="ttname"><a href="../../d6/d2a/cme_8h.html#aa58b13ad2e88aaa20449bfea242396a4">LOG_FILE_ALL</a></div><div class="ttdeci">int const LOG_FILE_ALL</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d2a/cme_8h_source.html#l00382">cme.h:382</a></div></div>
<div class="ttc" id="acme_8h_html_aa768cb14b5c6123ee95e6e4ebd9fe331"><div class="ttname"><a href="../../d6/d2a/cme_8h.html#aa768cb14b5c6123ee95e6e4ebd9fe331">RTN_OK</a></div><div class="ttdeci">int const RTN_OK</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d2a/cme_8h_source.html#l00580">cme.h:580</a></div></div>
<div class="ttc" id="acme_8h_html_ab4869c0fb8ec425940f898430be5e46a"><div class="ttname"><a href="../../d6/d2a/cme_8h.html#ab4869c0fb8ec425940f898430be5e46a">RTN_ERR_NO_PROFILES_1</a></div><div class="ttdeci">int const RTN_ERR_NO_PROFILES_1</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d2a/cme_8h_source.html#l00609">cme.h:609</a></div></div>
<div class="ttc" id="acme_8h_html_abd7b3a789b8f318e39b67dc1cf4a2673"><div class="ttname"><a href="../../d6/d2a/cme_8h.html#abd7b3a789b8f318e39b67dc1cf4a2673">RTN_ERR_CANNOT_INSERT_POINT</a></div><div class="ttdeci">int const RTN_ERR_CANNOT_INSERT_POINT</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d2a/cme_8h_source.html#l00629">cme.h:629</a></div></div>
<div class="ttc" id="acme_8h_html_abe5cabe81fdbe153e73fd894b3794e50"><div class="ttname"><a href="../../d6/d2a/cme_8h.html#abe5cabe81fdbe153e73fd894b3794e50">DIRECTION_UPCOAST</a></div><div class="ttdeci">int const DIRECTION_UPCOAST</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d2a/cme_8h_source.html#l00396">cme.h:396</a></div></div>
<div class="ttc" id="acme_8h_html_ac5528230f00386b7317458e308458f5e"><div class="ttname"><a href="../../d6/d2a/cme_8h.html#ac5528230f00386b7317458e308458f5e">strDblToStr</a></div><div class="ttdeci">string strDblToStr(const T &amp;t)</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d2a/cme_8h_source.html#l01164">cme.h:1164</a></div></div>
<div class="ttc" id="acme_8h_html_ace82416ca7fb524bd4da49c3d402b082"><div class="ttname"><a href="../../d6/d2a/cme_8h.html#ace82416ca7fb524bd4da49c3d402b082">RTN_ERR_NO_SOLUTION_FOR_ENDPOINT</a></div><div class="ttdeci">int const RTN_ERR_NO_SOLUTION_FOR_ENDPOINT</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d2a/cme_8h_source.html#l00607">cme.h:607</a></div></div>
<div class="ttc" id="acme_8h_html_ade186989e07cd54874887cd10d4a8465"><div class="ttname"><a href="../../d6/d2a/cme_8h.html#ade186989e07cd54874887cd10d4a8465">RIGHT_HANDED</a></div><div class="ttdeci">int const RIGHT_HANDED</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d2a/cme_8h_source.html#l00400">cme.h:400</a></div></div>
<div class="ttc" id="acme_8h_html_ae3b6dc50cfc97050529faa5e0bd66136"><div class="ttname"><a href="../../d6/d2a/cme_8h.html#ae3b6dc50cfc97050529faa5e0bd66136">tAbs</a></div><div class="ttdeci">T tAbs(T a)</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d2a/cme_8h_source.html#l01150">cme.h:1150</a></div></div>
<div class="ttc" id="acme_8h_html_afb9499d46447e0115ed3abc66ce28a7d"><div class="ttname"><a href="../../d6/d2a/cme_8h.html#afb9499d46447e0115ed3abc66ce28a7d">LF_CAT_INTERVENTION</a></div><div class="ttdeci">int const LF_CAT_INTERVENTION</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d2a/cme_8h_source.html#l00434">cme.h:434</a></div></div>
<div class="ttc" id="acme_8h_html_afdd3411d0fa60c62522af14ea2a90570"><div class="ttname"><a href="../../d6/d2a/cme_8h.html#afdd3411d0fa60c62522af14ea2a90570">LEFT_HANDED</a></div><div class="ttdeci">int const LEFT_HANDED</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d2a/cme_8h_source.html#l00401">cme.h:401</a></div></div>
<div class="ttc" id="acoast_8h_html"><div class="ttname"><a href="../../de/d65/coast_8h.html">coast.h</a></div><div class="ttdoc">Contains CRWCoast definitions.</div></div>
<div class="ttc" id="acreate__profiles_8cpp_html_ae04a8509dc0ab747823a37fe3bb91f26"><div class="ttname"><a href="../../da/db2/create__profiles_8cpp.html#ae04a8509dc0ab747823a37fe3bb91f26">bCurvaturePairCompareDescending</a></div><div class="ttdeci">bool bCurvaturePairCompareDescending(const pair&lt; int, double &gt; &amp;prLeft, const pair&lt; int, double &gt; &amp;prRight)</div><div class="ttdoc">Function used to sort coastline curvature values when locating start points of normal profiles.</div><div class="ttdef"><b>Definition</b> <a href="#l00057">create_profiles.cpp:57</a></div></div>
<div class="ttc" id="asimulation_8h_html"><div class="ttname"><a href="../../dd/d6a/simulation_8h.html">simulation.h</a></div><div class="ttdoc">Contains CSimulation definitions.</div></div>
<div class="ttc" id="autils__global_8cpp_html_a20842d0a19d0ca952c91f3e1eb175fee"><div class="ttname"><a href="../../d2/dfd/utils__global_8cpp.html#a20842d0a19d0ca952c91f3e1eb175fee">nRound</a></div><div class="ttdeci">int nRound(double const d)</div><div class="ttdoc">Version of the above that returns an int.</div><div class="ttdef"><b>Definition</b> <a href="../../d2/dfd/utils__global_8cpp_source.html#l00056">utils_global.cpp:56</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="../../da/db2/create__profiles_8cpp.html">create_profiles.cpp</a></li>
    <li class="footer">Generated on Fri Apr 11 2025 10:55:20 for CoastalME (Coastal Modelling Environment) by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
</body>
</html>
